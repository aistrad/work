The file /home/aiscend/work/vibelife/apps/api/routes/skills.py has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
   248→        }
   249→    }
   250→
   251→
   252→@router.get("/recommendations")
   253→async def get_recommendations(
   254→    limit: int = Query(default=3, le=10, description="返回数量"),
   255→    context: Optional[str] = Query(None, description="当前对话上下文"),
   256→    current_user: CurrentUser = Depends(get_current_user),
   257→):
   258→    """
   259→    获取推荐 Skill
   260→
   261→    v7.5: 使用数据库优先加载
   262→
   263→    基于用户档案、使用历史和对话上下文推荐 Skill。
   264→
   265→    Args:
   266→        limit: 返回数量，默认 3，最大 10
   267→        context: 当前对话上下文（关键词）
   268→
   269→    Returns:
   270→        recommendations: 推荐 Skill 列表
   271→    """
   272→    # 获取用户已订阅和已屏蔽的 Skill
   273→    subscribed_ids = await SkillSubscriptionRepository.get_subscribed_skill_ids(current_user.user_id)
   274→    blocked_ids = await SkillRecommendationBlockRepository.get_blocked_skills(current_user.user_id)
   275→
   276→    # v7.5: 使用 async 函数
   277→    all_skills = await get_all_skill_metadata_async()
   278→
   279→    # 过滤：未订阅 + 未屏蔽 + 非 core
   280→    candidates = [
   281→        s for s in all_skills
   282→        if s.id not in subscribed_ids
   283→        and s.id not in blocked_ids
   284→        and s.category != "core"
   285→    ]
   286→
   287→    recommendations = []
   288→    for skill in candidates[:limit]:
   289→        # 简单推荐逻辑：基于触发词匹配
   290→        reason = "featured"
   291→        context_text = f"试试「{skill.name}」，{skill.showcase.tagline or skill.description}"
   292→
   293→        if context:
   294→            # 检查上下文是否匹配触发词
   295→            for trigger in skill.triggers:
   296→                if trigger in context:
   297→                    reason = "based_on_conversation"
   298→                    context_text = f"你提到了「{trigger}」，{skill.name} 可以帮助你。"
   299→                    break
   300→
   301→        # 获取试用次数
   302→        trial_used = await SkillSubscriptionRepository.get_trial_usage(current_user.user_id, skill.id)
   303→        trial_remaining = skill.pricing.trial_messages - trial_used if skill.pricing.type != "free" else None
   304→
   305→        recommendations.append({
   306→            "skill_id": skill.id,
   307→            "skill": {
   308→                "id": skill.id,
   309→                "name": skill.name,
   310→                "icon": skill.icon,
   311→                "color": skill.color,
   312→                "tagline": skill.showcase.tagline,
   313→            },
   314→            "reason": reason,
   315→            "context": context_text,
   316→            "score": 0.8,
   317→            "trial_messages_remaining": trial_remaining,
   318→        })
   319→
   320→    return {
   321→        "recommendations": recommendations,
   322→        "generated_at": datetime.utcnow().isoformat(),
   323→    }
   324→
   325→
   326→@router.get("/featured")
   327→async def get_featured():