The file /home/aiscend/work/vibelife/apps/api/routes/skills.py has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
   141→# ═══════════════════════════════════════════════════════════════════════════
   142→# Endpoints
   143→# ═══════════════════════════════════════════════════════════════════════════
   144→
   145→@router.get("")
   146→async def list_skills(
   147→    category: Optional[str] = Query(None, description="按分类筛选: core, default, professional"),
   148→    subscribed: Optional[bool] = Query(None, description="只返回已订阅的 Skill"),
   149→    current_user: Optional[CurrentUser] = Depends(get_optional_user),
   150→):
   151→    """
   152→    获取所有 Skill 列表（带元数据和订阅状态）
   153→
   154→    v7.5: 使用数据库优先加载，支持动态配置
   155→
   156→    Args:
   157→        category: 按分类筛选 (core/default/professional)
   158→        subscribed: 只返回已订阅的 Skill
   159→
   160→    Returns:
   161→        skills: Skill 列表，包含元数据和用户订阅状态
   162→        categories: 分类统计
   163→        total: 总数
   164→    """
   165→    # v7.5: 使用 async 函数（数据库优先）
   166→    if category:
   167→        all_metadata = await get_skills_by_category_async(category)
   168→    else:
   169→        all_metadata = await get_all_skill_metadata_async()
   170→
   171→    # 获取用户订阅状态
   172→    user_statuses = {}
   173→    if current_user:
   174→        subscriptions = await SkillSubscriptionRepository.get_user_subscriptions(current_user.user_id)
   175→        user_statuses = {s.skill_id: s for s in subscriptions}
   176→
   177→    # 构建响应
   178→    skills = []
   179→    for metadata in all_metadata:
   180→        skill_dict = metadata.to_dict()
   181→        sub = user_statuses.get(metadata.id)
   182→
   183→        # 计算试用剩余次数
   184→        trial_limit = metadata.pricing.trial_messages if metadata.pricing.type != "free" else None
   185→        trial_used = sub.trial_messages_used if sub else 0
   186→
   187→        skill_dict["user_status"] = {
   188→            "subscribed": sub.status == "subscribed" if sub else False,
   189→            "push_enabled": sub.push_enabled if sub else False,
   190→            "trial_messages_used": trial_used,
   191→            "trial_messages_remaining": (trial_limit - trial_used) if trial_limit else None,
   192→        }
   193→
   194→        # 筛选已订阅
   195→        if subscribed is not None:
   196→            is_subscribed = skill_dict["user_status"]["subscribed"]
   197→            if subscribed and not is_subscribed:
   198→                continue
   199→            if not subscribed and is_subscribed:
   200→                continue
   201→
   202→        skills.append(skill_dict)
   203→
   204→    # v7.5: 使用 async 函数获取分类统计
   205→    categories = await get_skill_categories_summary_async()
   206→
   207→    return {"skills": skills, "categories": categories, "total": len(skills)}
   208→
   209→
   210→# ═══════════════════════════════════════════════════════════════════════════
   211→# 订阅管理端点 (v7.4)