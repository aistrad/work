The file /home/aiscend/work/vibelife/apps/api/services/agent/skill_loader.py has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
   513â†’        external_tools=data.get("external_tools", []),  # v7.3
   514â†’    )
   515â†’
   516â†’
   517â†’@lru_cache(maxsize=32)
   518â†’def load_skill_metadata(skill_id: str) -> Optional[SkillMetadata]:
   519â†’    """åŠ è½½ Skill å…ƒæ•°æ®ï¼ˆç”¨äº Skill Management APIï¼‰- v7.4 æ–°å¢
   520â†’
   521â†’    ä» SKILL.md çš„ frontmatter ä¸­è¯»å–å®Œæ•´çš„å…ƒæ•°æ®é…ç½®ï¼Œ
   522â†’    åŒ…æ‹¬ category, pricing, showcase, subscription ç­‰å­—æ®µã€‚
   523â†’    """
   524â†’    skill_path = SKILLS_DIR / skill_id / "SKILL.md"
   525â†’    if not skill_path.exists():
   526â†’        return None
   527â†’
   528â†’    text = skill_path.read_text(encoding='utf-8')
   529â†’    metadata, _ = parse_frontmatter(text)
   530â†’
   531â†’    # ä» description ä¸­æå–è§¦å‘è¯ï¼ˆå¦‚æœ frontmatter ä¸­æ²¡æœ‰ï¼‰
   532â†’    triggers = metadata.get("triggers", [])
   533â†’    if not triggers:
   534â†’        description = metadata.get("description", "")
   535â†’        trigger_match = re.search(r'è§¦å‘è¯[ï¼š:]\s*([^ã€‚.]+)', description)
   536â†’        if trigger_match:
   537â†’            trigger_str = trigger_match.group(1)
   538â†’            triggers = [t.strip() for t in re.split(r'[ã€,ï¼Œ]', trigger_str) if t.strip()]
   539â†’
   540â†’    # è§£æ pricing
   541â†’    pricing_data = metadata.get("pricing", {})
   542â†’    pricing = SkillPricing(
   543â†’        type=pricing_data.get("type", "free") if isinstance(pricing_data, dict) else "free",
   544â†’        trial_messages=pricing_data.get("trial_messages", 3) if isinstance(pricing_data, dict) else 3,
   545â†’        credits_per_use=pricing_data.get("credits_per_use") if isinstance(pricing_data, dict) else None,
   546â†’    )
   547â†’
   548â†’    # è§£æ features
   549â†’    features_data = metadata.get("features", [])
   550â†’    features = []
   551â†’    if isinstance(features_data, list):
   552â†’        for f in features_data:
   553â†’            if isinstance(f, dict):
   554â†’                features.append(SkillFeature(
   555â†’                    name=f.get("name", ""),
   556â†’                    description=f.get("description", ""),
   557â†’                    icon=f.get("icon", "ğŸ“Œ"),
   558â†’                    tier=f.get("tier", "free"),
   559â†’                ))
   560â†’
   561â†’    # è§£æ showcase
   562â†’    showcase_data = metadata.get("showcase", {})
   563â†’    showcase = SkillShowcase(
   564â†’        tagline=showcase_data.get("tagline", "") if isinstance(showcase_data, dict) else "",
   565â†’        highlights=showcase_data.get("highlights", []) if isinstance(showcase_data, dict) else [],
   566â†’        preview_image=showcase_data.get("preview_image") if isinstance(showcase_data, dict) else None,
   567â†’        demo_prompts=showcase_data.get("demo_prompts", []) if isinstance(showcase_data, dict) else [],
   568â†’    )
   569â†’
   570â†’    # è§£æ subscription
   571â†’    subscription_data = metadata.get("subscription", {})
   572â†’    category = metadata.get("category", "professional")
   573â†’    subscription = SkillSubscription(
   574â†’        auto_subscribe=subscription_data.get("auto_subscribe", category == "default") if isinstance(subscription_data, dict) else (category == "default"),
   575â†’        can_unsubscribe=subscription_data.get("can_unsubscribe", category != "core") if isinstance(subscription_data, dict) else (category != "core"),
   576â†’        push_default=subscription_data.get("push_default", True) if isinstance(subscription_data, dict) else True,
   577â†’        min_subscription_days=subscription_data.get("min_subscription_days", 0) if isinstance(subscription_data, dict) else 0,
   578â†’    )
   579â†’
   580â†’    return SkillMetadata(
   581â†’        id=metadata.get("id", skill_id),
   582â†’        name=metadata.get("name", skill_id),
   583â†’        description=metadata.get("description", ""),
   584â†’        version=metadata.get("version", "1.0.0"),
   585â†’        category=category,
   586â†’        icon=metadata.get("icon", "ğŸ’¡"),
   587â†’        color=metadata.get("color", "#6B7280"),
   588â†’        triggers=triggers,
   589â†’        pricing=pricing,
   590â†’        features=features,
   591â†’        showcase=showcase,
   592â†’        subscription=subscription,
   593â†’    )
   594â†’
   595â†’
   596â†’def get_all_skill_metadata() -> List[SkillMetadata]:
   597â†’    """è·å–æ‰€æœ‰å¯ç”¨ Skill çš„å…ƒæ•°æ®ï¼ˆç”¨äº Skill åˆ—è¡¨ APIï¼‰- v7.4 æ–°å¢"""
   598â†’    skills = []
   599â†’    for skill_id in get_available_skills():
   600â†’        metadata = load_skill_metadata(skill_id)
   601â†’        if metadata:
   602â†’            skills.append(metadata)
   603â†’    return skills
   604â†’
   605â†’
   606â†’def get_skills_by_category(category: str) -> List[SkillMetadata]:
   607â†’    """æŒ‰åˆ†ç±»è·å– Skill åˆ—è¡¨ - v7.4 æ–°å¢
   608â†’
   609â†’    Args:
   610â†’        category: core | default | professional
   611â†’
   612â†’    Returns:
   613â†’        è¯¥åˆ†ç±»ä¸‹æ‰€æœ‰ Skill çš„å…ƒæ•°æ®åˆ—è¡¨
   614â†’    """
   615â†’    return [s for s in get_all_skill_metadata() if s.category == category]
   616â†’
   617â†’
   618â†’@lru_cache(maxsize=64)
   619â†’def load_scenario(skill_id: str, scenario_id: str) -> Optional[ScenarioConfig]:
   620â†’    """åŠ è½½åœºæ™¯é…ç½®"""
   621â†’    scenario_path = SKILLS_DIR / skill_id / "scenarios" / f"{scenario_id}.md"
   622â†’    if not scenario_path.exists():
   623â†’        return None
   624â†’
   625â†’    text = scenario_path.read_text(encoding='utf-8')