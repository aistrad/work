     1→# 案例提取 Prompt 模板 v2
     2→
     3→> 此 Prompt 在 Claude Code 中手动执行，不调用外部 LLM API。
     4→> **核心理念**：从"结论导向"转向"推理导向"，提取专家的思维过程而非仅提取结论。
     5→
     6→## 设计原则
     7→
     8→```
     9→┌─────────────────────────────────────────────────────────────────────────────┐
    10→│                                                                             │
    11→│   旧模式：提取"结论"                                                        │
    12→│   ─────────────────                                                        │
    13→│   { "pattern": "正官格", "strength": "身强" }  ← 用户只能看到结论           │
    14→│                                                                             │
    15→│   新模式：提取"推理链条"                                                    │
    16→│   ─────────────────────                                                    │
    17→│   { "reasoning_chain": [                                                   │
    18→│       { "observation": "...", "analysis": "...", "conclusion": "..." }    │
    19→│     ]                                                                      │
    20→│   }  ← 用户能看到专家的思维过程                                            │
    21→│                                                                             │
    22→└─────────────────────────────────────────────────────────────────────────────┘
    23→```
    24→
    25→---
    26→
    27→## 使用方法
    28→
    29→1. 从 knowledge_chunks 表中读取待分析的文本
    30→2. 确定该 Skill 的思维架构体系（参考 SKILL.md）
    31→3. 将文本填入下方模板
    32→4. 在 Claude Code 中执行 prompt
    33→5. 将结果手动写入 cases 表
    34→
    35→---
    36→
    37→## Prompt 模板
    38→
    39→```
    40→请从以下{skill_name}专业文本中提取案例。
    41→
    42→## Skill类型: {skill_id}
    43→
    44→## 该 Skill 的思维架构体系
    45→
    46→{thinking_frameworks}
    47→
    48→## 案例数据结构
    49→
    50→### core_data (核心数据)
    51→{core_data_schema}
    52→
    53→### features (特征数据)
    54→{features_schema}
    55→
    56→## 待分析文本
    57→
    58→{text}
    59→
    60→## 提取要求
    61→
    62→### 1. 基础信息提取
    63→- name: 案例名称/标题
    64→- core_data: 核心数据 (按上述结构)
    65→- features: 特征数据 (按上述结构)
    66→
    67→### 2. 推理链条提取 (关键)
    68→
    69→从文本中识别专家的推理过程，提取为 reasoning_chain 数组：
    70→
    71→每个推理步骤包含：
    72→| 字段 | 说明 |
    73→|------|------|
    74→| step | 步骤序号 (1, 2, 3...) |
    75→| framework | 使用的思维架构名称 |
    76→| observation | 专家观察到的特征/现象 |
    77→| analysis | 专家的分析推理过程 |
    78→| conclusion | 该步骤得出的结论 |
    79→
    80→示例：
    81→{
    82→  "reasoning_chain": [
    83→    {
    84→      "step": 1,
    85→      "framework": "客体思维架构",
    86→      "observation": "劫财辛金透出于年柱",
    87→      "analysis": "劫财被正官丁火克制，力量被削弱",
    88→      "conclusion": "劫财弱势，反衬比肩特质强势"
    89→    },
    90→    {
    91→      "step": 2,
    92→      "framework": "柱位思维架构",
    93→      "observation": "劫财位于年柱",
    94→      "analysis": "年柱代表童年时期和祖辈宫位",
    95→      "conclusion": "童年期会有贵人相助的机遇"
    96→    }
    97→  ]
    98→}
    99→
   100→### 3. 指导模式提取 (关键)
   101→
   102→从文本中提取可复用的指导建议，提取为 guidance_patterns 数组：
   103→
   104→每个指导模式包含：
   105→| 字段 | 说明 |
   106→|------|------|
   107→| pattern_name | 模式名称 |
   108→| condition | 适用条件 (什么情况下使用) |
   109→| advice | 具体建议 |
   110→| source | 来源依据 (如哪本书、哪个理论) |
   111→
   112→示例：
   113→{
   114→  "guidance_patterns": [
   115→    {
   116→      "pattern_name": "劫弱反补法",
   117→      "condition": "劫财被克弱时",
   118→      "advice": "不宜合伙创业，适合独立发展或寻求贵人扶持",
   119→      "source": "正偏转换理论"
   120→    }
   121→  ]
   122→}
   123→
   124→### 4. 思维架构标注
   125→
   126→标注该案例使用了哪些思维架构：
   127→- thinking_frameworks_used: ["架构1", "架构2", ...]
   128→
   129→### 5. 其他字段
   130→- tags: 标签数组 (如: ["事业", "财运"])
   131→- scenario_ids: 适用场景ID数组 (如: ["basic_reading", "career"])
   132→
   133→## 输出格式
   134→
   135→以JSON格式输出，完整结构如下：
   136→
   137→{
   138→  "name": "案例名称",
   139→  "core_data": {...},
   140→  "features": {...},
   141→  "thinking_frameworks_used": ["架构1", "架构2"],
   142→  "reasoning_chain": [
   143→    {"step": 1, "framework": "...", "observation": "...", "analysis": "...", "conclusion": "..."},
   144→    {"step": 2, ...}
   145→  ],
   146→  "guidance_patterns": [
   147→    {"pattern_name": "...", "condition": "...", "advice": "...", "source": "..."}
   148→  ],
   149→  "tags": ["标签1", "标签2"],
   150→  "scenario_ids": ["scenario1", "scenario2"]
   151→}
   152→
   153→如果文本中没有案例，返回: {"no_case": true, "reason": "原因说明"}
   154→
   155→请直接输出JSON，不要添加其他说明。
   156→```
   157→
   158→---
   159→
   160→## Skill 特定配置
   161→
   162→### Bazi (八字)
   163→
   164→**思维架构体系**:
   165→- 主体思维架构：身强/身弱判定
   166→- 客体思维架构：十神分析
   167→- 五行思维架构：五行分布特征
   168→- 柱位思维架构：四柱位置含义
   169→- 冲合思维架构：冲合关系解读
   170→- 时运思维架构：大运流年分析
   171→- 正偏思维架构：正偏十神转换
   172→
   173→**core_data**:
   174→- year: 年柱 (如: 甲子)
   175→- month: 月柱
   176→- day: 日柱
   177→- hour: 时柱
   178→- gender: 性别 (男/女)
   179→
   180→**features**:
   181→- daymaster: 日主 (如: 甲木)
   182→- strength: 身强/身弱
   183→- pattern: 格局 (如: 正官格)
   184→- key_gods: 关键十神 (数组)
   185→
   186→### Zodiac (占星)
   187→
   188→**思维架构体系**:
   189→- 元素思维架构：火/土/风/水元素分析
   190→- 模式思维架构：基本/固定/变动模式分析
   191→- 相位思维架构：行星相位解读
   192→- 宫位思维架构：十二宫位分析
   193→- 行运思维架构：行运推进分析
   194→
   195→**core_data**:
   196→- sun_sign: 太阳星座
   197→- moon_sign: 月亮星座
   198→- rising_sign: 上升星座
   199→- birth_chart: 星盘配置摘要
   200→
   201→**features**:
   202→- dominant_element: 主导元素
   203→- dominant_modality: 主导模式
   204→- key_aspects: 关键相位
   205→- stellium: 星群 (如有)
   206→
   207→### Tarot (塔罗)
   208→
   209→**思维架构体系**:
   210→- 大小牌思维架构：大牌vs小牌分析
   211→- 花色思维架构：权杖/圣杯/宝剑/钱币
   212→- 数字思维架构：牌号数字含义
   213→- 叙事思维架构：牌阵故事整合
   214→- 元素尊严架构：元素强弱分析
   215→
   216→**core_data**:
   217→- spread_type: 牌阵类型
   218→- cards: 抽到的牌 (数组)
   219→- question: 问题类型
   220→
   221→**features**:
   222→- major_count: 大牌数量
   223→- dominant_suit: 主导花色
   224→- reversed_count: 逆位数量
   225→- key_cards: 关键牌
   226→
   227→### Career (职业)
   228→
   229→**思维架构体系**:
   230→- 职业锚思维架构：核心职业动机分析
   231→- 霍兰德思维架构：职业兴趣类型分析
   232→- MBTI思维架构：性格类型分析
   233→- 技能矩阵架构：技能组合分析
   234→- 发展阶段架构：职业周期分析
   235→
   236→**core_data**:
   237→- background: 职业背景
   238→- current_role: 当前职位
   239→- challenge: 面临挑战
   240→
   241→**features**:
   242→- industry: 行业
   243→- career_stage: 职业阶段
   244→- key_skills: 核心技能
   245→- goals: 职业目标
   246→
   247→---
   248→
   249→## 数据库写入 SQL
   250→
   251→```sql
   252→INSERT INTO cases (
   253→    id, skill_id, scenario_ids, name,
   254→    core_data, features,
   255→    thinking_frameworks_used,
   256→    reasoning_chain,
   257→    guidance_patterns,
   258→    tags, authority
   259→)
   260→VALUES (
   261→    'CASE_{skill_id}_{uuid}',
   262→    '{skill_id}',
   263→    ARRAY['basic_reading', 'career'],
   264→    '案例名称',
   265→    '{"year":"甲子","month":"乙丑","day":"丙寅","hour":"丁卯","gender":"男"}'::jsonb,
   266→    '{"daymaster":"丙火","strength":"身强","pattern":"正官格","key_gods":["正官","正印"]}'::jsonb,
   267→    ARRAY['客体思维架构', '柱位思维架构'],
   268→    '[{"step":1,"framework":"客体思维架构","observation":"...","analysis":"...","conclusion":"..."}]'::jsonb,
   269→    '[{"pattern_name":"劫弱反补法","condition":"劫财被克弱时","advice":"...","source":"正偏转换理论"}]'::jsonb,
   270→    ARRAY['事业', '财运'],
   271→    'medium'
   272→);
   273→```
   274→
   275→---
   276→
   277→## 提取质量标准
   278→
   279→| 维度 | 标准 |
   280→|------|------|
   281→| 推理链条 | 至少2-3步完整的推理过程 |
   282→| 思维架构 | 至少标注1个使用的架构 |
   283→| 指导模式 | 至少提取1个可复用的指导建议 |
   284→| 来源追溯 | 指导模式必须标注来源 |
   285→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
