   295→        logger.info("=" * 60)
   296→        logger.info("Pipeline Complete!")
   297→        logger.info(f"Results: {results}")
   298→        logger.info("=" * 60)
   299→
   300→        return results
   301→
   302→
   303→async def main():
   304→    parser = argparse.ArgumentParser(
   305→        description="Knowledge Builder Pipeline",
   306→        formatter_class=argparse.RawDescriptionHelpFormatter,
   307→        epilog="""
   308→Examples:
   309→  # Run all stages
   310→  python build_knowledge.py --skill bazi --stages all
   311→
   312→  # Run specific stages
   313→  python build_knowledge.py --skill bazi --stages 0,1,2,3
   314→  python build_knowledge.py --skill bazi --stages 4a,4b
   315→
   316→  # Interactive review
   317→  python build_knowledge.py --skill bazi --stages 5 --review
   318→
   319→  # Quality report only
   320→  python build_knowledge.py --skill bazi --stages 6
   321→        """
   322→    )
   323→
   324→    parser.add_argument(
   325→        "--skill", "-s",
   326→        required=True,
   327→        help="Skill ID (bazi, zodiac, tarot, career)"
   328→    )
   329→    parser.add_argument(
   330→        "--stages",
   331→        default="all",
   332→        help="Stages to run: all, 0, 1-3, 4a, 4b, 5, 6 (comma-separated)"
   333→    )
   334→    parser.add_argument(
   335→        "--review",
   336→        action="store_true",
   337→        help="Interactive review mode for stage 5"
   338→    )
   339→    parser.add_argument(
   340→        "--limit",
   341→        type=int,
   342→        default=100,
   343→        help="Limit for chunk processing (default: 100)"
   344→    )
   345→
   346→    args = parser.parse_args()
   347→
   348→    builder = KnowledgeBuilder(args.skill)
   349→
   350→    if args.stages == "all":
   351→        await builder.run_all()
   352→    else:
   353→        stages = [s.strip() for s in args.stages.split(",")]
   354→
   355→        for stage in stages:
   356→            if stage == "0":
   357→                await builder.run_stage_0()
   358→            elif stage in ("1", "2", "3", "1-3"):
   359→                await builder.run_stages_1_2_3()
   360→            elif stage == "4a":
   361→                await builder.run_stage_4a(args.limit)
   362→            elif stage == "4b":
   363→                await builder.run_stage_4b(args.limit)
   364→            elif stage == "5":
   365→                await builder.run_stage_5(interactive=args.review)
   366→            elif stage == "6":
   367→                await builder.run_stage_6()
   368→            else:
   369→                logger.warning(f"Unknown stage: {stage}")
   370→
   371→
   372→if __name__ == "__main__":
   373→    asyncio.run(main())
   374→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
