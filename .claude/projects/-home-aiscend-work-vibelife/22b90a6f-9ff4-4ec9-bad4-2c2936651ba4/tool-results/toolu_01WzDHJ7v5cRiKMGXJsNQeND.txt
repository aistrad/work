     1→# 案例提取 Prompt 模板
     2→
     3→> 此 Prompt 在 Claude Code 中手动执行，不调用外部 LLM API。
     4→
     5→## 使用方法
     6→
     7→1. 从 knowledge_chunks 表中读取待分析的文本
     8→2. 将文本填入下方模板的 `{text}` 位置
     9→3. 根据 skill 类型选择对应的 schema
    10→4. 在 Claude Code 中执行 prompt
    11→5. 将结果手动写入 cases 表
    12→
    13→---
    14→
    15→## Prompt 模板
    16→
    17→```
    18→请从以下{skill_name}专业文本中提取案例。
    19→
    20→## Skill类型: {skill_id}
    21→
    22→## 案例数据结构
    23→
    24→core_data 字段说明:
    25→{core_data_schema}
    26→
    27→features 字段说明:
    28→{features_schema}
    29→
    30→## 待分析文本
    31→
    32→{text}
    33→
    34→## 输出要求
    35→
    36→如果文本中包含案例，请以JSON格式输出，包含以下字段:
    37→- name: 案例名称/标题
    38→- core_data: 核心数据 (按上述结构)
    39→- features: 特征数据 (按上述结构)
    40→- tags: 标签数组 (如: ["事业", "财运"])
    41→- analysis: 分析内容 (JSON对象，包含 key_points 数组)
    42→- conclusion: 结论 (JSON对象，包含 summary 和 advice)
    43→- scenario_ids: 适用场景ID数组 (如: ["basic_reading", "career"])
    44→
    45→如果文本中没有案例，返回: {"no_case": true}
    46→
    47→请直接输出JSON，不要添加其他说明。
    48→```
    49→
    50→---
    51→
    52→## Skill 特定 Schema
    53→
    54→### Bazi (八字)
    55→
    56→**core_data**:
    57→- year: 年柱 (如: 甲子)
    58→- month: 月柱
    59→- day: 日柱
    60→- hour: 时柱
    61→- gender: 性别 (男/女)
    62→
    63→**features**:
    64→- daymaster: 日主 (如: 甲木)
    65→- strength: 身强/身弱
    66→- pattern: 格局 (如: 正官格)
    67→- key_gods: 关键十神 (数组)
    68→
    69→### Zodiac (占星)
    70→
    71→**core_data**:
    72→- sun_sign: 太阳星座
    73→- moon_sign: 月亮星座
    74→- rising_sign: 上升星座
    75→- birth_chart: 星盘配置摘要
    76→
    77→**features**:
    78→- dominant_element: 主导元素
    79→- dominant_modality: 主导模式
    80→- key_aspects: 关键相位
    81→- stellium: 星群 (如有)
    82→
    83→### Tarot (塔罗)
    84→
    85→**core_data**:
    86→- spread_type: 牌阵类型
    87→- cards: 抽到的牌 (数组)
    88→- question: 问题类型
    89→
    90→**features**:
    91→- major_count: 大牌数量
    92→- dominant_suit: 主导花色
    93→- reversed_count: 逆位数量
    94→- key_cards: 关键牌
    95→
    96→### Career (职业)
    97→
    98→**core_data**:
    99→- background: 职业背景
   100→- current_role: 当前职位
   101→- challenge: 面临挑战
   102→
   103→**features**:
   104→- industry: 行业
   105→- career_stage: 职业阶段
   106→- key_skills: 核心技能
   107→- goals: 职业目标
   108→
   109→---
   110→
   111→## 数据库写入 SQL
   112→
   113→```sql
   114→INSERT INTO cases (id, skill_id, scenario_ids, name, core_data, features, tags, analysis, conclusion, authority)
   115→VALUES (
   116→    'CASE_{skill_id}_{uuid}',
   117→    '{skill_id}',
   118→    ARRAY['basic_reading', 'career'],
   119→    '案例名称',
   120→    '{"year":"甲子","month":"乙丑","day":"丙寅","hour":"丁卯","gender":"男"}'::jsonb,
   121→    '{"daymaster":"丙火","strength":"身强","pattern":"正官格","key_gods":["正官","正印"]}'::jsonb,
   122→    ARRAY['事业', '财运'],
   123→    '{"key_points":["要点1","要点2"]}'::jsonb,
   124→    '{"summary":"总结","advice":"建议"}'::jsonb,
   125→    'medium'
   126→);
   127→```
   128→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
