     1→# 场景生成 Prompt 模板
     2→
     3→> 此 Prompt 在 Claude Code 中手动执行，不调用外部 LLM API。
     4→
     5→## 使用方法
     6→
     7→1. 从 knowledge_chunks 表中读取待分析的知识内容
     8→2. 查询已有场景列表
     9→3. 将内容填入下方模板
    10→4. 在 Claude Code 中执行 prompt
    11→5. 将结果手动写入 scenario_candidates 表
    12→
    13→---
    14→
    15→## Prompt 模板
    16→
    17→```
    18→你是一个专业的服务场景设计专家。请分析以下知识内容，识别可以服务用户的场景。
    19→
    20→## Skill类型: {skill_id}
    21→
    22→## 知识内容摘要
    23→
    24→{content_summary}
    25→
    26→## 已有场景列表
    27→
    28→{existing_scenarios}
    29→
    30→## 输出要求
    31→
    32→请设计一个新的服务场景（如果内容支持），以JSON格式输出：
    33→
    34→{
    35→  "scenario_id": "场景ID (英文，如 career_analysis)",
    36→  "name": "场景名称 (中文)",
    37→  "level": "entry|standard|professional",
    38→  "billing": "free|basic|premium",
    39→  "description": "场景描述",
    40→  "primary_triggers": ["主要触发词1", "主要触发词2"],
    41→  "secondary_triggers": ["次要触发词1", "次要触发词2"],
    42→  "prerequisites": ["前置要求1"],
    43→  "sop_phases": [
    44→    {
    45→      "phase": 1,
    46→      "name": "信息收集",
    47→      "type": "required|optional|reactive",
    48→      "description": "收集用户基础信息",
    49→      "tools": ["collect_user_info"]
    50→    },
    51→    {
    52→      "phase": 2,
    53→      "name": "计算处理",
    54→      "type": "required",
    55→      "description": "执行确定性计算",
    56→      "tools": ["calculate_chart"]
    57→    },
    58→    {
    59→      "phase": 3,
    60→      "name": "主动追问",
    61→      "type": "optional",
    62→      "description": "根据分析结果向用户提问",
    63→      "tools": ["ask_user_question"]
    64→    },
    65→    {
    66→      "phase": 4,
    67→      "name": "深度分析",
    68→      "type": "required",
    69→      "description": "结合知识库进行分析",
    70→      "knowledge_queries": ["相关查询1"]
    71→    },
    72→    {
    73→      "phase": 5,
    74→      "name": "输出交付",
    75→      "type": "required",
    76→      "description": "生成报告和洞察",
    77→      "tools": ["show_chart", "show_report", "show_insight"]
    78→    }
    79→  ],
    80→  "output_template": "输出模板描述",
    81→  "estimated_turns": "3-5"
    82→}
    83→
    84→如果内容不适合生成新场景，返回: {"no_scenario": true, "reason": "原因"}
    85→
    86→请直接输出JSON，不要添加其他说明。
    87→```
    88→
    89→---
    90→
    91→## SOP Phase 类型说明
    92→
    93→| 类型 | 说明 |
    94→|------|------|
    95→| required | 必须执行的阶段 |
    96→| optional | 可选阶段，根据条件触发 |
    97→| reactive | 响应式阶段，用户提问时触发 |
    98→
    99→## 服务级别说明
   100→
   101→| 级别 | 说明 | 计费 |
   102→|------|------|------|
   103→| entry | 入门级，简要分析 | free |
   104→| standard | 标准级，详细分析 | basic |
   105→| professional | 专业级，综合全面分析 | premium |
   106→
   107→---
   108→
   109→## 数据库写入 SQL
   110→
   111→```sql
   112→INSERT INTO scenario_candidates (
   113→    skill_id, scenario_id, name, level, billing, description,
   114→    primary_triggers, secondary_triggers, prerequisites,
   115→    sop_phases, output_template, estimated_turns, status
   116→)
   117→VALUES (
   118→    '{skill_id}',
   119→    '{scenario_id}',
   120→    '{name}',
   121→    '{level}',
   122→    '{billing}',
   123→    '{description}',
   124→    ARRAY['{trigger1}', '{trigger2}'],
   125→    ARRAY['{secondary1}', '{secondary2}'],
   126→    ARRAY['{prerequisite1}'],
   127→    '[{"phase":1,"name":"信息收集","type":"required","description":"...","tools":["collect_user_info"]}]'::jsonb,
   128→    '{output_template}',
   129→    '{estimated_turns}',
   130→    'pending'
   131→);
   132→```
   133→
   134→---
   135→
   136→## 查询已有场景
   137→
   138→```sql
   139→SELECT DISTINCT scenario_id, name, level, billing
   140→FROM scenario_index si
   141→JOIN scenario_candidates sc ON si.skill_id = sc.skill_id AND si.scenario_id = sc.scenario_id
   142→WHERE si.skill_id = '{skill_id}'
   143→ORDER BY level, scenario_id;
   144→```
   145→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
