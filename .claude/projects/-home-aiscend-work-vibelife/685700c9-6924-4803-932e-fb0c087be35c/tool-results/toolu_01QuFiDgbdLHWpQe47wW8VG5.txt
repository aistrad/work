     1→# VibeLife 用户流程设计方案
     2→
     3→> **文档版本**: v1.0
     4→> **设计日期**: 2026-01-09
     5→> **设计原则**: World Class 沉浸感 + 品牌高级感 + 30秒 Aha Moment
     6→> **核心目标**: 1000 付费用户（混合模式：单次购买 + 订阅）
     7→
     8→---
     9→
    10→## 1. 设计概要
    11→
    12→### 1.1 核心设计决策
    13→
    14→| 决策点 | 选择 | 理由 |
    15→|--------|------|------|
    16→| **入口体验** | 品牌沉浸式首页 | World class 高级感，建立信任 |
    17→| **注册策略** | 访客模式优先 | 降低门槛，付费时再注册 |
    18→| **Aha Moment** | 30秒内触发 | 命盘可视化 + "来自未来的信" |
    19→| **转化路径** | 立即购买报告 | 高价值感知，快速转化 |
    20→| **主动推送** | 聊天界面主动推送 | 核心差异化，"主动关心你" |
    21→| **访谈设计** | LLM 实时个性化生成 | 3个问题，混合回答形式 |
    22→| **信的形式** | 简体中文纸张给主人的信 | 情感连接，文学感 |
    23→| **信的访问** | 免费完整展示 | 先给价值，再引导付费 |
    24→
    25→### 1.2 用户流程总览
    26→
    27→```
    28→┌────────────────────────────────────────────────────────────────────────────────┐
    29→│                        VibeLife 用户流程总览                                    │
    30→├────────────────────────────────────────────────────────────────────────────────┤
    31→│                                                                                │
    32→│  ┌─────────────────────────────────────────────────────────────────────────┐   │
    33→│  │                        STAGE 0: ENTRY                                   │   │
    34→│  │                      品牌入口 · 第一印象                                 │   │
    35→│  ├─────────────────────────────────────────────────────────────────────────┤   │
    36→│  │                                                                         │   │
    37→│  │  小红书/搜索/分享 → www.vibelife.app (品牌首页)                         │   │
    38→│  │                           │                                             │   │
    39→│  │                           ▼                                             │   │
    40→│  │              ┌─────────────────────────────┐                            │   │
    41→│  │              │   沉浸式品牌首页体验          │                            │   │
    42→│  │              │   "让每个人都能被深度理解"    │                            │   │
    43→│  │              └───────────────┬─────────────┘                            │   │
    44→│  │                              │                                          │   │
    45→│  │          ┌──────────────────┼──────────────────┐                        │   │
    46→│  │          ▼                  ▼                  ▼                        │   │
    47→│  │   ┌──────────┐       ┌──────────┐       ┌──────────┐                    │   │
    48→│  │   │ 八字命理  │       │ 星座占星  │       │   MBTI   │                    │   │
    49→│  │   │  bazi    │       │  zodiac  │       │  (P2)   │                    │   │
    50→│  │   └────┬─────┘       └────┬─────┘       └──────────┘                    │   │
    51→│  │        │                  │                                             │   │
    52→│  └────────│──────────────────│─────────────────────────────────────────────┘   │
    53→│           │                  │                                                 │
    54→│  ┌────────▼──────────────────▼─────────────────────────────────────────────┐   │
    55→│  │                        STAGE 1: LANDING                                 │   │
    56→│  │                    子站着陆 · 价值传递                                   │   │
    57→│  ├─────────────────────────────────────────────────────────────────────────┤   │
    58→│  │                                                                         │   │
    59→│  │   bazi.vibelife.app / zodiac.vibelife.app                               │   │
    60→│  │                              │                                          │   │
    61→│  │                              ▼                                          │   │
    62→│  │              ┌─────────────────────────────┐                            │   │
    63→│  │              │   子站专属 Landing Page      │                            │   │
    64→│  │              │   高级感 + 价值承诺 + CTA    │                            │   │
    65→│  │              └───────────────┬─────────────┘                            │   │
    66→│  │                              │                                          │   │
    67→│  │                              ▼                                          │   │
    68→│  │              ┌─────────────────────────────┐                            │   │
    69→│  │              │       "开始对话"              │                            │   │
    70→│  │              └───────────────┬─────────────┘                            │   │
    71→│  │                              │                                          │   │
    72→│  └──────────────────────────────│──────────────────────────────────────────┘   │
    73→│                                 │                                              │
    74→│  ┌──────────────────────────────▼──────────────────────────────────────────┐   │
    75→│  │                        STAGE 2: AHA MOMENT                              │   │
    76→│  │                    30秒内 · 顿悟时刻                                     │   │
    77→│  ├─────────────────────────────────────────────────────────────────────────┤   │
    78→│  │                                                                         │   │
    79→│  │   0-3s    选择关注点 (感情/事业/自我)                                    │   │
    80→│  │   3-8s    加载动画 "正在为你绘制命盘..."                                 │   │
    81→│  │   8-12s   🔥 Aha #1: 命盘/星盘可视化 + 日主洞察                          │   │
    82→│  │   12-18s  🔥 Aha #2: 今日运势卡片（免费价值）                            │   │
    83→│  │   18-25s  引导深度访谈 "只需3个问题..."                                  │   │
    84→│  │                              │                                          │   │
    85→│  │          ┌──────────────────┼──────────────────┐                        │   │
    86→│  │          ▼                                     ▼                        │   │
    87→│  │   ┌──────────────┐                     ┌──────────────┐                 │   │
    88→│  │   │  跳过，轻度用户 │                     │  继续深度访谈  │                 │   │
    89→│  │   │  (留存 → 召回) │                     │  (信任 → 转化) │                 │   │
    90→│  │   └──────────────┘                     └───────┬──────┘                 │   │
    91→│  │                                                │                        │   │
    92→│  └────────────────────────────────────────────────│────────────────────────┘   │
    93→│                                                   │                            │
    94→│  ┌────────────────────────────────────────────────▼────────────────────────┐   │
    95→│  │                        STAGE 3: INTERVIEW                               │   │
    96→│  │                    深度访谈 · 情感连接                                   │   │
    97→│  ├─────────────────────────────────────────────────────────────────────────┤   │
    98→│  │                                                                         │   │
    99→│  │   Q1: 生辰信息 (八字需时间，星座需日期) ─ 选择/输入                      │   │
   100→│  │   Q2: LLM 根据命盘个性化生成的问题 ─ 选择/文本                          │   │
   101→│  │   Q3: LLM 追问，触动内心 ─ 自由文本                                     │   │
   102→│  │                              │                                          │   │
   103→│  │                              ▼                                          │   │
   104→│  │              ┌─────────────────────────────┐                            │   │
   105→│  │              │  生成"来自未来的信"           │                            │   │
   106→│  │              │  (免费完整展示)               │                            │   │
   107→│  │              └───────────────┬─────────────┘                            │   │
   108→│  │                              │                                          │   │
   109→│  └──────────────────────────────│──────────────────────────────────────────┘   │
   110→│                                 │                                              │
   111→│  ┌──────────────────────────────▼──────────────────────────────────────────┐   │
   112→│  │                        STAGE 4: LETTER                                  │   │
   113→│  │                   "来自未来的信" · 打动用户                              │   │
   114→│  ├─────────────────────────────────────────────────────────────────────────┤   │
   115→│  │                                                                         │   │
   116→│  │              ┌─────────────────────────────┐                            │   │
   117→│  │              │   📜 纸张风格信件展示         │                            │   │
   118→│  │              │                             │                            │   │
   119→│  │              │   亲爱的 [用户昵称]:          │                            │   │
   120→│  │              │                             │                            │   │
   121→│  │              │   当你读到这封信时，         │                            │   │
   122→│  │              │   你已经在人生的某个转折点... │                            │   │
   123→│  │              │                             │                            │   │
   124→│  │              │   [基于命盘/星盘的个性化内容] │                            │   │
   125→│  │              │                             │                            │   │
   126→│  │              │   来自三年后的你              │                            │   │
   127→│  │              │                             │                            │   │
   128→│  │              └───────────────┬─────────────┘                            │   │
   129→│  │                              │                                          │   │
   130→│  │              ┌───────────────▼─────────────┐                            │   │
   131→│  │              │   展示完整报告的更多价值      │                            │   │
   132→│  │              │   • 人生K线图                │                            │   │
   133→│  │              │   • 三元棱镜                 │                            │   │
   134→│  │              │   • 关系分析                 │                            │   │
   135→│  │              │   • AI 生图海报              │                            │   │
   136→│  │              └───────────────┬─────────────┘                            │   │
   137→│  │                              │                                          │   │
   138→│  └──────────────────────────────│──────────────────────────────────────────┘   │
   139→│                                 │                                              │
   140→│  ┌──────────────────────────────▼──────────────────────────────────────────┐   │
   141→│  │                        STAGE 5: CONVERSION                              │   │
   142→│  │                    转化 · 购买报告                                       │   │
   143→│  ├─────────────────────────────────────────────────────────────────────────┤   │
   144→│  │                                                                         │   │
   145→│  │              ┌─────────────────────────────┐                            │   │
   146→│  │              │   购买完整深度报告            │                            │   │
   147→│  │              │                             │                            │   │
   148→│  │              │   单次购买 ¥19.9             │                            │   │
   149→│  │              │   或                         │                            │   │
   150→│  │              │   订阅 ¥19.9/月 (解锁更多)   │                            │   │
   151→│  │              └───────────────┬─────────────┘                            │   │
   152→│  │                              │                                          │   │
   153→│  │                  ┌───────────┴───────────┐                              │   │
   154→│  │                  ▼                       ▼                              │   │
   155→│  │           ┌──────────┐            ┌──────────┐                          │   │
   156→│  │           │ 付费用户  │            │ 免费用户  │                          │   │
   157→│  │           │ (已转化)  │            │ (待召回)  │                          │   │
   158→│  │           └────┬─────┘            └────┬─────┘                          │   │
   159→│  │                │                       │                                │   │
   160→│  └────────────────│───────────────────────│────────────────────────────────┘   │
   161→│                   │                       │                                    │
   162→│  ┌────────────────▼───────────────────────▼────────────────────────────────┐   │
   163→│  │                        STAGE 6: RETENTION                               │   │
   164→│  │                    留存 · 主动推送                                       │   │
   165→│  ├─────────────────────────────────────────────────────────────────────────┤   │
   166→│  │                                                                         │   │
   167→│  │   用户进入主界面 → 系统主动推送到聊天界面                                │   │
   168→│  │                                                                         │   │
   169→│  │   推送类型:                                                             │   │
   170→│  │   • 今日运势 + 个性化建议                                               │   │
   171→│  │   • 关键节点提醒 (大运流年转换)                                          │   │
   172→│  │   • 情感化问候 ("这两天你还好吗？")                                      │   │
   173→│  │   • 成长确认 ("还记得上次我们聊的...现在怎么样了？")                      │   │
   174→│  │   • 周末回顾 ("这周有什么值得庆祝的事吗？")                               │   │
   175→│  │   • 新月/满月提醒 (星座用户)                                             │   │
   176→│  │   • 节气提醒 (八字用户)                                                 │   │
   177→│  │                                                                         │   │
   178→│  └─────────────────────────────────────────────────────────────────────────┘   │
   179→│                                                                                │
   180→└────────────────────────────────────────────────────────────────────────────────┘
   181→```
   182→
   183→---
   184→
   185→## 2. STAGE 0: 品牌入口设计
   186→
   187→### 2.1 设计目标
   188→
   189→- **第一印象**：5秒内传达"这是什么"+"能为我做什么"
   190→- **高级感**：World class 设计水准，建立品牌信任
   191→- **沉浸感**：神秘、优雅、专业的东方美学
   192→- **引导明确**：清晰的 Skill 选择，降低决策成本
   193→
   194→### 2.2 www.vibelife.app 首页设计
   195→
   196→```typescript
   197→// apps/web/src/app/(www)/page.tsx
   198→/**
   199→ * 品牌首页 - World Class 沉浸式体验
   200→ *
   201→ * 设计理念：
   202→ * - 东方神秘美学 + 现代极简
   203→ * - 微妙动效，不分散注意力
   204→ * - 一屏一信息，渐进式引导
   205→ */
   206→
   207→export default function BrandHomePage() {
   208→  return (
   209→    <div className="min-h-screen bg-vellum overflow-hidden">
   210→      {/* ═══════════════════════════════════════════════════════════
   211→          HERO SECTION - 3秒传达核心价值
   212→          ═══════════════════════════════════════════════════════════ */}
   213→      <section className="min-h-screen relative flex items-center justify-center">
   214→        {/* 背景：禅意呼吸动效 */}
   215→        <div className="absolute inset-0 overflow-hidden">
   216→          <BreathAura variant="brand" />
   217→        </div>
   218→
   219→        {/* 品牌标识 + 核心价值主张 */}
   220→        <div className="relative z-10 text-center px-6 max-w-4xl mx-auto">
   221→          {/* Logo / Glyph */}
   222→          <motion.div
   223→            initial={{ opacity: 0, scale: 0.9 }}
   224→            animate={{ opacity: 1, scale: 1 }}
   225→            transition={{ duration: 1.2, ease: [0.16, 1, 0.3, 1] }}
   226→          >
   227→            <VibeGlyph size={120} variant="brand" />
   228→          </motion.div>
   229→
   230→          {/* 品牌名 */}
   231→          <motion.h1
   232→            initial={{ opacity: 0, y: 20 }}
   233→            animate={{ opacity: 1, y: 0 }}
   234→            transition={{ delay: 0.3, duration: 0.8 }}
   235→            className="mt-8 text-5xl md:text-7xl font-serif text-ink tracking-tight"
   236→          >
   237→            VibeLife
   238→          </motion.h1>
   239→
   240→          {/* 核心价值主张 */}
   241→          <motion.p
   242→            initial={{ opacity: 0, y: 20 }}
   243→            animate={{ opacity: 1, y: 0 }}
   244→            transition={{ delay: 0.5, duration: 0.8 }}
   245→            className="mt-6 text-xl md:text-2xl text-ink/70 font-light"
   246→          >
   247→            让每个人都能被深度理解
   248→          </motion.p>
   249→
   250→          {/* 副标题 */}
   251→          <motion.p
   252→            initial={{ opacity: 0 }}
   253→            animate={{ opacity: 1 }}
   254→            transition={{ delay: 0.8, duration: 0.8 }}
   255→            className="mt-4 text-base text-ink/50"
   256→          >
   257→            不是工具，是关系。不是被动响应，是主动关心。
   258→          </motion.p>
   259→
   260→          {/* 向下引导 */}
   261→          <motion.div
   262→            initial={{ opacity: 0 }}
   263→            animate={{ opacity: 1 }}
   264→            transition={{ delay: 1.2, duration: 0.8 }}
   265→            className="mt-16"
   266→          >
   267→            <ScrollIndicator />
   268→          </motion.div>
   269→        </div>
   270→      </section>
   271→
   272→      {/* ═══════════════════════════════════════════════════════════
   273→          SKILL SELECTION - 选择你的探索方式
   274→          ═══════════════════════════════════════════════════════════ */}
   275→      <section className="min-h-screen py-24 px-6 flex items-center">
   276→        <div className="max-w-6xl mx-auto w-full">
   277→          <motion.h2
   278→            initial={{ opacity: 0, y: 20 }}
   279→            whileInView={{ opacity: 1, y: 0 }}
   280→            viewport={{ once: true }}
   281→            className="text-3xl md:text-4xl font-serif text-ink text-center mb-4"
   282→          >
   283→            选择你的探索方式
   284→          </motion.h2>
   285→
   286→          <motion.p
   287→            initial={{ opacity: 0 }}
   288→            whileInView={{ opacity: 1 }}
   289→            viewport={{ once: true }}
   290→            className="text-center text-ink/60 mb-16"
   291→          >
   292→            每一种智慧都是理解自己的窗口
   293→          </motion.p>
   294→
   295→          {/* Skill Cards - 三列布局 */}
   296→          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
   297→            <SkillCard
   298→              skill="bazi"
   299→              title="八字命理"
   300→              subtitle="东方古老智慧"
   301→              description="四柱八字，五行相生。从出生时刻解读你的人生密码。"
   302→              href="https://bazi.vibelife.app"
   303→              color="玄金"
   304→            />
   305→            <SkillCard
   306→              skill="zodiac"
   307→              title="星座占星"
   308→              subtitle="西方星象学"
   309→              description="行星能量，星座特质。从星盘发现你的灵魂蓝图。"
   310→              href="https://zodiac.vibelife.app"
   311→              color="星蓝"
   312→            />
   313→            <SkillCard
   314→              skill="mbti"
   315→              title="MBTI 人格"
   316→              subtitle="心理学视角"
   317→              description="16型人格，认知功能。从行为模式理解你的心智结构。"
   318→              href="#"
   319→              comingSoon
   320→              color="翠绿"
   321→            />
   322→          </div>
   323→        </div>
   324→      </section>
   325→
   326→      {/* ═══════════════════════════════════════════════════════════
   327→          VALUE PROPOSITION - 为什么选择 VibeLife
   328→          ═══════════════════════════════════════════════════════════ */}
   329→      <section className="py-24 px-6 bg-ink">
   330→        <div className="max-w-4xl mx-auto">
   331→          <h2 className="text-3xl md:text-4xl font-serif text-vellum text-center mb-16">
   332→            不只是算命，是真正被理解
   333→          </h2>
   334→
   335→          <div className="space-y-12">
   336→            <ValuePoint
   337→              icon="💬"
   338→              title="主动关心你"
   339→              description="不是你问我答，是我主动在关键时刻提醒你。运势转换、情绪低落、重要决策，我都在。"
   340→            />
   341→            <ValuePoint
   342→              icon="🧠"
   343→              title="越聊越懂你"
   344→              description="每一次对话都在加深理解。你的故事、你的选择、你的成长，我都记得。"
   345→            />
   346→            <ValuePoint
   347→              icon="🔮"
   348→              title="多维度视角"
   349→              description="八字、星座、MBTI，三种智慧交叉验证。全面理解你，而不是标签化你。"
   350→            />
   351→          </div>
   352→        </div>
   353→      </section>
   354→
   355→      {/* ═══════════════════════════════════════════════════════════
   356→          FINAL CTA - 开始你的旅程
   357→          ═══════════════════════════════════════════════════════════ */}
   358→      <section className="py-24 px-6 text-center">
   359→        <h2 className="text-2xl font-serif text-ink mb-8">
   360→          准备好被深度理解了吗？
   361→        </h2>
   362→
   363→        <div className="flex flex-col sm:flex-row gap-4 justify-center">
   364→          <a
   365→            href="https://bazi.vibelife.app"
   366→            className="btn-primary"
   367→          >
   368→            从八字开始
   369→          </a>
   370→          <a
   371→            href="https://zodiac.vibelife.app"
   372→            className="btn-secondary"
   373→          >
   374→            从星座开始
   375→          </a>
   376→        </div>
   377→      </section>
   378→    </div>
   379→  );
   380→}
   381→```
   382→
   383→### 2.3 Skill Card 组件
   384→
   385→```typescript
   386→// apps/web/src/components/brand/SkillCard.tsx
   387→interface SkillCardProps {
   388→  skill: string;
   389→  title: string;
   390→  subtitle: string;
   391→  description: string;
   392→  href: string;
   393→  color: string;
   394→  comingSoon?: boolean;
   395→}
   396→
   397→function SkillCard({
   398→  skill,
   399→  title,
   400→  subtitle,
   401→  description,
   402→  href,
   403→  color,
   404→  comingSoon,
   405→}: SkillCardProps) {
   406→  return (
   407→    <motion.a
   408→      href={comingSoon ? undefined : href}
   409→      initial={{ opacity: 0, y: 30 }}
   410→      whileInView={{ opacity: 1, y: 0 }}
   411→      viewport={{ once: true }}
   412→      whileHover={comingSoon ? {} : { y: -8, boxShadow: "0 20px 40px rgba(0,0,0,0.1)" }}
   413→      className={cn(
   414→        "block p-8 rounded-2xl border border-vellum-200 bg-white/80 backdrop-blur",
   415→        "transition-all duration-500",
   416→        comingSoon && "opacity-60 cursor-not-allowed"
   417→      )}
   418→    >
   419→      {/* Skill Glyph */}
   420→      <div className="mb-6">
   421→        <SimpleVibeGlyph size={48} skill={skill as SkillType} />
   422→      </div>
   423→
   424→      {/* Title */}
   425→      <h3 className="text-2xl font-serif text-ink mb-1">{title}</h3>
   426→      <p className="text-sm text-ink/50 mb-4">{subtitle}</p>
   427→
   428→      {/* Description */}
   429→      <p className="text-ink/70 leading-relaxed mb-6">{description}</p>
   430→
   431→      {/* CTA */}
   432→      {comingSoon ? (
   433→        <span className="inline-flex items-center text-sm text-ink/40">
   434→          即将推出
   435→        </span>
   436→      ) : (
   437→        <span className="inline-flex items-center text-sm text-skill-primary font-medium group-hover:gap-2 transition-all">
   438→          开始探索
   439→          <ArrowRight className="w-4 h-4 ml-1" />
   440→        </span>
   441→      )}
   442→    </motion.a>
   443→  );
   444→}
   445→```
   446→
   447→---
   448→
   449→## 3. STAGE 1: 子站 Landing Page
   450→
   451→### 3.1 设计目标
   452→
   453→- **继承品牌感**：与主站视觉一致，但有 Skill 专属色彩
   454→- **价值传递**：清晰展示这个 Skill 能做什么
   455→- **快速行动**：一键开始，无需填写任何信息
   456→- **社会证明**：用户数量、评分、案例
   457→
   458→### 3.2 bazi.vibelife.app Landing Page
   459→
   460→```typescript
   461→// apps/web/src/app/(bazi)/page.tsx
   462→export default function BaziLandingPage() {
   463→  return (
   464→    <div className="min-h-screen bg-gradient-to-b from-bazi-bg to-vellum">
   465→      {/* Hero */}
   466→      <section className="py-24 px-6 text-center">
   467→        <SimpleVibeGlyph size={80} skill="bazi" />
   468→
   469→        <h1 className="mt-8 text-4xl md:text-5xl font-serif text-ink">
   470→          AI 八字命理
   471→        </h1>
   472→        <p className="mt-4 text-xl text-ink/70">
   473→          像大师一样专业，像闺蜜一样懂你
   474→        </p>
   475→
   476→        {/* Social Proof */}
   477→        <div className="mt-8 flex items-center justify-center gap-8 text-sm text-ink/60">
   478→          <span>10,000+ 用户</span>
   479→          <span>4.9 ★ 好评</span>
   480→          <span>94% 准确度</span>
   481→        </div>
   482→
   483→        {/* Primary CTA */}
   484→        <div className="mt-12">
   485→          <Link
   486→            href="/chat"
   487→            className="inline-flex items-center gap-2 px-8 py-4 bg-bazi-primary text-white rounded-2xl font-medium text-lg hover:shadow-glow-skill transition-all"
   488→          >
   489→            开始对话
   490→            <ArrowRight className="w-5 h-5" />
   491→          </Link>
   492→          <p className="mt-3 text-sm text-ink/50">
   493→            无需注册，立即体验
   494→          </p>
   495→        </div>
   496→      </section>
   497→
   498→      {/* Feature Highlights */}
   499→      <section className="py-16 px-6">
   500→        <div className="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
   501→          <FeatureCard
   502→            icon="📊"
   503→            title="命盘可视化"
   504→            description="专业的四柱八字命盘，五行配色一目了然"
   505→          />
   506→          <FeatureCard
   507→            icon="📈"
   508→            title="人生K线图"
   509→            description="过去10年到未来10年，运势起伏尽在掌握"
   510→          />
   511→          <FeatureCard
   512→            icon="📝"
   513→            title="深度报告"
   514→            description="3000字完整解读，来自未来的你写给现在的信"
   515→          />
   516→        </div>
   517→      </section>
   518→    </div>
   519→  );
   520→}
   521→```
   522→
   523→---
   524→
   525→## 4. STAGE 2 & 3: 30秒 Aha Moment + 深度访谈
   526→
   527→### 4.1 快速选择 → 命盘展示 → 今日运势
   528→
   529→（详见 onboarding-30s-prototype.md）
   530→
   531→### 4.2 深度访谈设计
   532→
   533→**关键设计点**：
   534→
   535→1. **3个问题，快速完成**
   536→2. **LLM 实时根据命盘/星盘生成个性化问题**
   537→3. **混合回答形式**：关键问题选择，追加问题文本
   538→4. **问题设计触动人心**
   539→
   540→```typescript
   541→// apps/web/src/components/interview/AdaptiveInterview.tsx
   542→/**
   543→ * 自适应深度访谈组件
   544→ *
   545→ * 核心特点：
   546→ * 1. 第一个问题固定（生辰信息）
   547→ * 2. 后续问题 LLM 根据命盘实时生成
   548→ * 3. 问题设计触动用户内心
   549→ */
   550→
   551→interface Question {
   552→  id: string;
   553→  question: string;
   554→  type: "datetime" | "choice" | "text";
   555→  options?: { value: string; label: string }[];
   556→  followUp?: boolean;  // 是否允许文本追加
   557→  aiGenerated?: boolean;
   558→}
   559→
   560→export function AdaptiveInterview({
   561→  skill,
   562→  onComplete,
   563→}: {
   564→  skill: SkillType;
   565→  onComplete: (answers: Record<string, any>) => void;
   566→}) {
   567→  const [currentStep, setCurrentStep] = useState(0);
   568→  const [answers, setAnswers] = useState<Record<string, any>>({});
   569→  const [questions, setQuestions] = useState<Question[]>([
   570→    // 第一个问题固定
   571→    {
   572→      id: "birth_info",
   573→      question: skill === "bazi"
   574→        ? "你的出生时间？"
   575→        : "你的出生日期？",
   576→      type: skill === "bazi" ? "datetime" : "date",
   577→    },
   578→  ]);
   579→  const [loading, setLoading] = useState(false);
   580→
   581→  // 第一个问题回答后，生成后续问题
   582→  const generateFollowUpQuestions = async (birthInfo: any) => {
   583→    setLoading(true);
   584→
   585→    try {
   586→      const response = await fetch("/api/v1/interview/generate-questions", {
   587→        method: "POST",
   588→        headers: { "Content-Type": "application/json" },
   589→        body: JSON.stringify({
   590→          skill,
   591→          birth_info: birthInfo,
   592→          answers_so_far: answers,
   593→        }),
   594→      });
   595→
   596→      const { questions: generatedQuestions } = await response.json();
   597→
   598→      setQuestions((prev) => [
   599→        ...prev,
   600→        ...generatedQuestions.map((q: any) => ({
   601→          ...q,
   602→          aiGenerated: true,
   603→        })),
   604→      ]);
   605→    } catch (error) {
   606→      console.error("Failed to generate questions:", error);
   607→      // Fallback to default questions
   608→      setQuestions((prev) => [
   609→        ...prev,
   610→        {
   611→          id: "current_focus",
   612→          question: "你现在最关心的是什么？",
   613→          type: "choice",
   614→          options: [
   615→            { value: "relationship", label: "感情问题" },
   616→            { value: "career", label: "事业发展" },
   617→            { value: "self", label: "自我认知" },
   618→          ],
   619→          followUp: true,
   620→        },
   621→        {
   622→          id: "recent_challenge",
   623→          question: "最近有什么让你困扰的事吗？",
   624→          type: "text",
   625→        },
   626→      ]);
   627→    } finally {
   628→      setLoading(false);
   629→    }
   630→  };
   631→
   632→  // 处理回答
   633→  const handleAnswer = async (questionId: string, answer: any) => {
   634→    const newAnswers = { ...answers, [questionId]: answer };
   635→    setAnswers(newAnswers);
   636→
   637→    // 第一个问题回答后，生成后续问题
   638→    if (currentStep === 0) {
   639→      await generateFollowUpQuestions(answer);
   640→    }
   641→
   642→    // 继续下一个问题或完成
   643→    if (currentStep < questions.length - 1) {
   644→      setCurrentStep(currentStep + 1);
   645→    } else if (questions.length >= 3) {
   646→      onComplete(newAnswers);
   647→    }
   648→  };
   649→
   650→  const currentQuestion = questions[currentStep];
   651→
   652→  return (
   653→    <div className="max-w-2xl mx-auto p-6">
   654→      {/* 进度指示 */}
   655→      <div className="mb-8">
   656→        <div className="flex items-center justify-between text-sm text-ink/60 mb-2">
   657→          <span>深度了解你</span>
   658→          <span>{currentStep + 1} / {Math.max(questions.length, 3)}</span>
   659→        </div>
   660→        <div className="h-1 bg-muted rounded-full overflow-hidden">
   661→          <div
   662→            className="h-full bg-skill-primary transition-all duration-500"
   663→            style={{ width: `${((currentStep + 1) / Math.max(questions.length, 3)) * 100}%` }}
   664→          />
   665→        </div>
   666→      </div>
   667→
   668→      {/* 问题 */}
   669→      {loading ? (
   670→        <QuestionSkeleton />
   671→      ) : (
   672→        <motion.div
   673→          key={currentQuestion.id}
   674→          initial={{ opacity: 0, x: 20 }}
   675→          animate={{ opacity: 1, x: 0 }}
   676→          exit={{ opacity: 0, x: -20 }}
   677→        >
   678→          <h2 className="text-2xl font-serif text-ink mb-6">
   679→            {currentQuestion.question}
   680→          </h2>
   681→
   682→          <QuestionInput
   683→            question={currentQuestion}
   684→            value={answers[currentQuestion.id]}
   685→            onChange={(value) => handleAnswer(currentQuestion.id, value)}
   686→          />
   687→        </motion.div>
   688→      )}
   689→    </div>
   690→  );
   691→}
   692→```
   693→
   694→### 4.3 LLM 个性化问题生成
   695→
   696→```python
   697→# apps/api/routes/interview.py
   698→from fastapi import APIRouter, Request
   699→from services.interview import InterviewQuestionGenerator
   700→
   701→router = APIRouter()
   702→
   703→@router.post("/generate-questions")
   704→async def generate_interview_questions(request: Request):
   705→    """
   706→    根据用户的命盘/星盘实时生成个性化访谈问题
   707→
   708→    设计原则：
   709→    1. 问题要触动用户内心
   710→    2. 问题要与命盘/星盘特征相关
   711→    3. 问题要引导用户深度表达
   712→    """
   713→    data = await request.json()
   714→    skill = data.get("skill")
   715→    birth_info = data.get("birth_info")
   716→    answers_so_far = data.get("answers_so_far", {})
   717→
   718→    generator = InterviewQuestionGenerator(skill)
   719→
   720→    # 计算命盘/星盘
   721→    if skill == "bazi":
   722→        chart = await calculate_bazi_chart(birth_info)
   723→    else:
   724→        chart = await calculate_zodiac_chart(birth_info)
   725→
   726→    # 生成问题
   727→    questions = await generator.generate(
   728→        chart=chart,
   729→        answers_so_far=answers_so_far,
   730→        num_questions=2,  # 还需要2个问题
   731→    )
   732→
   733→    return {"questions": questions}
   734→
   735→
   736→class InterviewQuestionGenerator:
   737→    """根据命盘生成触动人心的问题"""
   738→
   739→    QUESTION_TEMPLATES = {
   740→        "bazi": {
   741→            "relationship": [
   742→                "你的命盘显示{pattern}，在感情中你是否曾经{feeling}？",
   743→                "作为{day_master}日主的你，在亲密关系中最渴望的是什么？",
   744→            ],
   745→            "career": [
   746→                "你的{element}能量很强，是否常常在工作中感到{feeling}？",
   747→                "你的命盘暗示你适合{career_hint}，这与你现在的工作有关联吗？",
   748→            ],
   749→            "self": [
   750→                "命盘显示你{trait}，这个特质给你带来过什么影响？",
   751→                "你内心深处，是否一直有{desire}的渴望？",
   752→            ],
   753→        },
   754→        "zodiac": {
   755→            "relationship": [
   756→                "作为{sun_sign}，你的{venus_sign}金星让你在爱情中{pattern}，你认同吗？",
   757→                "你的月亮{moon_sign}暗示你内心需要{need}，是这样吗？",
   758→            ],
   759→            # ... 更多模板
   760→        },
   761→    }
   762→
   763→    async def generate(self, chart, answers_so_far, num_questions=2):
   764→        """
   765→        使用 LLM 根据命盘和模板生成个性化问题
   766→        """
   767→        # 1. 分析命盘特征
   768→        features = self.extract_features(chart)
   769→
   770→        # 2. 构建 prompt
   771→        prompt = f"""
   772→        你是一位深谙人心的命理师，正在与一位用户进行深度访谈。
   773→
   774→        用户信息：
   775→        - 命盘特征：{features}
   776→        - 已回答：{answers_so_far}
   777→
   778→        请生成 {num_questions} 个触动人心的问题，要求：
   779→        1. 问题要与命盘特征相关
   780→        2. 问题要能引导用户深度表达
   781→        3. 问题要让用户感到"被理解"
   782→        4. 语气温暖但不油腻
   783→
   784→        返回 JSON 格式：
   785→        [
   786→          {{
   787→            "id": "question_1",
   788→            "question": "问题内容",
   789→            "type": "choice",
   790→            "options": [{{"value": "xxx", "label": "xxx"}}],
   791→            "followUp": true
   792→          }}
   793→        ]
   794→        """
   795→
   796→        # 3. 调用 LLM
   797→        response = await self.llm.generate(prompt)
   798→        questions = parse_json(response)
   799→
   800→        return questions
   801→```
   802→
   803→---
   804→
   805→## 5. STAGE 4: "来自未来的信"
   806→
   807→### 5.1 设计理念
   808→
   809→这封信是整个产品的**情感高潮**，它需要：
   810→1. **形式感**：简体中文纸张风格，手写字体感
   811→2. **个性化**：基于命盘/星盘 + 访谈回答生成
   812→3. **情感共鸣**：让用户感到"被理解"
   813→4. **价值展示**：暗示完整报告能提供更多
   814→
   815→### 5.2 信的模板结构
   816→
   817→```
   818→┌─────────────────────────────────────────────────────────────┐
   819→│                                                             │
   820→│                          📜                                  │
   821→│                                                             │
   822→│                                                             │
   823→│   亲爱的 [用户昵称]：                                         │
   824→│                                                             │
   825→│   当你读到这封信时，你已经在人生的某个转折点了。               │
   826→│                                                             │
   827→│   [第一段：基于命盘的性格洞察]                                │
   828→│   作为{日主}日主的你，天生{特质}...                           │
   829→│   你的{五行}能量，让你在{领域}有着独特的天赋...               │
   830→│                                                             │
   831→│   [第二段：基于访谈回答的共鸣]                                │
   832→│   你提到最近{困扰}，我完全理解...                             │
   833→│   这不是偶然，你的命盘显示这段时间{运势分析}...               │
   834→│                                                             │
   835→│   [第三段：来自未来的建议]                                    │
   836→│   三年后的我想告诉你...                                       │
   837→│   不要因为{当下困境}而焦虑...                                 │
   838→│   你会在{时间点}迎来{转机}...                                 │
   839→│                                                             │
   840→│   [结尾：温暖的祝福]                                          │
   841→│   记住，你值得被深度理解。                                    │
   842→│                                                             │
   843→│                                                             │
   844→│                               来自三年后的你                  │
   845→│                               [日期]                         │
   846→│                                                             │
   847→└─────────────────────────────────────────────────────────────┘
   848→```
   849→
   850→### 5.3 信的组件实现
   851→
   852→```typescript
   853→// apps/web/src/components/report/FutureLetter.tsx
   854→interface FutureLetterProps {
   855→  content: string;
   856→  userName?: string;
   857→  date?: string;
   858→  onContinue: () => void;
   859→}
   860→
   861→export function FutureLetter({
   862→  content,
   863→  userName = "你",
   864→  date,
   865→  onContinue,
   866→}: FutureLetterProps) {
   867→  return (
   868→    <motion.div
   869→      initial={{ opacity: 0, y: 20 }}
   870→      animate={{ opacity: 1, y: 0 }}
   871→      className="max-w-2xl mx-auto p-6"
   872→    >
   873→      {/* 纸张效果 */}
   874→      <div
   875→        className={cn(
   876→          "relative p-8 md:p-12",
   877→          "bg-[#FFFEF5] rounded-sm",
   878→          "shadow-[0_4px_20px_rgba(0,0,0,0.08)]",
   879→          "border border-[#E8E4D9]",
   880→          // 纸张纹理
   881→          "bg-[url('/textures/paper.png')] bg-repeat",
   882→        )}
   883→        style={{
   884→          // 微妙的倾斜效果
   885→          transform: "rotate(-0.5deg)",
   886→        }}
   887→      >
   888→        {/* 信封图标 */}
   889→        <div className="absolute -top-4 left-1/2 -translate-x-1/2">
   890→          <span className="text-3xl">📜</span>
   891→        </div>
   892→
   893→        {/* 信件内容 */}
   894→        <div
   895→          className="prose prose-lg max-w-none"
   896→          style={{
   897→            fontFamily: "'Noto Serif SC', serif",
   898→            lineHeight: 2,
   899→          }}
   900→        >
   901→          {/* 称呼 */}
   902→          <p className="text-ink/80">
   903→            亲爱的 {userName}：
   904→          </p>
   905→
   906→          {/* 正文 - 保持换行格式 */}
   907→          <div className="whitespace-pre-line text-ink/70 leading-loose">
   908→            {content}
   909→          </div>
   910→
   911→          {/* 落款 */}
   912→          <div className="mt-12 text-right">
   913→            <p className="text-ink/60">来自三年后的你</p>
   914→            {date && (
   915→              <p className="text-sm text-ink/40">{date}</p>
   916→            )}
   917→          </div>
   918→        </div>
   919→
   920→        {/* 装饰性印章 */}
   921→        <div className="absolute bottom-8 right-8 opacity-30">
   922→          <div className="w-16 h-16 rounded-full border-2 border-bazi-primary flex items-center justify-center">
   923→            <span className="text-bazi-primary text-xs font-serif">VibeLife</span>
   924→          </div>
   925→        </div>
   926→      </div>
   927→
   928→      {/* 继续引导 */}
   929→      <div className="mt-12 text-center">
   930→        <p className="text-ink/60 mb-6">
   931→          这只是你故事的开始...
   932→        </p>
   933→
   934→        <button
   935→          onClick={onContinue}
   936→          className="btn-primary"
   937→        >
   938→          查看完整报告
   939→        </button>
   940→
   941→        {/* 价值提示 */}
   942→        <div className="mt-6 flex items-center justify-center gap-6 text-sm text-ink/50">
   943→          <span>📊 人生K线图</span>
   944→          <span>🔮 三元棱镜</span>
   945→          <span>🎨 AI 生图海报</span>
   946→        </div>
   947→      </div>
   948→    </motion.div>
   949→  );
   950→}
   951→```
   952→
   953→---
   954→
   955→## 6. STAGE 5: 转化设计
   956→
   957→### 6.1 定价策略
   958→
   959→（详见 user-revenue-growth.md）
   960→
   961→**核心定价**：
   962→- 单次购买完整报告：¥19.9 / $2.99
   963→- 订阅 Pro：¥19.9/月 或 ¥159/年
   964→
   965→### 6.2 付费墙设计
   966→
   967→付费墙在"来自未来的信"展示后触发，展示完整报告的更多价值。
   968→
   969→---
   970→
   971→## 7. STAGE 6: 主动推送设计
   972→
   973→### 7.1 设计理念
   974→
   975→**核心差异化**："不是被动响应，是主动关心"
   976→
   977→主动推送是 VibeLife 的核心护城河，它让用户感受到被关心、被理解。
   978→
   979→### 7.2 推送类型与时机
   980→
   981→```python
   982→# apps/api/services/proactive/push_types.py
   983→from enum import Enum
   984→from datetime import datetime, time
   985→from typing import Optional
   986→
   987→class PushType(str, Enum):
   988→    # 运势相关
   989→    DAILY_FORTUNE = "daily_fortune"        # 每日运势
   990→    WEEKLY_SUMMARY = "weekly_summary"      # 每周总结
   991→    MONTHLY_PREVIEW = "monthly_preview"    # 月度预览
   992→
   993→    # 节点提醒
   994→    DAYUN_CHANGE = "dayun_change"          # 大运转换
   995→    LIUNIAN_CHANGE = "liunian_change"      # 流年转换
   996→    SOLAR_TERM = "solar_term"              # 节气提醒
   997→    NEW_MOON = "new_moon"                  # 新月
   998→    FULL_MOON = "full_moon"                # 满月
   999→    MERCURY_RETROGRADE = "mercury_retro"   # 水逆开始/结束
  1000→
  1001→    # 情感关怀
  1002→    EMOTIONAL_CHECKIN = "emotional_checkin"  # 情感问候
  1003→    GROWTH_CHECKIN = "growth_checkin"        # 成长确认
  1004→    WEEKEND_REFLECTION = "weekend_reflection" # 周末回顾
  1005→    ENCOURAGEMENT = "encouragement"          # 鼓励
  1006→
  1007→    # 特殊事件
  1008→    BIRTHDAY_REMINDER = "birthday"         # 生日提醒
  1009→    ANNIVERSARY = "anniversary"            # 纪念日
  1010→
  1011→
  1012→class ProactivePushConfig:
  1013→    """主动推送配置"""
  1014→
  1015→    PUSH_SCHEDULES = {
  1016→        # ═══════════════════════════════════════════════════════════
  1017→        # 运势类 - 定时推送
  1018→        # ═══════════════════════════════════════════════════════════
  1019→        PushType.DAILY_FORTUNE: {
  1020→            "frequency": "daily",
  1021→            "preferred_time": time(8, 0),  # 早上8点
  1022→            "priority": "high",
  1023→            "template": """
  1024→早安，{nickname}！
  1025→
  1026→{daily_fortune_summary}
  1027→
  1028→今日关键词：{keyword}
  1029→幸运色：{lucky_color}
  1030→幸运数字：{lucky_number}
  1031→
  1032→{actionable_advice}
  1033→            """,
  1034→        },
  1035→
  1036→        PushType.WEEKLY_SUMMARY: {
  1037→            "frequency": "weekly",
  1038→            "day_of_week": 0,  # 周一
  1039→            "preferred_time": time(9, 0),
  1040→            "priority": "medium",
  1041→            "template": """
  1042→{nickname}，新的一周开始了！
  1043→
  1044→本周运势关键词：{weekly_keyword}
  1045→
  1046→上周回顾：
  1047→{last_week_summary}
  1048→
  1049→本周建议：
  1050→{weekly_advice}
  1051→            """,
  1052→        },
  1053→
  1054→        # ═══════════════════════════════════════════════════════════
  1055→        # 节点提醒 - 事件触发
  1056→        # ═══════════════════════════════════════════════════════════
  1057→        PushType.DAYUN_CHANGE: {
  1058→            "frequency": "event",
  1059→            "advance_days": 30,  # 提前30天提醒
  1060→            "priority": "critical",
  1061→            "template": """
  1062→{nickname}，重要提醒！
  1063→
  1064→你将在 {change_date} 进入新的大运周期。
  1065→
  1066→从 {old_dayun} → {new_dayun}
  1067→
  1068→这意味着：
  1069→{change_analysis}
  1070→
  1071→建议你在这段时间：
  1072→{preparation_advice}
  1073→            """,
  1074→        },
  1075→
  1076→        PushType.SOLAR_TERM: {
  1077→            "frequency": "event",
  1078→            "priority": "medium",
  1079→            "template": """
  1080→{nickname}，今天是{solar_term}。
  1081→
  1082→{solar_term_meaning}
  1083→
  1084→对于你的 {day_master} 日主来说：
  1085→{personalized_advice}
  1086→            """,
  1087→        },
  1088→
  1089→        PushType.NEW_MOON: {
  1090→            "frequency": "event",
  1091→            "skill": "zodiac",  # 仅星座用户
  1092→            "priority": "medium",
  1093→            "template": """
  1094→{nickname}，今晚新月落在{moon_sign}座！
  1095→
  1096→这个新月对你的影响：
  1097→{moon_impact}
  1098→
  1099→许愿时间：{best_time}
  1100→新月许愿建议：
  1101→{wish_advice}
  1102→            """,
  1103→        },
  1104→
  1105→        # ═══════════════════════════════════════════════════════════
  1106→        # 情感关怀 - 智能触发
  1107→        # ═══════════════════════════════════════════════════════════
  1108→        PushType.EMOTIONAL_CHECKIN: {
  1109→            "frequency": "adaptive",  # 根据用户状态
  1110→            "triggers": [
  1111→                "user_inactive_3_days",
  1112→                "detected_low_mood",
  1113→                "challenging_transit",
  1114→            ],
  1115→            "priority": "high",
  1116→            "templates": [
  1117→                """
  1118→{nickname}，这两天你还好吗？
  1119→
  1120→我注意到最近 {observation}。
  1121→
  1122→如果你想聊聊，我在这里。
  1123→                """,
  1124→                """
  1125→嘿 {nickname}，
  1126→
  1127→好几天没看到你了，想来问候一下。
  1128→
  1129→最近怎么样？有什么想分享的吗？
  1130→                """,
  1131→            ],
  1132→        },
  1133→
  1134→        PushType.GROWTH_CHECKIN: {
  1135→            "frequency": "adaptive",
  1136→            "triggers": [
  1137→                "after_report_viewed_7_days",
  1138→                "after_advice_given_14_days",
  1139→            ],
  1140→            "priority": "medium",
  1141→            "template": """
  1142→{nickname}，
  1143→
  1144→还记得我们上次聊到的 {previous_topic} 吗？
  1145→
  1146→现在过去 {days_passed} 天了，事情有什么进展吗？
  1147→
  1148→{follow_up_question}
  1149→            """,
  1150→        },
  1151→
  1152→        PushType.WEEKEND_REFLECTION: {
  1153→            "frequency": "weekly",
  1154→            "day_of_week": 6,  # 周六
  1155→            "preferred_time": time(18, 0),
  1156→            "priority": "low",
  1157→            "template": """
  1158→{nickname}，周末愉快！
  1159→
  1160→这周有什么值得庆祝的事吗？
  1161→即使是很小的进步，也值得被记住。
  1162→
  1163→{reflection_prompt}
  1164→            """,
  1165→        },
  1166→
  1167→        PushType.ENCOURAGEMENT: {
  1168→            "frequency": "adaptive",
  1169→            "triggers": [
  1170→                "challenging_transit_peak",
  1171→                "user_expressed_difficulty",
  1172→            ],
  1173→            "priority": "high",
  1174→            "template": """
  1175→{nickname}，
  1176→
  1177→我知道这段时间对你来说不容易。
  1178→
  1179→但请相信，{encouragement_based_on_chart}。
  1180→
  1181→你已经很努力了，继续加油！
  1182→            """,
  1183→        },
  1184→
  1185→        # ═══════════════════════════════════════════════════════════
  1186→        # 特殊事件
  1187→        # ═══════════════════════════════════════════════════════════
  1188→        PushType.BIRTHDAY_REMINDER: {
  1189→            "frequency": "yearly",
  1190→            "advance_days": 0,  # 当天
  1191→            "priority": "high",
  1192→            "template": """
  1193→{nickname}，生日快乐！ 🎂
  1194→
  1195→今天是你的太阳回归日，新的一年开始了。
  1196→
  1197→你的本命年运势：
  1198→{birthday_fortune}
  1199→
  1200→今年对你来说最重要的是：
  1201→{yearly_focus}
  1202→
  1203→祝你生日快乐，新的一岁更精彩！
  1204→            """,
  1205→        },
  1206→    }
  1207→
  1208→
  1209→class ProactivePushService:
  1210→    """主动推送服务"""
  1211→
  1212→    async def get_pending_pushes(self, user_id: str) -> list[dict]:
  1213→        """获取待推送消息"""
  1214→        pushes = []
  1215→
  1216→        # 1. 检查定时推送
  1217→        timed_pushes = await self._check_timed_pushes(user_id)
  1218→        pushes.extend(timed_pushes)
  1219→
  1220→        # 2. 检查事件触发推送
  1221→        event_pushes = await self._check_event_pushes(user_id)
  1222→        pushes.extend(event_pushes)
  1223→
  1224→        # 3. 检查智能触发推送
  1225→        adaptive_pushes = await self._check_adaptive_pushes(user_id)
  1226→        pushes.extend(adaptive_pushes)
  1227→
  1228→        # 4. 按优先级排序
  1229→        pushes.sort(key=lambda x: {"critical": 0, "high": 1, "medium": 2, "low": 3}[x["priority"]])
  1230→
  1231→        return pushes
  1232→
  1233→    async def _check_timed_pushes(self, user_id: str) -> list[dict]:
  1234→        """检查定时推送（每日运势等）"""
  1235→        # ...
  1236→
  1237→    async def _check_event_pushes(self, user_id: str) -> list[dict]:
  1238→        """检查事件触发推送（大运转换、节气等）"""
  1239→        # 检查用户的命盘，计算是否有即将到来的重要节点
  1240→        # ...
  1241→
  1242→    async def _check_adaptive_pushes(self, user_id: str) -> list[dict]:
  1243→        """检查智能触发推送（情感关怀等）"""
  1244→        # 分析用户最近的活跃度、对话内容等
  1245→        # ...
  1246→```
  1247→
  1248→### 7.3 推送触发时机
  1249→
  1250→```typescript
  1251→// apps/web/src/hooks/useProactivePush.ts
  1252→/**
  1253→ * 主动推送 Hook
  1254→ *
  1255→ * 触发时机：用户进入主界面时
  1256→ */
  1257→
  1258→export function useProactivePush() {
  1259→  const { addMessage } = useChat();
  1260→  const { user } = useAuth();
  1261→
  1262→  useEffect(() => {
  1263→    if (!user) return;
  1264→
  1265→    const fetchAndDisplayPushes = async () => {
  1266→      try {
  1267→        const response = await fetch("/api/v1/proactive/pending", {
  1268→          method: "GET",
  1269→          headers: {
  1270→            "Content-Type": "application/json",
  1271→          },
  1272→        });
  1273→
  1274→        const { pushes } = await response.json();
  1275→
  1276→        // 将推送消息添加到聊天界面
  1277→        for (const push of pushes) {
  1278→          // 使用延迟，让消息逐条出现
  1279→          await new Promise((resolve) => setTimeout(resolve, 500));
  1280→
  1281→          addMessage({
  1282→            role: "assistant",
  1283→            content: push.content,
  1284→            timestamp: new Date().toISOString(),
  1285→            pushType: push.type,
  1286→          });
  1287→
  1288→          // 标记为已推送
  1289→          await fetch("/api/v1/proactive/mark-sent", {
  1290→            method: "POST",
  1291→            body: JSON.stringify({ push_id: push.id }),
  1292→          });
  1293→        }
  1294→      } catch (error) {
  1295→        console.error("Failed to fetch proactive pushes:", error);
  1296→      }
  1297→    };
  1298→
  1299→    fetchAndDisplayPushes();
  1300→  }, [user]);
  1301→}
  1302→```
  1303→
  1304→### 7.4 更多推送创意
  1305→
  1306→1. **情绪感知推送**
  1307→   - 检测用户对话中的情绪关键词
  1308→   - 低落时发送鼓励，开心时一起庆祝
  1309→
  1310→2. **智能沉默关怀**
  1311→   - 用户3天没登录 → "最近忙吗？有什么想分享的吗？"
  1312→   - 用户7天没登录 → "想你了，回来看看你的运势吧"
  1313→
  1314→3. **共鸣式问候**
  1315→   - 基于命盘特征："作为火日主的你，今天可能会感到..."
  1316→   - 基于当前运势："这周土星逆行可能让你感到..."
  1317→
  1318→4. **成就庆祝**
  1319→   - 对话累计100轮 → "我们已经聊了100次了，谢谢你的信任"
  1320→   - 订阅满一年 → "一年了，我们一起走过了..."
  1321→
  1322→5. **季节性问候**
  1323→   - 春节："新年快乐，你的新年运势..."
  1324→   - 中秋："月圆人团圆，今晚的月亮对你的影响..."
  1325→
  1326→---
  1327→
  1328→## 8. 实施路线图
  1329→
  1330→### Phase 1 (Week 1-2): 核心流程
  1331→
  1332→```
  1333→前端
  1334→├── [ ] www.vibelife.app 品牌首页
  1335→├── [ ] 子站 Landing Page (bazi/zodiac)
  1336→├── [ ] 30秒 Aha Moment 流程
  1337→├── [ ] 自适应访谈组件
  1338→├── [ ] "来自未来的信" 组件
  1339→└── [ ] 付费墙组件
  1340→
  1341→后端
  1342→├── [ ] 访谈问题生成 API
  1343→├── [ ] "来自未来的信" 生成 API
  1344→├── [ ] 报告生成 API
  1345→└── [ ] 访客用户状态管理
  1346→
  1347→数据追踪
  1348→├── [ ] 漏斗埋点
  1349→├── [ ] Aha Moment 时间追踪
  1350→└── [ ] 转化率追踪
  1351→```
  1352→
  1353→### Phase 2 (Week 3-4): 主动推送
  1354→
  1355→```
  1356→后端
  1357→├── [ ] 推送类型定义
  1358→├── [ ] 推送调度器
  1359→├── [ ] 智能触发逻辑
  1360→└── [ ] 推送模板管理
  1361→
  1362→前端
  1363→├── [ ] 聊天界面推送展示
  1364→├── [ ] 推送通知 Hook
  1365→└── [ ] 推送设置页面
  1366→```
  1367→
  1368→### Phase 3 (Week 5-6): 优化迭代
  1369→
  1370→```
  1371→数据分析
  1372→├── [ ] 漏斗分析
  1373→├── [ ] 推送效果分析
  1374→└── [ ] 用户反馈收集
  1375→
  1376→优化
  1377→├── [ ] 访谈问题优化
  1378→├── [ ] "来自未来的信" 模板优化
  1379→├── [ ] 推送时机优化
  1380→└── [ ] 转化率优化
  1381→```
  1382→
  1383→---
  1384→
  1385→## 9. 成功指标
  1386→
  1387→### 9.1 核心 KPI
  1388→
  1389→| 指标 | 目标 | 计算方式 |
  1390→|------|------|----------|
  1391→| Time to Aha | < 30秒 | 首次进入到看到命盘的时间 |
  1392→| Aha 完成率 | > 70% | 进入用户中看到命盘的比例 |
  1393→| 访谈完成率 | > 50% | 开始访谈的用户中完成的比例 |
  1394→| 信阅读率 | > 80% | 生成信的用户中阅读的比例 |
  1395→| 转化率 | > 5% | 看到信的用户中付费的比例 |
  1396→| 日活留存 | > 40% | 次日返回的用户比例 |
  1397→| 推送点击率 | > 30% | 收到推送后点击的比例 |
  1398→
  1399→### 9.2 健康度指标
  1400→
  1401→| 指标 | 健康范围 | 预警线 |
  1402→|------|----------|--------|
  1403→| Free-to-Paid 转化 | 3-8% | < 2% |
  1404→| 付费用户留存 | > 60% | < 40% |
  1405→| 推送打开率 | > 25% | < 15% |
  1406→| NPS | > 40 | < 20 |
  1407→
  1408→---
  1409→
  1410→## 10. 总结
  1411→
  1412→这份用户流程设计方案综合了：
  1413→1. **品牌沉浸式入口**：World class 高级感
  1414→2. **30秒 Aha Moment**：快速价值交付
  1415→3. **个性化深度访谈**：LLM 实时生成触动人心的问题
  1416→4. **"来自未来的信"**：情感高潮，免费完整展示
  1417→5. **主动推送系统**：核心差异化，让用户感受被关心
  1418→
  1419→实施后预期：
  1420→- 首次访问到 Aha Moment：< 30秒
  1421→- 访谈完成率：> 50%
  1422→- 付费转化率：> 5%
  1423→- 日活留存：> 40%
  1424→
  1425→---
  1426→
  1427→*文档由深度访谈综合设计，如需修改请继续讨论。*
  1428→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
