     1→"use client";
     2→
     3→/**
     4→ * Chat Page - 主对话页面（三栏布局）
     5→ * Based on: vibelife spec v3.0
     6→ *
     7→ * PC端:
     8→ * - 左侧 NavBar (64px) - 固定导航
     9→ * - 中间 Chat Stream (flex-1) - 对话流始终显示
    10→ * - 右侧 Panel (360px) - 根据 NavBar Tab 切换内容
    11→ *
    12→ * 移动端:
    13→ * - 顶部 Header
    14→ * - 内容区 - 根据底部 Tab 完全切换
    15→ * - 底部 TabBar
    16→ */
    17→
    18→import { useState, useMemo } from "react";
    19→import { useRouter } from "next/navigation";
    20→import { useSkill } from "@/providers";
    21→import { AppShell, useAppShell, type TabType } from "@/components/layout";
    22→import { ChatPanel, ChartPanel, JourneyPanel, MePanel } from "@/components/layout/panels";
    23→import { ChatContainer } from "@/components/chat/ChatContainer";
    24→import { LuminousPaper, BreathAura } from "@/components/core";
    25→
    26→// ═══════════════════════════════════════════════════════════════════════════
    27→// Panel Content Switcher
    28→// ═══════════════════════════════════════════════════════════════════════════
    29→
    30→function PanelContent() {
    31→  const router = useRouter();
    32→  const { skill, activeTab } = useAppShell();
    33→
    34→  // Navigation handlers
    35→  const handleOpenRelationship = () => {
    36→    router.push("/relationship");
    37→  };
    38→
    39→  const handleGenerateReport = () => {
    40→    router.push("/interview?returnTo=/report");
    41→  };
    42→
    43→  const handleViewKLine = () => {
    44→    // TODO: 实现 K 线详情页
    45→    console.log("View K-Line");
    46→  };
    47→
    48→  // Demo data - 实际应从 API 获取
    49→  const demoProfile = useMemo(() => {
    50→    if (skill === "bazi") {
    51→      return {
    52→        dayMaster: "甲木",
    53→        pattern: "正印格",
    54→        currentLuck: "壬寅大运",
    55→        pillars: {
    56→          year: { stem: "庚", branch: "午" },
    57→          month: { stem: "戊", branch: "子" },
    58→          day: { stem: "甲", branch: "辰" },
    59→        },
    60→      };
    61→    }
    62→    if (skill === "zodiac") {
    63→      return {
    64→        sunSign: "双子座",
    65→        moonSign: "天蝎座",
    66→        risingSign: "狮子座",
    67→      };
    68→    }
    69→    return null;
    70→  }, [skill]);
    71→
    72→  const demoNowNext = useMemo(() => ({
    73→    currentPhase: "积累期",
    74→    currentTheme: "这是一个适合沉淀学习的阶段，不急于求成",
    75→    nextMilestone: "突破期",
    76→    nextDate: "2026年下半年",
    77→  }), []);
    78→
    79→  switch (activeTab) {
    80→    case "chat":
    81→      return (
    82→        <ChatPanel
    83→          skill={skill}
    84→          profile={demoProfile}
    85→          insights={[]}
    86→          onOpenRelationship={handleOpenRelationship}
    87→        />
    88→      );
    89→    case "chart":
    90→      return (
    91→        <ChartPanel
    92→          skill={skill}
    93→          nowNextData={demoNowNext}
    94→          klinePreview={{
    95→            currentScore: 72,
    96→            trend: "up",
    97→            period: "2026年",
    98→          }}
    99→          onViewKLine={handleViewKLine}
   100→          onGenerateReport={handleGenerateReport}
   101→        />
   102→      );
   103→    case "journey":
   104→      return (
   105→        <JourneyPanel
   106→          skill={skill}
   107→          totalConversations={12}
   108→          totalInsights={5}
   109→          memberSince="2025年12月"
   110→          timeline={[
   111→            {
   112→              id: "1",
   113→              date: "今天",
   114→              title: "关于事业方向的对话",
   115→              summary: "探讨了未来3年的职业规划",
   116→              type: "conversation",
   117→            },
   118→            {
   119→              id: "2",
   120→              date: "昨天",
   121→              title: "你的核心优势",
   122→              summary: "甲木日主，天生有领导力和创造力",
   123→              type: "insight",
   124→            },
   125→          ]}
   126→        />
   127→      );
   128→    case "me":
   129→      return (
   130→        <MePanel
   131→          skill={skill}
   132→          user={{
   133→            name: "测试用户",
   134→            email: "test@vibelife.app",
   135→            isPro: false,
   136→          }}
   137→          onLogout={() => console.log("Logout")}
   138→        />
   139→      );
   140→    default:
   141→      return null;
   142→  }
   143→}
   144→
   145→// ═══════════════════════════════════════════════════════════════════════════
   146→// Chat Content (中间区域)
   147→// ═══════════════════════════════════════════════════════════════════════════
   148→
   149→function ChatContent() {
   150→  const { skill, voiceMode } = useAppShell();
   151→
   152→  return (
   153→    <LuminousPaper skill={skill} variant="default" className="h-full relative">
   154→      {/* Background aura */}
   155→      <BreathAura
   156→        skill={skill}
   157→        size="xl"
   158→        position="top"
   159→        intensity="low"
   160→        className="opacity-30"
   161→      />
   162→
   163→      {/* Chat Container */}
   164→      <ChatContainer
   165→        skillId={skill}
   166→        skill={skill}
   167→        voiceMode={voiceMode}
   168→      />
   169→    </LuminousPaper>
   170→  );
   171→}
   172→
   173→// ═══════════════════════════════════════════════════════════════════════════
   174→// Main Page Component
   175→// ═══════════════════════════════════════════════════════════════════════════
   176→
   177→export default function ChatPage() {
   178→  const { skill } = useSkill();
   179→
   180→  return (
   181→    <AppShell skill={skill} panelContent={<PanelContent />}>
   182→      <ChatContent />
   183→    </AppShell>
   184→  );
   185→}
   186→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
