     1→"use client";
     2→
     3→import { cn } from "@/lib/utils";
     4→
     5→/**
     6→ * BaziChart - 八字命盘可视化
     7→ *
     8→ * 展示四柱八字: 年/月/日/时
     9→ * 包含: 天干 + 地支 + 五行 + 十神
    10→ */
    11→
    12→// 五行类型
    13→type Element = "wood" | "fire" | "earth" | "metal" | "water";
    14→
    15→// 天干地支数据
    16→interface Pillar {
    17→  stem: string; // 天干: 甲乙丙丁...
    18→  branch: string; // 地支: 子丑寅卯...
    19→  element: Element; // 五行
    20→  tenGod?: string; // 十神: 比肩, 劫财, 食神...
    21→}
    22→
    23→interface BaziChartProps {
    24→  pillars: {
    25→    year: Pillar;
    26→    month: Pillar;
    27→    day: Pillar;
    28→    hour?: Pillar; // 时柱可选
    29→  };
    30→  dayMaster?: string; // 日主
    31→  showTenGods?: boolean;
    32→  showElements?: boolean;
    33→  size?: "sm" | "md" | "lg";
    34→  variant?: "compact" | "full";
    35→  className?: string;
    36→}
    37→
    38→// 五行颜色映射
    39→const ELEMENT_COLORS: Record<Element, string> = {
    40→  wood: "text-green-600 bg-green-50 border-green-200",
    41→  fire: "text-red-600 bg-red-50 border-red-200",
    42→  earth: "text-amber-600 bg-amber-50 border-amber-200",
    43→  metal: "text-slate-500 bg-slate-50 border-slate-200",
    44→  water: "text-blue-600 bg-blue-50 border-blue-200",
    45→};
    46→
    47→const ELEMENT_NAMES: Record<Element, string> = {
    48→  wood: "木",
    49→  fire: "火",
    50→  earth: "土",
    51→  metal: "金",
    52→  water: "水",
    53→};
    54→
    55→type PillarKey = "year" | "month" | "day" | "hour";
    56→
    57→const PILLAR_NAMES: Record<PillarKey, string> = {
    58→  year: "年柱",
    59→  month: "月柱",
    60→  day: "日柱",
    61→  hour: "时柱",
    62→};
    63→
    64→// 单个柱子组件
    65→function PillarColumn({
    66→  pillar,
    67→  label,
    68→  isDayMaster = false,
    69→  showTenGod = true,
    70→  showElement = true,
    71→  size = "md",
    72→}: {
    73→  pillar: Pillar;
    74→  label: string;
    75→  isDayMaster?: boolean;
    76→  showTenGod?: boolean;
    77→  showElement?: boolean;
    78→  size?: "sm" | "md" | "lg";
    79→}) {
    80→  const sizeClasses = {
    81→    sm: "w-14 text-xs",
    82→    md: "w-20 text-sm",
    83→    lg: "w-24 text-base",
    84→  };
    85→
    86→  return (
    87→    <div
    88→      className={cn(
    89→        "flex flex-col items-center gap-1",
    90→        sizeClasses[size],
    91→        isDayMaster && "relative"
    92→      )}
    93→    >
    94→      {/* 柱名 */}
    95→      <span className="text-muted-foreground text-[10px] uppercase tracking-wider">
    96→        {label}
    97→      </span>
    98→
    99→      {/* 天干 */}
   100→      <div
   101→        className={cn(
   102→          "w-full aspect-square rounded-lg border-2 flex items-center justify-center font-serif font-bold",
   103→          ELEMENT_COLORS[pillar.element],
   104→          isDayMaster && "ring-2 ring-antique-gold ring-offset-2"
   105→        )}
   106→      >
   107→        {pillar.stem}
   108→      </div>
   109→
   110→      {/* 地支 */}
   111→      <div
   112→        className={cn(
   113→          "w-full aspect-square rounded-lg border flex items-center justify-center font-serif",
   114→          "bg-muted/30 border-border/50"
   115→        )}
   116→      >
   117→        {pillar.branch}
   118→      </div>
   119→
   120→      {/* 五行 */}
   121→      {showElement && (
   122→        <span className={cn("text-[10px]", ELEMENT_COLORS[pillar.element].split(" ")[0])}>
   123→          ({ELEMENT_NAMES[pillar.element]})
   124→        </span>
   125→      )}
   126→
   127→      {/* 十神 */}
   128→      {showTenGod && pillar.tenGod && (
   129→        <span className="text-[10px] text-muted-foreground bg-muted/50 px-1.5 py-0.5 rounded">
   130→          {pillar.tenGod}
   131→        </span>
   132→      )}
   133→
   134→      {/* 日主标记 */}
   135→      {isDayMaster && (
   136→        <span className="absolute -top-6 left-1/2 -translate-x-1/2 text-[9px] text-antique-gold font-medium">
   137→          日主
   138→        </span>
   139→      )}
   140→    </div>
   141→  );
   142→}
   143→
   144→export function BaziChart({
   145→  pillars,
   146→  showTenGods = true,
   147→  showElements = true,
   148→  size = "md",
   149→  variant = "full",
   150→  className,
   151→}: BaziChartProps) {
   152→  const pillarEntries: Array<{ key: PillarKey; data: Pillar }> = [
   153→    { key: "year", data: pillars.year },
   154→    { key: "month", data: pillars.month },
   155→    { key: "day", data: pillars.day },
   156→    ...(pillars.hour ? [{ key: "hour" as PillarKey, data: pillars.hour }] : []),
   157→  ];
   158→
   159→  if (variant === "compact") {
   160→    return (
   161→      <div className={cn("space-y-2", className)}>
   162→        {pillarEntries.map(({ key, data }) => (
   163→          <div key={key} className="flex items-center gap-2 text-sm">
   164→            <span className="w-8 text-muted-foreground">
   165→              {PILLAR_NAMES[key].charAt(0)}:
   166→            </span>
   167→            <span className="font-serif font-medium">
   168→              {data.stem}
   169→              {data.branch}
   170→            </span>
   171→            <span className={cn("text-xs", ELEMENT_COLORS[data.element].split(" ")[0])}>
   172→              ({ELEMENT_NAMES[data.element]})
   173→            </span>
   174→            {data.tenGod && (
   175→              <span className="text-xs text-muted-foreground">[{data.tenGod}]</span>
   176→            )}
   177→          </div>
   178→        ))}
   179→      </div>
   180→    );
   181→  }
   182→
   183→  return (
   184→    <div className={cn("flex justify-center gap-3 pt-6", className)}>
   185→      {pillarEntries.map(({ key, data }) => (
   186→        <PillarColumn
   187→          key={key}
   188→          pillar={data}
   189→          label={PILLAR_NAMES[key]}
   190→          isDayMaster={key === "day"}
   191→          showTenGod={showTenGods}
   192→          showElement={showElements}
   193→          size={size}
   194→        />
   195→      ))}
   196→    </div>
   197→  );
   198→}
   199→
   200→export default BaziChart;
   201→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
