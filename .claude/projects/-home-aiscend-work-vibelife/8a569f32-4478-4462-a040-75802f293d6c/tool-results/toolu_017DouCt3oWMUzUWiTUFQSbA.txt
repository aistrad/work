============================= test session starts ==============================
platform linux -- Python 3.13.3, pytest-8.4.2, pluggy-1.6.0 -- /data/anaconda3/envs/ai/bin/python
cachedir: .pytest_cache
rootdir: /home/aiscend/work/vibelife/apps/api
configfile: pytest.ini
plugins: mock-3.15.0, time-machine-2.17.0, asyncio-1.1.0, cov-7.0.0, anyio-4.9.0
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 22 items

tests/test_real_vibeprofile.py::TestProfileRead::test_01_get_profile_user1 üì¶ PostgreSQL: PostgreSQL 16.10 (Ubuntu 16.10-0ubuntu0.24.04.1) o...
FAILED
tests/test_real_vibeprofile.py::TestProfileRead::test_02_get_profile_user2 FAILED
tests/test_real_vibeprofile.py::TestProfileRead::test_03_get_profile_user3 FAILED
tests/test_real_vibeprofile.py::TestProfileRead::test_04_get_birth_info FAILED
tests/test_real_vibeprofile.py::TestProfileRead::test_05_get_preferences FAILED
tests/test_real_vibeprofile.py::TestProfileRead::test_06_get_life_context FAILED
tests/test_real_vibeprofile.py::TestProfileRead::test_07_get_skill_data FAILED
tests/test_real_vibeprofile.py::TestProfileRead::test_08_get_extracted FAILED
tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_09_get_user_subscriptions FAILED
tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_10_get_skill_subscription FAILED
tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_11_is_subscribed FAILED
tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_12_is_push_enabled FAILED
tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_13_get_subscribed_skill_ids FAILED
tests/test_real_vibeprofile.py::TestPushSettings::test_14_get_push_settings FAILED
tests/test_real_vibeprofile.py::TestPushSettings::test_15_get_push_hour FAILED
tests/test_real_vibeprofile.py::TestPushSettings::test_16_is_in_quiet_hours 
‚úÖ ÂÖçÊâìÊâ∞Êó∂ÊÆµÊ£ÄÊü•
FAILED
tests/test_real_vibeprofile.py::TestLifeContext::test_17_list_life_context_paths FAILED
tests/test_real_vibeprofile.py::TestLifeContext::test_18_read_life_context_path FAILED
tests/test_real_vibeprofile.py::TestProfileWrite::test_19_update_preferences FAILED
tests/test_real_vibeprofile.py::TestProfileWrite::test_20_update_birth_info FAILED
tests/test_real_vibeprofile.py::TestOtherFeatures::test_21_get_blocked_skills FAILED
tests/test_real_vibeprofile.py::TestOtherFeatures::test_22_is_skill_blocked FAILED

=================================== FAILURES ===================================
__________________ TestProfileRead.test_01_get_profile_user1 ___________________
stores/db.py:148: in get_connection
    yield conn
stores/db.py:191: in fetchrow
    return await conn.fetchrow(query, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:748: in fetchrow
    data = await self._execute(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:1864: in _execute
    result, _ = await self.__execute(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:1961: in __execute
    result, stmt = await self._do_execute(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2012: in _do_execute
    stmt = await self._get_statement(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:432: in _get_statement
    statement = await self._protocol.prepare(
asyncpg/protocol/protocol.pyx:165: in prepare
    ???
E   RuntimeError: Task <Task pending name='Task-4' coro=<TestProfileRead.test_01_get_profile_user1() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:60> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseProtocol._on_waiter_completed()]> attached to a different loop

During handling of the above exception, another exception occurred:
tests/test_real_vibeprofile.py:60: in test_01_get_profile_user1
    profile = await repo.get_profile(TEST_USER_1)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:235: in __aexit__
    await self.gen.athrow(value)
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1031: in __aexit__
    await self.pool.release(con)
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:905: in release
    return await asyncio.shield(ch.release(timeout))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:228: in release
    raise ex
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:218: in release
    await self._con.reset(timeout=budget)
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:1562: in reset
    await self.execute(reset_query)
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:349: in execute
    result = await self._protocol.query(query, timeout)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
asyncpg/protocol/protocol.pyx:360: in query
    ???
asyncpg/protocol/protocol.pyx:745: in asyncpg.protocol.protocol.BaseProtocol._check_state
    ???
E   asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress
__________________ TestProfileRead.test_02_get_profile_user2 ___________________
tests/test_real_vibeprofile.py:72: in test_02_get_profile_user2
    profile = await repo.get_profile(TEST_USER_2)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-9' coro=<TestProfileRead.test_02_get_profile_user2() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:72> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
__________________ TestProfileRead.test_03_get_profile_user3 ___________________
tests/test_real_vibeprofile.py:81: in test_03_get_profile_user3
    profile = await repo.get_profile(TEST_USER_3)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-13' coro=<TestProfileRead.test_03_get_profile_user3() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:81> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
____________________ TestProfileRead.test_04_get_birth_info ____________________
tests/test_real_vibeprofile.py:90: in test_04_get_birth_info
    birth_info = await repo.get_birth_info(TEST_USER_1)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:147: in get_birth_info
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-17' coro=<TestProfileRead.test_04_get_birth_info() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:90> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
___________________ TestProfileRead.test_05_get_preferences ____________________
tests/test_real_vibeprofile.py:100: in test_05_get_preferences
    preferences = await repo.get_preferences(TEST_USER_1)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:169: in get_preferences
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-21' coro=<TestProfileRead.test_05_get_preferences() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:100> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
___________________ TestProfileRead.test_06_get_life_context ___________________
tests/test_real_vibeprofile.py:111: in test_06_get_life_context
    life_context = await repo.get_life_context(TEST_USER_1)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:185: in get_life_context
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-25' coro=<TestProfileRead.test_06_get_life_context() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:111> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
____________________ TestProfileRead.test_07_get_skill_data ____________________
tests/test_real_vibeprofile.py:120: in test_07_get_skill_data
    skill_data = await repo.get_skill_data(TEST_USER_1, 'bazi')
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:153: in get_skill_data
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-29' coro=<TestProfileRead.test_07_get_skill_data() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:120> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
____________________ TestProfileRead.test_08_get_extracted _____________________
tests/test_real_vibeprofile.py:129: in test_08_get_extracted
    extracted = await repo.get_extracted(TEST_USER_1)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:442: in get_extracted
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-33' coro=<TestProfileRead.test_08_get_extracted() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:129> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
____________ TestSkillSubscriptions.test_09_get_user_subscriptions _____________
tests/test_real_vibeprofile.py:146: in test_09_get_user_subscriptions
    subscriptions = await repo.get_user_subscriptions(TEST_USER_1)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:526: in get_user_subscriptions
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-37' coro=<TestSkillSubscriptions.test_09_get_user_subscriptions() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:146> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
____________ TestSkillSubscriptions.test_10_get_skill_subscription _____________
tests/test_real_vibeprofile.py:158: in test_10_get_skill_subscription
    subscriptions = await repo.get_user_subscriptions(TEST_USER_1)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:526: in get_user_subscriptions
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-41' coro=<TestSkillSubscriptions.test_10_get_skill_subscription() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:158> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
_________________ TestSkillSubscriptions.test_11_is_subscribed _________________
tests/test_real_vibeprofile.py:174: in test_11_is_subscribed
    subscriptions = await repo.get_user_subscriptions(TEST_USER_1)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:526: in get_user_subscriptions
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-45' coro=<TestSkillSubscriptions.test_11_is_subscribed() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:174> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
________________ TestSkillSubscriptions.test_12_is_push_enabled ________________
tests/test_real_vibeprofile.py:188: in test_12_is_push_enabled
    subscriptions = await repo.get_user_subscriptions(TEST_USER_1)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:526: in get_user_subscriptions
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-49' coro=<TestSkillSubscriptions.test_12_is_push_enabled() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:188> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
___________ TestSkillSubscriptions.test_13_get_subscribed_skill_ids ____________
tests/test_real_vibeprofile.py:202: in test_13_get_subscribed_skill_ids
    skill_ids = await repo.get_subscribed_skill_ids(TEST_USER_1)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:550: in get_subscribed_skill_ids
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-53' coro=<TestSkillSubscriptions.test_13_get_subscribed_skill_ids() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:202> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
__________________ TestPushSettings.test_14_get_push_settings __________________
tests/test_real_vibeprofile.py:220: in test_14_get_push_settings
    settings = await repo.get_push_settings(TEST_USER_1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:834: in get_push_settings
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-57' coro=<TestPushSettings.test_14_get_push_settings() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:220> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
____________________ TestPushSettings.test_15_get_push_hour ____________________
tests/test_real_vibeprofile.py:234: in test_15_get_push_hour
    push_hour = await repo.get_push_hour(TEST_USER_1)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:906: in get_push_hour
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-61' coro=<TestPushSettings.test_15_get_push_hour() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:234> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
__________________ TestPushSettings.test_16_is_in_quiet_hours __________________
tests/test_real_vibeprofile.py:249: in test_16_is_in_quiet_hours
    is_quiet = await repo.is_in_quiet_hours(TEST_USER_1, hour)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:916: in is_in_quiet_hours
    prefs = await UnifiedProfileRepository.get_push_settings(user_id)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:834: in get_push_settings
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-65' coro=<TestPushSettings.test_16_is_in_quiet_hours() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:249> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
_______________ TestLifeContext.test_17_list_life_context_paths ________________
tests/test_real_vibeprofile.py:263: in test_17_list_life_context_paths
    paths = await repo.list_life_context_paths(TEST_USER_1)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:1175: in list_life_context_paths
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-69' coro=<TestLifeContext.test_17_list_life_context_paths() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:263> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
________________ TestLifeContext.test_18_read_life_context_path ________________
tests/test_real_vibeprofile.py:275: in test_18_read_life_context_path
    paths = await repo.list_life_context_paths(TEST_USER_1)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:1175: in list_life_context_paths
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-73' coro=<TestLifeContext.test_18_read_life_context_path() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:275> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
_________________ TestProfileWrite.test_19_update_preferences __________________
tests/test_real_vibeprofile.py:303: in test_19_update_preferences
    original = await repo.get_preferences(TEST_USER_1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:169: in get_preferences
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-77' coro=<TestProfileWrite.test_19_update_preferences() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:303> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
__________________ TestProfileWrite.test_20_update_birth_info __________________
tests/test_real_vibeprofile.py:332: in test_20_update_birth_info
    original = await repo.get_birth_info(TEST_USER_1)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:147: in get_birth_info
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-81' coro=<TestProfileWrite.test_20_update_birth_info() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:332> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
_________________ TestOtherFeatures.test_21_get_blocked_skills _________________
tests/test_real_vibeprofile.py:365: in test_21_get_blocked_skills
    blocked = await repo.get_blocked_skills(TEST_USER_1)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:937: in get_blocked_skills
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-85' coro=<TestOtherFeatures.test_21_get_blocked_skills() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:365> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
__________________ TestOtherFeatures.test_22_is_skill_blocked __________________
tests/test_real_vibeprofile.py:376: in test_22_is_skill_blocked
    is_blocked = await repo.is_skill_blocked(TEST_USER_1, 'test_skill')
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:1003: in is_skill_blocked
    blocked_skills = await UnifiedProfileRepository.get_blocked_skills(user_id)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:937: in get_blocked_skills
    profile = await UnifiedProfileRepository.get_profile(user_id)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
stores/unified_profile_repo.py:132: in get_profile
    row = await fetchrow(
stores/db.py:190: in fetchrow
    async with get_connection() as conn:
               ^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/contextlib.py:214: in __aenter__
    return await anext(self.gen)
           ^^^^^^^^^^^^^^^^^^^^^
stores/db.py:147: in get_connection
    async with pool.acquire() as conn:  # type: ignore[union-attr]
               ^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:1024: in __aenter__
    self.connection = await self.pool._acquire(self.timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:864: in _acquire
    return await _acquire_impl()
           ^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:849: in _acquire_impl
    proxy = await ch.acquire()  # type: PoolConnectionProxy
            ^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:140: in acquire
    await self.connect()
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:132: in connect
    self._con = await self._pool._get_new_connection()
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/pool.py:517: in _get_new_connection
    con = await self._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connection.py:2421: in connect
    return await connect_utils._connect(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:1049: in _connect
    conn = await _connect_addr(
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:886: in _connect_addr
    return await __connect_addr(params, True, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:931: in __connect_addr
    tr, pr = await connector
             ^^^^^^^^^^^^^^^
/data/anaconda3/envs/ai/lib/python3.13/site-packages/asyncpg/connect_utils.py:802: in _create_ssl_connection
    tr, pr = await loop.create_connection(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1135: in create_connection
    sock = await self._connect_sock(
/data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:1038: in _connect_sock
    await self.sock_connect(sock, address)
/data/anaconda3/envs/ai/lib/python3.13/asyncio/selector_events.py:641: in sock_connect
    return await fut
           ^^^^^^^^^
E   RuntimeError: Task <Task pending name='Task-89' coro=<TestOtherFeatures.test_22_is_skill_blocked() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:376> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
---------------------------- Captured log teardown -----------------------------
ERROR    asyncio:base_events.py:1865 Future exception was never retrieved
future: <Future finished exception=ConnectionDoesNotExistError('connection was closed in the middle of operation')>
asyncpg.exceptions.ConnectionDoesNotExistError: connection was closed in the middle of operation
=========================== short test summary info ============================
FAILED tests/test_real_vibeprofile.py::TestProfileRead::test_01_get_profile_user1 - asyncpg.exceptions._base.InterfaceError: cannot perform operation: another operation is in progress
FAILED tests/test_real_vibeprofile.py::TestProfileRead::test_02_get_profile_user2 - RuntimeError: Task <Task pending name='Task-9' coro=<TestProfileRead.test_02_get_profile_user2() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:72> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestProfileRead::test_03_get_profile_user3 - RuntimeError: Task <Task pending name='Task-13' coro=<TestProfileRead.test_03_get_profile_user3() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:81> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestProfileRead::test_04_get_birth_info - RuntimeError: Task <Task pending name='Task-17' coro=<TestProfileRead.test_04_get_birth_info() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:90> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestProfileRead::test_05_get_preferences - RuntimeError: Task <Task pending name='Task-21' coro=<TestProfileRead.test_05_get_preferences() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:100> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestProfileRead::test_06_get_life_context - RuntimeError: Task <Task pending name='Task-25' coro=<TestProfileRead.test_06_get_life_context() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:111> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestProfileRead::test_07_get_skill_data - RuntimeError: Task <Task pending name='Task-29' coro=<TestProfileRead.test_07_get_skill_data() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:120> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestProfileRead::test_08_get_extracted - RuntimeError: Task <Task pending name='Task-33' coro=<TestProfileRead.test_08_get_extracted() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:129> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_09_get_user_subscriptions - RuntimeError: Task <Task pending name='Task-37' coro=<TestSkillSubscriptions.test_09_get_user_subscriptions() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:146> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_10_get_skill_subscription - RuntimeError: Task <Task pending name='Task-41' coro=<TestSkillSubscriptions.test_10_get_skill_subscription() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:158> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_11_is_subscribed - RuntimeError: Task <Task pending name='Task-45' coro=<TestSkillSubscriptions.test_11_is_subscribed() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:174> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_12_is_push_enabled - RuntimeError: Task <Task pending name='Task-49' coro=<TestSkillSubscriptions.test_12_is_push_enabled() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:188> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestSkillSubscriptions::test_13_get_subscribed_skill_ids - RuntimeError: Task <Task pending name='Task-53' coro=<TestSkillSubscriptions.test_13_get_subscribed_skill_ids() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:202> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestPushSettings::test_14_get_push_settings - RuntimeError: Task <Task pending name='Task-57' coro=<TestPushSettings.test_14_get_push_settings() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:220> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestPushSettings::test_15_get_push_hour - RuntimeError: Task <Task pending name='Task-61' coro=<TestPushSettings.test_15_get_push_hour() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:234> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestPushSettings::test_16_is_in_quiet_hours - RuntimeError: Task <Task pending name='Task-65' coro=<TestPushSettings.test_16_is_in_quiet_hours() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:249> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestLifeContext::test_17_list_life_context_paths - RuntimeError: Task <Task pending name='Task-69' coro=<TestLifeContext.test_17_list_life_context_paths() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:263> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestLifeContext::test_18_read_life_context_path - RuntimeError: Task <Task pending name='Task-73' coro=<TestLifeContext.test_18_read_life_context_path() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:275> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestProfileWrite::test_19_update_preferences - RuntimeError: Task <Task pending name='Task-77' coro=<TestProfileWrite.test_19_update_preferences() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:303> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestProfileWrite::test_20_update_birth_info - RuntimeError: Task <Task pending name='Task-81' coro=<TestProfileWrite.test_20_update_birth_info() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:332> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestOtherFeatures::test_21_get_blocked_skills - RuntimeError: Task <Task pending name='Task-85' coro=<TestOtherFeatures.test_21_get_blocked_skills() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:365> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
FAILED tests/test_real_vibeprofile.py::TestOtherFeatures::test_22_is_skill_blocked - RuntimeError: Task <Task pending name='Task-89' coro=<TestOtherFeatures.test_22_is_skill_blocked() running at /home/aiscend/work/vibelife/apps/api/tests/test_real_vibeprofile.py:376> cb=[_run_until_complete_cb() at /data/anaconda3/envs/ai/lib/python3.13/asyncio/base_events.py:181]> got Future <Future pending cb=[BaseSelectorEventLoop._sock_write_done()()]> attached to a different loop
============================== 22 failed in 4.70s ==============================