  1500→┌─────────────────────────────────────────────────────────────────────────────┐
  1501→│                                                                             │
  1502→│   文件上传与信息抽取                                                        │
  1503→│                                                                             │
  1504→│   ═══════════════════════════════════════════════════════════════════════   │
  1505→│                                                                             │
  1506→│   支持的文件类型                                                            │
  1507→│   ─────────────────────────────────────────────────────────────────────     │
  1508→│                                                                             │
  1509→│   图片（JPG, PNG, HEIC）                                                    │
  1510→│   ├── 其他 App 的排盘截图 → 抽取八字/星盘信息                               │
  1511→│   ├── 聊天记录截图 → 抽取关系模式、沟通风格                                 │
  1512→│   └── 手写笔记 → OCR + 内容理解                                             │
  1513→│                                                                             │
  1514→│   文档（PDF, DOCX, TXT）                                                    │
  1515→│   ├── 简历 → 抽取职业经历、技能、发展轨迹                                   │
  1516→│   ├── 日记/随笔 → 抽取情绪模式、价值观、关注点                              │
  1517→│   └── 其他文档 → 自由抽取相关信息                                           │
  1518→│                                                                             │
  1519→│   ─────────────────────────────────────────────────────────────────────     │
  1520→│                                                                             │
  1521→│   抽取流程                                                                  │
  1522→│   ─────────────────────────────────────────────────────────────────────     │
  1523→│                                                                             │
  1524→│   1. 文件预处理                                                             │
  1525→│      • 图片：压缩 + OCR                                                     │
  1526→│      • PDF：文本提取 + 图片提取                                             │
  1527→│      • 文档：格式转换 + 文本提取                                            │
  1528→│                                                                             │
  1529→│   2. LLM 结构化抽取                                                         │
  1530→│      • 使用 Claude 3 Vision / GPT-4V 进行图片理解                           │
  1531→│      • 输出 JSON Schema 格式的结构化数据                                    │
  1532→│      • 置信度评分                                                           │
  1533→│                                                                             │
  1534→│   3. Profile 更新                                                           │
  1535→│      • 新信息与现有 Profile 融合                                            │
  1536→│      • 冲突检测 + 用新值覆盖                                                │
  1537→│      • 版本记录                                                             │
  1538→│                                                                             │
  1539→│   ─────────────────────────────────────────────────────────────────────     │
  1540→│                                                                             │
  1541→│   抽取示例：聊天记录截图                                                    │
  1542→│   ─────────────────────────────────────────────────────────────────────     │
  1543→│                                                                             │
  1544→│   输入：用户上传与伴侣的聊天截图                                            │
  1545→│                                                                             │
  1546→│   抽取输出：                                                                │
  1547→│   {                                                                         │
  1548→│     "relationship_context": {                                               │
  1549→│       "type": "romantic",                                                   │
  1550→│       "status": "in_conflict",                                              │
  1551→│       "duration_hint": "seems established"                                  │
  1552→│     },                                                                      │
  1553→│     "communication_patterns": {                                             │
  1554→│       "user_style": "tends to explain, seeks understanding",                │
  1555→│       "partner_style": "short responses, seems frustrated"                  │
  1556→│     },                                                                      │
  1557→│     "emotional_cues": {                                                     │
  1558→│       "user_emotion": "anxious, trying to fix",                             │
  1559→│       "conflict_topic": "time/attention allocation"                         │
  1560→│     },                                                                      │
  1561→│     "insights": [                                                           │
  1562→│       "用户习惯付出和解释",                                                 │
  1563→│       "对方可能需要空间而非解释",                                           │
  1564→│       "存在沟通方式不匹配"                                                  │
  1565→│     ]                                                                       │
  1566→│   }                                                                         │
  1567→│                                                                             │
  1568→└─────────────────────────────────────────────────────────────────────────────┘
  1569→```
  1570→
  1571→## 4.4 Profile 结构设计
  1572→
  1573→```
  1574→┌─────────────────────────────────────────────────────────────────────────────┐
  1575→│                                                                             │
  1576→│   USER PROFILE 结构设计                                                     │
  1577→│                                                                             │
  1578→│   ═══════════════════════════════════════════════════════════════════════   │
  1579→│                                                                             │
  1580→│   存储方式：JSON（PostgreSQL JSONB 字段）                                   │
  1581→│   更新机制：融合式 + 版本化（保留历史，支持回溯）                           │
  1582→│                                                                             │
  1583→│   ─────────────────────────────────────────────────────────────────────     │
  1584→│                                                                             │
  1585→│   Profile JSON Schema                                                       │
  1586→│   ─────────────────────────────────────────────────────────────────────     │
  1587→│                                                                             │
  1588→│   {                                                                         │
  1589→│     "version": "1.0",                                                       │
  1590→│     "updated_at": "2026-01-07T10:30:00Z",                                  │
  1591→│                                                                             │
  1592→│     // ═══════════════════════════════════════════════════════════════      │
  1593→│     // Layer 1: 基础信息（硬数据，用户提供）                                │
  1594→│     // ═══════════════════════════════════════════════════════════════      │
  1595→│     "basic": {                                                              │
  1596→│       "birth_datetime": "1990-03-15T08:30:00",                             │
  1597→│       "birth_location": {                                                   │
  1598→│         "city": "上海",                                                     │
  1599→│         "country": "中国",                                                  │
  1600→│         "timezone": "Asia/Shanghai",                                        │
  1601→│         "coordinates": [121.4737, 31.2304]                                 │
  1602→│       },                                                                    │
  1603→│       "gender": "male",                                                     │
  1604→│       "name": "Alex",                                                       │
  1605→│       "occupation": "产品经理"                                              │
  1606→│     },                                                                      │
  1607→│                                                                             │
  1608→│     // ═══════════════════════════════════════════════════════════════      │
  1609→│     // Layer 2: 生活上下文（软数据，AI 采集/抽取）                          │
  1610→│     // ═══════════════════════════════════════════════════════════════      │
  1611→│     "life_context": {                                                       │
  1612→│       "career": {                                                           │
  1613→│         "status": "employed_considering_change",                            │
  1614→│         "industry": "互联网",                                               │
  1615→│         "years_experience": 8,                                              │
  1616→│         "concerns": ["职业瓶颈", "想尝试创业"]                              │
  1617→│       },                                                                    │
  1618→│       "relationship": {                                                     │
  1619→│         "status": "in_relationship",                                        │
  1620→│         "duration": "3 years",                                              │
  1621→│         "concerns": ["沟通问题", "未来规划不一致"]                          │
  1622→│       },                                                                    │
  1623→│       "current_focus": ["职业方向", "关系问题"],                            │
  1624→│       "life_stage": "career_transition",                                    │
  1625→│       "recent_events": [                                                    │
  1626→│         {"date": "2025-12", "event": "被裁员", "impact": "high"},           │
  1627→│         {"date": "2026-01", "event": "和伴侣争吵", "impact": "medium"}      │
  1628→│       ]                                                                     │
  1629→│     },                                                                      │
  1630→│                                                                             │
  1631→│     // ═══════════════════════════════════════════════════════════════      │
  1632→│     // Layer 3: AI 洞察（LLM 综合推断）                                     │
  1633→│     // ═══════════════════════════════════════════════════════════════      │
  1634→│     "ai_insights": {                                                        │
  1635→│       "personality_traits": [                                               │
  1636→│         {"trait": "追求完美", "confidence": 0.85},                          │
  1637→│         {"trait": "不善表达需求", "confidence": 0.78},                      │
  1638→│         {"trait": "责任感强", "confidence": 0.92}                           │
  1639→│       ],                                                                    │
  1640→│       "communication_style": "理性分析型，倾向于讲道理",                    │
  1641→│       "emotional_patterns": {                                               │
  1642→│         "triggers": ["被忽视", "失去控制感"],                               │
  1643→│         "coping": "压抑然后爆发"                                            │
  1644→│       },                                                                    │
  1645→│       "relationship_patterns": {                                            │
  1646→│         "style": "付出型，不善索取",                                        │
  1647→│         "blind_spots": ["忽视自己的需求"]                                   │
  1648→│       },                                                                    │
  1649→│       "growth_areas": ["学会表达需求", "接受不完美"]                        │
  1650→│     },                                                                      │
  1651→│                                                                             │
  1652→│     // ═══════════════════════════════════════════════════════════════      │
  1653→│     // Layer 4: Identity Prism（心理学框架层）                              │
  1654→│     // ═══════════════════════════════════════════════════════════════      │
  1655→│     "identity_prism": {                                                     │
  1656→│       "core": {                                                             │
  1657→│         "keyword": "追求深度理解",                                          │
  1658→│         "description": "你天生对表象不满足，总想探究本质",                  │
  1659→│         "data_source": "bazi_daymaster + mbti_dominant"                     │
  1660→│       },                                                                    │
  1661→│       "inner": {                                                            │
  1662→│         "keyword": "渴望被认可",                                            │
  1663→│         "description": "在你心里，其实最在意的是被看见和肯定",              │
  1664→│         "data_source": "ai_insight + conversation"                          │
  1665→│       },                                                                    │
  1666→│       "outer": {                                                            │
  1667→│         "keyword": "冷静可靠",                                              │
  1668→│         "description": "你给人的感觉是理性、稳定、可依赖",                  │
  1669→│         "data_source": "bazi_shishen + behavior_pattern"                    │
  1670→│       }                                                                     │
  1671→│     },                                                                      │
  1672→│                                                                             │
  1673→│     // ═══════════════════════════════════════════════════════════════      │
  1674→│     // 用户偏好                                                             │
  1675→│     // ═══════════════════════════════════════════════════════════════      │
  1676→│     "preferences": {                                                        │
  1677→│       "voice_mode": "warm",  // warm | sarcastic                            │
  1678→│       "language": "zh-CN",                                                  │
  1679→│       "notification": false                                                 │
  1680→│     }                                                                       │
  1681→│   }                                                                         │
  1682→│                                                                             │
  1683→│   ─────────────────────────────────────────────────────────────────────     │
  1684→│                                                                             │
  1685→│   版本管理                                                                  │
  1686→│   ─────────────────────────────────────────────────────────────────────     │
  1687→│                                                                             │
  1688→│   • 每次重大更新创建新版本快照                                              │
  1689→│   • 保留最近 10 个版本                                                      │
  1690→│   • 支持回溯查看「你当时是这么说的...」                                     │
  1691→│                                                                             │
  1692→└─────────────────────────────────────────────────────────────────────────────┘
  1693→```
  1694→
  1695→## 4.5 Context 构建机制
  1696→
  1697→```
  1698→┌─────────────────────────────────────────────────────────────────────────────┐
  1699→│                                                                             │
  1700→│   CONTEXT 构建机制                                                          │
  1701→│                                                                             │
  1702→│   ═══════════════════════════════════════════════════════════════════════   │
  1703→│                                                                             │
  1704→│   核心原则                                                                  │
  1705→│   ─────────────────────────────────────────────────────────────────────     │
  1706→│                                                                             │
  1707→│   「充分利用模型的上下文能力，减少系统复杂度。」                            │
  1708→│                                                                             │
  1709→│   • 不做对话摘要，直接使用原始对话                                          │
  1710→│   • 不做过度压缩，保留信息丰富度                                            │
  1711→│   • 根据话题动态选择 Profile 相关部分                                       │
  1712→│                                                                             │
  1713→│   ─────────────────────────────────────────────────────────────────────     │
  1714→│                                                                             │
  1715→│   Context 组成                                                              │
  1716→│   ─────────────────────────────────────────────────────────────────────     │
  1717→│                                                                             │
  1718→│   ┌─────────────────────────────────────────────────────────────────────┐   │
  1719→│   │                                                                     │   │
  1720→│   │   1. System Prompt                                                  │   │
  1721→│   │   ─────────────────────────────────────────────────────────         │   │
  1722→│   │   • Vibe Persona 定义                                               │   │
  1723→│   │   • 语气模式设置（温暖/吐槽）                                        │   │
  1724→│   │   • 禁止事项（不预测、不恐吓、不评判）                              │   │
  1725→│   │   • 当前 Skill 上下文（八字/星座）                                  │   │
  1726→│   │                                                                     │   │
  1727→│   │   2. 话题相关 Profile                                               │   │
  1728→│   │   ─────────────────────────────────────────────────────────         │   │
  1729→│   │   • 根据当前话题动态选择 Profile 中的相关部分                       │   │
  1730→│   │   • 例：聊职业 → 注入 career 和 ai_insights.growth_areas           │   │
  1731→│   │   • 例：聊关系 → 注入 relationship 和 relationship_patterns        │   │
  1732→│   │                                                                     │   │
  1733→│   │   3. 知识库检索结果                                                 │   │
  1734→│   │   ─────────────────────────────────────────────────────────         │   │
  1735→│   │   • 根据话题从知识库检索相关内容                                    │   │
  1736→│   │   • 八字理论、格局解读、星座特质等                                  │   │
  1737→│   │                                                                     │   │
  1738→│   │   4. 对话历史                                                       │   │
  1739→│   │   ─────────────────────────────────────────────────────────         │   │
  1740→│   │   • 最近 N 轮对话（不做摘要，原始保留）                             │   │
  1741→│   │   • N 根据 token 预算动态调整                                       │   │
  1742→│   │                                                                     │   │
  1743→│   └─────────────────────────────────────────────────────────────────────┘   │
  1744→│                                                                             │
  1745→│   ─────────────────────────────────────────────────────────────────────     │
  1746→│                                                                             │
  1747→│   Context 构建伪代码                                                        │
  1748→│   ─────────────────────────────────────────────────────────────────────     │
  1749→│                                                                             │
  1750→│   def build_context(user_id, current_message, skill):                       │
  1751→│       # 1. 加载 System Prompt                                               │
  1752→│       system_prompt = load_system_prompt(                                   │
  1753→│           skill=skill,                                                      │
  1754→│           voice_mode=user.preferences.voice_mode                            │
  1755→│       )                                                                     │
  1756→│                                                                             │
  1757→│       # 2. 识别话题，选择相关 Profile 部分                                  │
  1758→│       topic = classify_topic(current_message)                               │
  1759→│       relevant_profile = select_profile_sections(                           │
  1760→│           profile=user.profile,                                             │
  1761→│           topic=topic                                                       │
  1762→│       )                                                                     │
  1763→│                                                                             │
  1764→│       # 3. 检索知识库                                                       │
  1765→│       knowledge = retrieve_knowledge(                                       │
  1766→│           skill=skill,                                                      │
  1767→│           query=current_message,                                            │
  1768→│           user_chart=user.chart                                             │
  1769→│       )                                                                     │
  1770→│                                                                             │
  1771→│       # 4. 获取对话历史（原始，不摘要）                                     │
  1772→│       history = get_recent_messages(                                        │
  1773→│           user_id=user_id,                                                  │
  1774→│           token_budget=calculate_remaining_tokens()                         │
  1775→│       )                                                                     │
  1776→│                                                                             │
  1777→│       # 5. 组装 Context                                                     │
  1778→│       return {                                                              │
  1779→│           "system": system_prompt,                                          │
  1780→│           "context": f"""                                                   │
  1781→│               <user_profile>                                                │
  1782→│               {json.dumps(relevant_profile)}                                │
  1783→│               </user_profile>                                               │
  1784→│                                                                             │
  1785→│               <knowledge>                                                   │
  1786→│               {knowledge}                                                   │
  1787→│               </knowledge>                                                  │
  1788→│           """,                                                              │
  1789→│           "messages": history + [current_message]                           │
  1790→│       }                                                                     │
  1791→│                                                                             │
  1792→└─────────────────────────────────────────────────────────────────────────────┘
  1793→```
  1794→
  1795→## 4.6 Identity Prism 心理学框架
  1796→
  1797→```
  1798→╔═══════════════════════════════════════════════════════════════════════════════╗
  1799→║                                                                               ║
  1800→║   IDENTITY PRISM 心理学框架                                                   ║
  1801→║                                                                               ║
  1802→║   ─────────────────────────────────────────────────────────────────────────   ║
  1803→║                                                                               ║
  1804→║   这不是单一理论，而是现代整合心理学的元模型（Meta-model）。                  ║
  1805→║   它是对心理学百年发展中各路大师理论的高度提炼和综合。                        ║
  1806→║                                                                               ║
  1807→╠═══════════════════════════════════════════════════════════════════════════════╣
  1808→║                                                                               ║
  1809→║   理论根源                                                                    ║
  1810→║   ─────────────────────────────────────────────────────────────────────────   ║
  1811→║                                                                               ║
  1812→║   1. 深度心理学的「人格结构」                                                 ║
  1813→║      来源：卡尔·荣格 (Carl Jung) & 温尼科特 (D.W. Winnicott)                  ║
  1814→║                                                                               ║
  1815→║      • Outer = Persona（人格面具）—— 荣格                                     ║
  1816→║        我们在社会中为了适应环境而戴上的面具                                   ║
  1817→║                                                                               ║
  1818→║      • Inner = Ego/False Self（自我/假自体）—— 弗洛伊德/温尼科特              ║
  1819→║        为了防御外界侵害而建立的顺从性自我                                     ║
  1820→║                                                                               ║
  1821→║      • Core = The Self/True Self（自性/真自体）—— 荣格/温尼科特               ║
  1822→║        不论外界如何变化，内心深处那个不变的「我」                             ║
  1823→║                                                                               ║
  1824→║   ─────────────────────────────────────────────────────────────────────────   ║
  1825→║                                                                               ║
  1826→║   2. 社会心理学的「洋葱模型」                                                 ║
  1827→║      来源：欧文·奥尔特曼 (Irwin Altman) & 社会渗透理论                        ║
  1828→║                                                                               ║
  1829→║      • 表层（Outer）：传记特征（年龄、职业、性别）                            ║
  1830→║      • 中层（Inner）：偏好、态度、观点                                        ║
  1831→║      • 深层（Core）：信仰、恐惧、核心价值观                                   ║
  1832→║                                                                               ║
  1833→║   ─────────────────────────────────────────────────────────────────────────   ║
  1834→║                                                                               ║
  1835→║   3. 品牌身份棱镜                                                             ║
  1836→║      来源：让-诺埃尔·卡普费雷 (Jean-Noël Kapferer)                            ║
  1837→║                                                                               ║
  1838→║      • Physique（外在）≈ Outer                                                ║
  1839→║      • Self-image（自我形象）≈ Inner                                          ║
  1840→║      • Culture/Personality（核心）≈ Core                                      ║
  1841→║                                                                               ║
  1842→╠═══════════════════════════════════════════════════════════════════════════════╣
  1843→║                                                                               ║
  1844→║   VibeLife 的三层映射                                                         ║
  1845→║   ─────────────────────────────────────────────────────────────────────────   ║
  1846→║                                                                               ║
  1847→║   ┌──────────┬──────────────────┬─────────────────────┬────────────────────┐  ║
  1848→║   │  棱镜层  │  心理学原型      │  VibeLife 数据来源  │  核心问题          │  ║
  1849→║   ├──────────┼──────────────────┼─────────────────────┼────────────────────┤  ║
  1850→║   │          │                  │                     │                    │  ║
  1851→║   │  Core    │  True Self       │  BaZi (日主/格局)   │  「我本该是谁？」  │  ║
  1852→║   │  (核心)  │  (温尼科特)      │  + MBTI 主导功能    │  = 先天潜能        │  ║
  1853→║   │          │                  │                     │                    │  ║
  1854→║   ├──────────┼──────────────────┼─────────────────────┼────────────────────┤  ║
  1855→║   │          │                  │                     │                    │  ║
  1856→║   │  Inner   │  Ego / Shadow    │  AI 洞察抽取        │  「我如何看自己？」│  ║
  1857→║   │  (内在)  │  (弗洛伊德/荣格) │  + 用户自述         │  = 内心挣扎        │  ║
  1858→║   │          │                  │                     │                    │  ║
  1859→║   ├──────────┼──────────────────┼─────────────────────┼────────────────────┤  ║
  1860→║   │          │                  │                     │                    │  ║
  1861→║   │  Outer   │  Persona         │  BaZi (十神结构)    │  「我展示什么？」  │  ║
  1862→║   │  (外在)  │  (荣格)          │  + 行为模式分析     │  = 社会面具        │  ║
  1863→║   │          │                  │                     │                    │  ║
  1864→║   └──────────┴──────────────────┴─────────────────────┴────────────────────┘  ║
  1865→║                                                                               ║
  1866→╠═══════════════════════════════════════════════════════════════════════════════╣
  1867→║                                                                               ║
  1868→║   数据融合算法                                                                ║
  1869→║   ─────────────────────────────────────────────────────────────────────────   ║
  1870→║                                                                               ║
  1871→║   Core 层生成：                                                               ║
  1872→║   1. 计算八字日主 → 得到先天气质类型                                          ║
  1873→║   2. 判断格局 → 得到核心驱动力                                                ║
  1874→║   3. 结合用神 → 得到发展方向                                                  ║
  1875→║   4. LLM 生成自然语言描述                                                     ║
  1876→║                                                                               ║
  1877→║   Inner 层生成：                                                              ║
  1878→║   1. 从 AI 洞察中提取 emotional_patterns                                      ║
  1879→║   2. 从对话中提取用户自述的内心状态                                           ║
  1880→║   3. 综合推断内心真正在意的是什么                                             ║
  1881→║   4. LLM 生成自然语言描述                                                     ║
  1882→║                                                                               ║
  1883→║   Outer 层生成：                                                              ║
  1884→║   1. 分析八字十神结构 → 社会角色倾向                                          ║
  1885→║   2. 从行为模式中提取对外表现                                                 ║
  1886→║   3. 综合推断给人的感觉                                                       ║
  1887→║   4. LLM 生成自然语言描述                                                     ║
  1888→║                                                                               ║
  1889→╚═══════════════════════════════════════════════════════════════════════════════╝
  1890→```
  1891→
  1892→---
  1893→
  1894→# Part 5: 技术架构
  1895→
  1896→## 5.1 系统架构总览
  1897→
  1898→```
  1899→╔═══════════════════════════════════════════════════════════════════════════════╗
  1900→║                                                                               ║
  1901→║                    VIBELIFE SYSTEM ARCHITECTURE                               ║
  1902→║                                                                               ║
  1903→╠═══════════════════════════════════════════════════════════════════════════════╣
  1904→║                                                                               ║
  1905→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
  1906→║   │                                                                         │ ║
  1907→║   │   L1: PRESENTATION LAYER (Web Only + PWA)                               │ ║
  1908→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
  1909→║   │                                                                         │ ║
  1910→║   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                    │ ║
  1911→║   │   │   Next.js   │  │   Mobile    │  │    PWA      │                    │ ║
  1912→║   │   │   Web App   │  │   Web View  │  │   Support   │                    │ ║
  1913→║   │   └─────────────┘  └─────────────┘  └─────────────┘                    │ ║
  1914→║   │                                                                         │ ║
  1915→║   │   技术栈：Next.js 14 + Tailwind + framer-motion + Zustand              │ ║
  1916→║   │                                                                         │ ║
  1917→║   └─────────────────────────────────────┬───────────────────────────────────┘ ║
  1918→║                                         │                                     ║
  1919→║                                         ▼                                     ║
  1920→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
  1921→║   │                                                                         │ ║
  1922→║   │   L2: API LAYER (FastAPI)                                               │ ║
  1923→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
  1924→║   │                                                                         │ ║
  1925→║   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ ║
  1926→║   │   │    Chat     │  │   Report    │  │ Relationship│  │    User     │   │ ║
  1927→║   │   │    API      │  │    API      │  │     API     │  │    API      │   │ ║
  1928→║   │   │             │  │             │  │             │  │             │   │ ║
  1929→║   │   │ • Stream    │  │ • Generate  │  │ • Create    │  │ • Profile   │   │ ║
  1930→║   │   │ • Context   │  │ • AI Image  │  │ • Invite    │  │ • Pref      │   │ ║
  1931→║   │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ ║
  1932→║   │                                                                         │ ║
  1933→║   └─────────────────────────────────────┬───────────────────────────────────┘ ║
  1934→║                                         │                                     ║
  1935→║                                         ▼                                     ║
  1936→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
  1937→║   │                                                                         │ ║
  1938→║   │   L3: VIBE ENGINE (核心智能引擎)                                        │ ║
  1939→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
  1940→║   │                                                                         │ ║
  1941→║   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ ║
  1942→║   │   │   Agent     │  │  Insight    │  │   Emotion   │  │   Portrait  │   │ ║
  1943→║   │   │   Runtime   │  │  Generator  │  │   Engine    │  │   Manager   │   │ ║
  1944→║   │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ ║
  1945→║   │                                                                         │ ║
  1946→║   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                    │ ║
  1947→║   │   │  Knowledge  │  │    File     │  │    Image    │                    │ ║
  1948→║   │   │  Retrieval  │  │  Extractor  │  │  Generator  │                    │ ║
  1949→║   │   └─────────────┘  └─────────────┘  └─────────────┘                    │ ║
  1950→║   │                                                                         │ ║
  1951→║   └─────────────────────────────────────┬───────────────────────────────────┘ ║
  1952→║                                         │                                     ║
  1953→║                                         ▼                                     ║
  1954→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
  1955→║   │                                                                         │ ║
  1956→║   │   L4: SKILL & KNOWLEDGE LAYER                                           │ ║
  1957→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
  1958→║   │                                                                         │ ║
  1959→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
  1960→║   │   │                         SKILLS                                  │   │ ║
  1961→║   │   │                                                                 │   │ ║
  1962→║   │   │   ┌─────────────┐           ┌─────────────┐                     │   │ ║
  1963→║   │   │   │    BaZi     │           │   Zodiac    │                     │   │ ║
  1964→║   │   │   │             │           │             │                     │   │ ║
  1965→║   │   │   │ • Calculator│           │ • Ephemeris │                     │   │ ║
  1966→║   │   │   │ • Transit   │           │ • Chart     │                     │   │ ║
  1967→║   │   │   │ • Analysis  │           │ • Events    │                     │   │ ║
  1968→║   │   │   └─────────────┘           └─────────────┘                     │   │ ║
  1969→║   │   │                                                                 │   │ ║
  1970→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
  1971→║   │                                                                         │ ║
  1972→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
  1973→║   │   │                     KNOWLEDGE BASE                              │   │ ║
  1974→║   │   │                                                                 │   │ ║
  1975→║   │   │   ┌─────────────┐           ┌─────────────┐                     │   │ ║
  1976→║   │   │   │  BaZi KB    │           │  Zodiac KB  │                     │   │ ║
  1977→║   │   │   │             │           │             │                     │   │ ║
  1978→║   │   │   │ • Theory    │           │ • Signs     │                     │   │ ║
  1979→║   │   │   │ • Patterns  │           │ • Houses    │                     │   │ ║
  1980→║   │   │   │ • Transit   │           │ • Aspects   │                     │   │ ║
  1981→║   │   │   └─────────────┘           └─────────────┘                     │   │ ║
  1982→║   │   │                                                                 │   │ ║
  1983→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
  1984→║   │                                                                         │ ║
  1985→║   └─────────────────────────────────────┬───────────────────────────────────┘ ║
  1986→║                                         │                                     ║
  1987→║                                         ▼                                     ║
  1988→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
  1989→║   │                                                                         │ ║
  1990→║   │   L5: DATA LAYER                                                        │ ║
  1991→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
  1992→║   │                                                                         │ ║
  1993→║   │   ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐          │ ║
  1994→║   │   │PostgreSQL│ │ Pinecone│ │  Redis  │ │   S3    │ │ Supabase│          │ ║
  1995→║   │   │ Primary │ │ Vector  │ │  Cache  │ │  Assets │ │  Auth   │          │ ║
  1996→║   │   └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘          │ ║
  1997→║   │                                                                         │ ║
  1998→║   └─────────────────────────────────────────────────────────────────────────┘ ║
  1999→║                                                                               ║

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
