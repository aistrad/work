The file /home/aiscend/work/vibelife/docs/prd/VibeID/VibeIDå‡çº§æ–¹æ¡ˆ.md has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
     1â†’# VibeID åŸå‹è®¡ç®—ç®—æ³•å‡çº§æ–¹æ¡ˆ
     2â†’
     3â†’> ç‰ˆæœ¬ï¼šv2.0
     4â†’> æ›´æ–°æ—¥æœŸï¼š2026-01-16
     5â†’> çŠ¶æ€ï¼šè®¾è®¡å®Œæˆ
     6â†’
     7â†’---
     8â†’
     9â†’## 1. é¡¹ç›®æ¦‚è¿°
    10â†’
    11â†’### 1.1 èƒŒæ™¯
    12â†’
    13â†’VibeID æ˜¯ VibeLife çš„æ ¸å¿ƒäººæ ¼æ“ä½œç³»ç»Ÿï¼Œå°†ä¸œæ–¹å‘½ç†ï¼ˆå…«å­—ï¼‰ä¸è¥¿æ–¹å æ˜Ÿï¼ˆæ˜Ÿåº§ï¼‰èåˆï¼Œæ˜ å°„åˆ°è£æ ¼12åŸå‹ä½“ç³»ã€‚å½“å‰ç®—æ³•å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š
    14â†’
    15â†’1. **å…«å­—æ ¼å±€åˆ¤æ–­è¿‡äºç®€åŒ–**ï¼šä»…åŸºäºæœˆä»¤åç¥ï¼Œæœªè€ƒè™‘æ—¥ä¸»å¼ºå¼±ã€ç”¨ç¥å–œå¿Œ
    16â†’2. **æ˜Ÿåº§ä¿¡æ¯åˆ©ç”¨ä¸è¶³**ï¼šä»…ç”¨å¤ªé˜³æ˜Ÿåº§ï¼Œæµªè´¹äº†å·²è®¡ç®—çš„ä¸°å¯Œæ˜Ÿç›˜æ•°æ®
    17â†’3. **èåˆç®—æ³•ç¼ºä¹ç†è®ºæ”¯æ’‘**ï¼š60%/40%æƒé‡æ˜¯æ‹è„‘è¢‹å†³å®šçš„
    18â†’4. **å¯è§£é‡Šæ€§ä¸è¶³**ï¼šç”¨æˆ·ä¸ç†è§£"ä¸ºä»€ä¹ˆæˆ‘æ˜¯è¿™ä¸ªåŸå‹"
    19â†’
    20â†’### 1.2 å‡çº§ç›®æ ‡
    21â†’
    22â†’| ç›®æ ‡ | æè¿° | ä¼˜å…ˆçº§ |
    23â†’|------|------|--------|
    24â†’| å‡†ç¡®æ€§ | è®©è®¡ç®—ç»“æœæ›´ç¬¦åˆç”¨æˆ·çœŸå®äººæ ¼ | P0 |
    25â†’| å¯è§£é‡Šæ€§ | è®©ç”¨æˆ·ç†è§£åŸå‹å½’å› çš„ä¾æ® | P0 |
    26â†’| æˆé•¿å¯¼å‘ | è®©ç³»ç»Ÿèƒ½å¼•å¯¼ç”¨æˆ·çš„ä¸ªä½“åŒ–æˆé•¿ | P1 |
    27â†’| å·®å¼‚åŒ– | è®©ä¸åŒç”¨æˆ·çš„ç»“æœæœ‰è¶³å¤ŸåŒºåˆ†åº¦ | P2 |
    28â†’
    29â†’### 1.3 è®¾è®¡åŸåˆ™
    30â†’
    31â†’1. **å…«å­—ä¸»å¯¼**ï¼šå…«å­—å†³å®šCoreåŸå‹ï¼Œæ˜Ÿåº§è¡¥å……è¡¨è¾¾ç»†èŠ‚
    32â†’2. **ä¸­ç­‰æ·±åº¦**ï¼šåŠ å…¥æ—¥ä¸»å¼ºå¼±ã€ç”¨ç¥å–œå¿Œï¼Œä½†ä¸è¿½æ±‚ä¸“ä¸šå‘½ç†å¸ˆçº§åˆ«
    33â†’3. **äº”ç‚¹æ˜Ÿç›˜**ï¼šå¤ªé˜³ã€æœˆäº®ã€ä¸Šå‡ã€é‡‘æ˜Ÿã€ç«æ˜Ÿäº”ç‚¹æ¨¡å‹
    34â†’4. **å¾—åˆ†è®¡ç®—+ç®€åŒ–å‘ˆç°**ï¼šåå°è®¡ç®—å®Œæ•´12åŸå‹å¾—åˆ†ï¼Œå‰å°å‘ˆç°ä¸»åŸå‹+å‰¯åŸå‹
    35â†’
    36â†’---
    37â†’
    38â†’## 2. æ ¸å¿ƒç®—æ³•è®¾è®¡
    39â†’
    40â†’### 2.1 å…«å­—åŸå‹è®¡ç®—ï¼ˆPrimary Sourceï¼‰
    41â†’
    42â†’#### 2.1.1 æ—¥ä¸»å¼ºå¼±åˆ¤æ–­
    43â†’
    44â†’æ—¥ä¸»å¼ºå¼±æ˜¯åŸå‹è®¡ç®—çš„åŸºç¡€å‚æ•°ï¼Œå½±å“åŸå‹çš„è¡¨è¾¾æ–¹å¼ã€‚
    45â†’
    46â†’```python
    47â†’class DayMasterStrength(Enum):
    48â†’    """æ—¥ä¸»å¼ºå¼±ç­‰çº§"""
    49â†’    EXTREMELY_STRONG = "ææ—º"  # å¾—ä»¤å¾—åœ°å¾—åŠ¿ï¼Œéœ€è¦æ³„è€—
    50â†’    STRONG = "åæ—º"            # æœ‰æ ¹æœ‰æ°”ï¼Œå–œæ³„è€—
    51â†’    BALANCED = "ä¸­å’Œ"          # èº«æ—ºå¼±å¹³è¡¡ï¼Œå–œé¡ºåŠ¿
    52â†’    WEAK = "åå¼±"              # æ— æ ¹å°‘æ°”ï¼Œå–œç”Ÿæ‰¶
    53â†’    EXTREMELY_WEAK = "æå¼±"    # ä»æ ¼æ¡ä»¶ï¼Œéœ€ç‰¹æ®Šå¤„ç†
    54â†’
    55â†’def calculate_day_master_strength(bazi: BaziChart) -> tuple[DayMasterStrength, float]:
    56â†’    """
    57â†’    è®¡ç®—æ—¥ä¸»å¼ºå¼±
    58â†’
    59â†’    Returns:
    60â†’        (å¼ºå¼±ç­‰çº§, å¼ºåº¦åˆ†æ•° -1.0 åˆ° 1.0)
    61â†’    """
    62â†’    score = 0.0
    63â†’
    64â†’    # 1. å¾—ä»¤åˆ¤æ–­ (æœˆæ”¯å¯¹æ—¥ä¸»çš„å½±å“)
    65â†’    month_branch = bazi.month_branch
    66â†’    day_master = bazi.day_master
    67â†’    seasonal_factor = get_seasonal_strength(day_master, month_branch)
    68â†’    score += seasonal_factor * 0.4  # æƒé‡40%
    69â†’
    70â†’    # 2. å¾—åœ°åˆ¤æ–­ (å››æ”¯å¯¹æ—¥ä¸»çš„æ ¹æ°”)
    71â†’    root_factor = calculate_root_strength(day_master, bazi.branches)
    72â†’    score += root_factor * 0.3  # æƒé‡30%
    73â†’
    74â†’    # 3. å¾—åŠ¿åˆ¤æ–­ (å¤©å¹²é€å‡ºçš„å¸®æ‰¶)
    75â†’    support_factor = calculate_stem_support(day_master, bazi.stems)
    76â†’    score += support_factor * 0.2  # æƒé‡20%
    77â†’
    78â†’    # 4. åˆå†²ä¿®æ­£ (å¹²æ”¯åˆåŒ–ã€åœ°æ”¯å†²åˆ)
    79â†’    combination_factor = calculate_combination_effect(bazi)
    80â†’    score += combination_factor * 0.1  # æƒé‡10%
    81â†’
    82â†’    # è½¬æ¢ä¸ºç­‰çº§
    83â†’    if score >= 0.6:
    84â†’        return (DayMasterStrength.EXTREMELY_STRONG, score)
    85â†’    elif score >= 0.2:
    86â†’        return (DayMasterStrength.STRONG, score)
    87â†’    elif score >= -0.2:
    88â†’        return (DayMasterStrength.BALANCED, score)
    89â†’    elif score >= -0.6:
    90â†’        return (DayMasterStrength.WEAK, score)
    91â†’    else:
    92â†’        return (DayMasterStrength.EXTREMELY_WEAK, score)
    93â†’```
    94â†’
    95â†’#### 2.1.2 ç”¨ç¥å–œå¿Œåˆ¤æ–­
    96â†’
    97â†’ç”¨ç¥å†³å®šäº†å‘½å±€çš„éœ€æ±‚æ–¹å‘ï¼Œç›´æ¥å½±å“åŸå‹çš„æ ¸å¿ƒé©±åŠ¨åŠ›ã€‚
    98â†’
    99â†’```python
   100â†’class UsefulGod(Enum):
   101â†’    """ç”¨ç¥ç±»å‹"""
   102â†’    WEALTH = "è´¢"        # è¿½æ±‚èµ„æºã€ç‰©è´¨
   103â†’    POWER = "å®˜æ€"       # è¿½æ±‚æƒåŠ›ã€åœ°ä½
   104â†’    RESOURCE = "å°"      # è¿½æ±‚çŸ¥è¯†ã€æ”¯æŒ
   105â†’    OUTPUT = "é£Ÿä¼¤"      # è¿½æ±‚è¡¨è¾¾ã€åˆ›é€ 
   106â†’    PEER = "æ¯”åŠ«"        # è¿½æ±‚åˆä½œã€ç«äº‰
   107â†’
   108â†’def determine_useful_god(bazi: BaziChart, strength: DayMasterStrength) -> UsefulGod:
   109â†’    """
   110â†’    æ ¹æ®æ—¥ä¸»å¼ºå¼±ç¡®å®šç”¨ç¥
   111â†’
   112â†’    åŸºæœ¬åŸåˆ™ï¼š
   113â†’    - èº«æ—ºï¼šå–œè´¢å®˜é£Ÿä¼¤ï¼ˆæ³„è€—ä¹‹ç¥ï¼‰
   114â†’    - èº«å¼±ï¼šå–œå°æ¯”ï¼ˆç”Ÿæ‰¶ä¹‹ç¥ï¼‰
   115â†’    - ç‰¹æ®Šæ ¼å±€ï¼šé¡ºåŠ¿å–ç”¨
   116â†’    """
   117â†’    if strength in [DayMasterStrength.STRONG, DayMasterStrength.EXTREMELY_STRONG]:
   118â†’        # èº«æ—ºå–œæ³„è€—
   119â†’        if has_strong_element(bazi, "food_god"):
   120â†’            return UsefulGod.OUTPUT  # é£Ÿä¼¤æ³„ç§€
   121â†’        elif has_strong_element(bazi, "wealth"):
   122â†’            return UsefulGod.WEALTH  # è´¢æ˜Ÿè€—èº«
   123â†’        else:
   124â†’            return UsefulGod.POWER  # å®˜æ€åˆ¶èº«
   125â†’    elif strength in [DayMasterStrength.WEAK, DayMasterStrength.EXTREMELY_WEAK]:
   126â†’        # èº«å¼±å–œç”Ÿæ‰¶
   127â†’        if has_strong_element(bazi, "resource"):
   128â†’            return UsefulGod.RESOURCE  # å°æ˜Ÿç”Ÿèº«
   129â†’        else:
   130â†’            return UsefulGod.PEER  # æ¯”åŠ«å¸®èº«
   131â†’    else:
   132â†’        # ä¸­å’Œå–å¹³è¡¡
   133â†’        return determine_balanced_god(bazi)
   134â†’```
   135â†’
   136â†’#### 2.1.3 æ ¼å±€+ç”¨ç¥â†’åŸå‹æ˜ å°„
   137â†’
   138â†’å‡çº§åçš„æ˜ å°„è€ƒè™‘æ ¼å±€å’Œç”¨ç¥çš„ç»„åˆï¼š
   139â†’
   140â†’```python
   141â†’# æ ¼å±€-ç”¨ç¥-åŸå‹æ˜ å°„è¡¨
   142â†’# æ¯ä¸ªæ ¼å±€æ ¹æ®ç”¨ç¥ä¸åŒï¼Œæ˜ å°„åˆ°ä¸åŒçš„åŸå‹ç»„åˆ
   143â†’
   144â†’BAZI_ARCHETYPE_MAPPING = {
   145â†’    # æ­£å®˜æ ¼ï¼ˆç§©åºã€è§„èŒƒã€è´£ä»»ï¼‰
   146â†’    "æ­£å®˜æ ¼": {
   147â†’        UsefulGod.WEALTH: {
   148â†’            "primary": Archetype.RULER,      # ç»Ÿæ²»è€…ï¼šé€šè¿‡èµ„æºç®¡ç†å®ç°ç§©åº
   149â†’            "secondary": Archetype.CAREGIVER, # ç…§é¡¾è€…ï¼šå¯¹ä»–äººè´Ÿè´£
   150â†’            "driver": "è´£ä»»é©±åŠ¨å‹æˆå°±è€…"
   151â†’        },
   152â†’        UsefulGod.RESOURCE: {
   153â†’            "primary": Archetype.SAGE,       # æ™ºè€…ï¼šé€šè¿‡çŸ¥è¯†è·å¾—æƒå¨
   154â†’            "secondary": Archetype.RULER,
   155â†’            "driver": "çŸ¥è¯†é©±åŠ¨å‹é¢†å¯¼è€…"
   156â†’        },
   157â†’        UsefulGod.OUTPUT: {
   158â†’            "primary": Archetype.CREATOR,    # åˆ›é€ è€…ï¼šåœ¨è§„èŒƒä¸­åˆ›æ–°
   159â†’            "secondary": Archetype.RULER,
   160â†’            "driver": "åˆ›æ–°é©±åŠ¨å‹æ”¹é©è€…"
   161â†’        },
   162â†’        UsefulGod.PEER: {
   163â†’            "primary": Archetype.REGULAR,    # å‡¡äººï¼šå¹³ç­‰åˆä½œçš„é¢†å¯¼
   164â†’            "secondary": Archetype.RULER,
   165â†’            "driver": "ç¾¤ä½“é©±åŠ¨å‹é¢†è¢–"
   166â†’        },
   167â†’        UsefulGod.POWER: {
   168â†’            "primary": Archetype.RULER,      # çº¯ç²¹çš„ç»Ÿæ²»è€…
   169â†’            "secondary": Archetype.HERO,
   170â†’            "driver": "æƒåŠ›é©±åŠ¨å‹é¢†å¯¼è€…"
   171â†’        }
   172â†’    },
   173â†’
   174â†’    # ä¸ƒæ€æ ¼ï¼ˆé­„åŠ›ã€æŒ‘æˆ˜ã€çªç ´ï¼‰
   175â†’    "ä¸ƒæ€æ ¼": {
   176â†’        UsefulGod.RESOURCE: {
   177â†’            "primary": Archetype.HERO,       # è‹±é›„ï¼šä»¥æ™ºå–èƒœ
   178â†’            "secondary": Archetype.SAGE,
   179â†’            "driver": "ç­–ç•¥å‹æˆ˜å£«"
   180â†’        },
   181â†’        UsefulGod.OUTPUT: {
   182â†’            "primary": Archetype.OUTLAW,     # å›é€†è€…ï¼šæŒ‘æˆ˜æƒå¨
   183â†’            "secondary": Archetype.CREATOR,
   184â†’            "driver": "é¢ è¦†æ€§åˆ›æ–°è€…"
   185â†’        },
   186â†’        UsefulGod.WEALTH: {
   187â†’            "primary": Archetype.HERO,       # è‹±é›„ï¼šå¾æœå¼è·å–
   188â†’            "secondary": Archetype.EXPLORER,
   189â†’            "driver": "å¼€æ‹“å‹å†’é™©å®¶"
   190â†’        },
   191â†’        UsefulGod.PEER: {
   192â†’            "primary": Archetype.HERO,       # è‹±é›„ï¼šå›¢é˜Ÿä½œæˆ˜
   193â†’            "secondary": Archetype.REGULAR,
   194â†’            "driver": "åˆä½œå‹æˆ˜å£«"
   195â†’        },
   196â†’        UsefulGod.POWER: {
   197â†’            "primary": Archetype.OUTLAW,     # å›é€†è€…ï¼šä»¥æš´åˆ¶æš´
   198â†’            "secondary": Archetype.HERO,
   199â†’            "driver": "é©å‘½å‹é¢†è¢–"
   200â†’        }
   201â†’    },
   202â†’
   203â†’    # æ­£å°æ ¼ï¼ˆæ»‹å…»ã€å­¦ä¹ ã€ä¼ æ‰¿ï¼‰
   204â†’    "æ­£å°æ ¼": {
   205â†’        UsefulGod.POWER: {
   206â†’            "primary": Archetype.SAGE,       # æ™ºè€…ï¼šçŸ¥è¯†å³æƒåŠ›
   207â†’            "secondary": Archetype.RULER,
   208â†’            "driver": "å­¦æœ¯å‹æƒå¨"
   209â†’        },
   210â†’        UsefulGod.WEALTH: {
   211â†’            "primary": Archetype.CAREGIVER,  # ç…§é¡¾è€…ï¼šèµ„æºæ»‹å…»ä»–äºº
   212â†’            "secondary": Archetype.SAGE,
   213â†’            "driver": "èµ„æºå‹å®ˆæŠ¤è€…"
   214â†’        },
   215â†’        UsefulGod.OUTPUT: {
   216â†’            "primary": Archetype.CREATOR,    # åˆ›é€ è€…ï¼šä¼ æ‰¿ä¸­åˆ›æ–°
   217â†’            "secondary": Archetype.SAGE,
   218â†’            "driver": "ä¼ æ‰¿å‹åˆ›ä½œè€…"
   219â†’        },
   220â†’        UsefulGod.PEER: {
   221â†’            "primary": Archetype.CAREGIVER,  # ç…§é¡¾è€…ï¼šç¾¤ä½“æ»‹å…»
   222â†’            "secondary": Archetype.REGULAR,
   223â†’            "driver": "ç¾¤ä½“å‹æ•™è‚²è€…"
   224â†’        },
   225â†’        UsefulGod.RESOURCE: {
   226â†’            "primary": Archetype.SAGE,       # çº¯ç²¹çš„æ™ºè€…
   227â†’            "secondary": Archetype.INNOCENT,
   228â†’            "driver": "çº¯ç²¹æ±‚çŸ¥è€…"
   229â†’        }
   230â†’    },
   231â†’
   232â†’    # åå°æ ¼ï¼ˆç‹¬ç«‹ã€éä¸»æµã€ç›´è§‰ï¼‰
   233â†’    "åå°æ ¼": {
   234â†’        UsefulGod.POWER: {
   235â†’            "primary": Archetype.MAGICIAN,   # é­”æœ¯å¸ˆï¼šç¥ç§˜çš„æƒåŠ›
   236â†’            "secondary": Archetype.SAGE,
   237â†’            "driver": "å¹•åæ“æ§è€…"
   238â†’        },
   239â†’        UsefulGod.OUTPUT: {
   240â†’            "primary": Archetype.CREATOR,    # åˆ›é€ è€…ï¼šéä¸»æµåˆ›ä½œ
   241â†’            "secondary": Archetype.OUTLAW,
   242â†’            "driver": "å…ˆé”‹è‰ºæœ¯å®¶"
   243â†’        },
   244â†’        UsefulGod.WEALTH: {
   245â†’            "primary": Archetype.MAGICIAN,   # é­”æœ¯å¸ˆï¼šç‚¹çŸ³æˆé‡‘
   246â†’            "secondary": Archetype.EXPLORER,
   247â†’            "driver": "å¦ç±»æŠ•èµ„è€…"
   248â†’        },
   249â†’        UsefulGod.PEER: {
   250â†’            "primary": Archetype.OUTLAW,     # å›é€†è€…ï¼šç¾¤ä½“è¾¹ç¼˜
   251â†’            "secondary": Archetype.MAGICIAN,
   252â†’            "driver": "åä¸»æµè”ç›Ÿè€…"
   253â†’        },
   254â†’        UsefulGod.RESOURCE: {
   255â†’            "primary": Archetype.SAGE,       # æ™ºè€…ï¼šæ·±åº¦ç ”ç©¶
   256â†’            "secondary": Archetype.MAGICIAN,
   257â†’            "driver": "ç¥ç§˜å­¦ç ”ç©¶è€…"
   258â†’        }
   259â†’    },
   260â†’
   261â†’    # é£Ÿç¥æ ¼ï¼ˆè¡¨è¾¾ã€äº«å—ã€åˆ†äº«ï¼‰
   262â†’    "é£Ÿç¥æ ¼": {
   263â†’        UsefulGod.WEALTH: {
   264â†’            "primary": Archetype.CREATOR,    # åˆ›é€ è€…ï¼šåˆ›ä½œå˜ç°
   265â†’            "secondary": Archetype.LOVER,
   266â†’            "driver": "å•†ä¸šåŒ–åˆ›ä½œè€…"
   267â†’        },
   268â†’        UsefulGod.POWER: {
   269â†’            "primary": Archetype.MAGICIAN,   # é­”æœ¯å¸ˆï¼šæ‰åè½¬åŒ–å½±å“åŠ›
   270â†’            "secondary": Archetype.CREATOR,
   271â†’            "driver": "å½±å“åŠ›åˆ›ä½œè€…"
   272â†’        },
   273â†’        UsefulGod.RESOURCE: {
   274â†’            "primary": Archetype.SAGE,       # æ™ºè€…ï¼šè¾“å‡ºå‹å­¦è€…
   275â†’            "secondary": Archetype.CREATOR,
   276â†’            "driver": "çŸ¥è¯†ä¼ æ’­è€…"
   277â†’        },
   278â†’        UsefulGod.PEER: {
   279â†’            "primary": Archetype.JESTER,     # æ„šè€…ï¼šå¨±ä¹å¤§ä¼—
   280â†’            "secondary": Archetype.CREATOR,
   281â†’            "driver": "ç¾¤ä½“å¨±ä¹è€…"
   282â†’        },
   283â†’        UsefulGod.OUTPUT: {
   284â†’            "primary": Archetype.CREATOR,    # çº¯ç²¹çš„åˆ›é€ è€…
   285â†’            "secondary": Archetype.JESTER,
   286â†’            "driver": "çº¯ç²¹è¡¨è¾¾è€…"
   287â†’        }
   288â†’    },
   289â†’
   290â†’    # ä¼¤å®˜æ ¼ï¼ˆå›é€†ã€åˆ›æ–°ã€æŒ‘æˆ˜ï¼‰
   291â†’    "ä¼¤å®˜æ ¼": {
   292â†’        UsefulGod.WEALTH: {
   293â†’            "primary": Archetype.CREATOR,    # åˆ›é€ è€…ï¼šåˆ›æ–°è·åˆ©
   294â†’            "secondary": Archetype.OUTLAW,
   295â†’            "driver": "é¢ è¦†å¼åˆ›ä¸šè€…"
   296â†’        },
   297â†’        UsefulGod.RESOURCE: {
   298â†’            "primary": Archetype.MAGICIAN,   # é­”æœ¯å¸ˆï¼šæ™ºæ…§å‹å›é€†
   299â†’            "secondary": Archetype.CREATOR,
   300â†’            "driver": "æ€æƒ³å›é€†è€…"
   301â†’        },
   302â†’        UsefulGod.POWER: {
   303â†’            "primary": Archetype.OUTLAW,     # å›é€†è€…ï¼šæŒ‘æˆ˜æƒå¨
   304â†’            "secondary": Archetype.HERO,
   305â†’            "driver": "ä½“åˆ¶æŒ‘æˆ˜è€…"
   306â†’        },
   307â†’        UsefulGod.PEER: {
   308â†’            "primary": Archetype.OUTLAW,     # å›é€†è€…ï¼šç¾¤ä½“å›é€†
   309â†’            "secondary": Archetype.EXPLORER,
   310â†’            "driver": "åå›è”ç›Ÿè€…"
   311â†’        },
   312â†’        UsefulGod.OUTPUT: {
   313â†’            "primary": Archetype.CREATOR,    # åˆ›é€ è€…ï¼šæè‡´è¡¨è¾¾
   314â†’            "secondary": Archetype.OUTLAW,
   315â†’            "driver": "æç«¯è‰ºæœ¯å®¶"
   316â†’        }
   317â†’    },
   318â†’
   319â†’    # æ­£è´¢æ ¼ï¼ˆç¨³å¥ã€ç§¯ç´¯ã€åŠ¡å®ï¼‰
   320â†’    "æ­£è´¢æ ¼": {
   321â†’        UsefulGod.POWER: {
   322â†’            "primary": Archetype.RULER,      # ç»Ÿæ²»è€…ï¼šèµ„æºå‹é¢†å¯¼
   323â†’            "secondary": Archetype.REGULAR,
   324â†’            "driver": "èµ„æºç®¡ç†è€…"
   325â†’        },
   326â†’        UsefulGod.OUTPUT: {
   327â†’            "primary": Archetype.CREATOR,    # åˆ›é€ è€…ï¼šå®ç”¨åˆ›ä½œ
   328â†’            "secondary": Archetype.REGULAR,
   329â†’            "driver": "å®ç”¨å‹åˆ›ä½œè€…"
   330â†’        },
   331â†’        UsefulGod.RESOURCE: {
   332â†’            "primary": Archetype.SAGE,       # æ™ºè€…ï¼šç†è´¢ä¸“å®¶
   333â†’            "secondary": Archetype.CAREGIVER,
   334â†’            "driver": "è´¢åŠ¡é¡¾é—®å‹"
   335â†’        },
   336â†’        UsefulGod.PEER: {
   337â†’            "primary": Archetype.REGULAR,    # å‡¡äººï¼šå…±åŒè‡´å¯Œ
   338â†’            "secondary": Archetype.CAREGIVER,
   339â†’            "driver": "ç¾¤ä½“ç»æµè€…"
   340â†’        },
   341â†’        UsefulGod.WEALTH: {
   342â†’            "primary": Archetype.REGULAR,    # çº¯ç²¹çš„å‡¡äºº
   343â†’            "secondary": Archetype.LOVER,
   344â†’            "driver": "åŠ¡å®ç”Ÿæ´»è€…"
   345â†’        }
   346â†’    },
   347â†’
   348â†’    # åè´¢æ ¼ï¼ˆå†’é™©ã€æŠ•æœºã€æ…·æ…¨ï¼‰
   349â†’    "åè´¢æ ¼": {
   350â†’        UsefulGod.POWER: {
   351â†’            "primary": Archetype.EXPLORER,   # æ¢é™©å®¶ï¼šå†’é™©è·æƒ
   352â†’            "secondary": Archetype.RULER,
   353â†’            "driver": "å†’é™©å‹é¢†è¢–"
   354â†’        },
   355â†’        UsefulGod.OUTPUT: {
   356â†’            "primary": Archetype.JESTER,     # æ„šè€…ï¼šä¹å–„å¥½æ–½
   357â†’            "secondary": Archetype.CREATOR,
   358â†’            "driver": "æ…·æ…¨åˆ›ä½œè€…"
   359â†’        },
   360â†’        UsefulGod.RESOURCE: {
   361â†’            "primary": Archetype.MAGICIAN,   # é­”æœ¯å¸ˆï¼šæŠ•æœºæ™ºæ…§
   362â†’            "secondary": Archetype.EXPLORER,
   363â†’            "driver": "æŠ•èµ„ç­–ç•¥å®¶"
   364â†’        },
   365â†’        UsefulGod.PEER: {
   366â†’            "primary": Archetype.JESTER,     # æ„šè€…ï¼šç¤¾äº¤è¾¾äºº
   367â†’            "secondary": Archetype.LOVER,
   368â†’            "driver": "ç¤¾äº¤æŠ•èµ„è€…"
   369â†’        },
   370â†’        UsefulGod.WEALTH: {
   371â†’            "primary": Archetype.EXPLORER,   # æ¢é™©å®¶ï¼šè´¢å¯Œå†’é™©
   372â†’            "secondary": Archetype.JESTER,
   373â†’            "driver": "è´¢å¯Œæ¢é™©å®¶"
   374â†’        }
   375â†’    },
   376â†’
   377â†’    # æ¯”è‚©æ ¼ï¼ˆç‹¬ç«‹ã€ç«äº‰ã€è‡ªä¸»ï¼‰
   378â†’    "æ¯”è‚©æ ¼": {
   379â†’        UsefulGod.WEALTH: {
   380â†’            "primary": Archetype.EXPLORER,   # æ¢é™©å®¶ï¼šç‹¬ç«‹å¼€æ‹“
   381â†’            "secondary": Archetype.HERO,
   382â†’            "driver": "ç‹¬ç«‹å¼€æ‹“è€…"
   383â†’        },
   384â†’        UsefulGod.POWER: {
   385â†’            "primary": Archetype.HERO,       # è‹±é›„ï¼šç«äº‰è·èƒœ
   386â†’            "secondary": Archetype.OUTLAW,
   387â†’            "driver": "ç«äº‰å‹æˆ˜å£«"
   388â†’        },
   389â†’        UsefulGod.OUTPUT: {
   390â†’            "primary": Archetype.CREATOR,    # åˆ›é€ è€…ï¼šç‹¬ç«‹åˆ›ä½œ
   391â†’            "secondary": Archetype.EXPLORER,
   392â†’            "driver": "ç‹¬ç«‹åˆ›ä½œè€…"
   393â†’        },
   394â†’        UsefulGod.RESOURCE: {
   395â†’            "primary": Archetype.SAGE,       # æ™ºè€…ï¼šè‡ªå­¦æˆæ‰
   396â†’            "secondary": Archetype.EXPLORER,
   397â†’            "driver": "è‡ªå­¦å‹ä¸“å®¶"
   398â†’        },
   399â†’        UsefulGod.PEER: {
   400â†’            "primary": Archetype.REGULAR,    # å‡¡äººï¼šç¾¤ä½“è®¤åŒ
   401â†’            "secondary": Archetype.HERO,
   402â†’            "driver": "ç¾¤ä½“ç«äº‰è€…"
   403â†’        }
   404â†’    },
   405â†’
   406â†’    # åŠ«è´¢æ ¼ï¼ˆå†²åŠ¨ã€æœæ•¢ã€å¤šå˜ï¼‰
   407â†’    "åŠ«è´¢æ ¼": {
   408â†’        UsefulGod.WEALTH: {
   409â†’            "primary": Archetype.OUTLAW,     # å›é€†è€…ï¼šä¸æ‹©æ‰‹æ®µ
   410â†’            "secondary": Archetype.EXPLORER,
   411â†’            "driver": "æ¿€è¿›è·å–è€…"
   412â†’        },
   413â†’        UsefulGod.POWER: {
   414â†’            "primary": Archetype.HERO,       # è‹±é›„ï¼šå¼ºåŠ¿ç«äº‰
   415â†’            "secondary": Archetype.OUTLAW,
   416â†’            "driver": "å¼ºåŠ¿ç«äº‰è€…"
   417â†’        },
   418â†’        UsefulGod.OUTPUT: {
   419â†’            "primary": Archetype.JESTER,     # æ„šè€…ï¼šå†²åŠ¨è¡¨è¾¾
   420â†’            "secondary": Archetype.OUTLAW,
   421â†’            "driver": "å†²åŠ¨å‹è¡¨è¾¾è€…"
   422â†’        },
   423â†’        UsefulGod.RESOURCE: {
   424â†’            "primary": Archetype.MAGICIAN,   # é­”æœ¯å¸ˆï¼šå¿«é€Ÿå­¦ä¹ 
   425â†’            "secondary": Archetype.OUTLAW,
   426â†’            "driver": "é€Ÿæˆå‹å­¦ä¹ è€…"
   427â†’        },
   428â†’        UsefulGod.PEER: {
   429â†’            "primary": Archetype.OUTLAW,     # å›é€†è€…ï¼šç¾¤ä½“å†²çª
   430â†’            "secondary": Archetype.HERO,
   431â†’            "driver": "ç¾¤ä½“å†²çªè€…"
   432â†’        }
   433â†’    }
   434â†’}
   435â†’```
   436â†’
   437â†’#### 2.1.4 æ—¥ä¸»å¼ºå¼±å¯¹åŸå‹è¡¨è¾¾çš„ä¿®æ­£
   438â†’
   439â†’```python
   440â†’def apply_strength_modifier(
   441â†’    archetype_scores: dict[Archetype, float],
   442â†’    strength: DayMasterStrength,
   443â†’    strength_score: float
   444â†’) -> dict[Archetype, float]:
   445â†’    """
   446â†’    æ—¥ä¸»å¼ºå¼±ä¿®æ­£åŸå‹è¡¨è¾¾
   447â†’
   448â†’    èº«æ—ºï¼šå¢å¼ºå¤–å‘å‹åŸå‹ï¼ˆHero, Ruler, Outlaw, Explorer, Creatorï¼‰
   449â†’    èº«å¼±ï¼šå¢å¼ºå†…å‘å‹åŸå‹ï¼ˆSage, Caregiver, Innocent, Lover, Regularï¼‰
   450â†’    """
   451â†’    EXTROVERT_ARCHETYPES = {
   452â†’        Archetype.HERO, Archetype.RULER, Archetype.OUTLAW,
   453â†’        Archetype.EXPLORER, Archetype.CREATOR, Archetype.JESTER
   454â†’    }
   455â†’    INTROVERT_ARCHETYPES = {
   456â†’        Archetype.SAGE, Archetype.CAREGIVER, Archetype.INNOCENT,
   457â†’        Archetype.LOVER, Archetype.REGULAR, Archetype.MAGICIAN
   458â†’    }
   459â†’
   460â†’    modified_scores = archetype_scores.copy()
   461â†’
   462â†’    if strength_score > 0:  # èº«æ—º
   463â†’        modifier = 1 + strength_score * 0.2  # æœ€å¤š+20%
   464â†’        for archetype in EXTROVERT_ARCHETYPES:
   465â†’            if archetype in modified_scores:
   466â†’                modified_scores[archetype] *= modifier
   467â†’    else:  # èº«å¼±
   468â†’        modifier = 1 + abs(strength_score) * 0.2
   469â†’        for archetype in INTROVERT_ARCHETYPES:
   470â†’            if archetype in modified_scores:
   471â†’                modified_scores[archetype] *= modifier
   472â†’
   473â†’    return modified_scores
   474â†’```
   475â†’
   476â†’### 2.2 æ˜Ÿåº§åŸå‹è®¡ç®—ï¼ˆäº”ç‚¹æ¨¡å‹ï¼‰
   477â†’
   478â†’#### 2.2.1 äº”ç‚¹æ¨¡å‹è®¾è®¡
   479â†’
   480â†’```python
   481â†’class ZodiacFivePoints:
   482â†’    """äº”ç‚¹æ˜Ÿç›˜æ¨¡å‹"""
   483â†’
   484â†’    POINT_WEIGHTS = {
   485â†’        "sun": 0.35,      # æ ¸å¿ƒè‡ªæˆ‘
   486â†’        "moon": 0.25,     # æƒ…æ„Ÿéœ€æ±‚
   487â†’        "ascendant": 0.20, # ç¤¾ä¼šé¢å…·
   488â†’        "venus": 0.10,    # çˆ±æƒ…é£æ ¼
   489â†’        "mars": 0.10      # è¡ŒåŠ¨é£æ ¼
   490â†’    }
   491â†’
   492â†’    POINT_ARCHETYPE_LAYER = {
   493â†’        "sun": "core",       # å½±å“CoreåŸå‹
   494â†’        "moon": "inner",     # å½±å“Innerè¡¨è¾¾
   495â†’        "ascendant": "outer", # å½±å“Outerè¡¨è¾¾
   496â†’        "venus": "relation",  # å½±å“å…³ç³»æ¨¡å¼
   497â†’        "mars": "action"      # å½±å“è¡ŒåŠ¨æ¨¡å¼
   498â†’    }
   499â†’```
   500â†’
   501â†’#### 2.2.2 æ˜Ÿåº§â†’åŸå‹æ˜ å°„ï¼ˆäº”ç‚¹å®Œæ•´ç‰ˆï¼‰
   502â†’
   503â†’```python
   504â†’# å¤ªé˜³æ˜Ÿåº§æ˜ å°„ï¼ˆæ ¸å¿ƒè‡ªæˆ‘ï¼‰
   505â†’SUN_SIGN_ARCHETYPE_MAPPING = {
   506â†’    "ç™½ç¾Šåº§": {"primary": Archetype.HERO, "secondary": Archetype.EXPLORER},
   507â†’    "é‡‘ç‰›åº§": {"primary": Archetype.LOVER, "secondary": Archetype.REGULAR},
   508â†’    "åŒå­åº§": {"primary": Archetype.JESTER, "secondary": Archetype.MAGICIAN},
   509â†’    "å·¨èŸ¹åº§": {"primary": Archetype.CAREGIVER, "secondary": Archetype.INNOCENT},
   510â†’    "ç‹®å­åº§": {"primary": Archetype.RULER, "secondary": Archetype.CREATOR},
   511â†’    "å¤„å¥³åº§": {"primary": Archetype.SAGE, "secondary": Archetype.CAREGIVER},
   512â†’    "å¤©ç§¤åº§": {"primary": Archetype.LOVER, "secondary": Archetype.RULER},
   513â†’    "å¤©èåº§": {"primary": Archetype.MAGICIAN, "secondary": Archetype.OUTLAW},
   514â†’    "å°„æ‰‹åº§": {"primary": Archetype.EXPLORER, "secondary": Archetype.SAGE},
   515â†’    "æ‘©ç¾¯åº§": {"primary": Archetype.RULER, "secondary": Archetype.HERO},
   516â†’    "æ°´ç“¶åº§": {"primary": Archetype.OUTLAW, "secondary": Archetype.SAGE},
   517â†’    "åŒé±¼åº§": {"primary": Archetype.INNOCENT, "secondary": Archetype.MAGICIAN}
   518â†’}
   519â†’
   520â†’# æœˆäº®æ˜Ÿåº§æ˜ å°„ï¼ˆæƒ…æ„Ÿéœ€æ±‚/å†…åœ¨è¡¨è¾¾ï¼‰
   521â†’MOON_SIGN_ARCHETYPE_MAPPING = {
   522â†’    "ç™½ç¾Šåº§": {"primary": Archetype.HERO, "style": "ç›´æ¥ã€å†²åŠ¨çš„æƒ…æ„Ÿè¡¨è¾¾"},
   523â†’    "é‡‘ç‰›åº§": {"primary": Archetype.LOVER, "style": "ç¨³å®šã€æ„Ÿå®˜çš„æƒ…æ„Ÿéœ€æ±‚"},
   524â†’    "åŒå­åº§": {"primary": Archetype.JESTER, "style": "å¤šå˜ã€äº¤æµçš„æƒ…æ„Ÿæ¨¡å¼"},
   525â†’    "å·¨èŸ¹åº§": {"primary": Archetype.CAREGIVER, "style": "æ»‹å…»ã€ä¿æŠ¤çš„æƒ…æ„Ÿæœ¬èƒ½"},
   526â†’    "ç‹®å­åº§": {"primary": Archetype.CREATOR, "style": "çƒ­æƒ…ã€æˆå‰§åŒ–çš„æƒ…æ„Ÿ"},
   527â†’    "å¤„å¥³åº§": {"primary": Archetype.CAREGIVER, "style": "ç»†è‡´ã€æœåŠ¡çš„æƒ…æ„Ÿè¡¨è¾¾"},
   528â†’    "å¤©ç§¤åº§": {"primary": Archetype.LOVER, "style": "å’Œè°ã€å®¡ç¾çš„æƒ…æ„Ÿéœ€æ±‚"},
   529â†’    "å¤©èåº§": {"primary": Archetype.MAGICIAN, "style": "æ·±æ²‰ã€è½¬åŒ–çš„æƒ…æ„Ÿä½“éªŒ"},
   530â†’    "å°„æ‰‹åº§": {"primary": Archetype.EXPLORER, "style": "è‡ªç”±ã€ä¹è§‚çš„æƒ…æ„Ÿæ€åº¦"},
   531â†’    "æ‘©ç¾¯åº§": {"primary": Archetype.RULER, "style": "å…‹åˆ¶ã€åŠ¡å®çš„æƒ…æ„Ÿå¤„ç†"},
   532â†’    "æ°´ç“¶åº§": {"primary": Archetype.OUTLAW, "style": "è¶…è„±ã€äººé“çš„æƒ…æ„Ÿè§‚"},
   533â†’    "åŒé±¼åº§": {"primary": Archetype.INNOCENT, "style": "å…±æƒ…ã€æ¢¦å¹»çš„æƒ…æ„Ÿä¸–ç•Œ"}
   534â†’}
   535â†’
   536â†’# ä¸Šå‡æ˜Ÿåº§æ˜ å°„ï¼ˆç¤¾ä¼šé¢å…·/å¤–åœ¨è¡¨è¾¾ï¼‰
   537â†’ASCENDANT_ARCHETYPE_MAPPING = {
   538â†’    "ç™½ç¾Šåº§": {"primary": Archetype.HERO, "impression": "å……æ»¡æ´»åŠ›ã€ç«äº‰æ€§å¼º"},
   539â†’    "é‡‘ç‰›åº§": {"primary": Archetype.REGULAR, "impression": "ç¨³é‡å¯é ã€äº«å—ç”Ÿæ´»"},
   540â†’    "åŒå­åº§": {"primary": Archetype.JESTER, "impression": "æœºæ™ºçµæ´»ã€å–„äºæ²Ÿé€š"},
   541â†’    "å·¨èŸ¹åº§": {"primary": Archetype.CAREGIVER, "impression": "æ¸©æš–äº²åˆ‡ã€å¯Œæœ‰åŒç†å¿ƒ"},
   542â†’    "ç‹®å­åº§": {"primary": Archetype.RULER, "impression": "è‡ªä¿¡å¤§æ–¹ã€å¼•äººæ³¨ç›®"},
   543â†’    "å¤„å¥³åº§": {"primary": Archetype.SAGE, "impression": "è°¨æ…ç»†è‡´ã€è¿½æ±‚å®Œç¾"},
   544â†’    "å¤©ç§¤åº§": {"primary": Archetype.LOVER, "impression": "ä¼˜é›…å¾—ä½“ã€è¿½æ±‚å’Œè°"},
   545â†’    "å¤©èåº§": {"primary": Archetype.MAGICIAN, "impression": "ç¥ç§˜æ·±æ²‰ã€æ´å¯ŸåŠ›å¼º"},
   546â†’    "å°„æ‰‹åº§": {"primary": Archetype.EXPLORER, "impression": "å¼€æ”¾ä¹è§‚ã€è¿½æ±‚è‡ªç”±"},
   547â†’    "æ‘©ç¾¯åº§": {"primary": Archetype.RULER, "impression": "ä¸¥è‚ƒå¯é ã€ç›®æ ‡å¯¼å‘"},
   548â†’    "æ°´ç“¶åº§": {"primary": Archetype.OUTLAW, "impression": "ç‹¬ç‰¹å‰å«ã€ç‰¹ç«‹ç‹¬è¡Œ"},
   549â†’    "åŒé±¼åº§": {"primary": Archetype.INNOCENT, "impression": "æ¸©æŸ”æ¢¦å¹»ã€å¯Œæœ‰è‰ºæœ¯æ„Ÿ"}
   550â†’}
   551â†’
   552â†’# é‡‘æ˜Ÿæ˜Ÿåº§æ˜ å°„ï¼ˆçˆ±æƒ…é£æ ¼ï¼‰
   553â†’VENUS_SIGN_ARCHETYPE_MAPPING = {
   554â†’    "ç™½ç¾Šåº§": {"primary": Archetype.HERO, "love_style": "ä¸»åŠ¨è¿½æ±‚ã€çƒ­æƒ…ç›´æ¥"},
   555â†’    "é‡‘ç‰›åº§": {"primary": Archetype.LOVER, "love_style": "å¿ è¯šä¸“ä¸€ã€æ„Ÿå®˜äº«å—"},
   556â†’    "åŒå­åº§": {"primary": Archetype.JESTER, "love_style": "å¤šå˜æœ‰è¶£ã€æ™ºæ€§äº¤æµ"},
   557â†’    "å·¨èŸ¹åº§": {"primary": Archetype.CAREGIVER, "love_style": "æ¸©æŸ”å‘µæŠ¤ã€å®¶åº­å¯¼å‘"},
   558â†’    "ç‹®å­åº§": {"primary": Archetype.CREATOR, "love_style": "æµªæ¼«å¥¢åã€æˆå‰§åŒ–è¡¨è¾¾"},
   559â†’    "å¤„å¥³åº§": {"primary": Archetype.CAREGIVER, "love_style": "ç»†å¿ƒä½“è´´ã€å®é™…ä»˜å‡º"},
   560â†’    "å¤©ç§¤åº§": {"primary": Archetype.LOVER, "love_style": "ä¼˜é›…æµªæ¼«ã€è¿½æ±‚ç¾æ„Ÿ"},
   561â†’    "å¤©èåº§": {"primary": Archetype.MAGICIAN, "love_style": "æ·±æƒ…ä¸“ä¸€ã€å æœ‰æ¬²å¼º"},
   562â†’    "å°„æ‰‹åº§": {"primary": Archetype.EXPLORER, "love_style": "è‡ªç”±å¼€æ”¾ã€å†’é™©ç²¾ç¥"},
   563â†’    "æ‘©ç¾¯åº§": {"primary": Archetype.RULER, "love_style": "åŠ¡å®ç¨³é‡ã€é•¿æœŸæ‰¿è¯º"},
   564â†’    "æ°´ç“¶åº§": {"primary": Archetype.OUTLAW, "love_style": "ç‹¬ç«‹è‡ªç”±ã€æ‰“ç ´å¸¸è§„"},
   565â†’    "åŒé±¼åº§": {"primary": Archetype.INNOCENT, "love_style": "æµªæ¼«æ¢¦å¹»ã€æ— æ¡ä»¶ä»˜å‡º"}
   566â†’}
   567â†’
   568â†’# ç«æ˜Ÿæ˜Ÿåº§æ˜ å°„ï¼ˆè¡ŒåŠ¨é£æ ¼ï¼‰
   569â†’MARS_SIGN_ARCHETYPE_MAPPING = {
   570â†’    "ç™½ç¾Šåº§": {"primary": Archetype.HERO, "action_style": "æœæ–­å†²åŠ¨ã€ç«äº‰å¥½èƒœ"},
   571â†’    "é‡‘ç‰›åº§": {"primary": Archetype.REGULAR, "action_style": "ç¨³å¥æŒä¹…ã€åŠ¡å®åšå®š"},
   572â†’    "åŒå­åº§": {"primary": Archetype.MAGICIAN, "action_style": "çµæ´»å¤šå˜ã€ç­–ç•¥æ€§å¼º"},
   573â†’    "å·¨èŸ¹åº§": {"primary": Archetype.CAREGIVER, "action_style": "æƒ…ç»ªé©±åŠ¨ã€ä¿æŠ¤æœ¬èƒ½"},
   574â†’    "ç‹®å­åº§": {"primary": Archetype.RULER, "action_style": "è‡ªä¿¡é¢†å¯¼ã€è¿½æ±‚å“è¶Š"},
   575â†’    "å¤„å¥³åº§": {"primary": Archetype.SAGE, "action_style": "ç²¾ç¡®åˆ†æã€å®Œç¾ä¸»ä¹‰"},
   576â†’    "å¤©ç§¤åº§": {"primary": Archetype.LOVER, "action_style": "åè°ƒå¹³è¡¡ã€é¿å…å†²çª"},
   577â†’    "å¤©èåº§": {"primary": Archetype.MAGICIAN, "action_style": "åšå®šæ‰§ç€ã€éšç§˜ç­–ç•¥"},
   578â†’    "å°„æ‰‹åº§": {"primary": Archetype.EXPLORER, "action_style": "å†’é™©ä¹è§‚ã€è‡ªç”±å¥”æ”¾"},
   579â†’    "æ‘©ç¾¯åº§": {"primary": Archetype.HERO, "action_style": "åšéŸ§ä¸æ‹”ã€ç›®æ ‡å¯¼å‘"},
   580â†’    "æ°´ç“¶åº§": {"primary": Archetype.OUTLAW, "action_style": "ç‹¬ç‰¹åˆ›æ–°ã€æ‰“ç ´è§„åˆ™"},
   581â†’    "åŒé±¼åº§": {"primary": Archetype.INNOCENT, "action_style": "ç›´è§‰å¼•å¯¼ã€éšæµè€ŒåŠ¨"}
   582â†’}
   583â†’```
   584â†’
   585â†’#### 2.2.3 äº”ç‚¹ç»¼åˆè®¡ç®—
   586â†’
   587â†’```python
   588â†’def calculate_zodiac_archetype_scores(chart: ZodiacChart) -> dict[Archetype, float]:
   589â†’    """
   590â†’    åŸºäºäº”ç‚¹æ¨¡å‹è®¡ç®—æ˜Ÿåº§åŸå‹å¾—åˆ†
   591â†’    """
   592â†’    archetype_scores = {archetype: 0.0 for archetype in Archetype}
   593â†’    explanation_parts = []
   594â†’
   595â†’    # å¤ªé˜³æ˜Ÿåº§ï¼ˆ35%æƒé‡ï¼‰
   596â†’    sun_mapping = SUN_SIGN_ARCHETYPE_MAPPING[chart.sun_sign]
   597â†’    archetype_scores[sun_mapping["primary"]] += 0.35 * 1.0
   598â†’    archetype_scores[sun_mapping["secondary"]] += 0.35 * 0.5
   599â†’    explanation_parts.append(f"å¤ªé˜³{chart.sun_sign}èµ‹äºˆä½ {sun_mapping['primary'].value}çš„æ ¸å¿ƒç‰¹è´¨")
   600â†’
   601â†’    # æœˆäº®æ˜Ÿåº§ï¼ˆ25%æƒé‡ï¼‰
   602â†’    moon_mapping = MOON_SIGN_ARCHETYPE_MAPPING[chart.moon_sign]
   603â†’    archetype_scores[moon_mapping["primary"]] += 0.25 * 1.0
   604â†’    explanation_parts.append(f"æœˆäº®{chart.moon_sign}è®©ä½ çš„æƒ…æ„Ÿè¡¨è¾¾å‘ˆç°{moon_mapping['style']}")
   605â†’
   606â†’    # ä¸Šå‡æ˜Ÿåº§ï¼ˆ20%æƒé‡ï¼‰
   607â†’    asc_mapping = ASCENDANT_ARCHETYPE_MAPPING[chart.ascendant]
   608â†’    archetype_scores[asc_mapping["primary"]] += 0.20 * 1.0
   609â†’    explanation_parts.append(f"ä¸Šå‡{chart.ascendant}è®©ä½ ç»™äºº{asc_mapping['impression']}çš„å°è±¡")
   610â†’
   611â†’    # é‡‘æ˜Ÿæ˜Ÿåº§ï¼ˆ10%æƒé‡ï¼‰
   612â†’    venus_mapping = VENUS_SIGN_ARCHETYPE_MAPPING[chart.venus_sign]
   613â†’    archetype_scores[venus_mapping["primary"]] += 0.10 * 1.0
   614â†’    explanation_parts.append(f"é‡‘æ˜Ÿ{chart.venus_sign}è®©ä½ çš„çˆ±æƒ…é£æ ¼æ˜¯{venus_mapping['love_style']}")
   615â†’
   616â†’    # ç«æ˜Ÿæ˜Ÿåº§ï¼ˆ10%æƒé‡ï¼‰
   617â†’    mars_mapping = MARS_SIGN_ARCHETYPE_MAPPING[chart.mars_sign]
   618â†’    archetype_scores[mars_mapping["primary"]] += 0.10 * 1.0
   619â†’    explanation_parts.append(f"ç«æ˜Ÿ{chart.mars_sign}è®©ä½ çš„è¡ŒåŠ¨é£æ ¼æ˜¯{mars_mapping['action_style']}")
   620â†’
   621â†’    return archetype_scores, explanation_parts
   622â†’```
   623â†’
   624â†’### 2.3 ä¸œè¥¿æ–¹èåˆç®—æ³•
   625â†’
   626â†’#### 2.3.1 å…«å­—ä¸»å¯¼çš„èåˆè®¾è®¡
   627â†’
   628â†’```python
   629â†’class FusionStrategy:
   630â†’    """å…«å­—ä¸»å¯¼çš„ä¸œè¥¿æ–¹èåˆç­–ç•¥"""
   631â†’
   632â†’    # åŸºç¡€æƒé‡ï¼šå…«å­—70%ï¼Œæ˜Ÿåº§30%
   633â†’    BASE_BAZI_WEIGHT = 0.70
   634â†’    BASE_ZODIAC_WEIGHT = 0.30
   635â†’
   636â†’    # ä¸€è‡´æ€§å¥–åŠ±ï¼šå½“ä¸¤å¥—ç³»ç»ŸæŒ‡å‘åŒä¸€åŸå‹æ—¶
   637â†’    CONSISTENCY_BONUS = 0.15
   638â†’
   639â†’    # å†²çªå¤„ç†ï¼šå½“ä¸¤å¥—ç³»ç»ŸæŒ‡å‘å¯¹ç«‹åŸå‹æ—¶
   640â†’    CONFLICT_PENALTY = 0.10
   641â†’
   642â†’def calculate_fused_archetype(
   643â†’    bazi_scores: dict[Archetype, float],
   644â†’    zodiac_scores: dict[Archetype, float],
   645â†’    bazi_explanation: list[str],
   646â†’    zodiac_explanation: list[str]
   647â†’) -> VibeIDResult:
   648â†’    """
   649â†’    èåˆè®¡ç®—æœ€ç»ˆåŸå‹
   650â†’
   651â†’    ç­–ç•¥ï¼š
   652â†’    1. å…«å­—å†³å®šCoreåŸå‹ï¼ˆä¸»åŸå‹ï¼‰
   653â†’    2. æ˜Ÿåº§è°ƒæ•´è¡¨è¾¾å±‚æ¬¡ï¼ˆInner/Outerï¼‰
   654â†’    3. ä¸€è‡´æ€§å¢å¼ºç½®ä¿¡åº¦
   655â†’    4. å†²çªæ—¶å…«å­—ä¼˜å…ˆ
   656â†’    """
   657â†’
   658â†’    # Step 1: è·å–å…«å­—ä¸»åŸå‹
   659â†’    bazi_primary = max(bazi_scores, key=bazi_scores.get)
   660â†’    bazi_primary_score = bazi_scores[bazi_primary]
   661â†’
   662â†’    # Step 2: è·å–æ˜Ÿåº§ä¸»åŸå‹
   663â†’    zodiac_primary = max(zodiac_scores, key=zodiac_scores.get)
   664â†’    zodiac_primary_score = zodiac_scores[zodiac_primary]
   665â†’
   666â†’    # Step 3: ä¸€è‡´æ€§æ£€æŸ¥
   667â†’    consistency_type = check_consistency(bazi_primary, zodiac_primary)
   668â†’
   669â†’    # Step 4: èåˆè®¡ç®—
   670â†’    fused_scores = {}
   671â†’    for archetype in Archetype:
   672â†’        base_score = (
   673â†’            bazi_scores.get(archetype, 0) * FusionStrategy.BASE_BAZI_WEIGHT +
   674â†’            zodiac_scores.get(archetype, 0) * FusionStrategy.BASE_ZODIAC_WEIGHT
   675â†’        )
   676â†’
   677â†’        # ä¸€è‡´æ€§å¥–åŠ±
   678â†’        if archetype == bazi_primary and archetype == zodiac_primary:
   679â†’            base_score += FusionStrategy.CONSISTENCY_BONUS
   680â†’
   681â†’        fused_scores[archetype] = base_score
   682â†’
   683â†’    # Step 5: ç¡®å®šæœ€ç»ˆåŸå‹
   684â†’    primary_archetype = max(fused_scores, key=fused_scores.get)
   685â†’
   686â†’    # Step 6: ç¡®å®šå‰¯åŸå‹ï¼ˆæ’é™¤ä¸»åŸå‹åçš„æœ€é«˜åˆ†ï¼‰
   687â†’    secondary_scores = {k: v for k, v in fused_scores.items() if k != primary_archetype}
   688â†’    secondary_archetype = max(secondary_scores, key=secondary_scores.get)
   689â†’
   690â†’    # Step 7: ç”Ÿæˆè§£é‡Š
   691â†’    explanation = generate_explanation(
   692â†’        primary_archetype, secondary_archetype,
   693â†’        bazi_primary, zodiac_primary,
   694â†’        consistency_type,
   695â†’        bazi_explanation, zodiac_explanation
   696â†’    )
   697â†’
   698â†’    # Step 8: è®¡ç®—ç½®ä¿¡åº¦
   699â†’    confidence = calculate_confidence(
   700â†’        fused_scores[primary_archetype],
   701â†’        fused_scores[secondary_archetype],
   702â†’        consistency_type
   703â†’    )
   704â†’
   705â†’    return VibeIDResult(
   706â†’        primary_archetype=primary_archetype,
   707â†’        secondary_archetype=secondary_archetype,
   708â†’        all_scores=fused_scores,
   709â†’        confidence=confidence,
   710â†’        explanation=explanation,
   711â†’        bazi_contribution=bazi_explanation,
   712â†’        zodiac_contribution=zodiac_explanation
   713â†’    )
   714â†’
   715â†’def check_consistency(bazi_archetype: Archetype, zodiac_archetype: Archetype) -> str:
   716â†’    """
   717â†’    æ£€æŸ¥å…«å­—å’Œæ˜Ÿåº§åŸå‹çš„ä¸€è‡´æ€§
   718â†’    """
   719â†’    if bazi_archetype == zodiac_archetype:
   720â†’        return "perfect_match"  # å®Œç¾ä¸€è‡´
   721â†’
   722â†’    # å®šä¹‰åŸå‹å¯¹ç«‹å…³ç³»
   723â†’    OPPOSING_PAIRS = [
   724â†’        (Archetype.RULER, Archetype.OUTLAW),
   725â†’        (Archetype.HERO, Archetype.INNOCENT),
   726â†’        (Archetype.SAGE, Archetype.JESTER),
   727â†’        (Archetype.CAREGIVER, Archetype.EXPLORER),
   728â†’    ]
   729â†’
   730â†’    for pair in OPPOSING_PAIRS:
   731â†’        if {bazi_archetype, zodiac_archetype} == set(pair):
   732â†’            return "conflict"  # å¯¹ç«‹å†²çª
   733â†’
   734â†’    # å®šä¹‰åŸå‹ç›¸è¿‘å…³ç³»
   735â†’    SIMILAR_GROUPS = [
   736â†’        {Archetype.RULER, Archetype.HERO, Archetype.MAGICIAN},
   737â†’        {Archetype.SAGE, Archetype.CAREGIVER, Archetype.REGULAR},
   738â†’        {Archetype.CREATOR, Archetype.EXPLORER, Archetype.OUTLAW},
   739â†’        {Archetype.LOVER, Archetype.INNOCENT, Archetype.JESTER},
   740â†’    ]
   741â†’
   742â†’    for group in SIMILAR_GROUPS:
   743â†’        if bazi_archetype in group and zodiac_archetype in group:
   744â†’            return "similar"  # ç›¸è¿‘
   745â†’
   746â†’    return "neutral"  # ä¸­æ€§
   747â†’```
   748â†’
   749â†’#### 2.3.2 å¯è§£é‡Šæ€§æ¨¡å—
   750â†’
   751â†’```python
   752â†’def generate_explanation(
   753â†’    primary: Archetype,
   754â†’    secondary: Archetype,
   755â†’    bazi_primary: Archetype,
   756â†’    zodiac_primary: Archetype,
   757â†’    consistency: str,
   758â†’    bazi_explanation: list[str],
   759â†’    zodiac_explanation: list[str]
   760â†’) -> dict:
   761â†’    """
   762â†’    ç”Ÿæˆç”¨æˆ·å¯ç†è§£çš„åŸå‹è§£é‡Š
   763â†’    """
   764â†’
   765â†’    explanation = {
   766â†’        "summary": "",
   767â†’        "bazi_insight": "",
   768â†’        "zodiac_insight": "",
   769â†’        "integration_insight": "",
   770â†’        "growth_direction": ""
   771â†’    }
   772â†’
   773â†’    # ä¸»åŸå‹æ€»ç»“
   774â†’    explanation["summary"] = f"ä½ çš„æ ¸å¿ƒåŸå‹æ˜¯ã€{primary.chinese_name}ã€‘ï¼Œå‰¯åŸå‹æ˜¯ã€{secondary.chinese_name}ã€‘"
   775â†’
   776â†’    # å…«å­—æ´å¯Ÿ
   777â†’    explanation["bazi_insight"] = (
   778â†’        f"ä»å…«å­—è§’åº¦çœ‹ï¼Œ{bazi_explanation[0]}ã€‚"
   779â†’        f"è¿™å†³å®šäº†ä½ çš„äººç”Ÿåº•è‰²æ˜¯{bazi_primary.chinese_name}å‹çš„ã€‚"
   780â†’    )
   781â†’
   782â†’    # æ˜Ÿåº§æ´å¯Ÿ
   783â†’    explanation["zodiac_insight"] = (
   784â†’        f"ä»æ˜Ÿç›˜è§’åº¦çœ‹ï¼Œ{'; '.join(zodiac_explanation[:3])}ã€‚"
   785â†’        f"è¿™å½±å“äº†ä½ çš„è¡¨è¾¾æ–¹å¼åå‘{zodiac_primary.chinese_name}ã€‚"
   786â†’    )
   787â†’
   788â†’    # èåˆæ´å¯Ÿ
   789â†’    if consistency == "perfect_match":
   790â†’        explanation["integration_insight"] = (
   791â†’            f"ä¸œæ–¹å‘½ç†ä¸è¥¿æ–¹å æ˜Ÿé«˜åº¦ä¸€è‡´åœ°æŒ‡å‘{primary.chinese_name}åŸå‹ï¼Œ"
   792â†’            f"è¯´æ˜è¿™æ˜¯ä½ éå¸¸ç¨³å®šçš„æ ¸å¿ƒç‰¹è´¨ã€‚"
   793â†’        )
   794â†’    elif consistency == "conflict":
   795â†’        explanation["integration_insight"] = (
   796â†’            f"æœ‰è¶£çš„æ˜¯ï¼Œå…«å­—æŒ‡å‘{bazi_primary.chinese_name}ï¼Œ"
   797â†’            f"è€Œæ˜Ÿç›˜æŒ‡å‘{zodiac_primary.chinese_name}ï¼Œ"
   798â†’            f"è¿™ç§å¼ åŠ›å¯èƒ½è®©ä½ å†…å¿ƒæœ‰æ—¶æ„Ÿåˆ°çŸ›ç›¾ã€‚"
   799â†’            f"æœ€ç»ˆæˆ‘ä»¬ä»¥å…«å­—ä¸ºä¸»ï¼Œç¡®å®šä½ çš„ä¸»åŸå‹æ˜¯{primary.chinese_name}ã€‚"
   800â†’        )
   801â†’    else:
   802â†’        explanation["integration_insight"] = (
   803â†’            f"å…«å­—çš„{bazi_primary.chinese_name}ç‰¹è´¨ä¸æ˜Ÿç›˜çš„{zodiac_primary.chinese_name}ç‰¹è´¨"
   804â†’            f"ç›¸äº’è¡¥å……ï¼Œè®©ä½ çš„äººæ ¼æ›´åŠ ä¸°å¯Œå¤šå…ƒã€‚"
   805â†’        )
   806â†’
   807â†’    # æˆé•¿æ–¹å‘
   808â†’    explanation["growth_direction"] = generate_growth_direction(primary, secondary)
   809â†’
   810â†’    return explanation
   811â†’
   812â†’def generate_growth_direction(primary: Archetype, secondary: Archetype) -> str:
   813â†’    """
   814â†’    ç”Ÿæˆæˆé•¿æ–¹å‘å»ºè®®
   815â†’    """
   816â†’    GROWTH_DIRECTIONS = {
   817â†’        Archetype.HERO: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å­¦ä¼šæ¥çº³è„†å¼±ï¼Œåœ¨ä¿æŒå‹‡æ°”çš„åŒæ—¶åŸ¹å…»åŒç†å¿ƒã€‚",
   818â†’        Archetype.SAGE: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å°†æ™ºæ…§è½¬åŒ–ä¸ºè¡ŒåŠ¨ï¼Œä¸ä»…è¿½æ±‚ç†è§£ï¼Œæ›´è¦å®è·µå’Œåˆ†äº«ã€‚",
   819â†’        Archetype.CAREGIVER: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å­¦ä¼šç…§é¡¾è‡ªå·±ï¼Œå»ºç«‹å¥åº·çš„è¾¹ç•Œï¼Œé¿å…è¿‡åº¦ä»˜å‡ºã€‚",
   820â†’        Archetype.CREATOR: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å®Œæˆä½œå“è€Œéè¿½æ±‚å®Œç¾ï¼Œè®©åˆ›æ„çœŸæ­£è½åœ°ã€‚",
   821â†’        Archetype.RULER: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å­¦ä¼šæˆæƒå’Œä¿¡ä»»ï¼Œåœ¨æŒæ§ä¸­ä¿æŒçµæ´»ã€‚",
   822â†’        Archetype.OUTLAW: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å°†å›é€†è½¬åŒ–ä¸ºå»ºè®¾æ€§çš„å˜é©ï¼Œæ‰¾åˆ°å€¼å¾—ä¸ºä¹‹æˆ˜æ–—çš„äº‹ä¸šã€‚",
   823â†’        Archetype.MAGICIAN: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å°†æ´å¯Ÿç”¨äºå¸®åŠ©ä»–äººï¼Œè€Œéä»…ä»…æŒæ§å±€åŠ¿ã€‚",
   824â†’        Archetype.LOVER: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯åœ¨å…³ç³»ä¸­ä¿æŒç‹¬ç«‹æ€§ï¼Œé¿å…å¤±å»è‡ªæˆ‘ã€‚",
   825â†’        Archetype.JESTER: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯åœ¨æ¬¢ä¹ä¸­æ‰¾åˆ°æ·±åº¦ï¼Œè®©å¹½é»˜æœåŠ¡äºçœŸæ­£é‡è¦çš„äº‹ã€‚",
   826â†’        Archetype.REGULAR: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯åœ¨å½’å±ä¸­ä¿æŒç‹¬ç‰¹æ€§ï¼Œå‹‡æ•¢è¡¨è¾¾è‡ªå·±çš„è§‚ç‚¹ã€‚",
   827â†’        Archetype.INNOCENT: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯åœ¨ä¿æŒçº¯çœŸçš„åŒæ—¶å‘å±•æ™ºæ…§ï¼Œå­¦ä¼šè¾¨åˆ«è€Œéç›²ç›®ä¿¡ä»»ã€‚",
   828â†’        Archetype.EXPLORER: "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å­¦ä¼šæ·±è€•ï¼Œåœ¨è‡ªç”±æ¢ç´¢ä¸­ä¹Ÿèƒ½å»ºç«‹æŒä¹…çš„è¿æ¥ã€‚"
   829â†’    }
   830â†’
   831â†’    base_direction = GROWTH_DIRECTIONS[primary]
   832â†’
   833â†’    # æ ¹æ®å‰¯åŸå‹è¡¥å……
   834â†’    if secondary:
   835â†’        supplement = f"åŒæ—¶ï¼Œä½ çš„{secondary.chinese_name}å‰¯åŸå‹å¯ä»¥æˆä¸ºè¿™ä¸ªæˆé•¿è¿‡ç¨‹ä¸­çš„èµ„æºã€‚"
   836â†’        return base_direction + supplement
   837â†’
   838â†’    return base_direction
   839â†’```
   840â†’
   841â†’---
   842â†’
   843â†’## 3. æ•°æ®ç»“æ„è®¾è®¡
   844â†’
   845â†’### 3.1 VibeID ç»“æœç»“æ„
   846â†’
   847â†’```python
   848â†’@dataclass
   849â†’class VibeIDResult:
   850â†’    """VibeID è®¡ç®—ç»“æœ"""
   851â†’
   852â†’    # æ ¸å¿ƒåŸå‹
   853â†’    primary_archetype: Archetype
   854â†’    secondary_archetype: Archetype
   855â†’
   856â†’    # å®Œæ•´å¾—åˆ†ï¼ˆåå°ä¿å­˜ï¼Œç”¨äºé«˜çº§åŠŸèƒ½ï¼‰
   857â†’    all_scores: dict[Archetype, float]
   858â†’
   859â†’    # ç½®ä¿¡åº¦ï¼ˆ0-1ï¼‰
   860â†’    confidence: float
   861â†’
   862â†’    # å¯è§£é‡Šæ€§æ¨¡å—
   863â†’    explanation: dict[str, str]
   864â†’    bazi_contribution: list[str]
   865â†’    zodiac_contribution: list[str]
   866â†’
   867â†’    # å…ƒæ•°æ®
   868â†’    calculation_version: str = "v2.0"
   869â†’    calculated_at: datetime = field(default_factory=datetime.now)
   870â†’
   871â†’    # å…«å­—è¯¦æƒ…
   872â†’    bazi_pattern: str = ""
   873â†’    useful_god: str = ""
   874â†’    day_master_strength: str = ""
   875â†’
   876â†’    # æ˜Ÿåº§è¯¦æƒ…
   877â†’    sun_sign: str = ""
   878â†’    moon_sign: str = ""
   879â†’    ascendant: str = ""
   880â†’    venus_sign: str = ""
   881â†’    mars_sign: str = ""
   882â†’
   883â†’@dataclass
   884â†’class VibeIDDisplay:
   885â†’    """VibeID ç®€åŒ–å±•ç¤ºï¼ˆå‰ç«¯ä½¿ç”¨ï¼‰"""
   886â†’
   887â†’    primary_archetype: str  # ä¸»åŸå‹åç§°
   888â†’    primary_emoji: str      # ä¸»åŸå‹emoji
   889â†’    primary_tagline: str    # ä¸€å¥è¯æè¿°
   890â†’
   891â†’    secondary_archetype: str
   892â†’
   893â†’    summary: str            # ç»¼åˆæè¿°
   894â†’    growth_tip: str         # æˆé•¿æç¤º
   895â†’
   896â†’    # å½’å› ç®€è¿°ï¼ˆç”¨æˆ·å¯å±•å¼€æŸ¥çœ‹ï¼‰
   897â†’    bazi_brief: str         # "æ­£å®˜æ ¼+ç”¨ç¥ä¸ºè´¢"
   898â†’    zodiac_brief: str       # "å¤ªé˜³ç‹®å­+æœˆäº®å·¨èŸ¹"
   899â†’```
   900â†’
   901â†’### 3.2 åŸå‹å®šä¹‰
   902â†’
   903â†’```python
   904â†’class Archetype(Enum):
   905â†’    """è£æ ¼12åŸå‹"""
   906â†’
   907â†’    INNOCENT = "innocent"
   908â†’    SAGE = "sage"
   909â†’    EXPLORER = "explorer"
   910â†’    OUTLAW = "outlaw"
   911â†’    MAGICIAN = "magician"
   912â†’    HERO = "hero"
   913â†’    LOVER = "lover"
   914â†’    JESTER = "jester"
   915â†’    REGULAR = "regular"
   916â†’    CAREGIVER = "caregiver"
   917â†’    RULER = "ruler"
   918â†’    CREATOR = "creator"
   919â†’
   920â†’    @property
   921â†’    def chinese_name(self) -> str:
   922â†’        return {
   923â†’            "innocent": "å¤©çœŸè€…",
   924â†’            "sage": "æ™ºè€…",
   925â†’            "explorer": "æ¢é™©å®¶",
   926â†’            "outlaw": "å›é€†è€…",
   927â†’            "magician": "é­”æœ¯å¸ˆ",
   928â†’            "hero": "è‹±é›„",
   929â†’            "lover": "çˆ±äºº",
   930â†’            "jester": "æ„šè€…",
   931â†’            "regular": "å‡¡äºº",
   932â†’            "caregiver": "ç…§é¡¾è€…",
   933â†’            "ruler": "ç»Ÿæ²»è€…",
   934â†’            "creator": "åˆ›é€ è€…"
   935â†’        }[self.value]
   936â†’
   937â†’    @property
   938â†’    def emoji(self) -> str:
   939â†’        return {
   940â†’            "innocent": "ğŸŒ¸",
   941â†’            "sage": "ğŸ“š",
   942â†’            "explorer": "ğŸ§­",
   943â†’            "outlaw": "âš¡",
   944â†’            "magician": "ğŸ”®",
   945â†’            "hero": "âš”ï¸",
   946â†’            "lover": "ğŸ’•",
   947â†’            "jester": "ğŸ­",
   948â†’            "regular": "ğŸ ",
   949â†’            "caregiver": "ğŸ¤—",
   950â†’            "ruler": "ğŸ‘‘",
   951â†’            "creator": "ğŸ¨"
   952â†’        }[self.value]
   953â†’
   954â†’    @property
   955â†’    def tagline(self) -> str:
   956â†’        return {
   957â†’            "innocent": "ç›¸ä¿¡ç¾å¥½ï¼Œä¿æŒçº¯çœŸ",
   958â†’            "sage": "è¿½æ±‚çœŸç†ï¼Œå¯è¿ªæ™ºæ…§",
   959â†’            "explorer": "è¿½å¯»è‡ªç”±ï¼Œæ¢ç´¢æœªçŸ¥",
   960â†’            "outlaw": "æ‰“ç ´å¸¸è§„ï¼Œæ¨åŠ¨å˜é©",
   961â†’            "magician": "æ´å¯Ÿæœ¬è´¨ï¼Œè½¬åŒ–ç°å®",
   962â†’            "hero": "å…‹æœå›°éš¾ï¼Œè¯æ˜ä»·å€¼",
   963â†’            "lover": "è¿½æ±‚è¿æ¥ï¼Œåˆ›é€ äº²å¯†",
   964â†’            "jester": "æ´»åœ¨å½“ä¸‹ï¼Œå¸¦æ¥æ¬¢ä¹",
   965â†’            "regular": "è„šè¸å®åœ°ï¼Œå½’å±ç¾¤ä½“",
   966â†’            "caregiver": "ç…§é¡¾ä»–äººï¼Œæ— ç§å¥‰çŒ®",
   967â†’            "ruler": "æŒæ§å±€é¢ï¼Œæ‰¿æ‹…è´£ä»»",
   968â†’            "creator": "è¡¨è¾¾è‡ªæˆ‘ï¼Œåˆ›é€ ä¸æœ½"
   969â†’        }[self.value]
   970â†’```
   971â†’
   972â†’---
   973â†’
   974â†’## 4. API è®¾è®¡
   975â†’
   976â†’### 4.1 è®¡ç®—æ¥å£
   977â†’
   978â†’```python
   979â†’# POST /api/v1/vibeid/calculate
   980â†’{
   981â†’    "user_id": "string",
   982â†’    "birth_info": {
   983â†’        "year": 1990,
   984â†’        "month": 8,
   985â†’        "day": 15,
   986â†’        "hour": 14,
   987â†’        "minute": 30,
   988â†’        "longitude": 116.4,
   989â†’        "latitude": 39.9,
   990â†’        "timezone": "Asia/Shanghai"
   991â†’    },
   992â†’    "options": {
   993â†’        "include_full_scores": false,  # æ˜¯å¦è¿”å›å®Œæ•´12åŸå‹å¾—åˆ†
   994â†’        "include_explanation": true,   # æ˜¯å¦è¿”å›è§£é‡Šæ¨¡å—
   995â†’        "force_recalculate": false     # æ˜¯å¦å¼ºåˆ¶é‡æ–°è®¡ç®—
   996â†’    }
   997â†’}
   998â†’
   999â†’# Response
  1000â†’{
  1001â†’    "success": true,
  1002â†’    "data": {
  1003â†’        "display": {
  1004â†’            "primary_archetype": "åˆ›é€ è€…",
  1005â†’            "primary_emoji": "ğŸ¨",
  1006â†’            "primary_tagline": "è¡¨è¾¾è‡ªæˆ‘ï¼Œåˆ›é€ ä¸æœ½",
  1007â†’            "secondary_archetype": "å›é€†è€…",
  1008â†’            "summary": "ä½ çš„æ ¸å¿ƒåŸå‹æ˜¯åˆ›é€ è€…...",
  1009â†’            "growth_tip": "ä½ çš„æˆé•¿æ–¹å‘æ˜¯å®Œæˆä½œå“...",
  1010â†’            "bazi_brief": "ä¼¤å®˜æ ¼ Â· ç”¨ç¥ä¸ºè´¢",
  1011â†’            "zodiac_brief": "å¤ªé˜³ç‹®å­ Â· æœˆäº®åŒé±¼ Â· ä¸Šå‡å¤©è"
  1012â†’        },
  1013â†’        "explanation": {
  1014â†’            "summary": "...",
  1015â†’            "bazi_insight": "...",
  1016â†’            "zodiac_insight": "...",
  1017â†’            "integration_insight": "...",
  1018â†’            "growth_direction": "..."
  1019â†’        },
  1020â†’        "confidence": 0.85,
  1021â†’        "version": "v2.0"
  1022â†’    }
  1023â†’}
  1024â†’```
  1025â†’
  1026â†’### 4.2 è·å–è¯¦æƒ…æ¥å£
  1027â†’
  1028â†’```python
  1029â†’# GET /api/v1/vibeid/{user_id}/detail
  1030â†’# è·å–å®Œæ•´çš„ VibeID ä¿¡æ¯ï¼ŒåŒ…æ‹¬12åŸå‹å®Œæ•´å¾—åˆ†
  1031â†’
  1032â†’{
  1033â†’    "success": true,
  1034â†’    "data": {
  1035â†’        "primary": { ... },
  1036â†’        "all_scores": {
  1037â†’            "creator": 0.42,
  1038â†’            "outlaw": 0.28,
  1039â†’            "magician": 0.15,
  1040â†’            ...
  1041â†’        },
  1042â†’        "bazi_detail": {
  1043â†’            "pattern": "ä¼¤å®˜æ ¼",
  1044â†’            "useful_god": "è´¢",
  1045â†’            "day_master_strength": "åæ—º",
  1046â†’            "day_master": "ä¸™ç«",
  1047â†’            "explanation": ["ä¸™ç«ç”Ÿäºå·³æœˆ...", ...]
  1048â†’        },
  1049â†’        "zodiac_detail": {
  1050â†’            "sun": {"sign": "ç‹®å­åº§", "archetype": "ruler"},
  1051â†’            "moon": {"sign": "åŒé±¼åº§", "archetype": "innocent"},
  1052â†’            "ascendant": {"sign": "å¤©èåº§", "archetype": "magician"},
  1053â†’            "venus": {"sign": "å¤„å¥³åº§", "archetype": "caregiver"},
  1054â†’            "mars": {"sign": "ç™½ç¾Šåº§", "archetype": "hero"}
  1055â†’        }
  1056â†’    }
  1057â†’}
  1058â†’```
  1059â†’
  1060â†’---
  1061â†’
  1062â†’## 5. å®ç°è·¯çº¿å›¾
  1063â†’
  1064â†’### Phase 1: åŸºç¡€å‡çº§ï¼ˆWeek 1-2ï¼‰
  1065â†’
  1066â†’- [ ] å®ç°æ—¥ä¸»å¼ºå¼±è®¡ç®—æ¨¡å—
  1067â†’- [ ] å®ç°ç”¨ç¥å–œå¿Œåˆ¤æ–­æ¨¡å—
  1068â†’- [ ] å‡çº§å…«å­—åŸå‹æ˜ å°„è¡¨ï¼ˆæ ¼å±€+ç”¨ç¥ç»„åˆï¼‰
  1069â†’- [ ] å•å…ƒæµ‹è¯•è¦†ç›–
  1070â†’
  1071â†’### Phase 2: äº”ç‚¹æ¨¡å‹ï¼ˆWeek 3ï¼‰
  1072â†’
  1073â†’- [ ] æ‰©å±•æ˜Ÿåº§åŸå‹æ˜ å°„ï¼ˆæœˆäº®/ä¸Šå‡/é‡‘æ˜Ÿ/ç«æ˜Ÿï¼‰
  1074â†’- [ ] å®ç°äº”ç‚¹ç»¼åˆè®¡ç®—
  1075â†’- [ ] ä¸ç°æœ‰ ZodiacCalculator é›†æˆ
  1076â†’
  1077â†’### Phase 3: èåˆç®—æ³•ï¼ˆWeek 4ï¼‰
  1078â†’
  1079â†’- [ ] å®ç°å…«å­—ä¸»å¯¼çš„èåˆç­–ç•¥
  1080â†’- [ ] å®ç°ä¸€è‡´æ€§æ£€æŸ¥å’Œå¥–åŠ±/æƒ©ç½šæœºåˆ¶
  1081â†’- [ ] å®ç°ç½®ä¿¡åº¦è®¡ç®—
  1082â†’
  1083â†’### Phase 4: å¯è§£é‡Šæ€§ï¼ˆWeek 5ï¼‰
  1084â†’
  1085â†’- [ ] å®ç°è§£é‡Šç”Ÿæˆæ¨¡å—
  1086â†’- [ ] å®ç°æˆé•¿æ–¹å‘å»ºè®®
  1087â†’- [ ] å‰ç«¯å±•ç¤ºé€‚é…
  1088â†’
  1089â†’### Phase 5: æµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆWeek 6ï¼‰
  1090â†’
  1091â†’- [ ] ç«¯åˆ°ç«¯æµ‹è¯•
  1092â†’- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†
  1093â†’- [ ] ç®—æ³•å‚æ•°å¾®è°ƒ
  1094â†’
  1095â†’---
  1096â†’
  1097â†’## 6. é™„å½•
  1098â†’
  1099â†’### 6.1 å…«å­—æ ¼å±€å®Œæ•´æ˜ å°„è¡¨
  1100â†’
  1101â†’| æ ¼å±€ | ç”¨ç¥ä¸ºè´¢ | ç”¨ç¥ä¸ºå®˜æ€ | ç”¨ç¥ä¸ºå° | ç”¨ç¥ä¸ºé£Ÿä¼¤ | ç”¨ç¥ä¸ºæ¯”åŠ« |
  1102â†’|------|----------|------------|----------|------------|------------|
  1103â†’| æ­£å®˜æ ¼ | Ruler+Caregiver | Ruler+Hero | Sage+Ruler | Creator+Ruler | Regular+Ruler |
  1104â†’| ä¸ƒæ€æ ¼ | Hero+Explorer | Outlaw+Hero | Hero+Sage | Outlaw+Creator | Hero+Regular |
  1105â†’| æ­£å°æ ¼ | Caregiver+Sage | Sage+Ruler | Sage+Innocent | Creator+Sage | Caregiver+Regular |
  1106â†’| åå°æ ¼ | Magician+Explorer | Magician+Sage | Sage+Magician | Creator+Outlaw | Outlaw+Magician |
  1107â†’| é£Ÿç¥æ ¼ | Creator+Lover | Magician+Creator | Sage+Creator | Creator+Jester | Jester+Creator |
  1108â†’| ä¼¤å®˜æ ¼ | Creator+Outlaw | Outlaw+Hero | Magician+Creator | Creator+Outlaw | Outlaw+Explorer |
  1109â†’| æ­£è´¢æ ¼ | Regular+Lover | Ruler+Regular | Sage+Caregiver | Creator+Regular | Regular+Caregiver |
  1110â†’| åè´¢æ ¼ | Explorer+Jester | Explorer+Ruler | Magician+Explorer | Jester+Creator | Jester+Lover |
  1111â†’| æ¯”è‚©æ ¼ | Explorer+Hero | Hero+Outlaw | Sage+Explorer | Creator+Explorer | Regular+Hero |
  1112â†’| åŠ«è´¢æ ¼ | Outlaw+Explorer | Hero+Outlaw | Magician+Outlaw | Jester+Outlaw | Outlaw+Hero |
  1113â†’
  1114â†’### 6.2 æ˜Ÿåº§äº”ç‚¹æ˜ å°„å®Œæ•´è¡¨
  1115â†’
  1116â†’| æ˜Ÿåº§ | å¤ªé˜³(Core) | æœˆäº®(Inner) | ä¸Šå‡(Outer) | é‡‘æ˜Ÿ(Love) | ç«æ˜Ÿ(Action) |
  1117â†’|------|------------|-------------|-------------|------------|--------------|
  1118â†’| ç™½ç¾Š | Hero | Hero | Hero | Hero | Hero |
  1119â†’| é‡‘ç‰› | Lover | Lover | Regular | Lover | Regular |
  1120â†’| åŒå­ | Jester | Jester | Jester | Jester | Magician |
  1121â†’| å·¨èŸ¹ | Caregiver | Caregiver | Caregiver | Caregiver | Caregiver |
  1122â†’| ç‹®å­ | Ruler | Creator | Ruler | Creator | Ruler |
  1123â†’| å¤„å¥³ | Sage | Caregiver | Sage | Caregiver | Sage |
  1124â†’| å¤©ç§¤ | Lover | Lover | Lover | Lover | Lover |
  1125â†’| å¤©è | Magician | Magician | Magician | Magician | Magician |
  1126â†’| å°„æ‰‹ | Explorer | Explorer | Explorer | Explorer | Explorer |
  1127â†’| æ‘©ç¾¯ | Ruler | Ruler | Ruler | Ruler | Hero |
  1128â†’| æ°´ç“¶ | Outlaw | Outlaw | Outlaw | Outlaw | Outlaw |
  1129â†’| åŒé±¼ | Innocent | Innocent | Innocent | Innocent | Innocent |
  1130â†’
  1131â†’### 6.3 åŸå‹ä¸€è‡´æ€§çŸ©é˜µ
  1132â†’
  1133â†’```
  1134â†’           Hero  Ruler  Sage  Care  Creat Outl  Magi  Lover Jest  Regu  Inno  Expl
  1135â†’Hero        -     +      0     0     0     +     +     0     0     0     -     +
  1136â†’Ruler       +     -      +     +     0     -     +     0     0     +     0     0
  1137â†’Sage        0     +      -     +     +     0     +     0     -     +     0     0
  1138â†’Caregiver   0     +      +     -     0     0     0     +     0     +     +     -
  1139â†’Creator     0     0      +     0     -     +     +     +     +     0     0     +
  1140â†’Outlaw      +     -      0     0     +     -     +     0     +     -     0     +
  1141â†’Magician    +     +      +     0     +     +     -     0     0     0     0     0
  1142â†’Lover       0     0      0     +     +     0     0     -     +     +     +     0
  1143â†’Jester      0     0      -     0     +     +     0     +     -     +     +     +
  1144â†’Regular     0     +      +     +     0     -     0     +     +     -     +     0
  1145â†’Innocent    -     0      0     +     0     0     0     +     +     +     -     0
  1146â†’Explorer    +     0      0     -     +     +     0     0     +     0     0     -
  1147â†’
  1148â†’+ = ç›¸è¿‘ (similar)
  1149â†’- = å¯¹ç«‹ (conflict)
  1150â†’0 = ä¸­æ€§ (neutral)
  1151â†’```
  1152â†’
  1153â†’---
  1154â†’
  1155â†’## 7. å˜æ›´å†å²
  1156â†’
  1157â†’| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ |
  1158â†’|------|------|----------|
  1159â†’| v1.0 | 2026-01-10 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºç¡€æ˜ å°„è®¾è®¡ |
  1160â†’| v2.0 | 2026-01-16 | æ·±åº¦ä¼˜åŒ–ï¼šä¸­ç­‰æ·±åº¦å…«å­—è®¡ç®—ã€äº”ç‚¹æ˜Ÿç›˜æ¨¡å‹ã€å…«å­—ä¸»å¯¼èåˆã€å¯è§£é‡Šæ€§æ¨¡å— |
  1161â†’