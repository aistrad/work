     1â†’# VibeLife â†’ VibeID å‡çº§æ–¹æ¡ˆ
     2â†’
     3â†’> åŸºäº VibeIDè®¾è®¡-v4.md çš„ç³»ç»Ÿå‡çº§å®æ–½æ–¹æ¡ˆ
     4â†’> ç‰ˆæœ¬: 1.1 | æ›´æ–°æ—¥æœŸ: 2026-01-16
     5â†’
     6â†’---
     7â†’
     8â†’## ä¸€ã€æ¶æ„è®¾è®¡
     9â†’
    10â†’### 1.1 VibeID çš„åŒé‡èº«ä»½
    11â†’
    12â†’VibeID é‡‡ç”¨ **ç‰¹æ®Š Skill + åŸºç¡€è®¾æ–½** çš„åŒé‡èº«ä»½ï¼š
    13â†’
    14â†’```
    15â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    16â†’â”‚                      VibeLife ç³»ç»Ÿæ¶æ„                          â”‚
    17â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    18â†’â”‚                                                                 â”‚
    19â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    20â†’â”‚   â”‚                    CoreAgent                            â”‚   â”‚
    21â†’â”‚   â”‚                                                         â”‚   â”‚
    22â†’â”‚   â”‚   use_skill("vibeid") â”€â”€â”                               â”‚   â”‚
    23â†’â”‚   â”‚   use_skill("bazi")  â”€â”€â”€â”¼â”€â”€â†’ Skill Router               â”‚   â”‚
    24â†’â”‚   â”‚   use_skill("zodiac") â”€â”€â”¤                               â”‚   â”‚
    25â†’â”‚   â”‚   use_skill("tarot") â”€â”€â”€â”¤                               â”‚   â”‚
    26â†’â”‚   â”‚   use_skill("career") â”€â”€â”˜                               â”‚   â”‚
    27â†’â”‚   â”‚                                                         â”‚   â”‚
    28â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    29â†’â”‚                              â”‚                                   â”‚
    30â†’â”‚                              â–¼                                   â”‚
    31â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    32â†’â”‚   â”‚                                                         â”‚   â”‚
    33â†’â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
    34â†’â”‚   â”‚   â”‚ VibeID  â”‚  â”‚  Bazi   â”‚  â”‚ Zodiac  â”‚  â”‚  Tarot  â”‚   â”‚   â”‚
    35â†’â”‚   â”‚   â”‚  Skill  â”‚  â”‚  Skill  â”‚  â”‚  Skill  â”‚  â”‚  Skill  â”‚   â”‚   â”‚
    36â†’â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
    37â†’â”‚   â”‚        â”‚            â”‚            â”‚                      â”‚   â”‚
    38â†’â”‚   â”‚        â”‚      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚   â”‚
    39â†’â”‚   â”‚        â”‚      â”‚                                         â”‚   â”‚
    40â†’â”‚   â”‚        â–¼      â–¼                                         â”‚   â”‚
    41â†’â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
    42â†’â”‚   â”‚   â”‚           VibeID Profile (åŸºç¡€è®¾æ–½)             â”‚   â”‚   â”‚
    43â†’â”‚   â”‚   â”‚                                                 â”‚   â”‚   â”‚
    44â†’â”‚   â”‚   â”‚  â€¢ å››ç»´åŸå‹ (Core/Inner/Outer/Shadow)           â”‚   â”‚   â”‚
    45â†’â”‚   â”‚   â”‚  â€¢ 12åŸå‹å¾—åˆ†                                   â”‚   â”‚   â”‚
    46â†’â”‚   â”‚   â”‚  â€¢ æ¯æ—¥ Vibe æ•°æ®                               â”‚   â”‚   â”‚
    47â†’â”‚   â”‚   â”‚  â€¢ æˆé•¿è®°å½•                                     â”‚   â”‚   â”‚
    48â†’â”‚   â”‚   â”‚                                                 â”‚   â”‚   â”‚
    49â†’â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
    50â†’â”‚   â”‚                                                         â”‚   â”‚
    51â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    52â†’â”‚                                                                 â”‚
    53â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    54â†’```
    55â†’
    56â†’**è®¾è®¡ç†ç”±ï¼š**
    57â†’1. **ä½œä¸º Skill**: ç”¨æˆ·å¯é€šè¿‡å¯¹è¯è§¦å‘ VibeID åŠŸèƒ½ï¼ˆ"å¸®æˆ‘ç”Ÿæˆ VibeID"ã€"ä»Šå¤©çš„ Vibe æ€ä¹ˆæ ·"ï¼‰
    58â†’2. **ä½œä¸ºåŸºç¡€è®¾æ–½**: Bazi/Zodiac Skill å¯è¯»å–ç”¨æˆ·çš„ VibeID Profileï¼Œæä¾›æ›´ä¸ªæ€§åŒ–çš„è§£è¯»
    59â†’
    60â†’### 1.2 ç›®å½•ç»“æ„
    61â†’
    62â†’```
    63â†’apps/api/skills/vibeid/
    64â†’â”œâ”€â”€ SKILL.md                    # Skill å®šä¹‰æ–‡æ¡£
    65â†’â”œâ”€â”€ services/
    66â†’â”‚   â”œâ”€â”€ __init__.py
    67â†’â”‚   â”œâ”€â”€ archetype_calculator.py # åŸå‹è®¡ç®—ï¼ˆè°ƒç”¨ bazi/zodiac servicesï¼‰
    68â†’â”‚   â”œâ”€â”€ vibe_calculator.py      # æ¯æ—¥ Vibe å€¼è®¡ç®—
    69â†’â”‚   â”œâ”€â”€ transit_calculator.py   # è¡Œè¿å…±æŒ¯è®¡ç®—
    70â†’â”‚   â”œâ”€â”€ qa_engine.py            # é—®ç­”ç¡®è®¤å¼•æ“
    71â†’â”‚   â””â”€â”€ content_generator.py    # å†…å®¹ç”Ÿæˆï¼ˆå‹‡æ°”é‚€è¯·ã€æ·±åº¦æ—¥ç­‰ï¼‰
    72â†’â”œâ”€â”€ tools/
    73â†’â”‚   â”œâ”€â”€ tools.yaml              # å·¥å…·å®šä¹‰
    74â†’â”‚   â””â”€â”€ handlers.py             # å·¥å…·æ‰§è¡Œå™¨
    75â†’â”œâ”€â”€ scenarios/
    76â†’â”‚   â”œâ”€â”€ create_vibeid.yaml      # åˆ›å»º VibeID åœºæ™¯
    77â†’â”‚   â”œâ”€â”€ daily_vibe.yaml         # æ¯æ—¥ Vibe åœºæ™¯
    78â†’â”‚   â”œâ”€â”€ deep_day.yaml           # æ·±åº¦æ—¥åœºæ™¯
    79â†’â”‚   â”œâ”€â”€ growth_journey.yaml     # æˆé•¿é™ªä¼´åœºæ™¯
    80â†’â”‚   â””â”€â”€ archetype_explore.yaml  # åŸå‹æ¢ç´¢åœºæ™¯
    81â†’â””â”€â”€ reminders.yaml              # æé†’å®šä¹‰ï¼ˆæ¯æ—¥ Vibe æ¨é€ï¼‰
    82â†’
    83â†’apps/api/routes/
    84â†’â””â”€â”€ vibeid.py                   # VibeID ç‹¬ç«‹ APIï¼ˆé chatï¼‰
    85â†’    â”œâ”€â”€ POST /vibeid/create     # åˆ›å»º VibeID
    86â†’    â”œâ”€â”€ GET  /vibeid/profile    # è·å– VibeID Profile
    87â†’    â”œâ”€â”€ GET  /vibeid/daily      # è·å–æ¯æ—¥ Vibe
    88â†’    â”œâ”€â”€ POST /vibeid/qa         # é—®ç­”ç¡®è®¤
    89â†’    â””â”€â”€ POST /vibeid/feedback   # ç”¨æˆ·åé¦ˆ
    90â†’```
    91â†’
    92â†’---
    93â†’
    94â†’## äºŒã€æ•°æ®æ¨¡å‹è®¾è®¡
    95â†’
    96â†’### 2.1 å¤ç”¨ unified_profiles ç°æœ‰æ¶æ„
    97â†’
    98â†’VibeID æ•°æ®å­˜å‚¨åœ¨ `unified_profiles.profile.skill_data.vibeid` è·¯å¾„ä¸‹ï¼Œ**å®Œå…¨å¤ç”¨ç°æœ‰æ¶æ„**ï¼Œæ— éœ€æ–°å¢å­—æ®µã€‚
    99â†’
   100â†’**ç°æœ‰ unified_profiles ç»“æ„ï¼š**
   101â†’```json
   102â†’{
   103â†’  "birth_info": { ... },
   104â†’  "life_context": { ... },
   105â†’  "identity_prism": { ... },
   106â†’  "preferences": { "voice_mode": "warm", "language": "zh-CN" },
   107â†’  "skill_data": {
   108â†’    "bazi": { ... },
   109â†’    "zodiac": { ... },
   110â†’    "vibeid": { ... }  // â† VibeID æ•°æ®å­˜å‚¨ä½ç½®
   111â†’  }
   112â†’}
   113â†’```
   114â†’
   115â†’**VibeID æ•°æ®ç»“æ„ (`profile.skill_data.vibeid`)ï¼š**
   116â†’
   117â†’```json
   118â†’{
   119â†’  "version": "1.0",
   120â†’  "created_at": "2026-01-16T10:00:00Z",
   121â†’  "updated_at": "2026-01-16T10:00:00Z",
   122â†’
   123â†’  "archetypes": {
   124â†’    "core": {
   125â†’      "primary": "Creator",
   126â†’      "secondary": "Outlaw",
   127â†’      "confidence": "high",
   128â†’      "source": {
   129â†’        "bazi_contribution": "Creator",
   130â†’        "sun_contribution": "Outlaw"
   131â†’      }
   132â†’    },
   133â†’    "inner": {
   134â†’      "archetype": "Magician",
   135â†’      "emotional_traits": ["æƒ…æ„Ÿå¼ºçƒˆ", "éœ€è¦æ·±åº¦"]
   136â†’    },
   137â†’    "outer": {
   138â†’      "archetype": "Caregiver",
   139â†’      "social_style": ["æ¸©å’Œ", "ä½“è´´", "ä¿æŠ¤æ€§"]
   140â†’    },
   141â†’    "shadow": {
   142â†’      "primary_tendency": "Regular",
   143â†’      "alternative_tendencies": ["Innocent"],
   144â†’      "confidence": "medium",
   145â†’      "user_confirmed": false
   146â†’    }
   147â†’  },
   148â†’
   149â†’  "archetype_scores": {
   150â†’    "Innocent": 45,
   151â†’    "Explorer": 62,
   152â†’    "Sage": 58,
   153â†’    "Hero": 55,
   154â†’    "Outlaw": 78,
   155â†’    "Magician": 72,
   156â†’    "Regular": 35,
   157â†’    "Lover": 60,
   158â†’    "Jester": 48,
   159â†’    "Caregiver": 65,
   160â†’    "Creator": 85,
   161â†’    "Ruler": 52
   162â†’  },
   163â†’
   164â†’  "layer_consistency": {
   165â†’    "type": "social_adaptation",
   166â†’    "name": "ç¤¾ä¼šé€‚åº”å‹",
   167â†’    "description": "ä½ çš„å†…å¿ƒä¸–ç•Œä¸å¤–åœ¨å‘ˆç°æœ‰æ‰€ä¸åŒ"
   168â†’  },
   169â†’
   170â†’  "growth_data": {
   171â†’    "deep_days_count": 0,
   172â†’    "last_deep_day": null,
   173â†’    "courage_invitations_accepted": 0,
   174â†’    "current_stage": "persona_awareness",
   175â†’    "stage_scores": {
   176â†’      "persona_awareness": 0.3,
   177â†’      "shadow_integration": 0.1,
   178â†’      "energy_balance": 0.2,
   179â†’      "self_realization": 0.1
   180â†’    }
   181â†’  },
   182â†’
   183â†’  "qa_history": [
   184â†’    {
   185â†’      "question_type": "feature_validation",
   186â†’      "target_archetype": "Creator",
   187â†’      "answer": "å¤ªå‡†äº†",
   188â†’      "timestamp": "2026-01-16T10:05:00Z"
   189â†’    }
   190â†’  ]
   191â†’}
   192â†’```
   193â†’
   194â†’**æ•°æ®è®¿é—®æ–¹å¼ï¼ˆå¤ç”¨ç°æœ‰ Repositoryï¼‰ï¼š**
   195â†’
   196â†’```python
   197â†’from stores.unified_profile_repo import UnifiedProfileRepository
   198â†’
   199â†’# è¯»å– VibeID æ•°æ®
   200â†’vibeid = await UnifiedProfileRepository.get_skill_data(user_id, "vibeid")
   201â†’
   202â†’# å†™å…¥ VibeID æ•°æ®
   203â†’await UnifiedProfileRepository.update_skill_data(user_id, "vibeid", vibeid_data)
   204â†’```
   205â†’
   206â†’### 2.2 æ–°å»º daily_vibes è¡¨
   207â†’
   208â†’```sql
   209â†’CREATE TABLE daily_vibes (
   210â†’  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
   211â†’  user_id UUID NOT NULL REFERENCES vibe_users(id),
   212â†’  date DATE NOT NULL,
   213â†’
   214â†’  -- Vibe å€¼
   215â†’  vibe_score INTEGER NOT NULL CHECK (vibe_score >= 0 AND vibe_score <= 100),
   216â†’  energy_zone VARCHAR(20) NOT NULL, -- high_energy/vibrant/stable/reflective/deep
   217â†’
   218â†’  -- è¡Œè¿æ•°æ®
   219â†’  transit JSONB NOT NULL,
   220â†’  -- {
   221â†’  --   "activated_archetype": "Explorer",
   222â†’  --   "resonance_value": 15,
   223â†’  --   "bazi_transit": {"day_gan": "ç”²", "day_zhi": "å­"},
   224â†’  --   "astro_transit": {"moon_sign": "Aries", "major_aspects": [...]}
   225â†’  -- }
   226â†’
   227â†’  -- æ˜¯å¦æ·±åº¦æ—¥
   228â†’  is_deep_day BOOLEAN DEFAULT FALSE,
   229â†’
   230â†’  -- ç”Ÿæˆçš„å†…å®¹
   231â†’  content JSONB NOT NULL,
   232â†’  -- {
   233â†’  --   "greeting": "æ—©å®‰ï¼Œå°æ˜...",
   234â†’  --   "core_message": "...",
   235â†’  --   "courage_invitation": {...},
   236â†’  --   "shadow_content": {...}  -- ä»…æ·±åº¦æ—¥
   237â†’  -- }
   238â†’
   239â†’  -- ç”¨æˆ·åé¦ˆ
   240â†’  user_feedback JSONB DEFAULT NULL,
   241â†’  -- {
   242â†’  --   "mood_rating": 4,
   243â†’  --   "reflection": "...",
   244â†’  --   "courage_action_taken": true
   245â†’  -- }
   246â†’
   247â†’  created_at TIMESTAMP DEFAULT NOW(),
   248â†’
   249â†’  UNIQUE(user_id, date)
   250â†’);
   251â†’
   252â†’-- ç´¢å¼•ä¼˜åŒ–
   253â†’CREATE INDEX idx_daily_vibes_user_date ON daily_vibes(user_id, date DESC);
   254â†’CREATE INDEX idx_daily_vibes_date ON daily_vibes(date);
   255â†’CREATE INDEX idx_daily_vibes_deep_day ON daily_vibes(user_id, is_deep_day) WHERE is_deep_day = TRUE;
   256â†’```
   257â†’
   258â†’### 2.3 è·¨ Skill æ•°æ®è®¿é—®è§„èŒƒ
   259â†’
   260â†’VibeID ä½œä¸ºåŸºç¡€è®¾æ–½ï¼Œå…¶ä»– Skill å¯ä»¥è¯»å–ç”¨æˆ·çš„ VibeID Profile æ¥æä¾›ä¸ªæ€§åŒ–æœåŠ¡ã€‚
   261â†’
   262â†’**è®¿é—®æƒé™çŸ©é˜µï¼š**
   263â†’
   264â†’| Skill | å¯è¯»å–çš„ VibeID å­—æ®µ | ç”¨é€” |
   265â†’|-------|---------------------|------|
   266â†’| bazi | `archetypes.core`, `archetype_scores` | åŸºäºåŸå‹ä¸ªæ€§åŒ–è§£è¯» |
   267â†’| zodiac | `archetypes.core`, `archetypes.inner` | ç»“åˆæœˆäº®åŸå‹è§£è¯»æƒ…æ„Ÿ |
   268â†’| tarot | `archetypes.shadow`, `growth_data` | é˜´å½±æ•´åˆå¼•å¯¼ |
   269â†’| career | `archetypes.core`, `layer_consistency` | èŒä¸šåŒ¹é…å»ºè®® |
   270â†’
   271â†’**ç³»ç»Ÿçº§è®¿é—®æ¥å£ï¼š**
   272â†’
   273â†’```python
   274â†’# services/agent/skill_loader.py ä¸­æ·»åŠ 
   275â†’
   276â†’async def get_vibeid_for_skill(user_id: UUID, skill: str) -> Optional[Dict]:
   277â†’    """
   278â†’    è·å–å½“å‰ç”¨æˆ·çš„ VibeID æ•°æ®ï¼ˆä¾›å…¶ä»– Skill ä½¿ç”¨ï¼‰
   279â†’
   280â†’    æ ¹æ® skill ç±»å‹è¿”å›å…è®¸è®¿é—®çš„å­—æ®µå­é›†
   281â†’    """
   282â†’    vibeid = await UnifiedProfileRepository.get_skill_data(user_id, "vibeid")
   283â†’    if not vibeid:
   284â†’        return None
   285â†’
   286â†’    # å®šä¹‰å„ Skill å¯è®¿é—®çš„å­—æ®µ
   287â†’    SKILL_ACCESS_RULES = {
   288â†’        "bazi": ["archetypes.core", "archetype_scores"],
   289â†’        "zodiac": ["archetypes.core", "archetypes.inner"],
   290â†’        "tarot": ["archetypes.shadow", "growth_data"],
   291â†’        "career": ["archetypes.core", "layer_consistency"],
   292â†’    }
   293â†’
   294â†’    allowed_fields = SKILL_ACCESS_RULES.get(skill, [])
   295â†’    return filter_vibeid_fields(vibeid, allowed_fields)
   296â†’```
   297â†’
   298â†’**åœ¨ Skill System Prompt ä¸­æ³¨å…¥ VibeID ä¸Šä¸‹æ–‡ï¼š**
   299â†’
   300â†’```python
   301â†’# skill_loader.py build_system_prompt() ä¸­
   302â†’
   303â†’if user_vibeid := await get_vibeid_for_skill(user_id, skill):
   304â†’    context_parts.append(f"""
   305â†’## ç”¨æˆ·äººæ ¼ç”»åƒ (VibeID)
   306â†’- çµé­‚åŸå‹: {user_vibeid['archetypes']['core']['primary']}
   307â†’- æ¬¡è¦èƒ½é‡: {user_vibeid['archetypes']['core'].get('secondary', 'æ— ')}
   308â†’
   309â†’è¯·åœ¨è§£è¯»ä¸­èå…¥ç”¨æˆ·çš„åŸå‹ç‰¹è´¨ï¼Œæä¾›æ›´ä¸ªæ€§åŒ–çš„å»ºè®®ã€‚
   310â†’""")
   311â†’```
   312â†’
   313â†’---
   314â†’
   315â†’## ä¸‰ã€æ ¸å¿ƒæœåŠ¡å®ç°
   316â†’
   317â†’### 3.1 åŸå‹è®¡ç®—æœåŠ¡
   318â†’
   319â†’**æ–‡ä»¶**: `apps/api/skills/vibeid/services/archetype_calculator.py`
   320â†’
   321â†’```python
   322â†’from typing import Dict, Any
   323â†’from dataclasses import dataclass
   324â†’from enum import Enum
   325â†’
   326â†’# å¤ç”¨ç°æœ‰è®¡ç®—æœåŠ¡
   327â†’from skills.bazi.services import BaziCalculator
   328â†’from skills.zodiac.services import ZodiacCalculator
   329â†’
   330â†’
   331â†’class ArchetypeType(str, Enum):
   332â†’    INNOCENT = "Innocent"
   333â†’    EXPLORER = "Explorer"
   334â†’    SAGE = "Sage"
   335â†’    HERO = "Hero"
   336â†’    OUTLAW = "Outlaw"
   337â†’    MAGICIAN = "Magician"
   338â†’    REGULAR = "Regular"
   339â†’    LOVER = "Lover"
   340â†’    JESTER = "Jester"
   341â†’    CAREGIVER = "Caregiver"
   342â†’    CREATOR = "Creator"
   343â†’    RULER = "Ruler"
   344â†’
   345â†’
   346â†’# å…«å­—æ ¼å±€ â†’ åŸå‹æ˜ å°„
   347â†’BAZI_PATTERN_MAPPING = {
   348â†’    "æ­£å®˜æ ¼": (ArchetypeType.RULER, ArchetypeType.HERO),
   349â†’    "ä¸ƒæ€æ ¼": (ArchetypeType.HERO, ArchetypeType.OUTLAW),
   350â†’    "æ­£å°æ ¼": (ArchetypeType.SAGE, ArchetypeType.CAREGIVER),
   351â†’    "åå°æ ¼": (ArchetypeType.MAGICIAN, ArchetypeType.SAGE),
   352â†’    "æ¯”è‚©æ ¼": (ArchetypeType.REGULAR, ArchetypeType.HERO),
   353â†’    "åŠ«è´¢æ ¼": (ArchetypeType.OUTLAW, ArchetypeType.EXPLORER),
   354â†’    "é£Ÿç¥æ ¼": (ArchetypeType.JESTER, ArchetypeType.CREATOR),
   355â†’    "ä¼¤å®˜æ ¼": (ArchetypeType.CREATOR, ArchetypeType.OUTLAW),
   356â†’    "æ­£è´¢æ ¼": (ArchetypeType.REGULAR, ArchetypeType.RULER),
   357â†’    "åè´¢æ ¼": (ArchetypeType.EXPLORER, ArchetypeType.LOVER),
   358â†’}
   359â†’
   360â†’# å¤ªé˜³æ˜Ÿåº§ â†’ åŸå‹æ˜ å°„
   361â†’SUN_SIGN_MAPPING = {
   362â†’    "Aries": (ArchetypeType.HERO, ArchetypeType.EXPLORER),
   363â†’    "Taurus": (ArchetypeType.REGULAR, ArchetypeType.LOVER),
   364â†’    "Gemini": (ArchetypeType.JESTER, ArchetypeType.SAGE),
   365â†’    "Cancer": (ArchetypeType.CAREGIVER, ArchetypeType.LOVER),
   366â†’    "Leo": (ArchetypeType.RULER, ArchetypeType.CREATOR),
   367â†’    "Virgo": (ArchetypeType.SAGE, ArchetypeType.CAREGIVER),
   368â†’    "Libra": (ArchetypeType.LOVER, ArchetypeType.REGULAR),
   369â†’    "Scorpio": (ArchetypeType.MAGICIAN, ArchetypeType.OUTLAW),
   370â†’    "Sagittarius": (ArchetypeType.EXPLORER, ArchetypeType.SAGE),
   371â†’    "Capricorn": (ArchetypeType.RULER, ArchetypeType.HERO),
   372â†’    "Aquarius": (ArchetypeType.OUTLAW, ArchetypeType.MAGICIAN),
   373â†’    "Pisces": (ArchetypeType.INNOCENT, ArchetypeType.LOVER),
   374â†’}
   375â†’
   376â†’# æœˆäº®æ˜Ÿåº§ â†’ Inner åŸå‹æ˜ å°„
   377â†’MOON_SIGN_MAPPING = {
   378â†’    "Aries": ArchetypeType.HERO,
   379â†’    "Taurus": ArchetypeType.REGULAR,
   380â†’    "Gemini": ArchetypeType.JESTER,
   381â†’    "Cancer": ArchetypeType.CAREGIVER,
   382â†’    "Leo": ArchetypeType.CREATOR,
   383â†’    "Virgo": ArchetypeType.SAGE,
   384â†’    "Libra": ArchetypeType.LOVER,
   385â†’    "Scorpio": ArchetypeType.MAGICIAN,
   386â†’    "Sagittarius": ArchetypeType.EXPLORER,
   387â†’    "Capricorn": ArchetypeType.RULER,
   388â†’    "Aquarius": ArchetypeType.OUTLAW,
   389â†’    "Pisces": ArchetypeType.INNOCENT,
   390â†’}
   391â†’
   392â†’# Shadow å¯¹åº”å…³ç³»
   393â†’SHADOW_MAPPING = {
   394â†’    ArchetypeType.INNOCENT: ArchetypeType.HERO,
   395â†’    ArchetypeType.HERO: ArchetypeType.INNOCENT,
   396â†’    ArchetypeType.SAGE: ArchetypeType.JESTER,
   397â†’    ArchetypeType.JESTER: ArchetypeType.SAGE,
   398â†’    ArchetypeType.CAREGIVER: ArchetypeType.EXPLORER,
   399â†’    ArchetypeType.EXPLORER: ArchetypeType.CAREGIVER,
   400â†’    ArchetypeType.CREATOR: ArchetypeType.REGULAR,
   401â†’    ArchetypeType.REGULAR: ArchetypeType.CREATOR,
   402â†’    ArchetypeType.LOVER: ArchetypeType.MAGICIAN,
   403â†’    ArchetypeType.MAGICIAN: ArchetypeType.LOVER,
   404â†’    ArchetypeType.RULER: ArchetypeType.OUTLAW,
   405â†’    ArchetypeType.OUTLAW: ArchetypeType.RULER,
   406â†’}
   407â†’
   408â†’
   409â†’@dataclass
   410â†’class VibeIDResult:
   411â†’    """VibeID è®¡ç®—ç»“æœ"""
   412â†’    archetypes: Dict[str, Any]
   413â†’    archetype_scores: Dict[str, int]
   414â†’    layer_consistency: Dict[str, str]
   415â†’    bazi_data: Dict[str, Any]
   416â†’    natal_chart: Dict[str, Any]
   417â†’
   418â†’
   419â†’class ArchetypeCalculator:
   420â†’    """åŸå‹è®¡ç®—å™¨ - èåˆå…«å­—å’Œæ˜Ÿåº§"""
   421â†’
   422â†’    def __init__(self):
   423â†’        self.bazi_calculator = BaziCalculator()
   424â†’        self.zodiac_calculator = ZodiacCalculator()
   425â†’
   426â†’    async def calculate(
   427â†’        self,
   428â†’        birth_year: int,
   429â†’        birth_month: int,
   430â†’        birth_day: int,
   431â†’        birth_hour: int = 12,
   432â†’        birth_minute: int = 0,
   433â†’        birth_city: str = "åŒ—äº¬",
   434â†’        gender: str = "male"
   435â†’    ) -> VibeIDResult:
   436â†’        """è®¡ç®—å®Œæ•´çš„ VibeID"""
   437â†’
   438â†’        # 1. è°ƒç”¨å…«å­—è®¡ç®—
   439â†’        bazi_data = await self._calculate_bazi(
   440â†’            birth_year, birth_month, birth_day, birth_hour, gender
   441â†’        )
   442â†’
   443â†’        # 2. è°ƒç”¨æ˜Ÿç›˜è®¡ç®—
   444â†’        natal_chart = await self._calculate_natal_chart(
   445â†’            birth_year, birth_month, birth_day,
   446â†’            birth_hour, birth_minute, birth_city
   447â†’        )
   448â†’
   449â†’        # 3. è®¡ç®— Core åŸå‹ (å…«å­— 60% + å¤ªé˜³ 40%)
   450â†’        core = self._calculate_core(bazi_data, natal_chart)
   451â†’
   452â†’        # 4. è®¡ç®— Inner åŸå‹ (æœˆäº®æ˜Ÿåº§)
   453â†’        inner = self._calculate_inner(natal_chart)
   454â†’
   455â†’        # 5. è®¡ç®— Outer åŸå‹ (ä¸Šå‡æ˜Ÿåº§)
   456â†’        outer = self._calculate_outer(natal_chart)
   457â†’
   458â†’        # 6. è®¡ç®— Shadow åŸå‹
   459â†’        shadow = self._calculate_shadow(core["primary"])
   460â†’
   461â†’        # 7. è®¡ç®— 12 åŸå‹å¾—åˆ†
   462â†’        archetype_scores = self._calculate_all_scores(bazi_data, natal_chart)
   463â†’
   464â†’        # 8. åˆ†æå±‚é—´ä¸€è‡´æ€§
   465â†’        layer_consistency = self._analyze_layer_consistency(
   466â†’            core["primary"], inner["archetype"], outer["archetype"]
   467â†’        )
   468â†’
   469â†’        return VibeIDResult(
   470â†’            archetypes={
   471â†’                "core": core,
   472â†’                "inner": inner,
   473â†’                "outer": outer,
   474â†’                "shadow": shadow
   475â†’            },
   476â†’            archetype_scores=archetype_scores,
   477â†’            layer_consistency=layer_consistency,
   478â†’            bazi_data=bazi_data,
   479â†’            natal_chart=natal_chart
   480â†’        )
   481â†’
   482â†’    def _calculate_core(self, bazi_data: Dict, natal_chart: Dict) -> Dict:
   483â†’        """è®¡ç®— Core åŸå‹ (å…«å­— 60% + å¤ªé˜³ 40%)"""
   484â†’        pattern = bazi_data.get("pattern", "æ¯”è‚©æ ¼")
   485â†’        bazi_primary, bazi_secondary = BAZI_PATTERN_MAPPING.get(
   486â†’            pattern, (ArchetypeType.REGULAR, ArchetypeType.HERO)
   487â†’        )
   488â†’
   489â†’        sun_sign = natal_chart.get("sun_sign", "Aries")
   490â†’        sun_primary, sun_secondary = SUN_SIGN_MAPPING.get(
   491â†’            sun_sign, (ArchetypeType.HERO, ArchetypeType.EXPLORER)
   492â†’        )
   493â†’
   494â†’        if bazi_primary == sun_primary:
   495â†’            return {
   496â†’                "primary": bazi_primary.value,
   497â†’                "secondary": bazi_secondary.value,
   498â†’                "confidence": "high",
   499â†’                "source": {
   500â†’                    "bazi_contribution": bazi_primary.value,
   501â†’                    "sun_contribution": sun_primary.value
   502â†’                }
   503â†’            }
   504â†’        else:
   505â†’            return {
   506â†’                "primary": bazi_primary.value,
   507â†’                "secondary": sun_primary.value,
   508â†’                "confidence": "medium",
   509â†’                "source": {
   510â†’                    "bazi_contribution": bazi_primary.value,
   511â†’                    "sun_contribution": sun_primary.value
   512â†’                }
   513â†’            }
   514â†’
   515â†’    def _calculate_inner(self, natal_chart: Dict) -> Dict:
   516â†’        """è®¡ç®— Inner åŸå‹ (æœˆäº®æ˜Ÿåº§)"""
   517â†’        moon_sign = natal_chart.get("moon_sign", "Cancer")
   518â†’        archetype = MOON_SIGN_MAPPING.get(moon_sign, ArchetypeType.CAREGIVER)
   519â†’        return {
   520â†’            "archetype": archetype.value,
   521â†’            "emotional_traits": self._get_emotional_traits(archetype)
   522â†’        }
   523â†’
   524â†’    def _calculate_outer(self, natal_chart: Dict) -> Dict:
   525â†’        """è®¡ç®— Outer åŸå‹ (ä¸Šå‡æ˜Ÿåº§)"""
   526â†’        rising_sign = natal_chart.get("rising_sign", "Libra")
   527â†’        archetype = MOON_SIGN_MAPPING.get(rising_sign, ArchetypeType.LOVER)
   528â†’        return {
   529â†’            "archetype": archetype.value,
   530â†’            "social_style": self._get_social_style(archetype)
   531â†’        }
   532â†’
   533â†’    def _calculate_shadow(self, core_primary: str) -> Dict:
   534â†’        """è®¡ç®— Shadow åŸå‹"""
   535â†’        core_type = ArchetypeType(core_primary)
   536â†’        shadow_type = SHADOW_MAPPING.get(core_type, ArchetypeType.REGULAR)
   537â†’        return {
   538â†’            "primary_tendency": shadow_type.value,
   539â†’            "alternative_tendencies": [],
   540â†’            "confidence": "medium",
   541â†’            "user_confirmed": False
   542â†’        }
   543â†’
   544â†’    def _analyze_layer_consistency(
   545â†’        self, core: str, inner: str, outer: str
   546â†’    ) -> Dict[str, str]:
   547â†’        """åˆ†æå±‚é—´ä¸€è‡´æ€§"""
   548â†’        if core == inner == outer:
   549â†’            return {
   550â†’                "type": "highly_integrated",
   551â†’                "name": "é«˜åº¦æ•´åˆå‹",
   552â†’                "description": "ä½ çš„å†…å¤–é«˜åº¦ç»Ÿä¸€ï¼Œå±•ç°å‡ºçœŸå®ä¸€è‡´çš„è‡ªæˆ‘"
   553â†’            }
   554â†’        elif core == inner and inner != outer:
   555â†’            return {
   556â†’                "type": "social_adaptation",
   557â†’                "name": "ç¤¾ä¼šé€‚åº”å‹",
   558â†’                "description": "ä½ çš„å†…å¿ƒä¸–ç•Œä¸å¤–åœ¨å‘ˆç°æœ‰æ‰€ä¸åŒ"
   559â†’            }
   560â†’        elif core != inner:
   561â†’            return {
   562â†’                "type": "self_perception_gap",
   563â†’                "name": "è‡ªæˆ‘è®¤çŸ¥åå·®å‹",
   564â†’                "description": "ä½ çš„è‡ªæˆ‘è®¤çŸ¥ä¸æ·±å±‚é©±åŠ¨å­˜åœ¨å·®å¼‚"
   565â†’            }
   566â†’        else:
   567â†’            return {
   568â†’                "type": "complex",
   569â†’                "name": "å¤æ‚å‹",
   570â†’                "description": "ä½ çš„äººæ ¼ç»“æ„ä¸°å¯Œå¤šå…ƒ"
   571â†’            }
   572â†’```
   573â†’
   574â†’### 3.2 æ¯æ—¥ Vibe è®¡ç®—æœåŠ¡
   575â†’
   576â†’**æ–‡ä»¶**: `apps/api/skills/vibeid/services/vibe_calculator.py`
   577â†’
   578â†’```python
   579â†’from datetime import date
   580â†’from typing import Dict, Any
   581â†’
   582â†’from .archetype_calculator import ArchetypeType, SHADOW_MAPPING
   583â†’
   584â†’
   585â†’class VibeCalculator:
   586â†’    """æ¯æ—¥ Vibe å€¼è®¡ç®—å™¨"""
   587â†’
   588â†’    def calculate_daily_vibe(
   589â†’        self,
   590â†’        user_vibeid: Dict[str, Any],
   591â†’        target_date: date
   592â†’    ) -> Dict[str, Any]:
   593â†’        """è®¡ç®—æŒ‡å®šæ—¥æœŸçš„ Vibe å€¼"""
   594â†’
   595â†’        # 1. è®¡ç®—è¡Œè¿
   596â†’        transit = self._calculate_transit(target_date)
   597â†’
   598â†’        # 2. è®¡ç®—å…±æŒ¯å€¼
   599â†’        resonance = self._calculate_resonance(
   600â†’            user_core=user_vibeid["archetypes"]["core"]["primary"],
   601â†’            user_shadow=user_vibeid["archetypes"]["shadow"]["primary_tendency"],
   602â†’            activated_archetype=transit["activated_archetype"]
   603â†’        )
   604â†’
   605â†’        # 3. åˆ¤æ–­æ˜¯å¦æ·±åº¦æ—¥
   606â†’        is_deep_day = self._should_trigger_deep_day(
   607â†’            user_vibeid, transit["activated_archetype"], target_date
   608â†’        )
   609â†’
   610â†’        # 4. è®¡ç®—æœ€ç»ˆ Vibe å€¼
   611â†’        vibe_score = 50 + resonance
   612â†’        vibe_score = max(0, min(100, vibe_score))
   613â†’
   614â†’        # 5. ç¡®å®šèƒ½é‡åŒºé—´
   615â†’        energy_zone = self._get_energy_zone(vibe_score, is_deep_day)
   616â†’
   617â†’        return {
   618â†’            "date": target_date.isoformat(),
   619â†’            "vibe_score": vibe_score,
   620â†’            "energy_zone": energy_zone["zone"],
   621â†’            "energy_name": energy_zone["name"],
   622â†’            "transit": transit,
   623â†’            "resonance_value": resonance,
   624â†’            "is_deep_day": is_deep_day
   625â†’        }
   626â†’
   627â†’    def _get_energy_zone(self, score: int, is_deep_day: bool) -> Dict[str, str]:
   628â†’        """ç¡®å®šèƒ½é‡åŒºé—´"""
   629â†’        if is_deep_day:
   630â†’            return {"zone": "deep", "name": "æ·±åº¦æ—¥", "color": "#6B46C1"}
   631â†’        elif score >= 80:
   632â†’            return {"zone": "high_energy", "name": "é«˜èƒ½é‡", "color": "#F59E0B"}
   633â†’        elif score >= 60:
   634â†’            return {"zone": "vibrant", "name": "æ´»åŠ›æœŸ", "color": "#10B981"}
   635â†’        elif score >= 40:
   636â†’            return {"zone": "stable", "name": "å¹³ç¨³æœŸ", "color": "#3B82F6"}
   637â†’        else:
   638â†’            return {"zone": "reflective", "name": "å†…çœæœŸ", "color": "#8B5CF6"}
   639â†’```
   640â†’
   641â†’### 3.3 é—®ç­”ç¡®è®¤å¼•æ“
   642â†’
   643â†’**æ–‡ä»¶**: `apps/api/skills/vibeid/services/qa_engine.py`
   644â†’
   645â†’```python
   646â†’from typing import Dict, Any, List, Optional
   647â†’from dataclasses import dataclass
   648â†’from enum import Enum
   649â†’
   650â†’
   651â†’class QuestionType(str, Enum):
   652â†’    CORE_VALIDATION = "core_validation"      # CoreåŸå‹éªŒè¯
   653â†’    SHADOW_SELECTION = "shadow_selection"    # Shadowé€‰æ‹©
   654â†’    FEATURE_VALIDATION = "feature_validation" # ç‰¹å¾éªŒè¯
   655â†’    LAYER_CONSISTENCY = "layer_consistency"  # å±‚é—´ä¸€è‡´æ€§ç¡®è®¤
   656â†’
   657â†’
   658â†’@dataclass
   659â†’class MagicQuestion:
   660â†’    """é­”æ³•é—®é¢˜"""
   661â†’    question_type: QuestionType
   662â†’    question_text: str
   663â†’    options: List[Dict[str, Any]]
   664â†’    target_archetype: Optional[str] = None
   665â†’
   666â†’
   667â†’class QAEngine:
   668â†’    """é—®ç­”ç¡®è®¤å¼•æ“"""
   669â†’
   670â†’    def generate_core_validation_question(
   671â†’        self,
   672â†’        core_archetype: str,
   673â†’        confidence: str
   674â†’    ) -> MagicQuestion:
   675â†’        """ç”Ÿæˆ Core åŸå‹éªŒè¯é—®é¢˜"""
   676â†’
   677â†’        archetype_questions = {
   678â†’            "Creator": {
   679â†’                "question": "å½“ä½ æœ‰ä¸€ä¸ªåˆ›æ„æƒ³æ³•æ—¶ï¼Œä½ é€šå¸¸ä¼šï¼š",
   680â†’                "options": [
   681â†’                    {"label": "ç«‹åˆ»å¼€å§‹è¡ŒåŠ¨ï¼Œè¾¹åšè¾¹æƒ³", "score": 3},
   682â†’                    {"label": "å…ˆè§„åˆ’å¥½å†åŠ¨æ‰‹", "score": 2},
   683â†’                    {"label": "ç­‰å¾…åˆé€‚çš„æ—¶æœºå’Œèµ„æº", "score": 1},
   684â†’                    {"label": "å¯»æ±‚ä»–äººçš„æ„è§å’Œæ”¯æŒ", "score": 0}
   685â†’                ]
   686â†’            },
   687â†’            "Explorer": {
   688â†’                "question": "é¢å¯¹æœªçŸ¥çš„é¢†åŸŸï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼š",
   689â†’                "options": [
   690â†’                    {"label": "å…´å¥‹ï¼è¿™æ˜¯æ¢ç´¢çš„å¥½æœºä¼š", "score": 3},
   691â†’                    {"label": "å¥½å¥‡ä½†ä¼šå…ˆåšäº›è°ƒç ”", "score": 2},
   692â†’                    {"label": "æœ‰äº›ç´§å¼ ï¼Œéœ€è¦å‡†å¤‡å……åˆ†", "score": 1},
   693â†’                    {"label": "å€¾å‘äºå¾…åœ¨èˆ’é€‚åŒº", "score": 0}
   694â†’                ]
   695â†’            },
   696â†’            # ... å…¶ä»–åŸå‹çš„é—®é¢˜
   697â†’        }
   698â†’
   699â†’        q = archetype_questions.get(core_archetype, archetype_questions["Creator"])
   700â†’
   701â†’        return MagicQuestion(
   702â†’            question_type=QuestionType.CORE_VALIDATION,
   703â†’            question_text=q["question"],
   704â†’            options=q["options"],
   705â†’            target_archetype=core_archetype
   706â†’        )
   707â†’
   708â†’    def generate_shadow_selection_question(
   709â†’        self,
   710â†’        shadow_candidates: List[str]
   711â†’    ) -> MagicQuestion:
   712â†’        """ç”Ÿæˆ Shadow é€‰æ‹©é—®é¢˜"""
   713â†’
   714â†’        return MagicQuestion(
   715â†’            question_type=QuestionType.SHADOW_SELECTION,
   716â†’            question_text="åœ¨å‹åŠ›æˆ–å›°å¢ƒä¸­ï¼Œä½ æœ€å®¹æ˜“å‡ºç°å“ªç§å€¾å‘ï¼Ÿ",
   717â†’            options=[
   718â†’                {
   719â†’                    "label": self._get_shadow_label(candidate),
   720â†’                    "archetype": candidate
   721â†’                }
   722â†’                for candidate in shadow_candidates[:4]
   723â†’            ]
   724â†’        )
   725â†’
   726â†’    def process_answer(
   727â†’        self,
   728â†’        question: MagicQuestion,
   729â†’        user_answer: Dict[str, Any],
   730â†’        current_vibeid: Dict[str, Any]
   731â†’    ) -> Dict[str, Any]:
   732â†’        """å¤„ç†ç”¨æˆ·å›ç­”ï¼Œè¿”å›è°ƒæ•´åçš„ VibeID"""
   733â†’
   734â†’        if question.question_type == QuestionType.CORE_VALIDATION:
   735â†’            return self._process_core_validation(
   736â†’                question, user_answer, current_vibeid
   737â†’            )
   738â†’        elif question.question_type == QuestionType.SHADOW_SELECTION:
   739â†’            return self._process_shadow_selection(
   740â†’                question, user_answer, current_vibeid
   741â†’            )
   742â†’
   743â†’        return current_vibeid
   744â†’```
   745â†’
   746â†’---
   747â†’
   748â†’## å››ã€å·¥å…·å®šä¹‰
   749â†’
   750â†’**æ–‡ä»¶**: `apps/api/skills/vibeid/tools/tools.yaml`
   751â†’
   752â†’```yaml
   753â†’tools:
   754â†’  - name: create_vibeid
   755â†’    description: ä¸ºç”¨æˆ·åˆ›å»º VibeID äººæ ¼ç”»åƒ
   756â†’    parameters:
   757â†’      type: object
   758â†’      properties:
   759â†’        birth_year:
   760â†’          type: integer
   761â†’          description: å‡ºç”Ÿå¹´ä»½
   762â†’        birth_month:
   763â†’          type: integer
   764â†’          description: å‡ºç”Ÿæœˆä»½
   765â†’        birth_day:
   766â†’          type: integer
   767â†’          description: å‡ºç”Ÿæ—¥æœŸ
   768â†’        birth_hour:
   769â†’          type: integer
   770â†’          description: å‡ºç”Ÿæ—¶è¾°ï¼ˆ0-23ï¼‰
   771â†’        birth_minute:
   772â†’          type: integer
   773â†’          description: å‡ºç”Ÿåˆ†é’Ÿ
   774â†’        birth_city:
   775â†’          type: string
   776â†’          description: å‡ºç”ŸåŸå¸‚
   777â†’        gender:
   778â†’          type: string
   779â†’          enum: [male, female]
   780â†’          description: æ€§åˆ«
   781â†’      required: [birth_year, birth_month, birth_day]
   782â†’
   783â†’  - name: get_daily_vibe
   784â†’    description: è·å–ç”¨æˆ·ä»Šæ—¥çš„ Vibe å€¼å’Œèƒ½é‡çŠ¶æ€
   785â†’    parameters:
   786â†’      type: object
   787â†’      properties:
   788â†’        date:
   789â†’          type: string
   790â†’          format: date
   791â†’          description: æ—¥æœŸï¼ˆé»˜è®¤ä»Šå¤©ï¼‰
   792â†’
   793â†’  - name: show_vibeid_card
   794â†’    description: å±•ç¤ºç”¨æˆ·çš„ VibeID å¡ç‰‡
   795â†’    parameters:
   796â†’      type: object
   797â†’      properties:
   798â†’        style:
   799â†’          type: string
   800â†’          enum: [full, mini, share]
   801â†’          description: å¡ç‰‡æ ·å¼
   802â†’
   803â†’  - name: ask_magic_question
   804â†’    description: å‘ç”¨æˆ·æå‡ºé­”æ³•é—®é¢˜è¿›è¡Œç¡®è®¤
   805â†’    parameters:
   806â†’      type: object
   807â†’      properties:
   808â†’        question_type:
   809â†’          type: string
   810â†’          enum: [core_validation, shadow_selection, feature_validation]
   811â†’        context:
   812â†’          type: string
   813â†’          description: é—®é¢˜ä¸Šä¸‹æ–‡
   814â†’
   815â†’  - name: trigger_courage_invitation
   816â†’    description: å‘èµ·å‹‡æ°”é‚€è¯·
   817â†’    parameters:
   818â†’      type: object
   819â†’      properties:
   820â†’        invitation_type:
   821â†’          type: string
   822â†’          enum: [daily, deep_day, growth]
   823â†’        archetype_focus:
   824â†’          type: string
   825â†’          description: èšç„¦çš„åŸå‹
   826â†’
   827â†’  - name: record_growth_action
   828â†’    description: è®°å½•ç”¨æˆ·çš„æˆé•¿è¡ŒåŠ¨
   829â†’    parameters:
   830â†’      type: object
   831â†’      properties:
   832â†’        action_type:
   833â†’          type: string
   834â†’          enum: [courage_taken, reflection_done, shadow_acknowledged]
   835â†’        description:
   836â†’          type: string
   837â†’        archetype:
   838â†’          type: string
   839â†’```
   840â†’
   841â†’---
   842â†’
   843â†’## äº”ã€åœºæ™¯å®šä¹‰
   844â†’
   845â†’### 5.1 åˆ›å»º VibeID åœºæ™¯
   846â†’
   847â†’**æ–‡ä»¶**: `apps/api/skills/vibeid/scenarios/create_vibeid.yaml`
   848â†’
   849â†’```yaml
   850â†’name: create_vibeid
   851â†’trigger:
   852â†’  keywords:
   853â†’    - åˆ›å»ºvibeid
   854â†’    - ç”Ÿæˆæˆ‘çš„äººæ ¼
   855â†’    - å¸®æˆ‘ç®—ç®—
   856â†’    - æˆ‘æƒ³äº†è§£è‡ªå·±
   857â†’  intent: create_personality_profile
   858â†’
   859â†’flow:
   860â†’  - step: collect_birth_info
   861â†’    prompt: |
   862â†’      æˆ‘æ¥å¸®ä½ åˆ›å»ºä¸“å±çš„ VibeID äººæ ¼ç”»åƒï¼
   863â†’
   864â†’      ä¸ºäº†å‡†ç¡®è®¡ç®—ï¼Œæˆ‘éœ€è¦çŸ¥é“ä½ çš„å‡ºç”Ÿä¿¡æ¯ï¼š
   865â†’      - å‡ºç”Ÿæ—¥æœŸï¼ˆå¹´æœˆæ—¥ï¼‰
   866â†’      - å‡ºç”Ÿæ—¶é—´ï¼ˆå¦‚æœçŸ¥é“çš„è¯ï¼‰
   867â†’      - å‡ºç”ŸåŸå¸‚
   868â†’    required_fields: [birth_year, birth_month, birth_day]
   869â†’
   870â†’  - step: calculate_vibeid
   871â†’    action: create_vibeid
   872â†’
   873â†’  - step: present_core
   874â†’    prompt: |
   875â†’      ğŸ­ ä½ çš„çµé­‚åŸå‹æ˜¯ **{core.primary}**
   876â†’
   877â†’      {core_description}
   878â†’
   879â†’      {if core.confidence == "medium"}
   880â†’      æˆ‘æ³¨æ„åˆ°ä½ çš„å…«å­—å’Œæ˜Ÿç›˜æ˜¾ç¤ºäº†ä¸€äº›ä¸åŒçš„ç‰¹è´¨ï¼Œ
   881â†’      è®©æˆ‘é—®ä½ ä¸€ä¸ªé—®é¢˜æ¥ç¡®è®¤...
   882â†’      {/if}
   883â†’
   884â†’  - step: magic_question
   885â†’    condition: core.confidence != "high"
   886â†’    action: ask_magic_question
   887â†’    params:
   888â†’      question_type: core_validation
   889â†’
   890â†’  - step: present_full
   891â†’    action: show_vibeid_card
   892â†’    params:
   893â†’      style: full
   894â†’
   895â†’  - step: shadow_intro
   896â†’    prompt: |
   897â†’      æ¯ä¸ªäººéƒ½æœ‰é˜´å½±é¢ã€‚ä½ çš„é˜´å½±å€¾å‘æ˜¯ **{shadow.primary_tendency}**ã€‚
   898â†’
   899â†’      è¿™ä¸æ˜¯"å"çš„ä¸€é¢ï¼Œè€Œæ˜¯ä½ å°šæœªå……åˆ†å‘å±•çš„æ½œåŠ›ã€‚
   900â†’
   901â†’      æƒ³è¦äº†è§£æ›´å¤šå—ï¼Ÿ
   902â†’```
   903â†’
   904â†’### 5.2 æ¯æ—¥ Vibe åœºæ™¯
   905â†’
   906â†’**æ–‡ä»¶**: `apps/api/skills/vibeid/scenarios/daily_vibe.yaml`
   907â†’
   908â†’```yaml
   909â†’name: daily_vibe
   910â†’trigger:
   911â†’  keywords:
   912â†’    - ä»Šå¤©çš„vibe
   913â†’    - ä»Šæ—¥è¿åŠ¿
   914â†’    - ä»Šå¤©æ€ä¹ˆæ ·
   915â†’  schedule:
   916â†’    time: "08:00"
   917â†’    timezone: user_timezone
   918â†’
   919â†’flow:
   920â†’  - step: calculate_daily
   921â†’    action: get_daily_vibe
   922â†’
   923â†’  - step: present_vibe
   924â†’    template: |
   925â†’      {greeting}, {user_name}ï¼
   926â†’
   927â†’      ğŸ“Š ä»Šæ—¥ Vibe å€¼ï¼š**{vibe_score}**
   928â†’      ğŸŒˆ èƒ½é‡çŠ¶æ€ï¼š**{energy_name}**
   929â†’
   930â†’      {if is_deep_day}
   931â†’      âš¡ ä»Šå¤©æ˜¯ä½ çš„ **æ·±åº¦æ—¥**
   932â†’
   933â†’      å½“å‰è¡Œè¿æ¿€æ´»äº†ä½ çš„ {shadow.primary_tendency} èƒ½é‡ã€‚
   934â†’      è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šå»è§‰å¯Ÿå’Œæ•´åˆè¿™éƒ¨åˆ†è‡ªå·±ã€‚
   935â†’
   936â†’      {shadow_guidance}
   937â†’      {else}
   938â†’      ä»Šå¤©çš„å®‡å®™èƒ½é‡æ¿€æ´»äº† **{transit.activated_archetype}** åŸå‹ã€‚
   939â†’
   940â†’      {daily_guidance}
   941â†’      {/if}
   942â†’
   943â†’  - step: courage_invitation
   944â†’    action: trigger_courage_invitation
   945â†’    params:
   946â†’      invitation_type: daily
   947â†’```
   948â†’
   949â†’### 5.3 æ·±åº¦æ—¥åœºæ™¯
   950â†’
   951â†’**æ–‡ä»¶**: `apps/api/skills/vibeid/scenarios/deep_day.yaml`
   952â†’
   953â†’```yaml
   954â†’name: deep_day
   955â†’trigger:
   956â†’  condition: is_deep_day == true
   957â†’
   958â†’content:
   959â†’  opening:
   960â†’    template: |
   961â†’      ğŸŒ™ ä»Šå¤©æ˜¯ä½ çš„ **æ·±åº¦æ—¥**
   962â†’
   963â†’      è¿™æ˜¯ä¸€ä¸ªå‘å†…æ¢ç´¢çš„ç‰¹æ®Šæ—¶åˆ»ã€‚
   964â†’      å½“å‰çš„å®‡å®™èƒ½é‡æ­£åœ¨ç…§äº®ä½ çš„ {shadow.primary_tendency} é¢å‘ã€‚
   965â†’
   966â†’  shadow_guidance:
   967â†’    by_archetype:
   968â†’      Regular:
   969â†’        message: |
   970â†’          ä½ å†…å¿ƒæ·±å¤„å¯èƒ½æ¸´æœ›æ›´å¤šçš„å½’å±æ„Ÿå’Œè¢«æ¥çº³ã€‚
   971â†’          ä»Šå¤©ï¼Œè¯•ç€è§‰å¯Ÿè¿™ç§æ¸´æœ›ï¼Œè€Œä¸æ˜¯é€ƒé¿å®ƒã€‚
   972â†’        invitation: |
   973â†’          å‹‡æ°”é‚€è¯·ï¼šä»Šå¤©æ‰¾ä¸€ä¸ªæœºä¼šï¼ŒçœŸå®åœ°è¡¨è¾¾ä½ çš„éœ€æ±‚ã€‚
   974â†’
   975â†’      Creator:
   976â†’        message: |
   977â†’          ä½ å¯èƒ½æ„Ÿåˆ°åˆ›é€ åŠ›è¢«å‹æŠ‘ï¼Œæˆ–è€…å®³æ€•è‡ªå·±çš„ä½œå“ä¸å¤Ÿå¥½ã€‚
   978â†’          è¿™äº›æ„Ÿå—éƒ½æ˜¯æ­£å¸¸çš„ï¼Œå®ƒä»¬åœ¨æé†’ä½ å†…åœ¨çš„åˆ›é€ ç«èŠ±ã€‚
   979â†’        invitation: |
   980â†’          å‹‡æ°”é‚€è¯·ï¼šä»Šå¤©ç”¨5åˆ†é’Ÿï¼Œåˆ›é€ ä¸€äº›"ä¸å®Œç¾"çš„ä¸œè¥¿ã€‚
   981â†’
   982â†’      # ... å…¶ä»–åŸå‹
   983â†’
   984â†’  closing:
   985â†’    template: |
   986â†’      è®°ä½ï¼Œé˜´å½±ä¸æ˜¯æ•Œäººï¼Œè€Œæ˜¯ç­‰å¾…è¢«æ•´åˆçš„æ½œåŠ›ã€‚
   987â†’
   988â†’      ä»Šæ™šï¼Œä½ å¯ä»¥å›æ¥å’Œæˆ‘åˆ†äº«ä½ çš„ä½“éªŒã€‚
   989â†’```
   990â†’
   991â†’---
   992â†’
   993â†’## å…­ã€API è·¯ç”±è®¾è®¡
   994â†’
   995â†’**æ–‡ä»¶**: `apps/api/routes/vibeid.py`
   996â†’
   997â†’```python
   998â†’from fastapi import APIRouter, Depends, HTTPException
   999â†’from pydantic import BaseModel
  1000â†’from typing import Optional
  1001â†’from datetime import date
  1002â†’
  1003â†’from services.auth import get_current_user
  1004â†’from skills.vibeid.services import (
  1005â†’    ArchetypeCalculator,
  1006â†’    VibeCalculator,
  1007â†’    QAEngine,
  1008â†’    ContentGenerator
  1009â†’)
  1010â†’
  1011â†’router = APIRouter(prefix="/vibeid", tags=["vibeid"])
  1012â†’
  1013â†’
  1014â†’class CreateVibeIDRequest(BaseModel):
  1015â†’    birth_year: int
  1016â†’    birth_month: int
  1017â†’    birth_day: int
  1018â†’    birth_hour: Optional[int] = 12
  1019â†’    birth_minute: Optional[int] = 0
  1020â†’    birth_city: Optional[str] = "åŒ—äº¬"
  1021â†’    gender: Optional[str] = "male"
  1022â†’
  1023â†’
  1024â†’class QAAnswerRequest(BaseModel):
  1025â†’    question_id: str
  1026â†’    answer: dict
  1027â†’
  1028â†’
  1029â†’@router.post("/create")
  1030â†’async def create_vibeid(
  1031â†’    request: CreateVibeIDRequest,
  1032â†’    user = Depends(get_current_user)
  1033â†’):
  1034â†’    """åˆ›å»ºç”¨æˆ·çš„ VibeID"""
  1035â†’    calculator = ArchetypeCalculator()
  1036â†’
  1037â†’    result = await calculator.calculate(
  1038â†’        birth_year=request.birth_year,
  1039â†’        birth_month=request.birth_month,
  1040â†’        birth_day=request.birth_day,
  1041â†’        birth_hour=request.birth_hour,
  1042â†’        birth_minute=request.birth_minute,
  1043â†’        birth_city=request.birth_city,
  1044â†’        gender=request.gender
  1045â†’    )
  1046â†’
  1047â†’    # ä¿å­˜åˆ° unified_profiles
  1048â†’    await save_vibeid_to_profile(user.id, result)
  1049â†’
  1050â†’    return {
  1051â†’        "success": True,
  1052â†’        "vibeid": result.__dict__
  1053â†’    }
  1054â†’
  1055â†’
  1056â†’@router.get("/profile")
  1057â†’async def get_vibeid_profile(user = Depends(get_current_user)):
  1058â†’    """è·å–ç”¨æˆ·çš„ VibeID Profile"""
  1059â†’    profile = await get_user_vibeid(user.id)
  1060â†’
  1061â†’    if not profile:
  1062â†’        raise HTTPException(
  1063â†’            status_code=404,
  1064â†’            detail="VibeID not found. Please create one first."
  1065â†’        )
  1066â†’
  1067â†’    return profile
  1068â†’
  1069â†’
  1070â†’@router.get("/daily")
  1071â†’async def get_daily_vibe(
  1072â†’    target_date: Optional[date] = None,
  1073â†’    user = Depends(get_current_user)
  1074â†’):
  1075â†’    """è·å–æ¯æ—¥ Vibe"""
  1076â†’    vibeid = await get_user_vibeid(user.id)
  1077â†’
  1078â†’    if not vibeid:
  1079â†’        raise HTTPException(
  1080â†’            status_code=404,
  1081â†’            detail="VibeID not found"
  1082â†’        )
  1083â†’
  1084â†’    calculator = VibeCalculator()
  1085â†’    target = target_date or date.today()
  1086â†’
  1087â†’    daily_vibe = calculator.calculate_daily_vibe(vibeid, target)
  1088â†’
  1089â†’    # ç”Ÿæˆå†…å®¹
  1090â†’    generator = ContentGenerator()
  1091â†’    content = await generator.generate_daily_content(
  1092â†’        vibeid, daily_vibe
  1093â†’    )
  1094â†’
  1095â†’    return {
  1096â†’        **daily_vibe,
  1097â†’        "content": content
  1098â†’    }
  1099â†’
  1100â†’
  1101â†’@router.post("/qa")
  1102â†’async def submit_qa_answer(
  1103â†’    request: QAAnswerRequest,
  1104â†’    user = Depends(get_current_user)
  1105â†’):
  1106â†’    """æäº¤é—®ç­”ç¡®è®¤ç­”æ¡ˆ"""
  1107â†’    engine = QAEngine()
  1108â†’
  1109â†’    # è·å–é—®é¢˜
  1110â†’    question = await get_pending_question(user.id, request.question_id)
  1111â†’
  1112â†’    # å¤„ç†ç­”æ¡ˆ
  1113â†’    current_vibeid = await get_user_vibeid(user.id)
  1114â†’    updated_vibeid = engine.process_answer(
  1115â†’        question, request.answer, current_vibeid
  1116â†’    )
  1117â†’
  1118â†’    # ä¿å­˜æ›´æ–°
  1119â†’    await save_vibeid_to_profile(user.id, updated_vibeid)
  1120â†’
  1121â†’    return {
  1122â†’        "success": True,
  1123â†’        "updated_fields": ["archetypes", "archetype_scores"]
  1124â†’    }
  1125â†’
  1126â†’
  1127â†’@router.post("/feedback")
  1128â†’async def submit_daily_feedback(
  1129â†’    mood_rating: int,
  1130â†’    reflection: Optional[str] = None,
  1131â†’    courage_action_taken: bool = False,
  1132â†’    user = Depends(get_current_user)
  1133â†’):
  1134â†’    """æäº¤æ¯æ—¥åé¦ˆ"""
  1135â†’    await save_daily_feedback(
  1136â†’        user_id=user.id,
  1137â†’        date=date.today(),
  1138â†’        feedback={
  1139â†’            "mood_rating": mood_rating,
  1140â†’            "reflection": reflection,
  1141â†’            "courage_action_taken": courage_action_taken
  1142â†’        }
  1143â†’    )
  1144â†’
  1145â†’    # æ›´æ–°æˆé•¿æ•°æ®
  1146â†’    if courage_action_taken:
  1147â†’        await increment_courage_count(user.id)
  1148â†’
  1149â†’    return {"success": True}
  1150â†’```
  1151â†’
  1152â†’---
  1153â†’
  1154â†’## ä¸ƒã€å‰ç«¯ç»„ä»¶è®¾è®¡
  1155â†’
  1156â†’### 7.1 VibeID å¡ç‰‡ç»„ä»¶
  1157â†’
  1158â†’**æ–‡ä»¶**: `apps/web/src/skills/vibeid/cards/VibeIDCard.tsx`
  1159â†’
  1160â†’```tsx
  1161â†’import React from 'react';
  1162â†’
  1163â†’interface VibeIDCardProps {
  1164â†’  vibeid: {
  1165â†’    archetypes: {
  1166â†’      core: { primary: string; secondary: string };
  1167â†’      inner: { archetype: string };
  1168â†’      outer: { archetype: string };
  1169â†’      shadow: { primary_tendency: string };
  1170â†’    };
  1171â†’    archetype_scores: Record<string, number>;
  1172â†’    layer_consistency: { name: string; description: string };
  1173â†’  };
  1174â†’  style?: 'full' | 'mini' | 'share';
  1175â†’}
  1176â†’
  1177â†’export const VibeIDCard: React.FC<VibeIDCardProps> = ({ vibeid, style = 'full' }) => {
  1178â†’  const { archetypes, archetype_scores, layer_consistency } = vibeid;
  1179â†’
  1180â†’  if (style === 'mini') {
  1181â†’    return (
  1182â†’      <div className="vibeid-card-mini">
  1183â†’        <div className="core-badge">
  1184â†’          {archetypes.core.primary}
  1185â†’        </div>
  1186â†’      </div>
  1187â†’    );
  1188â†’  }
  1189â†’
  1190â†’  return (
  1191â†’    <div className="vibeid-card">
  1192â†’      {/* å››ç»´åŸå‹å±•ç¤º */}
  1193â†’      <div className="archetypes-grid">
  1194â†’        <div className="archetype-item core">
  1195â†’          <span className="label">çµé­‚åŸå‹</span>
  1196â†’          <span className="value">{archetypes.core.primary}</span>
  1197â†’          {archetypes.core.secondary && (
  1198â†’            <span className="secondary">+ {archetypes.core.secondary}</span>
  1199â†’          )}
  1200â†’        </div>
  1201â†’
  1202â†’        <div className="archetype-item inner">
  1203â†’          <span className="label">å†…åœ¨ä¸–ç•Œ</span>
  1204â†’          <span className="value">{archetypes.inner.archetype}</span>
  1205â†’        </div>
  1206â†’
  1207â†’        <div className="archetype-item outer">
  1208â†’          <span className="label">å¤–åœ¨å‘ˆç°</span>
  1209â†’          <span className="value">{archetypes.outer.archetype}</span>
  1210â†’        </div>
  1211â†’
  1212â†’        <div className="archetype-item shadow">
  1213â†’          <span className="label">é˜´å½±å€¾å‘</span>
  1214â†’          <span className="value">{archetypes.shadow.primary_tendency}</span>
  1215â†’        </div>
  1216â†’      </div>
  1217â†’
  1218â†’      {/* 12åŸå‹é›·è¾¾å›¾ */}
  1219â†’      <ArchetypeRadar scores={archetype_scores} />
  1220â†’
  1221â†’      {/* å±‚é—´ä¸€è‡´æ€§ */}
  1222â†’      <div className="layer-consistency">
  1223â†’        <span className="type">{layer_consistency.name}</span>
  1224â†’        <p>{layer_consistency.description}</p>
  1225â†’      </div>
  1226â†’    </div>
  1227â†’  );
  1228â†’};
  1229â†’```
  1230â†’
  1231â†’### 7.2 æ¯æ—¥ Vibe ç»„ä»¶
  1232â†’
  1233â†’**æ–‡ä»¶**: `apps/web/src/skills/vibeid/cards/DailyVibeCard.tsx`
  1234â†’
  1235â†’```tsx
  1236â†’import React from 'react';
  1237â†’
  1238â†’interface DailyVibeCardProps {
  1239â†’  dailyVibe: {
  1240â†’    vibe_score: number;
  1241â†’    energy_zone: string;
  1242â†’    energy_name: string;
  1243â†’    is_deep_day: boolean;
  1244â†’    content: {
  1245â†’      greeting: string;
  1246â†’      core_message: string;
  1247â†’      courage_invitation?: {
  1248â†’        type: string;
  1249â†’        message: string;
  1250â†’      };
  1251â†’    };
  1252â†’  };
  1253â†’}
  1254â†’
  1255â†’export const DailyVibeCard: React.FC<DailyVibeCardProps> = ({ dailyVibe }) => {
  1256â†’  const { vibe_score, energy_zone, energy_name, is_deep_day, content } = dailyVibe;
  1257â†’
  1258â†’  return (
  1259â†’    <div className={`daily-vibe-card ${energy_zone} ${is_deep_day ? 'deep-day' : ''}`}>
  1260â†’      {/* Vibe å€¼åœ†ç¯ */}
  1261â†’      <div className="vibe-score-ring">
  1262â†’        <svg viewBox="0 0 100 100">
  1263â†’          <circle
  1264â†’            cx="50" cy="50" r="45"
  1265â†’            fill="none"
  1266â†’            stroke="#e5e7eb"
  1267â†’            strokeWidth="8"
  1268â†’          />
  1269â†’          <circle
  1270â†’            cx="50" cy="50" r="45"
  1271â†’            fill="none"
  1272â†’            stroke="currentColor"
  1273â†’            strokeWidth="8"
  1274â†’            strokeDasharray={`${vibe_score * 2.83} 283`}
  1275â†’            transform="rotate(-90 50 50)"
  1276â†’          />
  1277â†’        </svg>
  1278â†’        <div className="score-text">
  1279â†’          <span className="number">{vibe_score}</span>
  1280â†’          <span className="label">Vibe</span>
  1281â†’        </div>
  1282â†’      </div>
  1283â†’
  1284â†’      {/* èƒ½é‡çŠ¶æ€ */}
  1285â†’      <div className="energy-badge">
  1286â†’        {is_deep_day && <span className="deep-day-icon">ğŸŒ™</span>}
  1287â†’        {energy_name}
  1288â†’      </div>
  1289â†’
  1290â†’      {/* å†…å®¹åŒº */}
  1291â†’      <div className="content">
  1292â†’        <p className="greeting">{content.greeting}</p>
  1293â†’        <p className="message">{content.core_message}</p>
  1294â†’
  1295â†’        {content.courage_invitation && (
  1296â†’          <div className="courage-invitation">
  1297â†’            <h4>âœ¨ å‹‡æ°”é‚€è¯·</h4>
  1298â†’            <p>{content.courage_invitation.message}</p>
  1299â†’            <button className="accept-btn">æ¥å—é‚€è¯·</button>
  1300â†’          </div>
  1301â†’        )}
  1302â†’      </div>
  1303â†’    </div>
  1304â†’  );
  1305â†’};
  1306â†’```
  1307â†’
  1308â†’---
  1309â†’
  1310â†’## å…«ã€å®æ–½è®¡åˆ’
  1311â†’
  1312â†’### Phase 1: åŸºç¡€è®¾æ–½ (Week 1-2)
  1313â†’
  1314â†’| ä»»åŠ¡ | ä¼˜å…ˆçº§ | ä¾èµ– |
  1315â†’|------|--------|------|
  1316â†’| æ•°æ®åº“è¡¨ç»“æ„è¿ç§» | P0 | - |
  1317â†’| ArchetypeCalculator æœåŠ¡ | P0 | bazi/zodiac services |
  1318â†’| åŸºç¡€ API è·¯ç”± | P0 | ArchetypeCalculator |
  1319â†’| VibeID Profile å­˜å‚¨ | P0 | æ•°æ®åº“ |
  1320â†’
  1321â†’### Phase 2: æ ¸å¿ƒåŠŸèƒ½ (Week 3-4)
  1322â†’
  1323â†’| ä»»åŠ¡ | ä¼˜å…ˆçº§ | ä¾èµ– |
  1324â†’|------|--------|------|
  1325â†’| VibeCalculator æ¯æ—¥è®¡ç®— | P0 | ArchetypeCalculator |
  1326â†’| QAEngine é—®ç­”ç¡®è®¤ | P1 | - |
  1327â†’| ContentGenerator å†…å®¹ç”Ÿæˆ | P1 | - |
  1328â†’| VibeID Skill å®šä¹‰ | P0 | æ‰€æœ‰ services |
  1329â†’
  1330â†’### Phase 3: å‰ç«¯é›†æˆ (Week 5-6)
  1331â†’
  1332â†’| ä»»åŠ¡ | ä¼˜å…ˆçº§ | ä¾èµ– |
  1333â†’|------|--------|------|
  1334â†’| VibeIDCard ç»„ä»¶ | P0 | API |
  1335â†’| DailyVibeCard ç»„ä»¶ | P0 | API |
  1336â†’| åˆ›å»º VibeID æµç¨‹ | P0 | QAEngine |
  1337â†’| æ·±åº¦æ—¥ç‰¹æ®Šç•Œé¢ | P1 | DailyVibeCard |
  1338â†’
  1339â†’### Phase 4: é«˜çº§åŠŸèƒ½ (Week 7-8)
  1340â†’
  1341â†’| ä»»åŠ¡ | ä¼˜å…ˆçº§ | ä¾èµ– |
  1342â†’|------|--------|------|
  1343â†’| å‹‡æ°”é‚€è¯·ç³»ç»Ÿ | P1 | ContentGenerator |
  1344â†’| æˆé•¿è¿½è¸ª | P1 | æ•°æ®åº“ |
  1345â†’| æ¯æ—¥æ¨é€ | P2 | VibeCalculator |
  1346â†’| åˆ†äº«åŠŸèƒ½ | P2 | VibeIDCard |
  1347â†’
  1348â†’---
  1349â†’
  1350â†’## ä¹ã€å¾…è§£å†³é—®é¢˜
  1351â†’
  1352â†’1. **è¡Œè¿è®¡ç®—ç²¾åº¦**: éœ€è¦ç¡®è®¤ bazi/zodiac è¡Œè¿è®¡ç®—çš„å‡†ç¡®æ€§å’Œæ€§èƒ½
  1353â†’2. **é—®ç­”æµç¨‹ UX**: å¦‚ä½•åœ¨æµå¼å“åº”ä¸­ä¼˜é›…åœ°æ’å…¥é—®ç­”ç¡®è®¤
  1354â†’3. **æ·±åº¦æ—¥é¢‘ç‡**: æ¯æœˆ 2-4 æ¬¡çš„æ§åˆ¶é€»è¾‘éœ€è¦ç»†åŒ–
  1355â†’4. **æ¨é€æœºåˆ¶**: éœ€è¦è¯„ä¼°æ¨é€æœåŠ¡çš„æŠ€æœ¯é€‰å‹ï¼ˆFCM/APNs/WebPushï¼‰
  1356â†’5. **æ•°æ®éšç§**: äººæ ¼æ•°æ®çš„åŠ å¯†å’Œè®¿é—®æ§åˆ¶ç­–ç•¥
  1357â†’
  1358â†’---
  1359â†’
  1360â†’## åã€éªŒæ”¶æ ‡å‡†
  1361â†’
  1362â†’### MVP éªŒæ”¶æ¸…å•
  1363â†’
  1364â†’- [ ] ç”¨æˆ·å¯ä»¥é€šè¿‡å‡ºç”Ÿä¿¡æ¯åˆ›å»º VibeID
  1365â†’- [ ] ç³»ç»Ÿæ­£ç¡®è®¡ç®—å››ç»´åŸå‹ï¼ˆCore/Inner/Outer/Shadowï¼‰
  1366â†’- [ ] ç³»ç»Ÿæ­£ç¡®è®¡ç®— 12 åŸå‹å¾—åˆ†
  1367â†’- [ ] ç”¨æˆ·å¯ä»¥æŸ¥çœ‹ VibeID å¡ç‰‡
  1368â†’- [ ] é—®ç­”ç¡®è®¤æµç¨‹æ­£å¸¸å·¥ä½œ
  1369â†’- [ ] æ¯æ—¥ Vibe å€¼æ­£ç¡®è®¡ç®—
  1370â†’- [ ] æ·±åº¦æ—¥æ­£ç¡®è§¦å‘
  1371â†’- [ ] å‹‡æ°”é‚€è¯·æ­£å¸¸å±•ç¤º
  1372â†’- [ ] æˆé•¿æ•°æ®æ­£ç¡®è®°å½•
  1373â†’
  1374â†’### æ€§èƒ½æŒ‡æ ‡
  1375â†’
  1376â†’- VibeID åˆ›å»ºå“åº”æ—¶é—´ < 3s
  1377â†’- æ¯æ—¥ Vibe è®¡ç®—å“åº”æ—¶é—´ < 500ms
  1378â†’- API å¯ç”¨æ€§ > 99.9%
  1379â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
