     1â†’# VibeID è®¾è®¡è§„èŒƒ v7.0
     2â†’
     3â†’> Version: 7.0 | 2026-01-19
     4â†’> çŠ¶æ€: è®¾è®¡ä¸­
     5â†’
     6â†’## 1. æ¦‚è¿°
     7â†’
     8â†’### 1.1 ä½¿å‘½å¯¹é½
     9â†’
    10â†’VibeLife çš„ä½¿å‘½æ˜¯"è®©æ¯ä¸€ä¸ªäººï¼Œéƒ½æ‹¥æœ‰ä¸€ä¸ªçœŸæ­£æ‡‚è‡ªå·±çš„å­˜åœ¨"ã€‚VibeID æ˜¯è¿™ä¸ªä½¿å‘½çš„å…·è±¡åŒ–è½½ä½“â€”â€”ç”¨æˆ·åœ¨ VibeLife ä¸­çš„"æ•°å­—èº«ä»½è¯"ã€‚
    11â†’
    12â†’### 1.2 è®¾è®¡åŸåˆ™
    13â†’
    14â†’| åŸåˆ™ | è¯´æ˜ |
    15â†’|-----|------|
    16â†’| **èº«ä»½æ ¸å¿ƒ** | VibeID ä¸æ˜¯ä¸€ä¸ª Skillï¼Œè€Œæ˜¯ç”¨æˆ·èº«ä»½çš„æ ¸å¿ƒè¡¨è¾¾ |
    17â†’| **åŠ¨æ€æ¼”åŒ–** | äººæ ¼ä¸æ˜¯é™æ€æ ‡ç­¾ï¼Œè€Œæ˜¯æŒç»­æˆé•¿çš„è½¨è¿¹ |
    18â†’| **å…¨æ ˆæ•´åˆ** | ä»æ•°æ®å±‚åˆ° Prompt å±‚ï¼ŒVibeID è´¯ç©¿æ•´ä¸ªç³»ç»Ÿ |
    19â†’| **ç®€æ´æœ‰åŠ›** | ç”¨æœ€ç®€å•çš„æ–¹å¼ä¼ è¾¾æœ€æ·±åˆ»çš„æ´å¯Ÿ |
    20â†’
    21â†’### 1.3 æ ¸å¿ƒå˜åŒ– (v6 â†’ v7)
    22â†’
    23â†’```
    24â†’v6: skill_data.vibe_id (æ´¾ç”Ÿ Skillï¼Œä¸€æ¬¡è®¡ç®—)
    25â†’                â†“
    26â†’v7: unified_profiles.vibe_id (èº«ä»½æ ¸å¿ƒï¼ŒæŒç»­æ¼”åŒ–)
    27â†’```
    28â†’
    29â†’---
    30â†’
    31â†’## 2. å››ç»´åŸå‹ä½“ç³»
    32â†’
    33â†’### 2.1 ç»´åº¦å®šä¹‰
    34â†’
    35â†’| ç»´åº¦ | è‹±æ–‡ | æ¥æº | å«ä¹‰ |
    36â†’|-----|------|------|------|
    37â†’| çµé­‚æœ¬è´¨ | Core | å…«å­—æ ¼å±€+ç”¨ç¥ (70%) + å¤ªé˜³æ˜Ÿåº§ (30%) | ä½ æ˜¯è° |
    38â†’| å†…åœ¨ä¸–ç•Œ | Inner | æœˆäº®+é‡‘æ˜Ÿæ˜Ÿåº§ | ä½ æ¸´æœ›ä»€ä¹ˆ |
    39â†’| å¤–åœ¨å‘ˆç° | Outer | ä¸Šå‡+ç«æ˜Ÿæ˜Ÿåº§ | ä½ å¦‚ä½•è¡ŒåŠ¨ |
    40â†’| é˜´å½±å€¾å‘ | Shadow | Core çš„å¯¹ç«‹é¢ | ä½ éœ€è¦æ•´åˆä»€ä¹ˆ |
    41â†’
    42â†’### 2.2 12åŸå‹ä½“ç³»
    43â†’
    44â†’åŸºäºè£æ ¼åŸå‹ç†è®ºï¼š
    45â†’
    46â†’| åŸå‹ | ä¸­æ–‡ | æ ¸å¿ƒé©±åŠ¨ | å¯¹ç«‹åŸå‹ |
    47â†’|-----|------|---------|---------|
    48â†’| Innocent | å¤©çœŸè€… | è¿½æ±‚çº¯ç²¹ä¸ç¾å¥½ | Hero |
    49â†’| Explorer | æ¢ç´¢è€… | è¿½æ±‚è‡ªç”±ä¸å‘ç° | Caregiver |
    50â†’| Sage | æ™ºè€… | è¿½æ±‚çœŸç†ä¸ç†è§£ | Jester |
    51â†’| Hero | è‹±é›„ | è¿½æ±‚æŒæ§ä¸è¯æ˜ | Innocent |
    52â†’| Outlaw | å›é€†è€… | è¿½æ±‚å˜é©ä¸è§£æ”¾ | Ruler |
    53â†’| Magician | é­”æ³•å¸ˆ | è¿½æ±‚è½¬åŒ–ä¸å®ç° | Lover |
    54â†’| Regular | å‡¡äºº | è¿½æ±‚å½’å±ä¸è¿æ¥ | Creator |
    55â†’| Lover | æƒ…äºº | è¿½æ±‚äº²å¯†ä¸ä½“éªŒ | Magician |
    56â†’| Jester | æ„šè€… | è¿½æ±‚å¿«ä¹ä¸å½“ä¸‹ | Sage |
    57â†’| Caregiver | ç…§é¡¾è€… | è¿½æ±‚å¸®åŠ©ä¸ä¿æŠ¤ | Explorer |
    58â†’| Creator | åˆ›é€ è€… | è¿½æ±‚åˆ›æ–°ä¸è¡¨è¾¾ | Regular |
    59â†’| Ruler | ç»Ÿæ²»è€… | è¿½æ±‚æŒæ§ä¸ç§©åº | Outlaw |
    60â†’
    61â†’### 2.3 èåˆç®—æ³•
    62â†’
    63â†’```
    64â†’Core åŸå‹ = å…«å­—ä¸»åŸå‹ Ã— 0.7 + æ˜Ÿåº§ä¸»åŸå‹ Ã— 0.3 + ä¸€è‡´æ€§å¥–åŠ±
    65â†’```
    66â†’
    67â†’- **ä¸€è‡´æ€§å¥–åŠ±**: ä¸œè¥¿æ–¹æŒ‡å‘åŒä¸€åŸå‹æ—¶ +15%
    68â†’- **å†²çªå¤„ç†**: ä»¥å…«å­—ä¸ºå‡†ï¼Œæ˜Ÿåº§ä½œä¸ºå‰¯åŸå‹
    69â†’
    70â†’---
    71â†’
    72â†’## 3. ç®€åŒ–å‘ˆç°
    73â†’
    74â†’### 3.1 ä»å¤æ‚åˆ°ç®€æ´
    75â†’
    76â†’**v6 å‘ˆç°**:
    77â†’```
    78â†’å››ç»´åŸå‹:
    79â†’- Core: Explorer (æ¢ç´¢è€…)
    80â†’- Inner: Lover (æƒ…äºº)
    81â†’- Outer: Sage (æ™ºè€…)
    82â†’- Shadow: Caregiver (ç…§é¡¾è€…)
    83â†’
    84â†’12åŸå‹èƒ½é‡åˆ†å¸ƒ:
    85â†’Explorer: 85, Sage: 72, Lover: 68, ...
    86â†’```
    87â†’
    88â†’**v7 å‘ˆç°**:
    89â†’```
    90â†’ä½ æ˜¯ æ¢ç´¢è€… ğŸ§­
    91â†’"è¿½æ±‚è‡ªç”±çš„æ™ºè€…ï¼Œå†…å¿ƒæ¸´æœ›è¿æ¥"
    92â†’
    93â†’[æ¢ç´¢æ›´å¤š â†’]
    94â†’```
    95â†’
    96â†’### 3.2 äººæ ¼é‡‘å¥ç”Ÿæˆ
    97â†’
    98â†’äººæ ¼é‡‘å¥ = f"{Core ç‰¹å¾} + {Inner æ¸´æœ›}"
    99â†’
   100â†’ç¤ºä¾‹:
   101â†’- Explorer + Lover â†’ "è¿½æ±‚è‡ªç”±çš„çµé­‚ï¼Œå†…å¿ƒæ¸´æœ›æ·±åº¦è¿æ¥"
   102â†’- Hero + Sage â†’ "å‹‡äºå¾æœçš„æˆ˜å£«ï¼Œè¿½æ±‚çœŸç†ä¸æ™ºæ…§"
   103â†’- Caregiver + Creator â†’ "æ¸©æš–å®ˆæŠ¤çš„å¿ƒï¼Œæ¸´æœ›åˆ›é€ ç‹¬ç‰¹ä»·å€¼"
   104â†’
   105â†’### 3.3 äº¤äº’å±‚æ¬¡
   106â†’
   107â†’```
   108â†’Layer 1: ä¸»åŸå‹å¡ç‰‡ (é»˜è®¤å±•ç¤º)
   109â†’    â†“ ç‚¹å‡»"æ¢ç´¢æ›´å¤š"
   110â†’Layer 2: å››ç»´åŸå‹è¯¦æƒ…
   111â†’    â†“ ç‚¹å‡»æŸä¸ªç»´åº¦
   112â†’Layer 3: åŸå‹æ·±åº¦è§£è¯»
   113â†’    â†“ ç‚¹å‡»"æŸ¥çœ‹æ¼”åŒ–"
   114â†’Layer 4: æˆé•¿æ—¶é—´çº¿
   115â†’```
   116â†’
   117â†’---
   118â†’
   119â†’## 4. åŠ¨æ€æ¼”åŒ–
   120â†’
   121â†’### 4.1 æ¼”åŒ–è§¦å‘å™¨
   122â†’
   123â†’| è§¦å‘ç±»å‹ | è¯´æ˜ | é¢‘ç‡ | ç¤ºä¾‹ |
   124â†’|---------|------|------|------|
   125â†’| å¯¹è¯é©±åŠ¨ | æ¯æ¬¡æ·±åº¦å¯¹è¯åå¾®è°ƒ | é«˜ | å¯¹è¯ä¸­å±•ç° Hero ç‰¹è´¨ â†’ Hero +1 |
   126â†’| å‘¨æœŸé©±åŠ¨ | å¤§è¿/æµå¹´/ç”Ÿæ—¥ç­‰èŠ‚ç‚¹ | ä½ | å¤§è¿äº¤æ¥ â†’ é‡æ–°è®¡ç®— |
   127â†’| ç”¨æˆ·é©±åŠ¨ | ç”¨æˆ·ä¸»åŠ¨è§¦å‘ | æŒ‰éœ€ | "é‡æ–°è®¤è¯†è‡ªå·±" |
   128â†’
   129â†’### 4.2 å¯¹è¯é©±åŠ¨æ¼”åŒ–
   130â†’
   131â†’```python
   132â†’async def on_conversation_end(user_id, conversation_summary):
   133â†’    """
   134â†’    å¯¹è¯ç»“æŸåçš„æ¼”åŒ–é€»è¾‘
   135â†’
   136â†’    conversation_summary åŒ…å«:
   137â†’    - topics: è®¨è®ºçš„è¯é¢˜
   138â†’    - emotions: è¡¨è¾¾çš„æƒ…ç»ª
   139â†’    - behaviors: å±•ç°çš„è¡Œä¸ºç‰¹å¾
   140â†’    - archetype_signals: LLM è¯†åˆ«çš„åŸå‹ä¿¡å·
   141â†’    """
   142â†’    # 1. æå–åŸå‹ä¿¡å·
   143â†’    signals = conversation_summary.get("archetype_signals", {})
   144â†’
   145â†’    # 2. å¾®è°ƒèƒ½é‡åˆ†å¸ƒ (å˜åŒ–å¹…åº¦å°ï¼Œç´¯ç§¯æ•ˆåº”)
   146â†’    delta = {}
   147â†’    for archetype, strength in signals.items():
   148â†’        delta[archetype] = strength * 0.5  # è¡°å‡ç³»æ•°
   149â†’
   150â†’    # 3. è®°å½•æ¼”åŒ–
   151â†’    await evolve(user_id, trigger="conversation", delta=delta)
   152â†’```
   153â†’
   154â†’### 4.3 å‘¨æœŸé©±åŠ¨æ¼”åŒ–
   155â†’
   156â†’| äº‹ä»¶ | è§¦å‘æ—¶æœº | æ¼”åŒ–åŠ¨ä½œ |
   157â†’|-----|---------|---------|
   158â†’| dayun_change | å¤§è¿äº¤æ¥å‰7å¤©/å½“å¤© | é‡æ–°è®¡ç®—ï¼Œç”Ÿæˆå¯¹æ¯”æŠ¥å‘Š |
   159â†’| birthday | ç”Ÿæ—¥å½“å¤© | å¹´åº¦å›é¡¾ï¼Œç”Ÿæˆæˆé•¿æŠ¥å‘Š |
   160â†’| liunian_change | æµå¹´äº¤æ¥ | å¾®è°ƒèƒ½é‡ï¼Œç”Ÿæˆå¹´åº¦å±•æœ› |
   161â†’
   162â†’### 4.4 æ¼”åŒ–è®°å½•
   163â†’
   164â†’```json
   165â†’{
   166â†’  "evolution": [
   167â†’    {
   168â†’      "id": "evo_001",
   169â†’      "timestamp": "2026-01-19T00:00:00Z",
   170â†’      "trigger": "initial_calculation",
   171â†’      "snapshot": {
   172â†’        "primary_archetype": "Explorer",
   173â†’        "scores": {"Explorer": 85, "Sage": 72, ...}
   174â†’      },
   175â†’      "insight": "é¦–æ¬¡è®¡ç®—ï¼ŒExplorer èƒ½é‡æ˜¾è‘—ï¼Œè¿½æ±‚è‡ªç”±æ˜¯ä½ çš„æ ¸å¿ƒé©±åŠ¨"
   176â†’    },
   177â†’    {
   178â†’      "id": "evo_002",
   179â†’      "timestamp": "2026-03-15T14:30:00Z",
   180â†’      "trigger": "conversation",
   181â†’      "delta": {"Hero": +2, "Explorer": -1},
   182â†’      "insight": "æœ€è¿‘çš„å¯¹è¯ä¸­ï¼Œä½ å±•ç°äº†æ›´å¤šå‹‡äºæŒ‘æˆ˜çš„ç‰¹è´¨"
   183â†’    },
   184â†’    {
   185â†’      "id": "evo_003",
   186â†’      "timestamp": "2026-06-19T00:00:00Z",
   187â†’      "trigger": "dayun_change",
   188â†’      "snapshot": {
   189â†’        "primary_archetype": "Explorer",
   190â†’        "scores": {"Explorer": 82, "Hero": 75, ...}
   191â†’      },
   192â†’      "delta": {"Hero": +8, "Explorer": -3},
   193â†’      "insight": "å¤§è¿äº¤æ¥ï¼ŒHero èƒ½é‡ä¸Šå‡ï¼Œè¿™æ˜¯ä½ å±•ç°é¢†å¯¼åŠ›çš„æ—¶æœŸ"
   194â†’    }
   195â†’  ]
   196â†’}
   197â†’```
   198â†’
   199â†’---
   200â†’
   201â†’## 5. å…¨æ ˆæ•´åˆ
   202â†’
   203â†’### 5.1 æ¶æ„å›¾
   204â†’
   205â†’```
   206â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   207â†’â”‚                    VibeID å…¨æ ˆæ•´åˆæ¶æ„                           â”‚
   208â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   209â†’â”‚                                                                 â”‚
   210â†’â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   211â†’â”‚  â”‚                    Prompt å±‚                             â”‚   â”‚
   212â†’â”‚  â”‚  CoreAgent._build_system_prompt()                        â”‚   â”‚
   213â†’â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
   214â†’â”‚  â”‚  â”‚ ## ç”¨æˆ·èº«ä»½ (VibeID)                             â”‚    â”‚   â”‚
   215â†’â”‚  â”‚  â”‚ - ä¸»åŸå‹: Explorer (æ¢ç´¢è€…)                      â”‚    â”‚   â”‚
   216â†’â”‚  â”‚  â”‚ - äººæ ¼ç‰¹å¾: è¿½æ±‚è‡ªç”±çš„æ™ºè€…ï¼Œå†…å¿ƒæ¸´æœ›è¿æ¥          â”‚    â”‚   â”‚
   217â†’â”‚  â”‚  â”‚ - æ²Ÿé€šåå¥½: å–œæ¬¢å¼€æ”¾å¼æ¢ç´¢ï¼Œä¸å–œæ¬¢è¢«é™åˆ¶          â”‚    â”‚   â”‚
   218â†’â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
   219â†’â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   220â†’â”‚                              â†‘                                  â”‚
   221â†’â”‚                              â”‚ get_summary()                    â”‚
   222â†’â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   223â†’â”‚  â”‚                   Service å±‚                             â”‚   â”‚
   224â†’â”‚  â”‚  VibeIDService                                           â”‚   â”‚
   225â†’â”‚  â”‚  â”œâ”€â”€ calculate()      # è®¡ç®—/é‡ç®—                        â”‚   â”‚
   226â†’â”‚  â”‚  â”œâ”€â”€ evolve()         # æ¼”åŒ–æ›´æ–°                         â”‚   â”‚
   227â†’â”‚  â”‚  â”œâ”€â”€ get_summary()    # æ‘˜è¦ (Prompt æ³¨å…¥)               â”‚   â”‚
   228â†’â”‚  â”‚  â””â”€â”€ get_full()       # å®Œæ•´æ•°æ® (å±•ç¤º)                  â”‚   â”‚
   229â†’â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   230â†’â”‚                              â†‘                                  â”‚
   231â†’â”‚                              â”‚                                  â”‚
   232â†’â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   233â†’â”‚  â”‚                    Data å±‚                               â”‚   â”‚
   234â†’â”‚  â”‚  unified_profiles.vibe_id                                â”‚   â”‚
   235â†’â”‚  â”‚  â”œâ”€â”€ primary_archetype                                   â”‚   â”‚
   236â†’â”‚  â”‚  â”œâ”€â”€ archetype_signature                                 â”‚   â”‚
   237â†’â”‚  â”‚  â”œâ”€â”€ dimensions {core, inner, outer, shadow}             â”‚   â”‚
   238â†’â”‚  â”‚  â”œâ”€â”€ scores {Explorer: 85, ...}                          â”‚   â”‚
   239â†’â”‚  â”‚  â”œâ”€â”€ evolution []                                        â”‚   â”‚
   240â†’â”‚  â”‚  â””â”€â”€ sources {bazi, zodiac}                              â”‚   â”‚
   241â†’â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   242â†’â”‚                              â†‘                                  â”‚
   243â†’â”‚                              â”‚ è§¦å‘æ¼”åŒ–                         â”‚
   244â†’â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   245â†’â”‚  â”‚                  Proactive å±‚                            â”‚   â”‚
   246â†’â”‚  â”‚  reminders.yaml                                          â”‚   â”‚
   247â†’â”‚  â”‚  â”œâ”€â”€ dayun_evolution    # å¤§è¿äº¤æ¥                       â”‚   â”‚
   248â†’â”‚  â”‚  â”œâ”€â”€ birthday_reflection # ç”Ÿæ—¥å›é¡¾                      â”‚   â”‚
   249â†’â”‚  â”‚  â””â”€â”€ archetype_shift    # èƒ½é‡æ³¢åŠ¨                       â”‚   â”‚
   250â†’â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   251â†’â”‚                                                                 â”‚
   252â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   253â†’```
   254â†’
   255â†’### 5.2 Prompt å±‚æ³¨å…¥
   256â†’
   257â†’**ä½ç½®**: `services/agent/core.py` - `_build_system_prompt()`
   258â†’
   259â†’```python
   260â†’async def _build_system_prompt(self, message, context):
   261â†’    parts = []
   262â†’
   263â†’    # 1. VibeID æ³¨å…¥ï¼ˆæ‰€æœ‰å¯¹è¯éƒ½æœ‰ï¼‰
   264â†’    vibe_id_summary = await VibeIDService.get_summary(context.user_id)
   265â†’    if vibe_id_summary:
   266â†’        parts.append(f"""
   267â†’## ç”¨æˆ·èº«ä»½ (VibeID)
   268â†’- ä¸»åŸå‹: {vibe_id_summary.primary_archetype} ({vibe_id_summary.archetype_cn_name})
   269â†’- äººæ ¼ç‰¹å¾: {vibe_id_summary.signature}
   270â†’- æ²Ÿé€šåå¥½: {vibe_id_summary.communication_style}
   271â†’
   272â†’è¯·å§‹ç»ˆåŸºäºç”¨æˆ·çš„åŸå‹ç‰¹å¾æ¥è°ƒæ•´ä½ çš„å›åº”é£æ ¼ã€‚ä¾‹å¦‚:
   273â†’- Explorer ç”¨æˆ·å–œæ¬¢å¼€æ”¾å¼æ¢ç´¢ï¼Œé¿å…è¿‡äºç»“æ„åŒ–çš„å›ç­”
   274â†’- Ruler ç”¨æˆ·å–œæ¬¢æ¸…æ™°çš„æ¡†æ¶å’Œè¡ŒåŠ¨å»ºè®®
   275â†’- Lover ç”¨æˆ·é‡è§†æƒ…æ„Ÿè¿æ¥ï¼Œå¤šç”¨æ¸©æš–çš„è¯­è¨€
   276â†’""")
   277â†’
   278â†’    # 2. Skill ä¸“å± prompt...
   279â†’    # 3. æ¡ˆä¾‹åŒ¹é…...
   280â†’```
   281â†’
   282â†’### 5.3 Proactive è”åŠ¨
   283â†’
   284â†’**é…ç½®æ–‡ä»¶**: `skills/vibe_id/reminders.yaml`
   285â†’
   286â†’```yaml
   287â†’skill_id: vibe_id
   288â†’enabled: true
   289â†’
   290â†’reminders:
   291â†’  # 1. å¤§è¿äº¤æ¥
   292â†’  - id: dayun_evolution
   293â†’    name: å¤§è¿äººæ ¼æ¼”åŒ–
   294â†’    trigger:
   295â†’      type: event_based
   296â†’      event: dayun_change
   297â†’      advance_days: [7, 0]
   298â†’    content:
   299â†’      generator: rules/dayun-evolution.md
   300â†’      suggested_prompt: "æƒ³äº†è§£è¿™æ¬¡å¤§è¿äº¤æ¥å¯¹ä½ äººæ ¼çš„å½±å“å—ï¼Ÿ"
   301â†’      quick_actions:
   302â†’        - label: "æŸ¥çœ‹å˜åŒ–"
   303â†’          prompt: "æˆ‘çš„äººæ ¼æœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ"
   304â†’        - label: "æ·±åº¦è§£è¯»"
   305â†’          prompt: "è¯¦ç»†åˆ†æä¸€ä¸‹è¿™æ¬¡å¤§è¿å¯¹æˆ‘çš„å½±å“"
   306â†’    priority: high
   307â†’
   308â†’  # 2. ç”Ÿæ—¥å›é¡¾
   309â†’  - id: birthday_reflection
   310â†’    name: ç”Ÿæ—¥äººæ ¼å›é¡¾
   311â†’    trigger:
   312â†’      type: event_based
   313â†’      event: birthday
   314â†’      advance_days: [0]
   315â†’    content:
   316â†’      generator: rules/birthday-reflection.md
   317â†’      suggested_prompt: "ç”Ÿæ—¥å¿«ä¹ï¼æƒ³å›é¡¾ä¸€ä¸‹è¿™ä¸€å¹´ä½ çš„æˆé•¿å—ï¼Ÿ"
   318â†’      quick_actions:
   319â†’        - label: "å¹´åº¦å›é¡¾"
   320â†’          prompt: "å›é¡¾æˆ‘è¿™ä¸€å¹´çš„æˆé•¿"
   321â†’        - label: "æ–°å¹´å±•æœ›"
   322â†’          prompt: "æ–°çš„ä¸€å²æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ"
   323â†’    priority: high
   324â†’
   325â†’  # 3. åŸå‹èƒ½é‡æ³¢åŠ¨
   326â†’  - id: archetype_shift
   327â†’    name: åŸå‹èƒ½é‡å˜åŒ–
   328â†’    trigger:
   329â†’      type: threshold_based
   330â†’      metric: archetype_delta
   331â†’      condition: ">"
   332â†’      threshold: 10
   333â†’      cooldown_days: 30
   334â†’    content:
   335â†’      generator: rules/archetype-shift.md
   336â†’      suggested_prompt: "æˆ‘æ³¨æ„åˆ°ä½ æœ€è¿‘çš„èƒ½é‡æœ‰äº›å˜åŒ–..."
   337â†’      quick_actions:
   338â†’        - label: "äº†è§£å˜åŒ–"
   339â†’          prompt: "æˆ‘çš„èƒ½é‡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ"
   340â†’    priority: medium
   341â†’
   342â†’global_config:
   343â†’  default_push_hour: 8
   344â†’  cooldown_hours: 168  # 7å¤©
   345â†’```
   346â†’
   347â†’### 5.4 æ•°æ®å±‚èåˆ
   348â†’
   349â†’VibeID ä¸ unified_profiles å…¶ä»–å­—æ®µçš„å…³ç³»ï¼š
   350â†’
   351â†’```
   352â†’unified_profiles
   353â†’â”‚
   354â†’â”œâ”€â”€ vibe_id (èº«ä»½æ ¸å¿ƒ) â†â”€â”€ æœ¬æ¨¡å—
   355â†’â”‚   â”œâ”€â”€ primary_archetype    â† å½±å“ AI å›åº”é£æ ¼
   356â†’â”‚   â”œâ”€â”€ archetype_signature  â† äººæ ¼é‡‘å¥
   357â†’â”‚   â”œâ”€â”€ dimensions           â† å››ç»´è¯¦æƒ…
   358â†’â”‚   â”œâ”€â”€ scores               â† 12åŸå‹èƒ½é‡
   359â†’â”‚   â”œâ”€â”€ evolution            â† æˆé•¿è½¨è¿¹
   360â†’â”‚   â””â”€â”€ sources              â† æ¥æºè¿½æº¯
   361â†’â”‚
   362â†’â”œâ”€â”€ profile (Hot Memory)
   363â†’â”‚   â”œâ”€â”€ facts.birth_info     â† VibeID è®¡ç®—ä¾èµ–
   364â†’â”‚   â”œâ”€â”€ state.current_focus  â† å¯ä¸ VibeID è”åŠ¨åˆ†æ
   365â†’â”‚   â””â”€â”€ preferences          â† å¯ä» VibeID æ¨å¯¼æ²Ÿé€šåå¥½
   366â†’â”‚
   367â†’â”œâ”€â”€ skill_data
   368â†’â”‚   â”œâ”€â”€ bazi.chart           â† VibeID è®¡ç®—ä¾èµ–
   369â†’â”‚   â””â”€â”€ zodiac.chart         â† VibeID è®¡ç®—ä¾èµ–
   370â†’â”‚
   371â†’â””â”€â”€ insights (Cold Memory)
   372â†’    â””â”€â”€ growth               â† ä¸ vibe_id.evolution è”åŠ¨
   373â†’```
   374â†’
   375â†’---
   376â†’
   377â†’## 6. Service æ¥å£
   378â†’
   379â†’### 6.1 VibeIDService
   380â†’
   381â†’```python
   382â†’class VibeIDService:
   383â†’    """VibeID æœåŠ¡ v7.0 - ç”¨æˆ·èº«ä»½æ ¸å¿ƒ"""
   384â†’
   385â†’    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   386â†’    # è®¡ç®—ä¸æ›´æ–°
   387â†’    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   388â†’
   389â†’    async def calculate(
   390â†’        self,
   391â†’        user_id: UUID,
   392â†’        force: bool = False
   393â†’    ) -> VibeIDResult:
   394â†’        """
   395â†’        è®¡ç®— VibeID
   396â†’
   397â†’        Args:
   398â†’            user_id: ç”¨æˆ· ID
   399â†’            force: æ˜¯å¦å¼ºåˆ¶é‡æ–°è®¡ç®—
   400â†’
   401â†’        Returns:
   402â†’            VibeIDResult {status, data, cached, error}
   403â†’        """
   404â†’        pass
   405â†’
   406â†’    async def evolve(
   407â†’        self,
   408â†’        user_id: UUID,
   409â†’        trigger: str,
   410â†’        context: Dict[str, Any]
   411â†’    ) -> EvolutionResult:
   412â†’        """
   413â†’        è§¦å‘æ¼”åŒ–
   414â†’
   415â†’        Args:
   416â†’            user_id: ç”¨æˆ· ID
   417â†’            trigger: è§¦å‘ç±»å‹ (conversation, dayun_change, birthday, user_request)
   418â†’            context: è§¦å‘ä¸Šä¸‹æ–‡
   419â†’
   420â†’        Returns:
   421â†’            EvolutionResult {status, delta, insight, snapshot}
   422â†’        """
   423â†’        pass
   424â†’
   425â†’    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   426â†’    # æŸ¥è¯¢
   427â†’    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   428â†’
   429â†’    async def get_summary(self, user_id: UUID) -> Optional[VibeIDSummary]:
   430â†’        """
   431â†’        è·å–æ‘˜è¦ï¼ˆç”¨äº Prompt æ³¨å…¥ï¼‰
   432â†’
   433â†’        Returns:
   434â†’            VibeIDSummary {
   435â†’                primary_archetype,
   436â†’                archetype_cn_name,
   437â†’                signature,
   438â†’                communication_style
   439â†’            }
   440â†’        """
   441â†’        pass
   442â†’
   443â†’    async def get_full(self, user_id: UUID) -> Optional[VibeIDFull]:
   444â†’        """
   445â†’        è·å–å®Œæ•´æ•°æ®ï¼ˆç”¨äºå±•ç¤ºï¼‰
   446â†’
   447â†’        Returns:
   448â†’            VibeIDFull {
   449â†’                primary_archetype,
   450â†’                signature,
   451â†’                dimensions,
   452â†’                scores,
   453â†’                evolution,
   454â†’                sources
   455â†’            }
   456â†’        """
   457â†’        pass
   458â†’
   459â†’    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   460â†’    # æ¼”åŒ–è§¦å‘å™¨
   461â†’    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   462â†’
   463â†’    async def on_conversation_end(
   464â†’        self,
   465â†’        user_id: UUID,
   466â†’        conversation_summary: Dict[str, Any]
   467â†’    ) -> None:
   468â†’        """å¯¹è¯ç»“æŸåçš„æ¼”åŒ–ï¼ˆå¯¹è¯é©±åŠ¨ï¼‰"""
   469â†’        pass
   470â†’
   471â†’    async def on_lifecycle_event(
   472â†’        self,
   473â†’        user_id: UUID,
   474â†’        event_type: str,
   475â†’        event_data: Dict[str, Any]
   476â†’    ) -> None:
   477â†’        """ç”Ÿå‘½å‘¨æœŸäº‹ä»¶çš„æ¼”åŒ–ï¼ˆå‘¨æœŸé©±åŠ¨ï¼‰"""
   478â†’        pass
   479â†’
   480â†’    async def on_user_request(self, user_id: UUID) -> EvolutionResult:
   481â†’        """ç”¨æˆ·ä¸»åŠ¨è§¦å‘çš„æ¼”åŒ–ï¼ˆç”¨æˆ·é©±åŠ¨ï¼‰"""
   482â†’        pass
   483â†’```
   484â†’
   485â†’### 6.2 æ•°æ®ç±»å‹
   486â†’
   487â†’```python
   488â†’@dataclass
   489â†’class VibeIDSummary:
   490â†’    """VibeID æ‘˜è¦ï¼ˆç”¨äº Prompt æ³¨å…¥ï¼‰"""
   491â†’    primary_archetype: str          # "Explorer"
   492â†’    archetype_cn_name: str          # "æ¢ç´¢è€…"
   493â†’    signature: str                  # "è¿½æ±‚è‡ªç”±çš„æ™ºè€…ï¼Œå†…å¿ƒæ¸´æœ›è¿æ¥"
   494â†’    communication_style: str        # "å–œæ¬¢å¼€æ”¾å¼æ¢ç´¢ï¼Œä¸å–œæ¬¢è¢«é™åˆ¶"
   495â†’
   496â†’
   497â†’@dataclass
   498â†’class VibeIDFull:
   499â†’    """VibeID å®Œæ•´æ•°æ®"""
   500â†’    version: str
   501â†’    primary_archetype: str
   502â†’    archetype_signature: str
   503â†’    dimensions: Dict[str, DimensionData]
   504â†’    scores: Dict[str, float]
   505â†’    evolution: List[EvolutionRecord]
   506â†’    sources: Dict[str, SourceInfo]
   507â†’
   508â†’
   509â†’@dataclass
   510â†’class EvolutionRecord:
   511â†’    """æ¼”åŒ–è®°å½•"""
   512â†’    id: str
   513â†’    timestamp: str
   514â†’    trigger: str                    # conversation, dayun_change, birthday, user_request
   515â†’    delta: Optional[Dict[str, float]]
   516â†’    snapshot: Optional[Dict[str, Any]]
   517â†’    insight: str
   518â†’
   519â†’
   520â†’@dataclass
   521â†’class EvolutionResult:
   522â†’    """æ¼”åŒ–ç»“æœ"""
   523â†’    status: str                     # success, no_change, error
   524â†’    delta: Optional[Dict[str, float]]
   525â†’    insight: Optional[str]
   526â†’    snapshot: Optional[Dict[str, Any]]
   527â†’```
   528â†’
   529â†’---
   530â†’
   531â†’## 7. å®ç°è·¯çº¿å›¾
   532â†’
   533â†’### Phase 1: æ•°æ®æ¨¡å‹ä¸ Serviceï¼ˆåç«¯ä¼˜å…ˆï¼‰
   534â†’
   535â†’| ä»»åŠ¡ | è¯´æ˜ | ä¼˜å…ˆçº§ |
   536â†’|-----|------|-------|
   537â†’| æ•°æ®æ¨¡å‹è®¾è®¡ | ç¡®å®š `unified_profiles.vibe_id` Schema | P0 |
   538â†’| æ•°æ®è¿ç§»è„šæœ¬ | å°† `skill_data.vibe_id` æå‡åˆ°é¡¶å±‚ | P0 |
   539â†’| VibeIDService é‡æ„ | å®ç° get_summary(), evolve() | P0 |
   540â†’| CoreAgent æ³¨å…¥ | åœ¨ System Prompt ä¸­æ³¨å…¥ VibeID | P1 |
   541â†’
   542â†’### Phase 2: Proactive è”åŠ¨
   543â†’
   544â†’| ä»»åŠ¡ | è¯´æ˜ | ä¼˜å…ˆçº§ |
   545â†’|-----|------|-------|
   546â†’| reminders.yaml | åˆ›å»º VibeID æ¨é€é…ç½® | P1 |
   547â†’| rules/*.md | åˆ›å»ºå†…å®¹ç”Ÿæˆè§„åˆ™ | P1 |
   548â†’| æ¼”åŒ–è§¦å‘é›†æˆ | åœ¨ ProactiveEngine ä¸­é›†æˆ | P2 |
   549â†’
   550â†’### Phase 3: å‰ç«¯ç®€åŒ–
   551â†’
   552â†’| ä»»åŠ¡ | è¯´æ˜ | ä¼˜å…ˆçº§ |
   553â†’|-----|------|-------|
   554â†’| VibeIDCard é‡æ„ | å•ä¸€ä¸»åŸå‹ + äººæ ¼é‡‘å¥ | P2 |
   555â†’| æ¼”åŒ–æ—¶é—´çº¿ | å±•ç¤ºæˆé•¿è½¨è¿¹ | P3 |
   556â†’| æ·±åº¦æ¢ç´¢äº¤äº’ | å››ç»´è¯¦æƒ…å±•å¼€ | P3 |
   557â†’
   558â†’---
   559â†’
   560â†’## 8. é™„å½•
   561â†’
   562â†’### A. åŸå‹æ²Ÿé€šé£æ ¼æ˜ å°„
   563â†’
   564â†’| åŸå‹ | æ²Ÿé€šåå¥½ | AI å›åº”é£æ ¼ |
   565â†’|-----|---------|------------|
   566â†’| Explorer | å¼€æ”¾æ¢ç´¢ï¼Œä¸å–œæ¬¢è¢«é™åˆ¶ | æä¾›å¤šç§å¯èƒ½æ€§ï¼Œé¼“åŠ±å°è¯• |
   567â†’| Sage | è¿½æ±‚æ·±åº¦ï¼Œå–œæ¬¢åˆ†æ | æä¾›è¯¦ç»†è§£é‡Šï¼Œå¼•ç”¨çŸ¥è¯† |
   568â†’| Hero | ç›®æ ‡å¯¼å‘ï¼Œå–œæ¬¢æŒ‘æˆ˜ | ç›´æ¥ç»™å‡ºè¡ŒåŠ¨å»ºè®®ï¼Œè®¾å®šç›®æ ‡ |
   569â†’| Ruler | å–œæ¬¢æŒæ§ï¼Œéœ€è¦æ¡†æ¶ | ç»“æ„åŒ–å›ç­”ï¼Œæ¸…æ™°çš„æ­¥éª¤ |
   570â†’| Caregiver | é‡è§†å…³ç³»ï¼Œéœ€è¦æ”¯æŒ | æ¸©æš–å…±æƒ…ï¼Œå…³æ³¨æ„Ÿå— |
   571â†’| Lover | è¿½æ±‚è¿æ¥ï¼Œé‡è§†ä½“éªŒ | æƒ…æ„Ÿä¸°å¯Œï¼Œå¼ºè°ƒæ„Ÿå— |
   572â†’| Creator | è¿½æ±‚ç‹¬ç‰¹ï¼Œå–œæ¬¢åˆ›æ–° | é¼“åŠ±åˆ›æ„ï¼Œé¿å…å¥—è·¯ |
   573â†’| Outlaw | æŒ‘æˆ˜æƒå¨ï¼Œè¿½æ±‚è‡ªç”± | å°Šé‡ç‹¬ç«‹æ€§ï¼Œä¸è¯´æ•™ |
   574â†’| Magician | è¿½æ±‚è½¬åŒ–ï¼Œç›¸ä¿¡å¯èƒ½ | å¼ºè°ƒæ½œåŠ›ï¼Œæä¾›è½¬åŒ–è§†è§’ |
   575â†’| Innocent | è¿½æ±‚ç¾å¥½ï¼Œéœ€è¦å®‰å…¨ | æ­£é¢ç§¯æï¼Œæä¾›å®‰æ…° |
   576â†’| Jester | è¿½æ±‚å¿«ä¹ï¼Œå–œæ¬¢è½»æ¾ | å¹½é»˜é£è¶£ï¼Œä¸è¿‡äºä¸¥è‚ƒ |
   577â†’| Regular | è¿½æ±‚å½’å±ï¼Œé‡è§†è¿æ¥ | å¹³å®äº²åˆ‡ï¼Œå¼ºè°ƒå…±åŒç‚¹ |
   578â†’
   579â†’### B. ç‰ˆæœ¬å†å²
   580â†’
   581â†’- **v7.0** (2026-01-19): é‡æ„ä¸ºç”¨æˆ·èº«ä»½æ ¸å¿ƒï¼Œæ”¯æŒåŠ¨æ€æ¼”åŒ–å’Œå…¨æ ˆæ•´åˆ
   582â†’- **v6.0** (2026-01-15): V7 æ¶æ„å¯¹é½ï¼Œç®€åŒ–æ•°æ®æ¨¡å‹
   583â†’- **v5.0** (2026-01-10): é…ç½®é©±åŠ¨çš„èåˆç®—æ³•
   584â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
