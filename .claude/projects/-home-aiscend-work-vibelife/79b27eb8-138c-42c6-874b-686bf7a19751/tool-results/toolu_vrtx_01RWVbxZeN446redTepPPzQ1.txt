     1â†’# Ultra Analysis Report: VibeLife é«˜ç«¯æ™ºèƒ½æœåŠ¡ä½“ç³»æ„å»º
     2â†’
     3â†’> **åŸºäº**: VibeLife V8 åŒ—ææ˜Ÿæ–‡æ¡£ä¸ç³»ç»Ÿæ¶æ„æ·±åº¦åˆ†æ
     4â†’> **ç”Ÿæˆæ—¶é—´**: 2026-01-21
     5â†’> **åˆ†ææ·±åº¦**: Ultra Modeï¼ˆæ–‡æ¡£+ä»£ç +è®¿è°ˆï¼‰
     6â†’
     7â†’---
     8â†’
     9â†’## 1. é¡¹ç›®ç†è§£
    10â†’
    11â†’### 1.1 æ„¿æ™¯å®šä½
    12â†’
    13â†’VibeLife çš„åŒ—ææ˜Ÿç›®æ ‡æ˜¯ **"è®©æ¯ä¸€ä¸ªäººï¼Œéƒ½æ‹¥æœ‰ä¸€ä¸ªçœŸæ­£æ‡‚è‡ªå·±çš„å­˜åœ¨"**ã€‚
    14â†’
    15â†’å½“å‰é˜¶æ®µï¼ˆ2026-2028ï¼‰æ ¸å¿ƒç›®æ ‡ï¼š**è¯æ˜ AI å¯ä»¥çœŸæ­£ç†è§£ä¸€ä¸ªäºº**
    16â†’
    17â†’ä½ æå‡ºçš„"è¶…é«˜ç«¯æ™ºèƒ½æœåŠ¡"æ„¿æ™¯ï¼Œæœ¬è´¨ä¸Šæ˜¯è¦å®ç°åŒ—ææ˜Ÿæ–‡æ¡£ä¸­çš„å…³é”®åœºæ™¯ï¼š
    18â†’
    19â†’```
    20â†’2035å¹´çš„æ—å°è–‡ï¼š
    21â†’"æˆ‘ä»¬åœ¨ä¸€èµ·ä¸‰å¹´äº†ï¼Œä½ çš„å‘¼å¸ã€ä½ çš„æ‰“å­—èŠ‚å¥ï¼Œæˆ‘éƒ½èƒ½æ„Ÿå—åˆ°ã€‚"
    22â†’"å®ƒæ¯”æˆ‘è‡ªå·±æ›´æ‡‚æˆ‘æƒ³è¦ä»€ä¹ˆã€‚"
    23â†’```
    24â†’
    25â†’è¿™éœ€è¦å®ç°ä¸‰ä¸ªå±‚æ¬¡çš„çªç ´ï¼š
    26â†’1. **Deep Understanding**ï¼šç†è§£ç”¨æˆ·è¿™ä¸ªäººï¼ˆä¸ä»…æ˜¯é—®é¢˜ï¼‰
    27â†’2. **Proactive Agency**ï¼šä¸»åŠ¨å…³å¿ƒï¼ˆä¸ç­‰ç”¨æˆ·å¼€å£ï¼‰
    28â†’3. **Master-Level Guidance**ï¼šå¤§å¸ˆçº§æ™ºæ…§ï¼ˆä¸æ˜¯é€šç”¨ AIï¼‰
    29â†’
    30â†’### 1.2 ç°æœ‰ç³»ç»Ÿæ¶æ„ä¼˜åŠ¿
    31â†’
    32â†’V8 æ¶æ„å·²ç»å»ºç«‹äº†ä¼˜ç§€çš„æŠ€æœ¯åŸºç¡€ï¼š
    33â†’
    34â†’| æ¶æ„æ¨¡å— | å®Œæˆåº¦ | äº®ç‚¹ |
    35â†’|---------|--------|------|
    36â†’| CoreAgent (Agentic Loop) | âœ… 95% | LLM é©±åŠ¨çš„ tool callingï¼Œé…ç½®é©±åŠ¨çš„ SOP |
    37â†’| Skill ç³»ç»Ÿ | âœ… 90% | 6+ skillsï¼Œè‡ªåŠ¨å‘ç°ï¼Œåˆ†å±‚æ¶æ„ï¼ˆcore/default/professionalï¼‰|
    38â†’| VibeProfile | âœ… 95% | ç»Ÿä¸€çš„ JSONB å­˜å‚¨ï¼ŒHot/Cold Memory åˆ†ç¦» |
    39â†’| Knowledge Base v2 | âœ… 85% | Case å€’æ’ç´¢å¼•ï¼Œå¿«é€ŸåŒ¹é… |
    40â†’| Proactive Engine | âœ… 80% | æ—¶é—´/äº‹ä»¶è§¦å‘å™¨ï¼Œä¸»åŠ¨æ¨é€ |
    41â†’| Protocol å¼•æ“ | âœ… 95% | å®Œæ•´çš„é…ç½®é©±åŠ¨æµç¨‹å¼•æ“ |
    42â†’
    43â†’**æ ¸å¿ƒä¼˜åŠ¿**ï¼š
    44â†’- é…ç½®é©±åŠ¨ï¼Œæ˜“æ‰©å±•
    45â†’- Agent SDK æ¶æ„æˆç†Ÿ
    46â†’- æ•°æ®åŸºç¡€è®¾æ–½å®Œå–„ï¼ˆVibeProfileï¼‰
    47â†’- å¤šç»´æ™ºæ…§èåˆï¼ˆbazi + zodiac + lifecoachï¼‰
    48â†’
    49â†’---
    50â†’
    51â†’## 2. ç°çŠ¶è¯„ä¼°
    52â†’
    53â†’### 2.1 å·²æœ‰çš„ä¼˜ç§€å®ç°
    54â†’
    55â†’**Lifecoach Skillï¼ˆ4/5æ˜Ÿï¼‰**ï¼š
    56â†’- âœ… å››å¤§æ–¹æ³•è®ºï¼ˆDan Koeã€Coveyã€ç‹é˜³æ˜ã€äº†å‡¡å››è®­ï¼‰
    57â†’- âœ… Protocol å¼•æ“å®Œæ•´å®ç°
    58â†’- âœ… å·¥å…·ä½“ç³»å®Œå–„ï¼ˆ14ä¸ªå·¥å…·ï¼‰
    59â†’- âœ… æµ‹è¯•è¦†ç›–ç‡ 100%
    60â†’
    61â†’**Bazi/Zodiac Skillï¼ˆ5/5æ˜Ÿï¼‰**ï¼š
    62â†’- âœ… æ·±åº¦çš„å‘½ç†å’Œå æ˜Ÿåˆ†æ
    63â†’- âœ… çŸ¥è¯†åº“æ£€ç´¢æ”¯æ’‘
    64â†’- âœ… å¯è§†åŒ–å¡ç‰‡å±•ç¤º
    65â†’
    66â†’**Core Skillï¼ˆ4.5/5æ˜Ÿï¼‰**ï¼š
    67â†’- âœ… æ¸©æš–çš„ AI äººæ ¼
    68â†’- âœ… æ·±åº¦å€¾å¬å’Œå…±æƒ…èƒ½åŠ›
    69â†’- âœ… è·¨å¯¹è¯è®°å¿†æœºåˆ¶
    70â†’
    71â†’### 2.2 å½“å‰çŸ­æ¿ï¼ˆåŸºäºè®¿è°ˆå’Œä»£ç åˆ†æï¼‰
    72â†’
    73â†’#### çŸ­æ¿ 1ï¼šä¸ªæ€§åŒ–æ·±åº¦ä¸è¶³ â­â­â­ ï¼ˆå½±å“æœ€å¤§ï¼‰
    74â†’
    75â†’**é—®é¢˜**ï¼š
    76â†’- lifecoach çš„å››å¤§æ–¹æ³•è®º**å®Œå…¨æ²¡æœ‰**è¯»å–ç”¨æˆ·çš„å‘½ç›˜æ•°æ®ï¼ˆ`skill_data.bazi`, `skill_data.zodiac`ï¼‰
    77â†’- æ‰€æœ‰å¤§å¸ˆç»™çš„å»ºè®®éƒ½æ˜¯"é€šç”¨"çš„ï¼Œæ²¡æœ‰åŸºäºç”¨æˆ·çš„å¤©èµ‹ç¦€èµ‹
    78â†’
    79â†’**ä»£ç è¯æ®**ï¼ˆ`apps/api/skills/lifecoach/services/api.py:214-260`ï¼‰ï¼š
    80â†’```python
    81â†’@skill_service(skill_id="lifecoach", action="read_state")
    82â†’async def read_lifecoach_state(...):
    83â†’    # åªè¯»å– skill_data.lifecoach
    84â†’    lifecoach_data = profile.get("skill_data", {}).get("lifecoach", {})
    85â†’
    86â†’    # âŒ å®Œå…¨æ²¡æœ‰è¯»å– baziã€zodiac æ•°æ®ï¼
    87â†’    # bazi_data = profile.get("skill_data", {}).get("bazi", {})
    88â†’    # zodiac_data = profile.get("skill_data", {}).get("zodiac", {})
    89â†’```
    90â†’
    91â†’**å½±å“**ï¼š
    92â†’- ç‹é˜³æ˜ä¸çŸ¥é“ç”¨æˆ·æ˜¯"å£¬æ°´æ—¥ä¸»ï¼Œé£Ÿä¼¤è¿‡é‡ï¼Œç¼ºåœŸ"
    93â†’- Dan Koe ä¸çŸ¥é“ç”¨æˆ·"åœŸæ˜Ÿåœ¨ç¬¬åå®«ï¼Œäº‹ä¸šå‹åŠ›å¤§"
    94â†’- **å¤§å¸ˆå˜æˆäº†"é€šç”¨å»ºè®®ç”Ÿæˆå™¨"ï¼Œè€Œé"çœŸæ­£æ‡‚ä½ çš„å¯¼å¸ˆ"**
    95â†’
    96â†’#### çŸ­æ¿ 2ï¼šé•¿æœŸé™ªä¼´æœºåˆ¶ä¸å®Œæ•´ â­â­â­
    97â†’
    98â†’**é—®é¢˜**ï¼š
    99â†’- ç¼ºå°‘è·¨ skill çš„è®°å¿†ç´¯ç§¯ï¼ˆlifecoach ä¸çŸ¥é“ç”¨æˆ·ä¸Šæ¬¡å’Œ bazi èŠäº†ä»€ä¹ˆï¼‰
   100â†’- Proactive Engine åªåšæ¨é€ï¼Œæ²¡æœ‰ä¸»åŠ¨å…³æ€€å¯¹è¯ï¼ˆ"ä¸Šæ¬¡ä½ è¯´æƒ³è·³æ§½ï¼Œç°åœ¨æ€ä¹ˆæ ·äº†ï¼Ÿ"ï¼‰
   101â†’- ç¼ºå°‘æˆé•¿å¯è§†åŒ–ç³»ç»Ÿï¼ˆæ²¡æœ‰ timelineã€æ²¡æœ‰ milestoneï¼‰
   102â†’
   103â†’**ä»£ç è¯æ®**ï¼ˆ`apps/api/services/proactive/engine.py:87-110`ï¼‰ï¼š
   104â†’```python
   105â†’async def generate_daily_fortune(self, user_id: str, skill_id: str):
   106â†’    # âœ… èƒ½ç”Ÿæˆè¿åŠ¿æ¨é€
   107â†’    # âŒ ä½†åªæ˜¯å•å‘æ¨é€ï¼Œä¸æ˜¯åŒå‘å…³æ€€å¯¹è¯
   108â†’    # âŒ ä¸ä¼šé—®"ä¸Šæ¬¡ä½ è¯´çš„ç›®æ ‡è¿›å±•å¦‚ä½•ï¼Ÿ"
   109â†’```
   110â†’
   111â†’#### çŸ­æ¿ 3ï¼šç¼ºå°‘æ–°çš„"å¤§å¸ˆ"è§’è‰² â­â­
   112â†’
   113â†’- åªæœ‰ç‹é˜³æ˜ã€äº†å‡¡å››è®­ï¼ˆå„’é‡Šé“ä¸­ï¼Œ"é“"çš„ä»£è¡¨ç¼ºå¤±ï¼‰
   114â†’- æ²¡æœ‰ä½›æ•™å¤§å¸ˆï¼ˆä½›é™€ã€æ…§èƒ½ã€å¼˜ä¸€æ³•å¸ˆï¼‰
   115â†’- æ²¡æœ‰ç°ä»£è¥¿æ–¹å¤§å¸ˆï¼ˆJordan Petersonã€Carl Jung ç­‰ï¼‰
   116â†’
   117â†’#### çŸ­æ¿ 4ï¼šå‰ç«¯æ²‰æµ¸æ„Ÿä¸è¶³ â­
   118â†’
   119â†’- Protocol é¡µé¢å­˜åœ¨ä½†å¯èƒ½ä¸å®Œæ•´ï¼ˆ`/apps/web/src/app/protocol/[protocolId]/`ï¼‰
   120â†’- ç¼ºå°‘å¤§å¸ˆä¸“å±çš„è§†è§‰é£æ ¼å’Œä»ªå¼æ„Ÿ
   121â†’- ç¼ºå°‘è¯­éŸ³å¯¹è¯æ”¯æŒ
   122â†’
   123â†’---
   124â†’
   125â†’## 3. é—®é¢˜è¯†åˆ«ä¸ä¼˜å…ˆçº§
   126â†’
   127â†’æ ¹æ®ä½ çš„å›ç­”ï¼ˆä¼˜å…ˆçº§ 2ã€3ã€4ï¼‰ï¼Œæˆ‘è¯†åˆ«å‡ºä»¥ä¸‹å…³é”®é—®é¢˜ï¼š
   128â†’
   129â†’### P0 - æœ€é«˜ä¼˜å…ˆçº§
   130â†’
   131â†’**é—®é¢˜ 1ï¼šç°æœ‰å¤§å¸ˆä¸æ‡‚ç”¨æˆ·å‘½ç›˜**
   132â†’- **å½±å“**ï¼šç›´æ¥ç ´å"çœŸæ­£æ‡‚ä½ "çš„æ ¸å¿ƒä»·å€¼ä¸»å¼ 
   133â†’- **è§£å†³éš¾åº¦**ï¼šä¸­ç­‰ï¼ˆéœ€è¦æ”¹é€  lifecoach skill çš„ä¸Šä¸‹æ–‡æ„å»ºï¼‰
   134â†’- **ROI**ï¼šæé«˜ï¼ˆç«‹å³æå‡ç”¨æˆ·ä½“éªŒè´¨é‡ï¼‰
   135â†’
   136â†’**é—®é¢˜ 2ï¼šç¼ºå°‘é•¿æœŸè®°å¿†å’Œæˆé•¿è¿½è¸ª**
   137â†’- **å½±å“**ï¼šç”¨æˆ·æ— æ³•æ„Ÿå—åˆ°"é™ªä¼´æ„Ÿ"å’Œ"æˆé•¿æ„Ÿ"
   138â†’- **è§£å†³éš¾åº¦**ï¼šä¸­ç­‰ï¼ˆéœ€è¦æ–°çš„æ•°æ®æ¨¡å‹å’Œ proactive æœºåˆ¶ï¼‰
   139â†’- **ROI**ï¼šé«˜ï¼ˆå»ºç«‹é•¿æœŸç”¨æˆ·ç²˜æ€§ï¼‰
   140â†’
   141â†’### P1 - é«˜ä¼˜å…ˆçº§
   142â†’
   143â†’**é—®é¢˜ 3ï¼šå‰ç«¯æ²‰æµ¸å¼ä½“éªŒä¸è¶³**
   144â†’- **å½±å“**ï¼šç”¨æˆ·æ— æ³•æ„Ÿå—åˆ°"å¤§å¸ˆçº§"çš„ä»ªå¼æ„Ÿ
   145â†’- **è§£å†³éš¾åº¦**ï¼šé«˜ï¼ˆéœ€è¦å‰ç«¯è®¾è®¡å’Œå¼€å‘ï¼‰
   146â†’- **ROI**ï¼šä¸­é«˜ï¼ˆæå‡å“ç‰Œæ„ŸçŸ¥ï¼‰
   147â†’
   148â†’### P2 - ä¸­ä¼˜å…ˆçº§
   149â†’
   150â†’**é—®é¢˜ 4ï¼šç¼ºå°‘ä½›æ•™å¤§å¸ˆè§’è‰²**
   151â†’- **å½±å“**ï¼šç”¨æˆ·é€‰æ‹©æœ‰é™
   152â†’- **è§£å†³éš¾åº¦**ï¼šä½ï¼ˆå¤ç”¨ç°æœ‰ protocol å¼•æ“ï¼‰
   153â†’- **ROI**ï¼šä¸­ï¼ˆæ‰©å±•ç”¨æˆ·ç¾¤ï¼‰
   154â†’
   155â†’---
   156â†’
   157â†’## 4. å»ºè®®æ–¹æ¡ˆ
   158â†’
   159â†’åŸºäºä½ çš„ä¼˜å…ˆçº§ï¼ˆ2ã€3ã€4ï¼‰å’Œç³»ç»Ÿæ¶æ„ï¼Œæˆ‘æå‡ºä»¥ä¸‹ä¸‰é˜¶æ®µæ–¹æ¡ˆï¼š
   160â†’
   161â†’### Phase 1: å¤§å¸ˆä¸ªæ€§åŒ–å‡çº§ï¼ˆ2-3å‘¨ï¼‰â­â­â­â­â­
   162â†’
   163â†’**ç›®æ ‡**ï¼šè®©ç°æœ‰å››å¤§æ–¹æ³•è®ºçš„"å¤§å¸ˆ"èƒ½å¤ŸåŸºäºç”¨æˆ·å‘½ç›˜ç»™å‡ºä¸ªæ€§åŒ–æŒ‡å¯¼
   164â†’
   165â†’**æŠ€æœ¯æ–¹æ¡ˆ**ï¼š
   166â†’
   167â†’#### 1.1 æ”¹é€  lifecoach skill çš„ä¸Šä¸‹æ–‡æ„å»º
   168â†’
   169â†’**ä¿®æ”¹ä½ç½®**ï¼š`apps/api/skills/lifecoach/SKILL.md` + `apps/api/services/agent/core.py`
   170â†’
   171â†’**å…³é”®æ”¹åŠ¨**ï¼šåœ¨æ„å»º System Prompt æ—¶æ³¨å…¥å‘½ç›˜æ´å¯Ÿ
   172â†’
   173â†’```python
   174â†’# apps/api/services/agent/core.py (Phase 2 ä¸Šä¸‹æ–‡æ„å»º)
   175â†’
   176â†’async def _build_phase2_context(self, skill: str, context: AgentContext):
   177â†’    # ç°æœ‰é€»è¾‘...
   178â†’
   179â†’    # âœ¨ æ–°å¢ï¼šå¦‚æœæ˜¯ lifecoachï¼Œæ³¨å…¥å‘½ç›˜æ´å¯Ÿ
   180â†’    if skill == "lifecoach":
   181â†’        bazi_insights = await self._extract_bazi_insights(context)
   182â†’        zodiac_insights = await self._extract_zodiac_insights(context)
   183â†’
   184â†’        # æ·»åŠ åˆ° System Prompt çš„éšè—ä¸Šä¸‹æ–‡ä¸­
   185â†’        hidden_context = f"""
   186â†’## ç”¨æˆ·å¤©èµ‹ç¦€èµ‹ï¼ˆä»…ä¾›å‚è€ƒï¼Œä¸è¦ç›´æ¥æåŠï¼‰
   187â†’
   188â†’### å…«å­—æ´å¯Ÿ
   189â†’{bazi_insights}
   190â†’
   191â†’### æ˜Ÿç›˜æ´å¯Ÿ
   192â†’{zodiac_insights}
   193â†’
   194â†’**ä½¿ç”¨åŸåˆ™**ï¼š
   195â†’- åœ¨ç»™å»ºè®®æ—¶è‡ªç„¶èå…¥è¿™äº›æ´å¯Ÿ
   196â†’- ä¸è¦è¯´"æ ¹æ®ä½ çš„å…«å­—..."ï¼Œè€Œæ˜¯è¯´"ä»¥ä½ çš„ç‰¹è´¨æ¥çœ‹..."
   197â†’- è®©æŒ‡å¯¼çœ‹èµ·æ¥æ¥è‡ªæ·±åˆ»çš„ç†è§£ï¼Œè€Œéå‘½ç†è®¡ç®—
   198â†’"""
   199â†’```
   200â†’
   201â†’**å…·ä½“å®ç°**ï¼š
   202â†’
   203â†’```python
   204â†’# æ–°å¢æ–¹æ³•ï¼šæå–å‘½ç›˜æ´å¯Ÿ
   205â†’async def _extract_bazi_insights(self, context: AgentContext) -> str:
   206â†’    """ä» bazi æ•°æ®æå–ä¸ lifecoach ç›¸å…³çš„æ´å¯Ÿ"""
   207â†’    bazi_data = context.skill_data.get("bazi", {})
   208â†’    if not bazi_data:
   209â†’        return "ï¼ˆç”¨æˆ·æœªæä¾›å…«å­—ï¼‰"
   210â†’
   211â†’    chart = bazi_data.get("chart", {})
   212â†’    insights = []
   213â†’
   214â†’    # æå–å…³é”®ç‰¹è´¨
   215â†’    day_stem = chart.get("day_stem")
   216â†’    dominant_gods = bazi_data.get("features", {}).get("dominant_gods", [])
   217â†’
   218â†’    # ç”Ÿæˆæ´å¯Ÿæ–‡æœ¬
   219â†’    if day_stem:
   220â†’        insights.append(f"- æ—¥ä¸»ï¼š{day_stem}ï¼ˆä»£è¡¨æ ¸å¿ƒäººæ ¼ç‰¹è´¨ï¼‰")
   221â†’
   222â†’    if dominant_gods:
   223â†’        insights.append(f"- ä¸»å¯¼åç¥ï¼š{', '.join(dominant_gods[:2])}ï¼ˆå½±å“è¡Œä¸ºæ¨¡å¼ï¼‰")
   224â†’
   225â†’    # å½“å‰å¤§è¿/æµå¹´
   226â†’    current_dayun = bazi_data.get("current_dayun", {})
   227â†’    if current_dayun:
   228â†’        insights.append(f"- å½“å‰å¤§è¿ï¼š{current_dayun.get('name')}ï¼ˆäººç”Ÿé˜¶æ®µä¸»é¢˜ï¼‰")
   229â†’
   230â†’    return "\n".join(insights)
   231â†’```
   232â†’
   233â†’**æ•ˆæœç¤ºä¾‹**ï¼š
   234â†’
   235â†’**ä¹‹å‰**ï¼š
   236â†’```
   237â†’ç”¨æˆ·ï¼šæˆ‘æƒ³æ”¹å˜ç°çŠ¶ï¼Œä½†æ€»æ˜¯æ‹–å»¶
   238â†’ç‹é˜³æ˜ï¼šæ‹–å»¶å¾€å¾€æºäºå†…å¿ƒçš„ææƒ§...ï¼ˆé€šç”¨å»ºè®®ï¼‰
   239â†’```
   240â†’
   241â†’**ä¹‹å**ï¼š
   242â†’```
   243â†’ç”¨æˆ·ï¼šæˆ‘æƒ³æ”¹å˜ç°çŠ¶ï¼Œä½†æ€»æ˜¯æ‹–å»¶
   244â†’ç‹é˜³æ˜ï¼šä»¥ä½ çš„ç‰¹è´¨æ¥çœ‹ï¼Œä½ å¤©ç”Ÿæ€è™‘æ·±è¿œï¼ˆå£¬æ°´æ—¥ä¸»ï¼‰ï¼Œå®¹æ˜“æƒ³å¾—å¤ªå¤šã€‚
   245â†’       åŠ ä¸Šå½“å‰é˜¶æ®µï¼ˆç”²æœ¨å¤§è¿ï¼‰æ­£æ˜¯éœ€è¦å‘å¤–ç”Ÿå‘çš„æ—¶å€™ã€‚
   246â†’       è¯•è¯•å…ˆåšå†æƒ³ï¼Œè€Œä¸æ˜¯æƒ³æ¸…æ¥šå†åšã€‚
   247â†’```
   248â†’
   249â†’ç”¨æˆ·ä¼šè§‰å¾—ï¼š"å“‡ï¼Œç‹é˜³æ˜çœŸçš„æ‡‚æˆ‘ï¼"â€”â€”ä½†è¡¨é¢ä¸Šæ²¡æå…«å­—ã€‚
   250â†’
   251â†’#### 1.2 ä¸ºæ¯ä¸ªæ–¹æ³•è®ºå®šåˆ¶"å‘½ç›˜ä½¿ç”¨ç­–ç•¥"
   252â†’
   253â†’åœ¨ `apps/api/skills/lifecoach/rules/` ä¸‹æ¯ä¸ªæ–¹æ³•è®ºæ–‡ä»¶ä¸­æ·»åŠ ï¼š
   254â†’
   255â†’```yaml
   256â†’# rules/yangming.md
   257â†’
   258â†’---
   259â†’# ... ç°æœ‰ frontmatter
   260â†’contextual_insights:
   261â†’  use_bazi: true
   262â†’  use_zodiac: true
   263â†’  bazi_focus: [æ—¥ä¸»ç‰¹è´¨, åç¥, å¤§è¿]  # ç‹é˜³æ˜å…³æ³¨æ€§æ ¼æ ¹æº
   264â†’  zodiac_focus: [æœˆäº®æ˜Ÿåº§, åœŸæ˜Ÿä½ç½®]  # å…³æ³¨æƒ…ç»ªæ¨¡å¼å’Œä¸šåŠ›è¯¾é¢˜
   265â†’---
   266â†’
   267â†’## å¦‚ä½•ä½¿ç”¨å‘½ç›˜æ´å¯Ÿ
   268â†’
   269â†’å½“ç”¨æˆ·æåˆ°"çŸ¥è¡Œä¸ä¸€"é—®é¢˜æ—¶ï¼š
   270â†’- æŸ¥çœ‹åç¥ï¼šé£Ÿä¼¤è¿‡æ—º â†’ æ€è™‘è¿‡å¤šï¼Œéš¾ä»¥è¡ŒåŠ¨
   271â†’- æŸ¥çœ‹åœŸæ˜Ÿä½ç½®ï¼šåœŸæ˜Ÿåˆ‘æ—¥ â†’ è‡ªæˆ‘é™åˆ¶å¼º
   272â†’- ç»™å‡ºå»ºè®®ï¼šä»"äº‹ä¸Šç£¨ç»ƒ"å…¥æ‰‹ï¼Œå…ˆå°è¡ŒåŠ¨å»ºç«‹ä¿¡å¿ƒ
   273â†’```
   274â†’
   275â†’#### 1.3 åˆ›å»ºè·¨ Skill çš„æ´å¯Ÿèšåˆå±‚
   276â†’
   277â†’**æ–°å»ºæ–‡ä»¶**ï¼š`apps/api/services/agent/profile_insights.py`
   278â†’
   279â†’```python
   280â†’"""
   281â†’è·¨ Skill çš„ç”¨æˆ·æ´å¯ŸèšåˆæœåŠ¡
   282â†’"""
   283â†’from typing import Dict, Any, List
   284â†’
   285â†’class ProfileInsightsService:
   286â†’    """èšåˆå¤šä¸ª skill çš„æ•°æ®ï¼Œç”Ÿæˆç»¼åˆæ´å¯Ÿ"""
   287â†’
   288â†’    @staticmethod
   289â†’    async def get_personality_insights(profile: Dict[str, Any]) -> Dict[str, Any]:
   290â†’        """ç»¼åˆ bazi + zodiac + extractedï¼Œç”Ÿæˆæ€§æ ¼æ´å¯Ÿ"""
   291â†’        bazi_data = profile.get("skill_data", {}).get("bazi", {})
   292â†’        zodiac_data = profile.get("skill_data", {}).get("zodiac", {})
   293â†’        extracted = profile.get("extracted", {})
   294â†’
   295â†’        return {
   296â†’            "core_traits": self._merge_core_traits(bazi_data, zodiac_data),
   297â†’            "behavioral_patterns": self._merge_patterns(bazi_data, zodiac_data),
   298â†’            "growth_areas": self._identify_growth_areas(bazi_data, zodiac_data, extracted),
   299â†’            "current_phase": self._identify_current_phase(bazi_data, zodiac_data),
   300â†’        }
   301â†’
   302â†’    @staticmethod
   303â†’    def _merge_core_traits(bazi, zodiac) -> List[str]:
   304â†’        """èåˆå…«å­—å’Œæ˜Ÿç›˜çš„æ ¸å¿ƒç‰¹è´¨"""
   305â†’        traits = []
   306â†’
   307â†’        # ä»å…«å­—æå–
   308â†’        if bazi:
   309â†’            day_stem = bazi.get("chart", {}).get("day_stem")
   310â†’            if day_stem in ["å£¬", "ç™¸"]:
   311â†’                traits.append("æ€ç»´çµæ´»ï¼Œå–„äºåº”å˜")
   312â†’            # ... æ›´å¤šæ˜ å°„
   313â†’
   314â†’        # ä»æ˜Ÿç›˜æå–
   315â†’        if zodiac:
   316â†’            sun_sign = zodiac.get("chart", {}).get("sun", {}).get("sign")
   317â†’            if sun_sign == "Aquarius":
   318â†’                traits.append("ç‹¬ç«‹æ€è€ƒï¼Œåˆ›æ–°ç²¾ç¥")
   319â†’            # ... æ›´å¤šæ˜ å°„
   320â†’
   321â†’        return traits
   322â†’```
   323â†’
   324â†’**é¢„æœŸæ•ˆæœ**ï¼š
   325â†’
   326â†’å¤§å¸ˆç»™å»ºè®®æ—¶ï¼Œä¼šåŒæ—¶è€ƒè™‘ï¼š
   327â†’- å…«å­—çš„äº”è¡Œç‰¹è´¨ï¼ˆåº•å±‚èƒ½é‡æ¨¡å¼ï¼‰
   328â†’- æ˜Ÿç›˜çš„è¡Œæ˜Ÿé…ç½®ï¼ˆå¿ƒç†åŠ¨æœºï¼‰
   329â†’- å†å²å¯¹è¯æå–çš„äº‹å®ï¼ˆå®é™…æƒ…å†µï¼‰
   330â†’
   331â†’â†’ **å½¢æˆ"çœŸæ­£æ‡‚ä½ "çš„ä¸ªæ€§åŒ–æŒ‡å¯¼**
   332â†’
   333â†’---
   334â†’
   335â†’### Phase 2: é•¿æœŸé™ªä¼´ç³»ç»Ÿï¼ˆ3-4å‘¨ï¼‰â­â­â­â­â­
   336â†’
   337â†’**ç›®æ ‡**ï¼šè®©å¤§å¸ˆèƒ½å¤Ÿ"è®°å¾—"ä¹‹å‰çš„å¯¹è¯ï¼Œä¸»åŠ¨å…³å¿ƒç›®æ ‡è¿›åº¦ï¼Œå¹¶å¯è§†åŒ–æˆé•¿
   338â†’
   339â†’#### 2.1 æ•°æ®æ¨¡å‹æ‰©å±•
   340â†’
   341â†’**æ‰©å±• VibeProfile**ï¼ˆ`apps/api/stores/unified_profile_repo.py`ï¼‰ï¼š
   342â†’
   343â†’```yaml
   344â†’# unified_profiles.profile æ–°å¢å­—æ®µ
   345â†’
   346â†’life_journey:
   347â†’  milestones: []  # é‡è¦æ—¶åˆ»ï¼ˆé¦–æ¬¡çªç ´ã€å…³é”®å†³å®šç­‰ï¼‰
   348â†’  recurring_themes: []  # åå¤å‡ºç°çš„æ¨¡å¼ï¼ˆå¦‚"æ‹–å»¶"ã€"é€ƒé¿äº²å¯†å…³ç³»"ï¼‰
   349â†’  master_observations: []  # å¤§å¸ˆçš„é•¿æœŸè§‚å¯Ÿ
   350â†’  growth_metrics:
   351â†’    self_awareness_score: 0-100  # è‡ªæˆ‘è§‰å¯Ÿåº¦
   352â†’    action_consistency_score: 0-100  # çŸ¥è¡Œåˆä¸€åº¦
   353â†’    emotional_balance_score: 0-100  # æƒ…ç»ªå¹³è¡¡åº¦
   354â†’```
   355â†’
   356â†’**æ–°å¢è¡¨**ï¼š`vibe_profile_timeline`ï¼ˆå·²å­˜åœ¨ï¼Œå¤ç”¨ï¼‰
   357â†’
   358â†’```sql
   359â†’-- è®°å½•ä¸å¤§å¸ˆå¯¹è¯çš„å…³é”®èŠ‚ç‚¹
   360â†’CREATE TABLE vibe_profile_timeline (
   361â†’    id TEXT PRIMARY KEY,
   362â†’    user_id TEXT NOT NULL,
   363â†’    event_type TEXT,  -- 'insight', 'goal_set', 'breakthrough', 'challenge'
   364â†’    title TEXT,
   365â†’    description TEXT,
   366â†’    related_skill TEXT,  -- 'lifecoach:yangming', 'bazi', etc.
   367â†’    metadata JSONB,  -- { protocol_id, conversation_id, ... }
   368â†’    created_at TIMESTAMPTZ
   369â†’);
   370â†’```
   371â†’
   372â†’#### 2.2 æ”¹é€  Proactive Engine ä¸º"ä¸»åŠ¨å…³æ€€"æ¨¡å¼
   373â†’
   374â†’**å½“å‰é—®é¢˜**ï¼šProactive Engine åªæ˜¯å•å‘æ¨é€
   375â†’
   376â†’**æ”¹é€ æ–¹æ¡ˆ**ï¼šæ”¯æŒ"å¯¹è¯å¼æ¨é€"
   377â†’
   378â†’**æ–°å»ºæ–‡ä»¶**ï¼š`apps/api/services/proactive/companion.py`
   379â†’
   380â†’```python
   381â†’"""
   382â†’Companion ä¸»åŠ¨å…³æ€€å¼•æ“
   383â†’"""
   384â†’class CompanionEngine:
   385â†’    """ä¸»åŠ¨å…³æ€€å¼•æ“ï¼ŒåŸºäºç”¨æˆ·çŠ¶æ€ç”Ÿæˆå…³æ€€å¯¹è¯"""
   386â†’
   387â†’    async def generate_check_in(self, user_id: str) -> Optional[Dict]:
   388â†’        """ç”Ÿæˆç­¾åˆ°å…³æ€€"""
   389â†’        profile = await UnifiedProfileRepository.get_profile(user_id)
   390â†’
   391â†’        # æ£€æŸ¥æ˜¯å¦æœ‰æœªå®Œæˆçš„ç›®æ ‡
   392â†’        goals = profile.get("life_context", {}).get("goals", [])
   393â†’        active_goals = [g for g in goals if g.get("status") == "active"]
   394â†’
   395â†’        if active_goals:
   396â†’            # é€‰æ‹©æœ€é‡è¦çš„ç›®æ ‡
   397â†’            goal = max(active_goals, key=lambda g: g.get("priority", 0))
   398â†’
   399â†’            # ç”Ÿæˆå…³æ€€æ¶ˆæ¯
   400â†’            return {
   401â†’                "type": "goal_check_in",
   402â†’                "title": f"å…³äºã€Œ{goal['title']}ã€",
   403â†’                "content": await self._generate_check_in_prompt(user_id, goal),
   404â†’                "suggested_reply": "åˆ†äº«ä¸€ä¸‹è¿›å±•ï¼Ÿ",
   405â†’            }
   406â†’
   407â†’        # æ£€æŸ¥æ˜¯å¦æœ‰åå¤å‡ºç°çš„æ¨¡å¼
   408â†’        themes = profile.get("life_journey", {}).get("recurring_themes", [])
   409â†’        if themes:
   410â†’            recent_theme = themes[-1]
   411â†’            return {
   412â†’                "type": "pattern_observation",
   413â†’                "content": f"æˆ‘æ³¨æ„åˆ°ã€Œ{recent_theme['pattern']}ã€è¿™ä¸ªæ¨¡å¼åˆå‡ºç°äº†...",
   414â†’            }
   415â†’
   416â†’        return None
   417â†’
   418â†’    async def _generate_check_in_prompt(self, user_id: str, goal: Dict) -> str:
   419â†’        """ä½¿ç”¨ LLM ç”Ÿæˆä¸ªæ€§åŒ–çš„å…³æ€€æç¤ºè¯"""
   420â†’        # è·å–ç”¨æˆ·çš„ preferred master
   421â†’        preferred_master = "yangming"  # ä» profile è¯»å–
   422â†’
   423â†’        # è°ƒç”¨ LLM ç”Ÿæˆ
   424â†’        prompt = f"""
   425â†’ä½ æ˜¯{preferred_master}ã€‚ç”¨æˆ·ä¸Šæ¬¡å’Œä½ å®šäº†ä¸€ä¸ªç›®æ ‡ï¼š
   426â†’
   427â†’{goal}
   428â†’
   429â†’ç°åœ¨è¿‡å»äº†{self._days_since(goal['created_at'])}å¤©ã€‚
   430â†’è¯·ç”Ÿæˆä¸€å¥ç®€çŸ­çš„å…³æ€€è¯è¯­ï¼Œè¯¢é—®è¿›å±•ã€‚
   431â†’
   432â†’è¦æ±‚ï¼š
   433â†’- ç¬¦åˆ{preferred_master}çš„è¯­æ°”
   434â†’- æ¸©æš–ä½†ä¸æ–½å‹
   435â†’- å¼•å¯¼ç”¨æˆ·åˆ†äº«
   436â†’"""
   437â†’        # ... LLM è°ƒç”¨
   438â†’```
   439â†’
   440â†’**è§¦å‘æœºåˆ¶**ï¼š
   441â†’
   442â†’```python
   443â†’# æ¯æ—¥å‡Œæ™¨ 4:00 æ‰«æ
   444â†’async def daily_scan():
   445â†’    users = await get_active_users()
   446â†’
   447â†’    for user in users:
   448â†’        # ç”Ÿæˆä¸»åŠ¨å…³æ€€
   449â†’        check_in = await CompanionEngine().generate_check_in(user.id)
   450â†’
   451â†’        if check_in:
   452â†’            # åˆ›å»ºé€šçŸ¥
   453â†’            await create_notification(
   454â†’                user_id=user.id,
   455â†’                type="companion_check_in",
   456â†’                content=check_in,
   457â†’                deliver_hour=user.preferred_hour  # ç”¨æˆ·è®¾ç½®çš„æ¨é€æ—¶é—´
   458â†’            )
   459â†’```
   460â†’
   461â†’**å‰ç«¯æ•ˆæœ**ï¼š
   462â†’
   463â†’```
   464â†’ã€é€šçŸ¥ã€‘ç‹é˜³æ˜
   465â†’
   466â†’"çŸ¥è¡Œåˆä¸€ï¼Œè´µåœ¨æŒæ’ã€‚
   467â†’ä¸Šæ¬¡ä½ è¯´è¦æ¯å¤©å†¥æƒ³10åˆ†é’Ÿï¼Œç°åœ¨å¦‚ä½•äº†ï¼Ÿ"
   468â†’
   469â†’[åˆ†äº«è¿›å±•] [æ”¹å¤©èŠ]
   470â†’```
   471â†’
   472â†’ç‚¹å‡»åè¿›å…¥å¯¹è¯ï¼Œç‹é˜³æ˜ä¼šç»§ç»­å¼•å¯¼å¤ç›˜ã€‚
   473â†’
   474â†’#### 2.3 æˆé•¿å¯è§†åŒ–ç³»ç»Ÿ
   475â†’
   476â†’**æ–°å»ºç»„ä»¶**ï¼š`apps/web/src/components/journey/GrowthTimeline.tsx`
   477â†’
   478â†’```tsx
   479â†’/**
   480â†’ * æˆé•¿æ—¶é—´çº¿ç»„ä»¶
   481â†’ * å±•ç¤ºç”¨æˆ·ä¸å¤§å¸ˆå¯¹è¯çš„å…³é”®èŠ‚ç‚¹
   482â†’ */
   483â†’export function GrowthTimeline({ userId }: { userId: string }) {
   484â†’  const { timeline } = useJourneyData(userId);
   485â†’
   486â†’  return (
   487â†’    <div className="growth-timeline">
   488â†’      {timeline.map(event => (
   489â†’        <TimelineNode key={event.id} event={event}>
   490â†’          <div className="event-icon">
   491â†’            {event.type === 'breakthrough' && 'ğŸŒŸ'}
   492â†’            {event.type === 'goal_set' && 'ğŸ¯'}
   493â†’            {event.type === 'insight' && 'ğŸ’¡'}
   494â†’          </div>
   495â†’          <div className="event-content">
   496â†’            <h4>{event.title}</h4>
   497â†’            <p>{event.description}</p>
   498â†’            <span className="master-badge">
   499â†’              {getMasterName(event.related_skill)}
   500â†’            </span>
   501â†’          </div>
   502â†’        </TimelineNode>
   503â†’      ))}
   504â†’    </div>
   505â†’  );
   506â†’}
   507â†’```
   508â†’
   509â†’**æ•°æ®æµ**ï¼š
   510â†’
   511â†’```
   512â†’ç”¨æˆ·ä¸ç‹é˜³æ˜å¯¹è¯
   513â†’  â†’ CoreAgent è¯†åˆ«åˆ°å…³é”®æ´å¯Ÿ/ç›®æ ‡
   514â†’  â†’ è°ƒç”¨ add_milestone å·¥å…·
   515â†’  â†’ å†™å…¥ vibe_profile_timeline
   516â†’  â†’ å‰ç«¯ GrowthTimeline å±•ç¤º
   517â†’```
   518â†’
   519â†’**å¯è§†åŒ–ç»´åº¦**ï¼š
   520â†’
   521â†’1. **æ—¶é—´çº¿è§†å›¾**ï¼šå±•ç¤ºä¸å¤§å¸ˆå¯¹è¯çš„å…³é”®èŠ‚ç‚¹
   522â†’2. **æˆé•¿é›·è¾¾å›¾**ï¼šå±•ç¤º growth_metrics çš„å˜åŒ–
   523â†’3. **ç›®æ ‡è¿›åº¦çœ‹æ¿**ï¼šå±•ç¤ºæ‰€æœ‰ç›®æ ‡çš„çŠ¶æ€
   524â†’4. **æ¨¡å¼è¯†åˆ«**ï¼šå±•ç¤º recurring_themes
   525â†’
   526â†’---
   527â†’
   528â†’### Phase 3: æ²‰æµ¸å¼å‰ç«¯ä½“éªŒï¼ˆ2-3å‘¨ï¼‰â­â­â­â­
   529â†’
   530â†’**ç›®æ ‡**ï¼šä¸ºæ¯ä½"å¤§å¸ˆ"æ‰“é€ ä¸“å±çš„è§†è§‰é£æ ¼å’Œå¯¹è¯æ°›å›´
   531â†’
   532â†’#### 3.1 Protocol é¡µé¢å®Œå–„
   533â†’
   534â†’**å½“å‰çŠ¶æ€**ï¼šProtocol é¡µé¢å­˜åœ¨ä½†å¯èƒ½ä¸å®Œæ•´
   535â†’
   536â†’**æ”¹è¿›æ–¹æ¡ˆ**ï¼š
   537â†’
   538â†’```tsx
   539â†’// apps/web/src/app/protocol/[protocolId]/page.tsx
   540â†’
   541â†’export default function ProtocolPage({ params }: { params: { protocolId: string } }) {
   542â†’  const { protocol, currentStep, loading } = useProtocol(params.protocolId);
   543â†’
   544â†’  // æ ¹æ® protocolId åŠ è½½ä¸åŒçš„è§†è§‰ä¸»é¢˜
   545â†’  const theme = useMemo(() => getMasterTheme(params.protocolId), [params.protocolId]);
   546â†’
   547â†’  return (
   548â†’    <div className="protocol-container" style={theme.styles}>
   549â†’      {/* èƒŒæ™¯æ°›å›´ */}
   550â†’      <MasterAmbience master={params.protocolId} />
   551â†’
   552â†’      {/* å¤§å¸ˆå¤´åƒ */}
   553â†’      <MasterAvatar master={params.protocolId} emotion={getEmotion(currentStep)} />
   554â†’
   555â†’      {/* è¿›åº¦æŒ‡ç¤º */}
   556â†’      <ProtocolProgress
   557â†’        current={currentStep}
   558â†’        total={protocol.total_steps}
   559â†’        theme={theme}
   560â†’      />
   561â†’
   562â†’      {/* å¯¹è¯åŒºåŸŸ */}
   563â†’      <ProtocolChat
   564â†’        protocolId={params.protocolId}
   565â†’        currentStep={currentStep}
   566â†’        onComplete={handleComplete}
   567â†’        theme={theme}
   568â†’      />
   569â†’    </div>
   570â†’  );
   571â†’}
   572â†’```
   573â†’
   574â†’#### 3.2 æ¯ä½å¤§å¸ˆçš„è§†è§‰ä¸»é¢˜
   575â†’
   576â†’**æ–°å»ºæ–‡ä»¶**ï¼š`apps/web/src/config/masterThemes.ts`
   577â†’
   578â†’```typescript
   579â†’export const masterThemes = {
   580â†’  yangming: {
   581â†’    name: "ç‹é˜³æ˜",
   582â†’    colors: {
   583â†’      primary: "#8B4513",      // å„’å®¶æ£•
   584â†’      secondary: "#D4AF37",    // é‡‘è‰²ç‚¹ç¼€
   585â†’      background: "linear-gradient(135deg, #f5f5dc 0%, #e8dcc4 100%)",
   586â†’    },
   587â†’    fonts: {
   588â†’      heading: "'Noto Serif SC', serif",  // å®‹ä½“æ„Ÿ
   589â†’      body: "'Noto Sans SC', sans-serif",
   590â†’    },
   591â†’    avatar: "/assets/masters/yangming.png",
   592â†’    ambience: {
   593â†’      particles: "bamboo",  // ç«¹å¶é£˜è½
   594â†’      sound: "/assets/sounds/guqin.mp3",  // å¤ç´èƒŒæ™¯éŸ³
   595â†’    },
   596â†’  },
   597â†’
   598â†’  buddha: {
   599â†’    name: "ä½›é™€",
   600â†’    colors: {
   601â†’      primary: "#FF9800",      // æ©™è¢ˆè£Ÿ
   602â†’      secondary: "#FFC107",    // é‡‘å…‰
   603â†’      background: "linear-gradient(135deg, #fff9e6 0%, #ffe0b2 100%)",
   604â†’    },
   605â†’    avatar: "/assets/masters/buddha.png",
   606â†’    ambience: {
   607â†’      particles: "lotus",  // è²èŠ±é£˜è½
   608â†’      sound: "/assets/sounds/tibetan-bowl.mp3",
   609â†’    },
   610â†’  },
   611â†’
   612â†’  dankoe: {
   613â†’    name: "Dan Koe",
   614â†’    colors: {
   615â†’      primary: "#1E90FF",      // ç°ä»£è“
   616â†’      secondary: "#00BFFF",
   617â†’      background: "linear-gradient(135deg, #f0f8ff 0%, #e6f2ff 100%)",
   618â†’    },
   619â†’    avatar: "/assets/masters/dankoe.jpg",
   620â†’    ambience: {
   621â†’      particles: "none",  // æç®€
   622â†’      sound: null,
   623â†’    },
   624â†’  },
   625â†’};
   626â†’```
   627â†’
   628â†’#### 3.3 ä»ªå¼æ„Ÿè®¾è®¡
   629â†’
   630â†’**è¿›å…¥åè®®æ—¶**ï¼š
   631â†’
   632â†’```tsx
   633â†’// æ·¡å…¥æ•ˆæœ + å¤§å¸ˆå‡ºç°åŠ¨ç”»
   634â†’<motion.div
   635â†’  initial={{ opacity: 0, scale: 0.8 }}
   636â†’  animate={{ opacity: 1, scale: 1 }}
   637â†’  transition={{ duration: 1.2, ease: "easeOut" }}
   638â†’>
   639â†’  <MasterAvatar master="yangming" />
   640â†’  <motion.p
   641â†’    initial={{ opacity: 0, y: 20 }}
   642â†’    animate={{ opacity: 1, y: 0 }}
   643â†’    transition={{ delay: 0.5 }}
   644â†’  >
   645â†’    "çŸ¥è¡Œåˆä¸€ï¼Œè´µåœ¨å½“ä¸‹ã€‚ä»Šæ—¥æˆ‘ä»¬å…±åŒæ¢ç´¢..."
   646â†’  </motion.p>
   647â†’</motion.div>
   648â†’```
   649â†’
   650â†’**å®Œæˆåè®®æ—¶**ï¼š
   651â†’
   652â†’```tsx
   653â†’// åº†ç¥åŠ¨ç”» + æˆå°±è§£é”
   654â†’<Confetti />
   655â†’<AchievementUnlocked
   656â†’  title="çŸ¥è¡Œåˆä¸€Â·åˆæ¢"
   657â†’  description="å®Œæˆäº†ä¸ç‹é˜³æ˜çš„ç¬¬ä¸€æ¬¡æ·±åº¦å¯¹è°ˆ"
   658â†’  icon="ğŸ†"
   659â†’/>
   660â†’```
   661â†’
   662â†’---
   663â†’
   664â†’### Phase 4: æ–°å¢ä½›æ•™å¤§å¸ˆï¼ˆ1-2å‘¨ï¼‰â­â­â­
   665â†’
   666â†’**ç›®æ ‡**ï¼šæ·»åŠ ä½›é™€ã€æ…§èƒ½ã€å¼˜ä¸€æ³•å¸ˆä¸‰ä½å¤§å¸ˆ
   667â†’
   668â†’**å®ç°æ–¹å¼**ï¼šå¤ç”¨ç°æœ‰ Protocol å¼•æ“
   669â†’
   670â†’#### 4.1 åˆ›å»ºä½›æ•™æ–¹æ³•è®º rule æ–‡ä»¶
   671â†’
   672â†’**æ–°å»ºæ–‡ä»¶**ï¼š`apps/api/skills/lifecoach/rules/buddhist/`
   673â†’
   674â†’```
   675â†’buddhist/
   676â†’â”œâ”€â”€ buddha.md      # ä½›é™€ï¼šå››åœ£è°› + å…«æ­£é“
   677â†’â”œâ”€â”€ huineng.md     # æ…§èƒ½ï¼šé¡¿æ‚Ÿæ³•é—¨ + æœ¬æ€§æ¸…å‡€
   678â†’â””â”€â”€ hongyi.md      # å¼˜ä¸€ï¼šæŒæˆ’ä¿®è¡Œ + è‰ºæœ¯äººç”Ÿ
   679â†’```
   680â†’
   681â†’**ç¤ºä¾‹**ï¼š`rules/buddhist/buddha.md`
   682â†’
   683â†’```yaml
   684â†’---
   685â†’id: buddha
   686â†’name: ä½›é™€å¿ƒæ³•
   687â†’impact: HIGH
   688â†’tags: ç—›è‹¦, æ‰§ç€, çƒ¦æ¼, è´ªå—”ç—´, è§£è„±, æ¶…æ§ƒ
   689â†’origin: ã€Šé˜¿å«ç»ã€‹ã€Šæ³•å¥ç»ã€‹
   690â†’card_types: [buddha, action_plan]
   691â†’---
   692â†’
   693â†’# ä½›é™€å¿ƒæ³•åè®®
   694â†’
   695â†’## è§¦å‘è¡Œä¸º
   696â†’å½“é€šè¿‡ tags åŒ¹é…åˆ°æ­¤è§„åˆ™æ—¶ï¼Œç«‹å³è°ƒç”¨ `show_protocol_invitation`ã€‚
   697â†’
   698â†’## æ ¸å¿ƒç†å¿µ
   699â†’> "è¯¸æ³•å› ç¼˜ç”Ÿï¼Œè¯¸æ³•å› ç¼˜ç­ã€‚"
   700â†’
   701â†’**å››åœ£è°›**ï¼š
   702â†’1. è‹¦è°›ï¼šç”Ÿå‘½çš„æœ¬è´¨æ˜¯è‹¦ï¼ˆdukkhaï¼‰
   703â†’2. é›†è°›ï¼šè‹¦çš„æ ¹æºæ˜¯æ¸´çˆ±ï¼ˆtanhÄï¼‰
   704â†’3. ç­è°›ï¼šè‹¦å¯ä»¥è¢«æ­¢æ¯ï¼ˆæ¶…æ§ƒï¼‰
   705â†’4. é“è°›ï¼šå…«æ­£é“æ˜¯æ­¢æ¯è‹¦çš„æ–¹æ³•
   706â†’
   707â†’## åè®®æ¦‚è§ˆ
   708â†’| é˜¶æ®µ | é—®é¢˜æ•° | æ—¶é•¿ | ç›®çš„ |
   709â†’|-----|-------|------|------|
   710â†’| Phase 1: è§‚è‹¦ | 2 | 4åˆ†é’Ÿ | æ­£è§†ç—›è‹¦ï¼Œä¸é€ƒé¿ |
   711â†’| Phase 2: æº¯æº | 2 | 3åˆ†é’Ÿ | æ‰¾åˆ°æ‰§ç€çš„æ ¹æº |
   712â†’| Phase 3: æ”¾ä¸‹ | 2 | 3åˆ†é’Ÿ | è®¾è®¡æ­£å¿µè¡ŒåŠ¨ |
   713â†’
   714â†’## Phase 1: è§‚è‹¦
   715â†’
   716â†’### Q1: å½“ä¸‹ä¹‹è‹¦
   717â†’```
   718â†’æ­¤åˆ»ï¼Œè®©ä½ æ„Ÿåˆ°ç—›è‹¦æˆ–ä¸æ»¡çš„æ˜¯ä»€ä¹ˆï¼Ÿ
   719â†’ä¸è¦ç¾åŒ–ï¼Œä¸è¦é€ƒé¿ï¼Œå°±çœ‹ç€å®ƒã€‚
   720â†’```
   721â†’
   722â†’### Q2: è‹¦çš„æ ·è²Œ
   723â†’```
   724â†’è¿™ä¸ªç—›è‹¦ï¼Œåœ¨ä½ çš„èº«ä½“é‡Œæ˜¯ä»€ä¹ˆæ„Ÿè§‰ï¼Ÿ
   725â†’ç´§ç»·ï¼Ÿç©ºè™šï¼Ÿç¼çƒ­ï¼Ÿæ²‰é‡ï¼Ÿ
   726â†’```
   727â†’
   728â†’## Phase 2: æº¯æº
   729â†’
   730â†’### Q3: æ‰§ç€ä½•ç‰©
   731â†’```
   732â†’è¿™ä»½ç—›è‹¦ï¼Œæºäºä½ æ¸´æœ›ä»€ä¹ˆï¼Ÿ
   733â†’æˆ–è€…ï¼Œææƒ§å¤±å»ä»€ä¹ˆï¼Ÿ
   734â†’```
   735â†’
   736â†’### Q4: æ‰§ç€ä¹‹æ ¹
   737â†’```
   738â†’è¿™ä¸ªæ¸´æœ›/ææƒ§ï¼Œæ˜¯ä½•æ—¶å¼€å§‹çš„ï¼Ÿ
   739â†’æ˜¯è°å‘Šè¯‰ä½ "å¿…é¡»"è¦è¿™æ ·ï¼Ÿ
   740â†’```
   741â†’
   742â†’## Phase 3: æ”¾ä¸‹
   743â†’
   744â†’### Q5: æ­£å¿µè¡ŒåŠ¨
   745â†’```
   746â†’å¦‚æœä¸å†æŠ“ç´§è¿™ä¸ªæ‰§ç€ï¼Œä½ ä¼šåšä»€ä¹ˆä¸åŒçš„é€‰æ‹©ï¼Ÿ
   747â†’```
   748â†’
   749â†’### Q6: å…«æ­£é“å®è·µ
   750â†’```
   751â†’é€‰ä¸€ä¸ª"æ­£é“"å¼€å§‹ï¼š
   752â†’- æ­£è¯­ï¼šè¯´çœŸè¯ï¼Œä¸ä¼¤äºº
   753â†’- æ­£å¿µï¼šè§‰å¯Ÿå½“ä¸‹ï¼Œä¸è¯„åˆ¤
   754â†’- æ­£ç²¾è¿›ï¼šæŒç»­ä½†ä¸æ‰§ç€
   755â†’
   756â†’ä½ å‡†å¤‡ä»å“ªä¸ªå¼€å§‹ï¼Ÿ
   757â†’```
   758â†’
   759â†’## æ•°æ®è¾“å‡º
   760â†’
   761â†’| å­—æ®µ | å€¼ | å­˜å‚¨ä½ç½® |
   762â†’|-----|---|---------|
   763â†’| suffering | ç”¨æˆ·çš„ç—›è‹¦ | journal (insight) |
   764â†’| attachment | æ‰§ç€çš„å¯¹è±¡ | north_star.pain_points |
   765â†’| practice | é€‰æ‹©çš„æ­£é“ | current.action |
   766â†’```
   767â†’
   768â†’#### 4.2 é…ç½®å¤§å¸ˆå…ƒæ•°æ®
   769â†’
   770â†’**ä¿®æ”¹**ï¼š`apps/api/services/agent/routing_config.py`
   771â†’
   772â†’```yaml
   773â†’# config/routing.yaml
   774â†’
   775â†’protocols:
   776â†’  # ... ç°æœ‰åè®®
   777â†’
   778â†’  buddha:
   779â†’    name: "ä½›é™€å¿ƒæ³•"
   780â†’    description: "é€šè¿‡å››åœ£è°›å’Œå…«æ­£é“ï¼Œè§‰å¯Ÿç—›è‹¦ï¼Œæ”¾ä¸‹æ‰§ç€"
   781â†’    estimated_time: "10åˆ†é’Ÿ"
   782â†’    total_steps: 6
   783â†’    tags: [ç—›è‹¦, æ‰§ç€, çƒ¦æ¼, è´ªå—”ç—´]
   784â†’    master_persona: |
   785â†’      æˆ‘æ˜¯ä½›é™€ã€‚æˆ‘ä¸æä¾›ç­”æ¡ˆï¼Œæˆ‘å¼•å¯¼ä½ çœ‹è§çœŸç›¸ã€‚
   786â†’      ç—›è‹¦ä¸æ˜¯æ•Œäººï¼Œæ‰§ç€æ‰æ˜¯ã€‚
   787â†’      æˆ‘çš„è¯­æ°”ï¼šå¹³é™ã€æ…ˆæ‚²ã€ä½†ç›´æŒ‡æœ¬è´¨ã€‚
   788â†’
   789â†’  huineng:
   790â†’    name: "æ…§èƒ½é¡¿æ‚Ÿ"
   791â†’    description: "ç›´æŒ‡æœ¬å¿ƒï¼Œè§æ€§æˆä½›ï¼Œä¸ç«‹æ–‡å­—"
   792â†’    estimated_time: "8åˆ†é’Ÿ"
   793â†’    total_steps: 5
   794â†’    tags: [è¿·èŒ«, å¯»æ‰¾è‡ªå·±, æœ¬æ€§, å¼€æ‚Ÿ]
   795â†’
   796â†’  hongyi:
   797â†’    name: "å¼˜ä¸€æŒæˆ’"
   798â†’    description: "ä¸¥æŒæˆ’å¾‹ï¼Œè‰ºæœ¯äººç”Ÿï¼Œä»æ”¾ä¸‹ä¸­å¾—è‡ªç”±"
   799â†’    estimated_time: "12åˆ†é’Ÿ"
   800â†’    total_steps: 7
   801â†’    tags: [è‡ªå¾‹, æŒæˆ’, æ¬²æœ›, è‰ºæœ¯]
   802â†’```
   803â†’
   804â†’#### 4.3 åˆ›å»ºä¸“å±å¡ç‰‡
   805â†’
   806â†’**æ–°å»º**ï¼š`apps/web/src/skills/lifecoach/cards/BuddhaCard.tsx`
   807â†’
   808â†’```tsx
   809â†’/**
   810â†’ * ä½›é™€å¿ƒæ³•å®Œæˆå¡ç‰‡
   811â†’ * å±•ç¤ºï¼šç—›è‹¦ â†’ æ‰§ç€ â†’ æ­£é“
   812â†’ */
   813â†’export function BuddhaCard({ data }: { data: BuddhaResult }) {
   814â†’  return (
   815â†’    <Card className="buddha-card">
   816â†’      <div className="lotus-background">
   817â†’        <img src="/assets/lotus.svg" alt="è²èŠ±" />
   818â†’      </div>
   819â†’
   820â†’      <Section title="ğŸŒ¸ ä½ çš„ç—›è‹¦">
   821â†’        <p>{data.suffering}</p>
   822â†’      </Section>
   823â†’
   824â†’      <Section title="ğŸ”— æ‰§ç€çš„æ ¹æº">
   825â†’        <p>{data.attachment}</p>
   826â†’      </Section>
   827â†’
   828â†’      <Section title="ğŸ›¤ï¸ ä½ çš„æ­£é“">
   829â†’        <p className="practice">{data.practice}</p>
   830â†’        <p className="quote">
   831â†’          "ä¸€åˆ‡æœ‰ä¸ºæ³•ï¼Œå¦‚æ¢¦å¹»æ³¡å½±ã€‚"
   832â†’        </p>
   833â†’      </Section>
   834â†’    </Card>
   835â†’  );
   836â†’}
   837â†’```
   838â†’
   839â†’**é¢„æœŸæ•ˆæœ**ï¼š
   840â†’
   841â†’- ç”¨æˆ·è¯´"æœ€è¿‘å¾ˆç—›è‹¦" â†’ CoreAgent åŒ¹é…åˆ° `buddha` åè®®
   842â†’- å±•ç¤ºé‚€è¯·å¡ç‰‡ï¼š"ä½›é™€å¿ƒæ³• - 10åˆ†é’Ÿè§‰å¯Ÿç—›è‹¦ï¼Œæ”¾ä¸‹æ‰§ç€"
   843â†’- ç”¨æˆ·è¿›å…¥ `/protocol/buddha` é¡µé¢
   844â†’- æ©™è‰²ä¸»é¢˜ï¼Œè²èŠ±é£˜è½ï¼Œé¢‚é’µéŸ³æ•ˆ
   845â†’- å®Œæˆåå±•ç¤ºä½›é™€å¡ç‰‡ï¼Œè®°å½•åˆ° timeline
   846â†’
   847â†’---
   848â†’
   849â†’## 5. ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼ˆRoadmapï¼‰
   850â†’
   851â†’### ç¬¬ä¸€é˜¶æ®µï¼ˆ2-3å‘¨ï¼‰ï¼šå¤§å¸ˆä¸ªæ€§åŒ–å‡çº§ â­â­â­â­â­
   852â†’
   853â†’**Week 1**: åç«¯æ”¹é€ 
   854â†’- [ ] ä¿®æ”¹ CoreAgentï¼Œåœ¨ Phase 2 æ³¨å…¥å‘½ç›˜æ´å¯Ÿ
   855â†’- [ ] åˆ›å»º `ProfileInsightsService`ï¼Œèšåˆ bazi + zodiac æ•°æ®
   856â†’- [ ] ä¸ºæ¯ä¸ªæ–¹æ³•è®ºæ·»åŠ  `contextual_insights` é…ç½®
   857â†’- [ ] æµ‹è¯•ï¼šéªŒè¯å¤§å¸ˆèƒ½"çœ‹åˆ°"å‘½ç›˜ä¿¡æ¯
   858â†’
   859â†’**Week 2-3**: ä¼˜åŒ–å’ŒéªŒè¯
   860â†’- [ ] åˆ›å»ºæµ‹è¯•è„šæœ¬ï¼Œå¯¹æ¯”å‡çº§å‰åçš„å›å¤è´¨é‡
   861â†’- [ ] è°ƒæ•´æ¯ä¸ªå¤§å¸ˆä½¿ç”¨å‘½ç›˜ä¿¡æ¯çš„"åº¦"ï¼ˆç‹é˜³æ˜å¤šç”¨ï¼ŒDan Koeå°‘ç”¨ï¼‰
   862â†’- [ ] ç¼–å†™æ–‡æ¡£ï¼š`docs/master-personalization-guide.md`
   863â†’
   864â†’**æˆåŠŸæ ‡å‡†**ï¼š
   865â†’- ç”¨æˆ·ä¸ç‹é˜³æ˜å¯¹è¯æ—¶ï¼Œå»ºè®®æ˜æ˜¾æ›´è´´åˆå…¶å‘½ç›˜ç‰¹è´¨
   866â†’- ä½†è¡¨é¢ä¸æ"å…«å­—"ã€"æ˜Ÿç›˜"ç­‰è¯æ±‡
   867â†’- ç”¨æˆ·æ„Ÿå—ï¼š"è¿™ä¸ª AI çœŸçš„æ‡‚æˆ‘ï¼"
   868â†’
   869â†’---
   870â†’
   871â†’### ç¬¬äºŒé˜¶æ®µï¼ˆ3-4å‘¨ï¼‰ï¼šé•¿æœŸé™ªä¼´ç³»ç»Ÿ â­â­â­â­â­
   872â†’
   873â†’**Week 1**: æ•°æ®æ¨¡å‹
   874â†’- [ ] æ‰©å±• VibeProfileï¼Œæ·»åŠ  `life_journey` å­—æ®µ
   875â†’- [ ] å¤ç”¨ `vibe_profile_timeline` è¡¨
   876â†’- [ ] åˆ›å»º `add_milestone` å·¥å…·
   877â†’
   878â†’**Week 2**: Proactive Companion
   879â†’- [ ] å®ç° `CompanionEngine`
   880â†’- [ ] ä¿®æ”¹ Proactive Workerï¼Œæ”¯æŒå¯¹è¯å¼æ¨é€
   881â†’- [ ] æµ‹è¯•ï¼šéªŒè¯å¤§å¸ˆèƒ½ä¸»åŠ¨å…³å¿ƒç›®æ ‡
   882â†’
   883â†’**Week 3**: æˆé•¿å¯è§†åŒ–
   884â†’- [ ] å‰ç«¯ï¼š`GrowthTimeline` ç»„ä»¶
   885â†’- [ ] å‰ç«¯ï¼šæˆé•¿é›·è¾¾å›¾
   886â†’- [ ] å‰ç«¯ï¼šç›®æ ‡çœ‹æ¿
   887â†’
   888â†’**Week 4**: é›†æˆæµ‹è¯•
   889â†’- [ ] ç«¯åˆ°ç«¯æµ‹è¯•ï¼šä»å¯¹è¯ â†’ milestone â†’ ä¸»åŠ¨å…³æ€€ â†’ å¯è§†åŒ–
   890â†’- [ ] ç”¨æˆ·æµ‹è¯•ï¼šé‚€è¯· 10 ä½çœŸå®ç”¨æˆ·ä½“éªŒ
   891â†’
   892â†’**æˆåŠŸæ ‡å‡†**ï¼š
   893â†’- ç”¨æˆ·èƒ½çœ‹åˆ°ä¸å¤§å¸ˆå¯¹è¯çš„æˆé•¿æ—¶é—´çº¿
   894â†’- å¤§å¸ˆèƒ½ä¸»åŠ¨å‘æ¶ˆæ¯ï¼š"ä¸Šæ¬¡ä½ è¯´æƒ³è·³æ§½ï¼Œç°åœ¨æ€ä¹ˆæ ·äº†ï¼Ÿ"
   895â†’- ç”¨æˆ·ç•™å­˜ç‡æå‡ 20%+
   896â†’
   897â†’---
   898â†’
   899â†’### ç¬¬ä¸‰é˜¶æ®µï¼ˆ2-3å‘¨ï¼‰ï¼šæ²‰æµ¸å¼å‰ç«¯ â­â­â­â­
   900â†’
   901â†’**Week 1**: è§†è§‰ä¸»é¢˜
   902â†’- [ ] è®¾è®¡æ¯ä½å¤§å¸ˆçš„è§†è§‰ä¸»é¢˜
   903â†’- [ ] å®ç° `MasterTheme` ç³»ç»Ÿ
   904â†’- [ ] æ·»åŠ æ°›å›´ç²’å­æ•ˆæœ
   905â†’
   906â†’**Week 2**: Protocol é¡µé¢
   907â†’- [ ] å®Œå–„ `/protocol/[protocolId]` é¡µé¢
   908â†’- [ ] æ·»åŠ è¿›å…¥/å®Œæˆä»ªå¼æ„Ÿ
   909â†’- [ ] å®ç°æˆå°±ç³»ç»Ÿ
   910â†’
   911â†’**Week 3**: ç»†èŠ‚ä¼˜åŒ–
   912â†’- [ ] æ·»åŠ éŸ³æ•ˆï¼ˆå¯é€‰ï¼‰
   913â†’- [ ] ä¼˜åŒ–åŠ¨ç”»æµç•…åº¦
   914â†’- [ ] ç§»åŠ¨ç«¯é€‚é…
   915â†’
   916â†’**æˆåŠŸæ ‡å‡†**ï¼š
   917â†’- ç”¨æˆ·è¿›å…¥åè®®æ—¶æœ‰"è¿›å…¥ä¿®è¡Œ"çš„ä»ªå¼æ„Ÿ
   918â†’- å®Œæˆåæœ‰æˆå°±æ„Ÿ
   919â†’- NPS > 70
   920â†’
   921â†’---
   922â†’
   923â†’### ç¬¬å››é˜¶æ®µï¼ˆ1-2å‘¨ï¼‰ï¼šæ–°å¢ä½›æ•™å¤§å¸ˆ â­â­â­
   924â†’
   925â†’**Week 1**: åè®®åˆ›å»º
   926â†’- [ ] ç¼–å†™ `buddha.md`, `huineng.md`, `hongyi.md`
   927â†’- [ ] é…ç½® routing.yaml
   928â†’- [ ] åˆ›å»ºä¸“å±å¡ç‰‡ç»„ä»¶
   929â†’
   930â†’**Week 2**: æµ‹è¯•å’Œä¸Šçº¿
   931â†’- [ ] æµ‹è¯•ä¸‰ä¸ªåè®®çš„å®Œæ•´æµç¨‹
   932â†’- [ ] è°ƒæ•´å¤§å¸ˆçš„è¯­æ°”å’Œæ·±åº¦
   933â†’- [ ] ä¸Šçº¿å¹¶æ”¶é›†ç”¨æˆ·åé¦ˆ
   934â†’
   935â†’**æˆåŠŸæ ‡å‡†**ï¼š
   936â†’- ä¸‰ä½ä½›æ•™å¤§å¸ˆä¸Šçº¿
   937â†’- ç”¨æˆ·èƒ½æ ¹æ®éœ€æ±‚é€‰æ‹©åˆé€‚çš„å¤§å¸ˆ
   938â†’- "ä¸ä½›é™€å¯¹è°ˆ"æˆä¸ºç‰¹è‰²åŠŸèƒ½
   939â†’
   940â†’---
   941â†’
   942â†’## 6. æŠ€æœ¯å®ç°è¦ç‚¹
   943â†’
   944â†’### 6.1 åˆ©ç”¨ Agent SDK æ¡†æ¶çš„æœ€ä½³å®è·µ
   945â†’
   946â†’åŸºäºä½ çš„åå¥½ï¼ˆ"ç”¨ skill å’Œ rule"ï¼‰ï¼Œä»¥ä¸‹æ˜¯å…³é”®è®¾è®¡åŸåˆ™ï¼š
   947â†’
   948â†’#### åŸåˆ™ 1ï¼šSkill æ˜¯"å¤§å¸ˆèº«ä»½"ï¼ŒRule æ˜¯"æ–¹æ³•è®º"
   949â†’
   950â†’```
   951â†’lifecoach (Skill)
   952â†’  â”œâ”€â”€ rules/yangming.md      â† ç‹é˜³æ˜çš„æ–¹æ³•è®º
   953â†’  â”œâ”€â”€ rules/dankoe.md        â† Dan Koe çš„æ–¹æ³•è®º
   954â†’  â””â”€â”€ rules/buddhist/
   955â†’      â”œâ”€â”€ buddha.md          â† ä½›é™€çš„æ–¹æ³•è®º
   956â†’      â””â”€â”€ huineng.md         â† æ…§èƒ½çš„æ–¹æ³•è®º
   957â†’
   958â†’æ¯ä¸ª rule æ–‡ä»¶å®šä¹‰ï¼š
   959â†’- å¤§å¸ˆçš„è¯­æ°”ï¼ˆmaster_personaï¼‰
   960â†’- åè®®æµç¨‹ï¼ˆphases + questionsï¼‰
   961â†’- å·¥å…·è°ƒç”¨ï¼ˆshow_protocol_invitationï¼‰
   962â†’```
   963â†’
   964â†’#### åŸåˆ™ 2ï¼šç”¨ Subagent å®ç°å¤§å¸ˆçš„"æ·±åº¦å¯¹è¯"
   965â†’
   966â†’```python
   967â†’# å½“ç”¨æˆ·å®Œæˆåè®®åï¼Œæƒ³ç»§ç»­æ·±å…¥æ¢è®¨
   968â†’# å¯ä»¥å¯åŠ¨ä¸€ä¸ª subagentï¼Œä¸“é—¨æ‰®æ¼”è¯¥å¤§å¸ˆ
   969â†’
   970â†’@tool_handler("talk_with_master")
   971â†’async def talk_with_master(args: Dict, context: ToolContext):
   972â†’    master_id = args["master"]  # yangming, buddha, etc.
   973â†’
   974â†’    # å¯åŠ¨ subagent
   975â†’    subagent = Subagent(
   976â†’        name=f"{master_id}_dialogue",
   977â†’        system_prompt=load_master_persona(master_id),
   978â†’        tools=["search_db", "add_milestone"],
   979â†’        max_turns=20,  # æ”¯æŒé•¿å¯¹è¯
   980â†’    )
   981â†’
   982â†’    # æ³¨å…¥ç”¨æˆ·çš„å‘½ç›˜æ´å¯Ÿ
   983â†’    hidden_context = await ProfileInsightsService.get_personality_insights(
   984â†’        context.profile
   985â†’    )
   986â†’
   987â†’    result = await subagent.run(
   988â†’        user_message=args["user_message"],
   989â†’        hidden_context=hidden_context,
   990â†’    )
   991â†’
   992â†’    return result
   993â†’```
   994â†’
   995â†’**æ•ˆæœ**ï¼š
   996â†’- ç”¨æˆ·å®Œæˆåè®®åï¼Œå¯ä»¥ç‚¹å‡»"ç»§ç»­ä¸ç‹é˜³æ˜å¯¹è°ˆ"
   997â†’- è¿›å…¥ä¸€ä¸ªæŒç»­çš„å¯¹è¯æ¨¡å¼ï¼ˆä¸å†æ˜¯ç»“æ„åŒ–é—®ç­”ï¼‰
   998â†’- ç‹é˜³æ˜ä¾ç„¶èƒ½çœ‹åˆ°ç”¨æˆ·å‘½ç›˜ï¼Œç»™å‡ºä¸ªæ€§åŒ–å»ºè®®
   999â†’
  1000â†’#### åŸåˆ™ 3ï¼šç”¨ SOP State ç®¡ç†åè®®è¿›åº¦
  1001â†’
  1002â†’```python
  1003â†’# apps/api/services/agent/sop_state.py
  1004â†’
  1005â†’# å·²æœ‰çš„ SOP State æœºåˆ¶éå¸¸é€‚åˆ Protocol å¼•æ“
  1006â†’# åªéœ€æ‰©å±•ï¼š
  1007â†’
  1008â†’async def save_protocol_state(user_id: str, protocol_id: str, state: Dict):
  1009â†’    """ä¿å­˜åè®®è¿›åº¦"""
  1010â†’    await UnifiedProfileRepository.update_skill_state(
  1011â†’        user_id,
  1012â†’        "lifecoach",
  1013â†’        f"protocol:{protocol_id}",
  1014â†’        state
  1015â†’    )
  1016â†’
  1017â†’async def resume_protocol(user_id: str, protocol_id: str) -> Optional[Dict]:
  1018â†’    """æ¢å¤æœªå®Œæˆçš„åè®®"""
  1019â†’    state = await UnifiedProfileRepository.get_skill_state(
  1020â†’        user_id,
  1021â†’        "lifecoach",
  1022â†’        f"protocol:{protocol_id}"
  1023â†’    )
  1024â†’
  1025â†’    if state and state.get("status") == "in_progress":
  1026â†’        return state  # { current_step, answers, started_at }
  1027â†’
  1028â†’    return None
  1029â†’```
  1030â†’
  1031â†’**æ•ˆæœ**ï¼š
  1032â†’- ç”¨æˆ·å¯ä»¥æš‚åœåè®®ï¼Œç¨åç»§ç»­
  1033â†’- å¤§å¸ˆä¼šè¯´ï¼š"æ¬¢è¿å›æ¥ï¼Œæˆ‘ä»¬ä¸Šæ¬¡èŠåˆ°äº†..."
  1034â†’
  1035â†’---
  1036â†’
  1037â†’### 6.2 å…³é”®ä»£ç æ”¹åŠ¨æ¸…å•
  1038â†’
  1039â†’| æ–‡ä»¶ | æ”¹åŠ¨å†…å®¹ | éš¾åº¦ | ä¼˜å…ˆçº§ |
  1040â†’|------|---------|------|-------|
  1041â†’| `services/agent/core.py` | åœ¨ Phase 2 æ³¨å…¥å‘½ç›˜æ´å¯Ÿ | ä¸­ | P0 |
  1042â†’| `services/agent/profile_insights.py` | æ–°å»ºï¼šè·¨ skill æ´å¯Ÿèšåˆ | ä¸­ | P0 |
  1043â†’| `skills/lifecoach/SKILL.md` | æ·»åŠ  contextual_insights é…ç½® | ä½ | P0 |
  1044â†’| `skills/lifecoach/rules/*.md` | ä¸ºæ¯ä¸ªæ–¹æ³•è®ºæ·»åŠ å‘½ç›˜ä½¿ç”¨ç­–ç•¥ | ä½ | P0 |
  1045â†’| `stores/unified_profile_repo.py` | æ‰©å±• life_journey å­—æ®µ | ä½ | P1 |
  1046â†’| `services/proactive/companion.py` | æ–°å»ºï¼šä¸»åŠ¨å…³æ€€å¼•æ“ | é«˜ | P1 |
  1047â†’| `skills/lifecoach/tools/handlers.py` | æ–°å¢ `add_milestone` å·¥å…· | ä¸­ | P1 |
  1048â†’| `apps/web/src/components/journey/` | æ–°å»ºï¼šæˆé•¿å¯è§†åŒ–ç»„ä»¶ | ä¸­ | P1 |
  1049â†’| `apps/web/src/app/protocol/` | å®Œå–„åè®®é¡µé¢ | é«˜ | P2 |
  1050â†’| `apps/web/src/config/masterThemes.ts` | æ–°å»ºï¼šå¤§å¸ˆè§†è§‰ä¸»é¢˜ | ä¸­ | P2 |
  1051â†’| `skills/lifecoach/rules/buddhist/` | æ–°å»ºï¼šä½›æ•™å¤§å¸ˆåè®® | ä½ | P3 |
  1052â†’
  1053â†’---
  1054â†’
  1055â†’## 7. é£é™©ä¸æŒ‘æˆ˜
  1056â†’
  1057â†’### 7.1 æŠ€æœ¯é£é™©
  1058â†’
  1059â†’**é£é™© 1**ï¼šLLM å¯èƒ½"è¯´æ¼å˜´"ï¼Œç›´æ¥æåˆ°å…«å­—/æ˜Ÿç›˜
  1060â†’
  1061â†’**ç¼“è§£æ–¹æ¡ˆ**ï¼š
  1062â†’- åœ¨ System Prompt æ˜ç¡®å¼ºè°ƒ"ä¸è¦è¯´'æ ¹æ®ä½ çš„å…«å­—...'"
  1063â†’- æä¾›æ­£åç¤ºä¾‹ï¼š
  1064â†’  ```
  1065â†’  âŒ "æ ¹æ®ä½ çš„å£¬æ°´æ—¥ä¸»..."
  1066â†’  âœ… "ä»¥ä½ çš„ç‰¹è´¨æ¥çœ‹ï¼Œä½ å¤©ç”Ÿæ€è™‘æ·±è¿œ..."
  1067â†’  ```
  1068â†’- æ·»åŠ  Post-processing æ£€æŸ¥ï¼Œè¿‡æ»¤æ•æ„Ÿè¯
  1069â†’
  1070â†’**é£é™© 2**ï¼šå‘½ç›˜æ´å¯Ÿä¸ç”¨æˆ·å®é™…æƒ…å†µä¸ç¬¦ï¼Œå¯¼è‡´è¯¯å¯¼
  1071â†’
  1072â†’**ç¼“è§£æ–¹æ¡ˆ**ï¼š
  1073â†’- å‘½ç›˜æ´å¯Ÿä»…ä½œä¸º"å‚è€ƒ"ï¼Œä¸ä½œä¸º"æ–­è¨€"
  1074â†’- å§‹ç»ˆç»™ç”¨æˆ·åé¦ˆçš„ç©ºé—´ï¼š"è¿™ç¬¦åˆä½ çš„æ„Ÿå—å—ï¼Ÿ"
  1075â†’- é€æ­¥éªŒè¯ï¼Œæ”¶é›†ç”¨æˆ·åé¦ˆï¼Œè°ƒæ•´ç®—æ³•
  1076â†’
  1077â†’### 7.2 ä½“éªŒé£é™©
  1078â†’
  1079â†’**é£é™© 3**ï¼šæ²‰æµ¸å¼è®¾è®¡å¯èƒ½è®©éƒ¨åˆ†ç”¨æˆ·æ„Ÿåˆ°"è¿‡åº¦åŒ…è£…"
  1080â†’
  1081â†’**ç¼“è§£æ–¹æ¡ˆ**ï¼š
  1082â†’- æä¾›"ç®€æ´æ¨¡å¼"å¼€å…³
  1083â†’- A/B æµ‹è¯•ä¸åŒçš„è§†è§‰å¼ºåº¦
  1084â†’- ä¼˜å…ˆä¿è¯å†…å®¹è´¨é‡ï¼Œè§†è§‰ä½œä¸º"é”¦ä¸Šæ·»èŠ±"
  1085â†’
  1086â†’### 7.3 è¿è¥é£é™©
  1087â†’
  1088â†’**é£é™© 4**ï¼šæ–°å¢å¤§å¸ˆåï¼Œç”¨æˆ·ä¸çŸ¥é“å¦‚ä½•é€‰æ‹©
  1089â†’
  1090â†’**ç¼“è§£æ–¹æ¡ˆ**ï¼š
  1091â†’- æä¾›"å¤§å¸ˆæ¨è"åŠŸèƒ½ï¼š
  1092â†’  ```
  1093â†’  ç”¨æˆ·è¯´ï¼š"æˆ‘å¾ˆè¿·èŒ«"
  1094â†’  AI: "æ ¹æ®ä½ çš„æƒ…å†µï¼Œæˆ‘æ¨èï¼š
  1095â†’    - ç‹é˜³æ˜ï¼ˆçŸ¥è¡Œåˆä¸€ï¼Œé€‚åˆæ€è™‘è¿‡å¤šçš„ä½ ï¼‰
  1096â†’    - ä½›é™€ï¼ˆè§‚ç…§ç—›è‹¦ï¼Œæ”¾ä¸‹æ‰§ç€ï¼‰
  1097â†’    å“ªä¸ªæ›´å¸å¼•ä½ ï¼Ÿ"
  1098â†’  ```
  1099â†’- åœ¨é¦–é¡µå±•ç¤ºå¤§å¸ˆç®€ä»‹å¡ç‰‡
  1100â†’
  1101â†’---
  1102â†’
  1103â†’## 8. æˆåŠŸæ ‡å‡†ä¸ KPI
  1104â†’
  1105â†’### 8.1 äº§å“æŒ‡æ ‡
  1106â†’
  1107â†’| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ï¼ˆ3ä¸ªæœˆåï¼‰|
  1108â†’|-----|------|--------------|
  1109â†’| "AI æ‡‚æˆ‘"è¯„åˆ† | ? | > 4.5/5 |
  1110â†’| 12ä¸ªæœˆç•™å­˜ç‡ | ? | > 50% |
  1111â†’| NPS | ? | > 60 |
  1112â†’| æ—¥å‡ä½¿ç”¨æ—¶é•¿ | ? | > 8 åˆ†é’Ÿ |
  1113â†’| Protocol å®Œæˆç‡ | ? | > 70% |
  1114â†’| ä¸»åŠ¨å…³æ€€å“åº”ç‡ | 0% | > 40% |
  1115â†’
  1116â†’### 8.2 æŠ€æœ¯æŒ‡æ ‡
  1117â†’
  1118â†’| æŒ‡æ ‡ | ç›®æ ‡ |
  1119â†’|-----|-----|
  1120â†’| Protocol API å“åº”æ—¶é—´ | < 500ms (P95) |
  1121â†’| LLM è°ƒç”¨æˆåŠŸç‡ | > 99% |
  1122â†’| å‘½ç›˜æ´å¯Ÿæ³¨å…¥è¦†ç›–ç‡ | > 95%ï¼ˆæœ‰å‘½ç›˜æ•°æ®çš„ç”¨æˆ·ï¼‰|
  1123â†’| Timeline æŸ¥è¯¢æ€§èƒ½ | < 200ms (P95) |
  1124â†’
  1125â†’### 8.3 ç”¨æˆ·å®šæ€§åé¦ˆ
  1126â†’
  1127â†’**æˆåŠŸæ ‡å¿—**ï¼š
  1128â†’- "ç‹é˜³æ˜çœŸçš„æ‡‚æˆ‘ï¼Œä»–è¯´çš„éƒ½æˆ³ä¸­äº†"
  1129â†’- "æˆ‘æ„Ÿè§‰æˆ‘åœ¨å’ŒçœŸäººå¤§å¸ˆå¯¹è¯ï¼Œä¸æ˜¯ AI"
  1130â†’- "è¿™ä¸ª App é™ªæˆ‘æˆé•¿äº†åŠå¹´ï¼Œæˆ‘éƒ½ä¸æƒ³æ¢äº†"
  1131â†’
  1132â†’---
  1133â†’
  1134â†’## 9. æ€»ç»“
  1135â†’
  1136â†’VibeLife å·²ç»æœ‰äº†ä¼˜ç§€çš„æŠ€æœ¯åŸºç¡€ï¼ˆV8 æ¶æ„ï¼‰å’Œäº§å“æ„¿æ™¯ï¼ˆåŒ—ææ˜Ÿæ–‡æ¡£ï¼‰ã€‚
  1137â†’
  1138â†’**è·ç¦»"è®©ç”¨æˆ·æ·±åº¦äº«å—è¶…é«˜ç«¯æ™ºèƒ½æœåŠ¡"çš„ç›®æ ‡ï¼Œä¸»è¦ç¼ºå¤±**ï¼š
  1139â†’
  1140â†’1. **ä¸ªæ€§åŒ–æ·±åº¦**ï¼šå¤§å¸ˆè¦èƒ½"çœ‹åˆ°"ç”¨æˆ·çš„å‘½ç›˜ï¼Œç»™å‡ºé’ˆå¯¹æ€§å»ºè®®ï¼ˆåº•å±‚èåˆï¼Œè¡¨é¢è‡ªç„¶ï¼‰
  1141â†’2. **é•¿æœŸé™ªä¼´**ï¼šå¤§å¸ˆè¦"è®°å¾—"ç”¨æˆ·ï¼Œä¸»åŠ¨å…³å¿ƒï¼Œå¯è§†åŒ–æˆé•¿
  1142â†’3. **æ²‰æµ¸å¼ä½“éªŒ**ï¼šæ¯ä½å¤§å¸ˆæœ‰ç‹¬ç‰¹çš„è§†è§‰é£æ ¼å’Œä»ªå¼æ„Ÿ
  1143â†’4. **å¤§å¸ˆå¤šæ ·æ€§**ï¼šè¡¥å……ä½›æ•™ç­‰æ–°çš„æ™ºæ…§ç»´åº¦
  1144â†’
  1145â†’**æŠ€æœ¯å®ç°è·¯å¾„æ¸…æ™°**ï¼š
  1146â†’- å……åˆ†åˆ©ç”¨ç°æœ‰çš„ Agent SDK æ¡†æ¶ï¼ˆSkill + Rule + Tool + Subagentï¼‰
  1147â†’- æ‰©å±• VibeProfileï¼ˆlife_journeyï¼‰
  1148â†’- æ”¹é€  Proactive Engineï¼ˆå¯¹è¯å¼å…³æ€€ï¼‰
  1149â†’- å®Œå–„å‰ç«¯ Protocol é¡µé¢
  1150â†’
  1151â†’**å»ºè®®ä¼˜å…ˆçº§**ï¼š
  1152â†’1. **Phase 1ï¼ˆP0ï¼‰**ï¼šå¤§å¸ˆä¸ªæ€§åŒ–å‡çº§ â†’ **ç«‹å³æå‡ä½“éªŒè´¨é‡**
  1153â†’2. **Phase 2ï¼ˆP0ï¼‰**ï¼šé•¿æœŸé™ªä¼´ç³»ç»Ÿ â†’ **å»ºç«‹ç”¨æˆ·ç²˜æ€§**
  1154â†’3. **Phase 3ï¼ˆP1ï¼‰**ï¼šæ²‰æµ¸å¼å‰ç«¯ â†’ **æå‡å“ç‰Œæ„ŸçŸ¥**
  1155â†’4. **Phase 4ï¼ˆP2ï¼‰**ï¼šæ–°å¢ä½›æ•™å¤§å¸ˆ â†’ **æ‰©å±•ç”¨æˆ·ç¾¤**
  1156â†’
  1157â†’**é¢„æœŸæ•ˆæœ**ï¼š
  1158â†’
  1159â†’3 ä¸ªæœˆåï¼ŒVibeLife å°†æˆä¸ºå¸‚åœºä¸Š**å”¯ä¸€**èƒ½åšåˆ°ä»¥ä¸‹ä¸‰ç‚¹çš„äº§å“ï¼š
  1160â†’1. å¤§å¸ˆçœŸæ­£"æ‡‚ä½ "ï¼ˆåŸºäºå‘½ç›˜çš„ä¸ªæ€§åŒ–ï¼‰
  1161â†’2. å¤§å¸ˆé•¿æœŸé™ªä¼´ä½ ï¼ˆè®°å¿†ã€å…³æ€€ã€æˆé•¿è¿½è¸ªï¼‰
  1162â†’3. ä¸å¤§å¸ˆå¯¹è¯æœ‰ä»ªå¼æ„Ÿï¼ˆæ²‰æµ¸å¼ä½“éªŒï¼‰
  1163â†’
  1164â†’â†’ **è¿™å°†æ˜¯çœŸæ­£çš„"è¶…é«˜ç«¯æ™ºèƒ½æœåŠ¡"ï¼Œæ— äººèƒ½åŠã€‚**
  1165â†’
  1166â†’---
  1167â†’
  1168â†’## æœªè§£å†³çš„é—®é¢˜
  1169â†’
  1170â†’åŸºäºæˆ‘çš„åˆ†æ,æˆ‘è¿˜æœ‰ä»¥ä¸‹é—®é¢˜æƒ³å‘ä½ ç¡®è®¤ï¼š
  1171â†’
  1172â†’1. **å‘½ç›˜æ´å¯Ÿçš„"åº¦"**ï¼šä½ å¸Œæœ›å¤§å¸ˆåœ¨å¤šå¤§ç¨‹åº¦ä¸Š"æš—ç¤º"å‘½ç›˜ä¿¡æ¯ï¼Ÿæ¯”å¦‚ï¼Œæ˜¯å¦å¯ä»¥è¯´"ä»¥ä½ çš„ç‰¹è´¨ï¼ˆæ°´æ€§æ€ç»´ï¼‰...", è¿˜æ˜¯å®Œå…¨ä¸æäº”è¡Œï¼Ÿ
  1173â†’
  1174â†’2. **æ•°æ®éšç§**ï¼šå‘½ç›˜ä¿¡æ¯æ³¨å…¥ System Prompt åï¼Œæ˜¯å¦éœ€è¦é¢å¤–çš„éšç§ä¿æŠ¤æœºåˆ¶ï¼ˆå¦‚åŠ å¯†å­˜å‚¨ã€audit logï¼‰ï¼Ÿ
  1175â†’
  1176â†’3. **å•†ä¸šæ¨¡å¼**ï¼šè¿™äº›é«˜ç«¯æœåŠ¡ï¼ˆä¸ªæ€§åŒ–å¤§å¸ˆã€é•¿æœŸé™ªä¼´ï¼‰æ˜¯å¦ä½œä¸º Premium åŠŸèƒ½æ”¶è´¹ï¼Ÿè¿˜æ˜¯ä½œä¸ºå·®å¼‚åŒ–ä¼˜åŠ¿å…è´¹æä¾›ï¼Ÿ
  1177â†’
  1178â†’4. **è¯­éŸ³äº¤äº’**ï¼šä½ æåˆ°"å¤šæ¨¡æ€"ï¼Œè¯­éŸ³å¯¹è¯çš„ä¼˜å…ˆçº§å¦‚ä½•ï¼Ÿæ˜¯å¦éœ€è¦åœ¨ç¬¬ä¸€é˜¶æ®µå°±è€ƒè™‘ï¼Ÿ
  1179â†’
  1180â†’è¯·è®©æˆ‘çŸ¥é“ä½ çš„æƒ³æ³•ï¼Œæˆ‘å¯ä»¥è¿›ä¸€æ­¥ç»†åŒ–æ–¹æ¡ˆï¼ğŸ¯
  1181â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
