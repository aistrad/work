     1â†’/**
     2â†’ * SelectRelationshipCard - é€‰æ‹©å·²ä¿å­˜çš„å…³ç³»å¯¹è±¡
     3â†’ *
     4â†’ * å±•ç¤ºç”¨æˆ·å·²ä¿å­˜çš„å…³ç³»å¯¹è±¡åˆ—è¡¨ï¼Œè®©ç”¨æˆ·é€‰æ‹©è¿›è¡Œåˆç›˜
     5â†’ */
     6â†’
     7â†’"use client";
     8â†’
     9â†’import { memo } from "react";
    10â†’import { registerCard } from "@/skills/CardRegistry";
    11â†’
    12â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    13â†’// Types
    14â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    15â†’
    16â†’interface Relationship {
    17â†’  id: string;
    18â†’  name: string;
    19â†’  type: string;
    20â†’  typeLabel: string;
    21â†’  typeIcon: string;
    22â†’  lastSynastryAt?: string;
    23â†’  synastryCount: number;
    24â†’}
    25â†’
    26â†’interface SelectRelationshipCardProps {
    27â†’  title?: string;
    28â†’  relationships: Relationship[];
    29â†’  allowAddNew?: boolean;
    30â†’  addNewLabel?: string;
    31â†’  onSelect?: (relationship: Relationship) => void;
    32â†’  onAddNew?: () => void;
    33â†’}
    34â†’
    35â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    36â†’// Sub-components
    37â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    38â†’
    39â†’const RelationshipItem = memo(function RelationshipItem({
    40â†’  relationship,
    41â†’  onClick,
    42â†’}: {
    43â†’  relationship: Relationship;
    44â†’  onClick: () => void;
    45â†’}) {
    46â†’  const formatLastSynastry = (dateStr?: string) => {
    47â†’    if (!dateStr) return "è¿˜æ²¡çœ‹è¿‡";
    48â†’
    49â†’    const date = new Date(dateStr);
    50â†’    const now = new Date();
    51â†’    const diffDays = Math.floor(
    52â†’      (now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24)
    53â†’    );
    54â†’
    55â†’    if (diffDays === 0) return "ä»Šå¤©";
    56â†’    if (diffDays === 1) return "æ˜¨å¤©";
    57â†’    if (diffDays < 7) return `${diffDays}å¤©å‰`;
    58â†’    if (diffDays < 30) return `${Math.floor(diffDays / 7)}å‘¨å‰`;
    59â†’    return `${Math.floor(diffDays / 30)}ä¸ªæœˆå‰`;
    60â†’  };
    61â†’
    62â†’  return (
    63â†’    <button
    64â†’      onClick={onClick}
    65â†’      className="w-full flex items-center gap-3 p-4 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700 hover:border-pink-300 dark:hover:border-pink-700 hover:shadow-md transition-all text-left"
    66â†’    >
    67â†’      {/* Icon */}
    68â†’      <div className="w-12 h-12 rounded-full bg-pink-100 dark:bg-pink-900/30 flex items-center justify-center flex-shrink-0">
    69â†’        <span className="text-2xl">{relationship.typeIcon}</span>
    70â†’      </div>
    71â†’
    72â†’      {/* Info */}
    73â†’      <div className="flex-1 min-w-0">
    74â†’        <div className="flex items-center gap-2">
    75â†’          <span className="font-medium text-slate-900 dark:text-slate-100 truncate">
    76â†’            {relationship.name}
    77â†’          </span>
    78â†’          <span className="text-xs px-2 py-0.5 rounded-full bg-slate-100 dark:bg-slate-700 text-slate-500 dark:text-slate-400">
    79â†’            {relationship.typeLabel}
    80â†’          </span>
    81â†’        </div>
    82â†’        <div className="text-sm text-slate-500 dark:text-slate-400 mt-0.5">
    83â†’          ä¸Šæ¬¡ï¼š{formatLastSynastry(relationship.lastSynastryAt)}
    84â†’          {relationship.synastryCount > 0 && (
    85â†’            <span className="ml-2">Â· å…± {relationship.synastryCount} æ¬¡</span>
    86â†’          )}
    87â†’        </div>
    88â†’      </div>
    89â†’
    90â†’      {/* Arrow */}
    91â†’      <div className="text-slate-400">
    92â†’        <svg
    93â†’          className="w-5 h-5"
    94â†’          fill="none"
    95â†’          stroke="currentColor"
    96â†’          viewBox="0 0 24 24"
    97â†’        >
    98â†’          <path
    99â†’            strokeLinecap="round"
   100â†’            strokeLinejoin="round"
   101â†’            strokeWidth={2}
   102â†’            d="M9 5l7 7-7 7"
   103â†’          />
   104â†’        </svg>
   105â†’      </div>
   106â†’    </button>
   107â†’  );
   108â†’});
   109â†’
   110â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   111â†’// Main Component
   112â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   113â†’
   114â†’function SelectRelationshipCard({
   115â†’  title = "ä½ æƒ³çœ‹å’Œè°çš„åˆç›˜ï¼Ÿ",
   116â†’  relationships = [],
   117â†’  allowAddNew = true,
   118â†’  addNewLabel = "æ·»åŠ æ–°çš„äºº",
   119â†’  onSelect,
   120â†’  onAddNew,
   121â†’}: SelectRelationshipCardProps) {
   122â†’  const handleSelect = (relationship: Relationship) => {
   123â†’    if (onSelect) {
   124â†’      onSelect(relationship);
   125â†’    }
   126â†’  };
   127â†’
   128â†’  const handleAddNew = () => {
   129â†’    if (onAddNew) {
   130â†’      onAddNew();
   131â†’    }
   132â†’  };
   133â†’
   134â†’  return (
   135â†’    <div className="select-relationship-card bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-950/30 dark:to-purple-950/30 rounded-xl border border-pink-200 dark:border-pink-800 p-5 my-2 animate-fade-in">
   136â†’      {/* Header */}
   137â†’      <div className="flex items-center gap-3 mb-4">
   138â†’        <div className="w-10 h-10 rounded-xl bg-pink-500/20 flex items-center justify-center">
   139â†’          <span className="text-xl">ğŸ’•</span>
   140â†’        </div>
   141â†’        <h3 className="text-lg font-semibold text-pink-900 dark:text-pink-100">
   142â†’          {title}
   143â†’        </h3>
   144â†’      </div>
   145â†’
   146â†’      {/* Relationship List */}
   147â†’      <div className="space-y-2">
   148â†’        {relationships.length > 0 ? (
   149â†’          relationships.map((rel) => (
   150â†’            <RelationshipItem
   151â†’              key={rel.id}
   152â†’              relationship={rel}
   153â†’              onClick={() => handleSelect(rel)}
   154â†’            />
   155â†’          ))
   156â†’        ) : (
   157â†’          <div className="text-center py-6 text-slate-500 dark:text-slate-400">
   158â†’            è¿˜æ²¡æœ‰ä¿å­˜ä»»ä½•äºº
   159â†’          </div>
   160â†’        )}
   161â†’
   162â†’        {/* Add New Button */}
   163â†’        {allowAddNew && (
   164â†’          <button
   165â†’            onClick={handleAddNew}
   166â†’            className="w-full flex items-center justify-center gap-2 p-4 bg-white/50 dark:bg-slate-800/50 rounded-xl border-2 border-dashed border-slate-300 dark:border-slate-600 hover:border-pink-400 dark:hover:border-pink-600 transition-all text-slate-600 dark:text-slate-400 hover:text-pink-600 dark:hover:text-pink-400"
   167â†’          >
   168â†’            <span className="text-xl">â•</span>
   169â†’            <span>{addNewLabel}</span>
   170â†’          </button>
   171â†’        )}
   172â†’      </div>
   173â†’    </div>
   174â†’  );
   175â†’}
   176â†’
   177â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   178â†’// Register to CardRegistry
   179â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   180â†’
   181â†’registerCard("select_relationship", SelectRelationshipCard);
   182â†’
   183â†’export default SelectRelationshipCard;
   184â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
