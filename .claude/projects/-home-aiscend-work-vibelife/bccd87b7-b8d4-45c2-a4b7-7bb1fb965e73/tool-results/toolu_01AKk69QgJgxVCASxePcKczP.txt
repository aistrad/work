     1â†’/**
     2â†’ * CollectSynastryInfoCard - æ”¶é›†åˆç›˜å¯¹è±¡ä¿¡æ¯
     3â†’ *
     4â†’ * æ”¶é›†å¯¹æ–¹çš„å‡ºç”Ÿä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š
     5â†’ * - å…³ç³»ç±»å‹ï¼ˆå¿…å¡«ï¼‰
     6â†’ * - å§“å/æ˜µç§°ï¼ˆå¿…å¡«ï¼‰
     7â†’ * - å‡ºç”Ÿæ—¥æœŸï¼ˆå¿…å¡«ï¼‰
     8â†’ * - å‡ºç”Ÿæ—¶é—´ï¼ˆå¯é€‰ï¼‰
     9â†’ * - å‡ºç”Ÿåœ°ç‚¹ï¼ˆå¿…å¡«ï¼‰
    10â†’ * - æ˜¯å¦ä¿å­˜ï¼ˆå¯é€‰ï¼‰
    11â†’ */
    12â†’
    13â†’"use client";
    14â†’
    15â†’import { memo, useState, useCallback } from "react";
    16â†’import { registerCard } from "@/skills/CardRegistry";
    17â†’
    18â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    19â†’// Types
    20â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    21â†’
    22â†’interface RelationshipOption {
    23â†’  value: string;
    24â†’  label: string;
    25â†’  icon: string;
    26â†’}
    27â†’
    28â†’interface CollectSynastryInfoCardProps {
    29â†’  title?: string;
    30â†’  onSubmit?: (data: SynastryInfoData) => void;
    31â†’}
    32â†’
    33â†’interface SynastryInfoData {
    34â†’  relationship_type: string;
    35â†’  person_name: string;
    36â†’  birth_date: string;
    37â†’  birth_time?: string;
    38â†’  birth_place: string;
    39â†’  save_relationship: boolean;
    40â†’}
    41â†’
    42â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    43â†’// Constants
    44â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    45â†’
    46â†’const RELATIONSHIP_OPTIONS: RelationshipOption[] = [
    47â†’  { value: "romantic", label: "æ‹äºº", icon: "ğŸ’•" },
    48â†’  { value: "spouse", label: "ä¼´ä¾£", icon: "ğŸ’" },
    49â†’  { value: "parent_child", label: "äº²å­", icon: "ğŸ‘¨â€ğŸ‘§" },
    50â†’  { value: "sibling", label: "å…„å¼Ÿå§å¦¹", icon: "ğŸ‘«" },
    51â†’  { value: "business", label: "åˆä¼™äºº", icon: "ğŸ¤" },
    52â†’  { value: "friend", label: "æœ‹å‹", icon: "ğŸ‘¥" },
    53â†’];
    54â†’
    55â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    56â†’// Sub-components
    57â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    58â†’
    59â†’const RelationshipTypeSelector = memo(function RelationshipTypeSelector({
    60â†’  value,
    61â†’  onChange,
    62â†’}: {
    63â†’  value: string;
    64â†’  onChange: (value: string) => void;
    65â†’}) {
    66â†’  return (
    67â†’    <div className="mb-4">
    68â†’      <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2">
    69â†’        TA æ˜¯ä½ çš„...
    70â†’      </label>
    71â†’      <div className="grid grid-cols-3 gap-2">
    72â†’        {RELATIONSHIP_OPTIONS.map((option) => (
    73â†’          <button
    74â†’            key={option.value}
    75â†’            type="button"
    76â†’            onClick={() => onChange(option.value)}
    77â†’            className={`flex flex-col items-center justify-center p-3 rounded-xl border-2 transition-all ${
    78â†’              value === option.value
    79â†’                ? "border-pink-500 bg-pink-50 dark:bg-pink-900/20"
    80â†’                : "border-slate-200 dark:border-slate-700 hover:border-pink-300"
    81â†’            }`}
    82â†’          >
    83â†’            <span className="text-2xl mb-1">{option.icon}</span>
    84â†’            <span className="text-xs text-slate-600 dark:text-slate-400">
    85â†’              {option.label}
    86â†’            </span>
    87â†’          </button>
    88â†’        ))}
    89â†’      </div>
    90â†’    </div>
    91â†’  );
    92â†’});
    93â†’
    94â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    95â†’// Main Component
    96â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    97â†’
    98â†’function CollectSynastryInfoCard({
    99â†’  title = "å‘Šè¯‰æˆ‘ TA çš„ä¿¡æ¯",
   100â†’  onSubmit,
   101â†’}: CollectSynastryInfoCardProps) {
   102â†’  const [formData, setFormData] = useState<SynastryInfoData>({
   103â†’    relationship_type: "",
   104â†’    person_name: "",
   105â†’    birth_date: "",
   106â†’    birth_time: "",
   107â†’    birth_place: "",
   108â†’    save_relationship: true,
   109â†’  });
   110â†’
   111â†’  const [errors, setErrors] = useState<Record<string, string>>({});
   112â†’
   113â†’  const handleChange = useCallback(
   114â†’    (field: keyof SynastryInfoData, value: string | boolean) => {
   115â†’      setFormData((prev) => ({ ...prev, [field]: value }));
   116â†’      // Clear error when field is modified
   117â†’      if (errors[field]) {
   118â†’        setErrors((prev) => {
   119â†’          const next = { ...prev };
   120â†’          delete next[field];
   121â†’          return next;
   122â†’        });
   123â†’      }
   124â†’    },
   125â†’    [errors]
   126â†’  );
   127â†’
   128â†’  const validate = useCallback((): boolean => {
   129â†’    const newErrors: Record<string, string> = {};
   130â†’
   131â†’    if (!formData.relationship_type) {
   132â†’      newErrors.relationship_type = "è¯·é€‰æ‹©å…³ç³»ç±»å‹";
   133â†’    }
   134â†’    if (!formData.person_name.trim()) {
   135â†’      newErrors.person_name = "è¯·è¾“å…¥å§“å";
   136â†’    }
   137â†’    if (!formData.birth_date) {
   138â†’      newErrors.birth_date = "è¯·é€‰æ‹©å‡ºç”Ÿæ—¥æœŸ";
   139â†’    }
   140â†’    if (!formData.birth_place.trim()) {
   141â†’      newErrors.birth_place = "è¯·è¾“å…¥å‡ºç”Ÿåœ°ç‚¹";
   142â†’    }
   143â†’
   144â†’    setErrors(newErrors);
   145â†’    return Object.keys(newErrors).length === 0;
   146â†’  }, [formData]);
   147â†’
   148â†’  const handleSubmit = useCallback(
   149â†’    (e: React.FormEvent) => {
   150â†’      e.preventDefault();
   151â†’
   152â†’      if (!validate()) {
   153â†’        return;
   154â†’      }
   155â†’
   156â†’      if (onSubmit) {
   157â†’        onSubmit(formData);
   158â†’      }
   159â†’    },
   160â†’    [formData, onSubmit, validate]
   161â†’  );
   162â†’
   163â†’  return (
   164â†’    <div className="collect-synastry-card bg-gradient-to-br from-pink-50 to-purple-50 dark:from-pink-950/30 dark:to-purple-950/30 rounded-xl border border-pink-200 dark:border-pink-800 p-5 my-2 animate-fade-in">
   165â†’      {/* Header */}
   166â†’      <div className="flex items-center gap-3 mb-5">
   167â†’        <div className="w-10 h-10 rounded-xl bg-pink-500/20 flex items-center justify-center">
   168â†’          <span className="text-xl">ğŸ’•</span>
   169â†’        </div>
   170â†’        <h3 className="text-lg font-semibold text-pink-900 dark:text-pink-100">
   171â†’          {title}
   172â†’        </h3>
   173â†’      </div>
   174â†’
   175â†’      <form onSubmit={handleSubmit}>
   176â†’        {/* Relationship Type */}
   177â†’        <RelationshipTypeSelector
   178â†’          value={formData.relationship_type}
   179â†’          onChange={(value) => handleChange("relationship_type", value)}
   180â†’        />
   181â†’        {errors.relationship_type && (
   182â†’          <p className="text-red-500 text-xs mt-1 -mt-2 mb-3">
   183â†’            {errors.relationship_type}
   184â†’          </p>
   185â†’        )}
   186â†’
   187â†’        {/* Name */}
   188â†’        <div className="mb-4">
   189â†’          <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">
   190â†’            TA å«ä»€ä¹ˆï¼Ÿ
   191â†’          </label>
   192â†’          <input
   193â†’            type="text"
   194â†’            value={formData.person_name}
   195â†’            onChange={(e) => handleChange("person_name", e.target.value)}
   196â†’            placeholder="å§“åæˆ–æ˜µç§°"
   197â†’            className={`w-full px-4 py-2.5 rounded-lg border bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-pink-500 ${
   198â†’              errors.person_name
   199â†’                ? "border-red-500"
   200â†’                : "border-slate-200 dark:border-slate-700"
   201â†’            }`}
   202â†’          />
   203â†’          {errors.person_name && (
   204â†’            <p className="text-red-500 text-xs mt-1">{errors.person_name}</p>
   205â†’          )}
   206â†’        </div>
   207â†’
   208â†’        {/* Birth Date */}
   209â†’        <div className="mb-4">
   210â†’          <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">
   211â†’            TA ä»€ä¹ˆæ—¶å€™å‡ºç”Ÿï¼Ÿ
   212â†’          </label>
   213â†’          <input
   214â†’            type="date"
   215â†’            value={formData.birth_date}
   216â†’            onChange={(e) => handleChange("birth_date", e.target.value)}
   217â†’            className={`w-full px-4 py-2.5 rounded-lg border bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-pink-500 ${
   218â†’              errors.birth_date
   219â†’                ? "border-red-500"
   220â†’                : "border-slate-200 dark:border-slate-700"
   221â†’            }`}
   222â†’          />
   223â†’          {errors.birth_date && (
   224â†’            <p className="text-red-500 text-xs mt-1">{errors.birth_date}</p>
   225â†’          )}
   226â†’        </div>
   227â†’
   228â†’        {/* Birth Time (Optional) */}
   229â†’        <div className="mb-4">
   230â†’          <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">
   231â†’            å‡ºç”Ÿæ—¶é—´{" "}
   232â†’            <span className="text-slate-400 font-normal">ï¼ˆå¯é€‰ï¼‰</span>
   233â†’          </label>
   234â†’          <input
   235â†’            type="time"
   236â†’            value={formData.birth_time}
   237â†’            onChange={(e) => handleChange("birth_time", e.target.value)}
   238â†’            placeholder="ä¸ç¡®å®šå¯ä»¥ä¸å¡«"
   239â†’            className="w-full px-4 py-2.5 rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:outline-none focus:ring-2 focus:ring-pink-500"
   240â†’          />
   241â†’          <p className="text-slate-400 text-xs mt-1">
   242â†’            ä¸ç¡®å®šå¯ä»¥ä¸å¡«ï¼Œç³»ç»Ÿä¼šä½¿ç”¨æ­£åˆæ—¶é—´
   243â†’          </p>
   244â†’        </div>
   245â†’
   246â†’        {/* Birth Place */}
   247â†’        <div className="mb-4">
   248â†’          <label className="block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1">
   249â†’            TA åœ¨å“ªé‡Œå‡ºç”Ÿï¼Ÿ
   250â†’          </label>
   251â†’          <input
   252â†’            type="text"
   253â†’            value={formData.birth_place}
   254â†’            onChange={(e) => handleChange("birth_place", e.target.value)}
   255â†’            placeholder="æœç´¢åŸå¸‚..."
   256â†’            className={`w-full px-4 py-2.5 rounded-lg border bg-white dark:bg-slate-800 text-slate-900 dark:text-slate-100 placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-pink-500 ${
   257â†’              errors.birth_place
   258â†’                ? "border-red-500"
   259â†’                : "border-slate-200 dark:border-slate-700"
   260â†’            }`}
   261â†’          />
   262â†’          {errors.birth_place && (
   263â†’            <p className="text-red-500 text-xs mt-1">{errors.birth_place}</p>
   264â†’          )}
   265â†’        </div>
   266â†’
   267â†’        {/* Save Checkbox */}
   268â†’        <div className="mb-5">
   269â†’          <label className="flex items-center gap-2 cursor-pointer">
   270â†’            <input
   271â†’              type="checkbox"
   272â†’              checked={formData.save_relationship}
   273â†’              onChange={(e) =>
   274â†’                handleChange("save_relationship", e.target.checked)
   275â†’              }
   276â†’              className="w-4 h-4 rounded border-slate-300 text-pink-500 focus:ring-pink-500"
   277â†’            />
   278â†’            <span className="text-sm text-slate-600 dark:text-slate-400">
   279â†’              ä¿å­˜ TAï¼Œæ–¹ä¾¿ä¸‹æ¬¡æŸ¥çœ‹
   280â†’            </span>
   281â†’          </label>
   282â†’        </div>
   283â†’
   284â†’        {/* Submit Button */}
   285â†’        <button
   286â†’          type="submit"
   287â†’          className="w-full py-3 px-4 bg-gradient-to-r from-pink-500 to-purple-500 text-white font-medium rounded-xl hover:from-pink-600 hover:to-purple-600 transition-all shadow-lg shadow-pink-500/25"
   288â†’        >
   289â†’          å¼€å§‹åˆ†æ
   290â†’        </button>
   291â†’      </form>
   292â†’    </div>
   293â†’  );
   294â†’}
   295â†’
   296â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   297â†’// Register to CardRegistry
   298â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   299â†’
   300â†’registerCard("collect_synastry_info", CollectSynastryInfoCard);
   301â†’
   302â†’export default CollectSynastryInfoCard;
   303â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
