     1→# In ./CLAUDE.md
     2→@vibelife/docs/archive/v8/ARCHITECTURE.md
     3→
     4→@vibelife/docs/deployment-test.md
     5→@vibelife/docs/config-test.md
     6→
     7→## Plan Mode
     8→- Make the plan extremely concise
     9→- At the end, give a list of unresolved questions
    10→
    11→## Agent SDK Best Practices
    12→
    13→### Skill 路由规范（强制）
    14→
    15→**只允许 LLM 工具调用方式进行 Skill 路由，禁止 Python 硬编码条件判断。**
    16→
    17→| 操作类型 | 正确方式 | 错误方式 |
    18→|---------|---------|---------|
    19→| Skill 路由 | `use_skill` 工具（LLM 调用） | Python `if/else` 关键词匹配 |
    20→| 场景/规则路由 | LLM 根据 prompt 判断 | Python `route_scenario()` 硬编码 |
    21→| 个性化内容生成 | LLM 生成 | Python 模板字符串拼接 |
    22→
    23→**原则**：
    24→- 脆弱/一致性操作 → 用代码（如数据存储、API 调用）
    25→- 上下文依赖/启发式任务 → 用 LLM（如路由、内容生成、意图识别）
    26→
    27→**示例**：
    28→```python
    29→# ❌ 错误：Python 硬编码路由
    30→def route_skill(message: str) -> str:
    31→    if "八字" in message:
    32→        return "bazi"
    33→    elif "星座" in message:
    34→        return "zodiac"
    35→
    36→# ✅ 正确：LLM 工具调用路由
    37→# 通过 use_skill 工具让 LLM 判断应该路由到哪个 skill
    38→```
    39→
    40→**参考**：`apps/api/services/agent/core.py` 中的 `build_use_skill_tool()`

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
