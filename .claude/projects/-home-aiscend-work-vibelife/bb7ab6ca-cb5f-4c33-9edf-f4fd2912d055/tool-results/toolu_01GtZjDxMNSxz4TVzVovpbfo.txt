The file /home/aiscend/work/vibelife/apps/api/routes/notifications.py has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
    17→def get_notification_service():
    18→    return NotificationService()
    19→
    20→
    21→@router.get("")
    22→async def get_notifications(
    23→    user_id: Optional[UUID] = Query(None, description="User ID (optional if authenticated)"),
    24→    limit: int = Query(50, ge=1, le=100),
    25→    svc: NotificationService = Depends(get_notification_service),
    26→    current_user: Optional[CurrentUser] = Depends(get_optional_user),
    27→):
    28→    """Get user notifications. Uses authenticated user if user_id not provided."""
    29→    # 优先使用认证用户的ID
    30→    effective_user_id = user_id
    31→    if not effective_user_id and current_user:
    32→        effective_user_id = current_user.user_id
    33→
    34→    if not effective_user_id:
    35→        raise HTTPException(status_code=401, detail="Authentication required")
    36→
    37→    try:
    38→        result = await svc.get_all(effective_user_id, limit)
    39→        # 确保返回格式与前端期望一致
    40→        if isinstance(result, dict):
    41→            return result
    42→        return {"items": result, "unread_count": len([n for n in result if not n.get("is_read", True)])}
    43→    except Exception as e:
    44→        logger.error(f"Failed to get notifications: {e}")
    45→        raise HTTPException(status_code=500, detail="Internal server error")
    46→
    47→
    48→@router.get("/unread")
    49→async def get_unread_notifications(