The file /home/aiscend/work/vibelife/apps/api/tests/integration/routes/test_notifications.py has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
   321→
   322→class TestNotificationsEdgeCases:
   323→    """边界情况和错误处理测试"""
   324→
   325→    async def test_get_notifications_service_error(self, client, override_auth):
   326→        """测试获取通知时服务层错误返回 500"""
   327→        with patch("routes.notifications.NotificationService") as mock_cls:
   328→            mock_service = MagicMock()
   329→            mock_service.get_all = AsyncMock(side_effect=Exception("Database connection failed"))
   330→            mock_cls.return_value = mock_service
   331→
   332→            response = await client.get(
   333→                "/api/v1/notifications",
   334→                headers={"Authorization": "Bearer test_token"}
   335→            )
   336→
   337→        assert response.status_code == 500
   338→        assert response.json()["detail"] == "Internal server error"
   339→
   340→    async def test_get_unread_notifications_service_error(self, client, override_auth):
   341→        """测试获取未读通知时服务层错误返回 500"""
   342→        with patch("routes.notifications.NotificationService") as mock_cls:
   343→            mock_service = MagicMock()
   344→            mock_service.get_unread = AsyncMock(side_effect=Exception("Service unavailable"))
   345→            mock_cls.return_value = mock_service
   346→
   347→            response = await client.get(
   348→                "/api/v1/notifications/unread",
   349→                headers={"Authorization": "Bearer test_token"}
   350→            )
   351→
   352→        assert response.status_code == 500
   353→        assert response.json()["detail"] == "Internal server error"
   354→
   355→    async def test_mark_read_service_error(self, client):
   356→        """测试标记已读时服务层错误返回 500"""
   357→        notification_id = str(uuid4())
   358→
   359→        with patch("routes.notifications.NotificationService") as mock_cls:
   360→            mock_service = MagicMock()
   361→            mock_service.mark_read = AsyncMock(side_effect=Exception("Write failed"))
   362→            mock_cls.return_value = mock_service
   363→
   364→            response = await client.post(f"/api/v1/notifications/{notification_id}/read")
   365→
   366→        assert response.status_code == 500
   367→        assert response.json()["detail"] == "Internal server error"
   368→
   369→    async def test_get_daily_fortune_service_error(self, client, override_auth):
   370→        """测试获取每日运势时服务层错误返回 500"""
   371→        with patch("routes.notifications.NotificationService") as mock_cls:
   372→            mock_service = MagicMock()
   373→            mock_service.get_today_daily = AsyncMock(side_effect=Exception("Fortune service down"))
   374→            mock_cls.return_value = mock_service
   375→
   376→            response = await client.get(
   377→                "/api/v1/notifications/daily",
   378→                headers={"Authorization": "Bearer test_token"}
   379→            )
   380→
   381→        assert response.status_code == 500
   382→        assert response.json()["detail"] == "Internal server error"
   383→
   384→    async def test_notifications_response_format(self, client, override_auth, mock_notification_service):
   385→        """测试响应格式一致性"""
   386→        response = await client.get(