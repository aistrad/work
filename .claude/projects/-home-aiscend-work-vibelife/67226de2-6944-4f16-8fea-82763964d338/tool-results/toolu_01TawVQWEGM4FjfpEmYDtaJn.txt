  1090→                parts.append(f"\n---\n\n## 当前场景: {scenario.name}\n\n{scenario.description}")
  1091→                # SOP
  1092→                if scenario.sop:
  1093→                    sop_text = "\n## 服务流程 (SOP)\n\n"
  1094→                    for phase in scenario.sop:
  1095→                        sop_text += f"### Phase {phase['phase']}: {phase['name']}\n{phase['content']}\n\n"
  1096→                    parts.append(sop_text)
  1097→
  1098→    # 伦理边界
  1099→    if skill.ethics.get("forbidden"):
  1100→        ethics_text = "\n## 伦理边界\n\n### 绝对禁止\n"
  1101→        for item in skill.ethics["forbidden"]:
  1102→            ethics_text += f"- {item}\n"
  1103→        parts.append(ethics_text)
  1104→
  1105→    # 边界控制原则（在伦理边界之后）- v2.1 更新
  1106→    boundary_text = """
  1107→## 能力边界（强制遵守）
  1108→
  1109→### 核心原则
  1110→你只能在当前 Skill 定义的能力范围内提供帮助。超出范围的问题，你必须诚实告知用户，而不是"胡说八道"。
  1111→
  1112→### 边界规则
  1113→
  1114→1. **只用当前 Skill 的工具**
  1115→   - 只能调用当前 Skill 声明的工具
  1116→   - 必须遵循 SKILL.md 中定义的流程和规则
  1117→   - 不要编造不存在的功能或服务
  1118→
  1119→2. **模糊请求的处理**（v2.1 新增）
  1120→   - 用户说"今日指引"、"帮我看看"、"继续" → **用当前 Skill 的工具处理**
  1121→   - 不要因为用户的话不在触发词列表里就调用 `recommend_skills`
  1122→   - 优先尝试用当前 Skill 的能力满足用户需求
  1123→
  1124→3. **用户明确要求换服务时**
  1125→   - 用户说"我想看星座"、"帮我算八字" → 可以调用 `activate_skill`
  1126→   - 用户说"换一个"、"退出" → 温暖告别或询问想要什么
  1127→
  1128→4. **超出范围时的处理**
  1129→   - 先用文字说明"这个超出了我的专长"
  1130→   - 询问用户"需要我帮你找到合适的服务吗？"
  1131→   - 用户确认后再调用 `activate_skill` 或 `recommend_skills`
  1132→   - **不要**直接调用路由工具，让用户有选择权
  1133→
  1134→5. **禁止的行为**
  1135→   - ❌ 不要假装知道你不知道的事情
  1136→   - ❌ 不要编造数据、结果或分析
  1137→   - ❌ 不要绕过定义好的流程自由发挥
  1138→   - ❌ 不要在用户请求可用当前 Skill 处理时调用路由工具
  1139→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
