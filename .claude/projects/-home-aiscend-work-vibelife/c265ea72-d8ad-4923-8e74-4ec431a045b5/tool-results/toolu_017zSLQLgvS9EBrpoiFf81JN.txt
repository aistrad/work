     1→# VibeLife 完整系统架构设计文档
     2→## The Living Companion Ecosystem
     3→
     4→**Version**: 1.0  
     5→**Date**: January 2026  
     6→**Domain**: vibelife.app
     7→
     8→---
     9→
    10→# 第一部分：战略架构总览
    11→
    12→## 1.1 核心战略定位
    13→
    14→```
    15→╔═══════════════════════════════════════════════════════════════════════════════╗
    16→║                                                                               ║
    17→║                              VIBELIFE                                         ║
    18→║                     THE LIVING COMPANION ECOSYSTEM                            ║
    19→║                                                                               ║
    20→║   ─────────────────────────────────────────────────────────────────────────   ║
    21→║                                                                               ║
    22→║   "每个人都值得被深度理解，每种成长都需要专业陪伴"                             ║
    23→║                                                                               ║
    24→║   ─────────────────────────────────────────────────────────────────────────   ║
    25→║                                                                               ║
    26→║   战略路径：                                                                  ║
    27→║                                                                               ║
    28→║   Phase 1: SKILL CONSTELLATION                                                ║
    29→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
    30→║   │                                                                         │ ║
    31→║   │    ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐    │ ║
    32→║   │    │  ASTRA  │  │  BAZI   │  │  MBTI   │  │ ATTACH  │  │ CAREER  │    │ ║
    33→║   │    │ .vibe   │  │ .vibe   │  │ .vibe   │  │ .vibe   │  │ .vibe   │    │ ║
    34→║   │    │ life.app│  │ life.app│  │ life.app│  │ life.app│  │ life.app│    │ ║
    35→║   │    └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘    │ ║
    36→║   │         │            │            │            │            │          │ ║
    37→║   │         └────────────┴─────┬──────┴────────────┴────────────┘          │ ║
    38→║   │                            │                                           │ ║
    39→║   │                   ┌────────▼────────┐                                  │ ║
    40→║   │                   │   VIBE ENGINE   │                                  │ ║
    41→║   │                   │   统一智能引擎   │                                  │ ║
    42→║   │                   └────────┬────────┘                                  │ ║
    43→║   │                            │                                           │ ║
    44→║   │                   ┌────────▼────────┐                                  │ ║
    45→║   │                   │    VIBE ID      │                                  │ ║
    46→║   │                   │   统一身份系统   │                                  │ ║
    47→║   │                   └─────────────────┘                                  │ ║
    48→║   │                                                                         │ ║
    49→║   │   "先去中心化做流量和能力验证"                                          │ ║
    50→║   └─────────────────────────────────────────────────────────────────────────┘ ║
    51→║                                                                               ║
    52→║   Phase 2: VIBELIFE CONSTELLATION HUB                                         ║
    53→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
    54→║   │                                                                         │ ║
    55→║   │                    ┌─────────────────────────┐                          │ ║
    56→║   │                    │                         │                          │ ║
    57→║   │                    │     VIBELIFE.APP        │                          │ ║
    58→║   │                    │     统一 AI Agent       │                          │ ║
    59→║   │                    │     Vibe Persona        │                          │ ║
    60→║   │                    │                         │                          │ ║
    61→║   │                    └───────────┬─────────────┘                          │ ║
    62→║   │                                │                                        │ ║
    63→║   │      ┌─────────┬─────────┬─────┴─────┬─────────┬─────────┐             │ ║
    64→║   │      ▼         ▼         ▼           ▼         ▼         ▼             │ ║
    65→║   │   [Astra]  [BaZi]    [MBTI]    [Attach]  [Career]   [...]             │ ║
    66→║   │                                                                         │ ║
    67→║   │   "再中心化做生态和长期留存"                                            │ ║
    68→║   └─────────────────────────────────────────────────────────────────────────┘ ║
    69→║                                                                               ║
    70→╚═══════════════════════════════════════════════════════════════════════════════╝
    71→```
    72→
    73→## 1.2 系统架构全景图
    74→
    75→```
    76→╔═══════════════════════════════════════════════════════════════════════════════╗
    77→║                                                                               ║
    78→║                    VIBELIFE SYSTEM ARCHITECTURE                               ║
    79→║                                                                               ║
    80→╠═══════════════════════════════════════════════════════════════════════════════╣
    81→║                                                                               ║
    82→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
    83→║   │                                                                         │ ║
    84→║   │   L1: SKILL CONSTELLATION LAYER (独立站群)                              │ ║
    85→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
    86→║   │                                                                         │ ║
    87→║   │   ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐         │ ║
    88→║   │   │  ASTRA  │ │  BAZI   │ │  MBTI   │ │ ATTACH  │ │ CAREER  │         │ ║
    89→║   │   │ 星座占星 │ │ 八字命理 │ │ 人格测评 │ │ 依恋分析 │ │ 职业发展 │         │ ║
    90→║   │   │         │ │         │ │         │ │         │ │         │         │ ║
    91→║   │   │ astra.  │ │ bazi.   │ │ mbti.   │ │ attach. │ │ career. │         │ ║
    92→║   │   │ vibelife│ │ vibelife│ │ vibelife│ │ vibelife│ │ vibelife│         │ ║
    93→║   │   │ .app    │ │ .app    │ │ .app    │ │ .app    │ │ .app    │         │ ║
    94→║   │   └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘         │ ║
    95→║   │        │           │           │           │           │              │ ║
    96→║   │        └───────────┴───────────┴───────────┴───────────┘              │ ║
    97→║   │                               │                                        │ ║
    98→║   │   统一模板引擎 │ 共享组件库 │ 一致用户体验 │ 统一商业化                │ ║
    99→║   │                                                                         │ ║
   100→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   101→║                                     │                                         ║
   102→║                                     ▼                                         ║
   103→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   104→║   │                                                                         │ ║
   105→║   │   L2: EXPERIENCE LAYER (体验标准层)                                     │ ║
   106→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   107→║   │                                                                         │ ║
   108→║   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ ║
   109→║   │   │ THE LANDING │  │   STREAM    │  │  INSIGHT    │  │  JOURNEY    │   │ ║
   110→║   │   │  零摩擦入口  │  │  对话之流   │  │  洞察卡片   │  │  成长轨迹   │   │ ║
   111→║   │   │             │  │             │  │             │  │             │   │ ║
   112→║   │   │ • 即问即答   │  │ • 沉浸对话  │  │ • 可视化   │  │ • 长期追踪  │   │ ║
   113→║   │   │ • 渐进注册   │  │ • 主动关怀  │  │ • 深度解读  │  │ • 演化记录  │   │ ║
   114→║   │   │ • 价值前置   │  │ • 情绪感知  │  │ • 行动建议  │  │ • 个人成长  │   │ ║
   115→║   │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ ║
   116→║   │                                                                         │ ║
   117→║   │   INSIGHT → INTERACT → EVOLVE → EDUCATE                                 │ ║
   118→║   │   看见      陪伴        演化      觉知                                   │ ║
   119→║   │                                                                         │ ║
   120→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   121→║                                     │                                         ║
   122→║                                     ▼                                         ║
   123→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   124→║   │                                                                         │ ║
   125→║   │   L3: SKILL AGENT LAYER (智能代理层)                                    │ ║
   126→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   127→║   │                                                                         │ ║
   128→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
   129→║   │   │                     SKILL AGENT RUNTIME                         │   │ ║
   130→║   │   │                                                                 │   │ ║
   131→║   │   │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐   │   │ ║
   132→║   │   │  │  PERSONA  │  │  SKILL    │  │  TOOL     │  │  CONTEXT  │   │   │ ║
   133→║   │   │  │  ENGINE   │  │  ROUTER   │  │  EXECUTOR │  │  MANAGER  │   │   │ ║
   134→║   │   │  │           │  │           │  │           │  │           │   │   │ ║
   135→║   │   │  │ • 角色人设 │  │ • 意图识别 │  │ • 函数调用 │  │ • 上下文   │   │   │ ║
   136→║   │   │  │ • 风格适配 │  │ • 流程编排 │  │ • 计算执行 │  │ • 记忆管理 │   │   │ ║
   137→║   │   │  │ • 情绪感知 │  │ • 多轮对话 │  │ • 结果整合 │  │ • 会话状态 │   │   │ ║
   138→║   │   │  └───────────┘  └───────────┘  └───────────┘  └───────────┘   │   │ ║
   139→║   │   │                                                                 │   │ ║
   140→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
   141→║   │                                                                         │ ║
   142→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   143→║                                     │                                         ║
   144→║                                     ▼                                         ║
   145→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   146→║   │                                                                         │ ║
   147→║   │   L4: KNOWLEDGE LAYER (知识引擎层)                                      │ ║
   148→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   149→║   │                                                                         │ ║
   150→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
   151→║   │   │                    KNOWLEDGE ENGINE                             │   │ ║
   152→║   │   │                                                                 │   │ ║
   153→║   │   │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │   │ ║
   154→║   │   │  │  KNOWLEDGE  │    │   HYBRID    │    │  KNOWLEDGE  │         │   │ ║
   155→║   │   │  │  PIPELINE   │───▶│  RETRIEVAL  │───▶│   GRADER    │         │   │ ║
   156→║   │   │  │             │    │             │    │             │         │   │ ║
   157→║   │   │  │ • 知识采集   │    │ • 向量检索  │    │ • 相关性评估 │         │   │ ║
   158→║   │   │  │ • 结构化     │    │ • 关键词    │    │ • 质量打分   │         │   │ ║
   159→║   │   │  │ • 嵌入索引   │    │ • 图遍历    │    │ • 重排序     │         │   │ ║
   160→║   │   │  └─────────────┘    └─────────────┘    └─────────────┘         │   │ ║
   161→║   │   │                                                                 │   │ ║
   162→║   │   │  ┌────────────────────────────────────────────────────────┐    │   │ ║
   163→║   │   │  │              SKILL KNOWLEDGE STORES                     │    │   │ ║
   164→║   │   │  │                                                         │    │   │ ║
   165→║   │   │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │    │   │ ║
   166→║   │   │  │  │  ASTRA  │ │  BAZI   │ │  MBTI   │ │ ATTACH  │  ...  │    │   │ ║
   167→║   │   │  │  │   KB    │ │   KB    │ │   KB    │ │   KB    │       │    │   │ ║
   168→║   │   │  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘       │    │   │ ║
   169→║   │   │  └────────────────────────────────────────────────────────┘    │   │ ║
   170→║   │   │                                                                 │   │ ║
   171→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
   172→║   │                                                                         │ ║
   173→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   174→║                                     │                                         ║
   175→║                                     ▼                                         ║
   176→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   177→║   │                                                                         │ ║
   178→║   │   L5: VIBE ENGINE (核心智能引擎)                                        │ ║
   179→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   180→║   │                                                                         │ ║
   181→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
   182→║   │   │                                                                 │   │ ║
   183→║   │   │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐   │   │ ║
   184→║   │   │  │    LLM    │  │  EMOTION  │  │  PATTERN  │  │  USER     │   │   │ ║
   185→║   │   │  │ ORCHESTR. │  │  SENSING  │  │ DETECTION │  │  MODEL    │   │   │ ║
   186→║   │   │  └───────────┘  └───────────┘  └───────────┘  └───────────┘   │   │ ║
   187→║   │   │                                                                 │   │ ║
   188→║   │   │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐   │   │ ║
   189→║   │   │  │ PROACTIVE │  │  INSIGHT  │  │   VIBE    │  │  GROWTH   │   │   │ ║
   190→║   │   │  │   AGENT   │  │ GENERATOR │  │   SCORE   │  │  TRACKER  │   │   │ ║
   191→║   │   │  └───────────┘  └───────────┘  └───────────┘  └───────────┘   │   │ ║
   192→║   │   │                                                                 │   │ ║
   193→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
   194→║   │                                                                         │ ║
   195→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   196→║                                     │                                         ║
   197→║                                     ▼                                         ║
   198→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   199→║   │                                                                         │ ║
   200→║   │   L6: IDENTITY & DATA LAYER (身份与数据层)                              │ ║
   201→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   202→║   │                                                                         │ ║
   203→║   │   ┌───────────────────────────────────────────────────────────────────┐ │ ║
   204→║   │   │                         VIBE ID                                   │ │ ║
   205→║   │   │               统一身份认证与授权系统                               │ │ ║
   206→║   │   │                                                                   │ │ ║
   207→║   │   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐               │ │ ║
   208→║   │   │  │ SSO/OAuth   │  │  Profile    │  │ Data Vault  │               │ │ ║
   209→║   │   │  │ 单点登录     │  │  用户画像   │  │  数据金库   │               │ │ ║
   210→║   │   │  └─────────────┘  └─────────────┘  └─────────────┘               │ │ ║
   211→║   │   └───────────────────────────────────────────────────────────────────┘ │ ║
   212→║   │                                                                         │ ║
   213→║   │   ┌───────────────────────────────────────────────────────────────────┐ │ ║
   214→║   │   │                      DATA STORES                                  │ │ ║
   215→║   │   │                                                                   │ │ ║
   216→║   │   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐    │ │ ║
   217→║   │   │  │PostgreSQL│ │Pinecone │ │  Neo4j  │ │  Redis  │ │   S3    │    │ │ ║
   218→║   │   │  │ Primary │ │ Vector  │ │  Graph  │ │  Cache  │ │  Assets │    │ │ ║
   219→║   │   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘    │ │ ║
   220→║   │   └───────────────────────────────────────────────────────────────────┘ │ ║
   221→║   │                                                                         │ ║
   222→║   └─────────────────────────────────────────────────────────────────────────┘ ║
   223→║                                                                               ║
   224→╚═══════════════════════════════════════════════════════════════════════════════╝
   225→```
   226→
   227→---
   228→
   229→# 第二部分：统一身份系统 (Vibe ID)
   230→
   231→## 2.1 Vibe ID 核心设计
   232→
   233→```
   234→╔═══════════════════════════════════════════════════════════════════════════════╗
   235→║                                                                               ║
   236→║                              VIBE ID SYSTEM                                   ║
   237→║                      跨星座的统一身份与数据主权                                ║
   238→║                                                                               ║
   239→║   ─────────────────────────────────────────────────────────────────────────   ║
   240→║                                                                               ║
   241→║   设计原则：                                                                  ║
   242→║                                                                               ║
   243→║   1. ONE IDENTITY, ALL CONSTELLATIONS                                         ║
   244→║      一个身份，访问所有 Skill 站点                                            ║
   245→║                                                                               ║
   246→║   2. USER DATA SOVEREIGNTY                                                    ║
   247→║      用户完全掌控自己的数据                                                   ║
   248→║                                                                               ║
   249→║   3. PROGRESSIVE DISCLOSURE                                                   ║
   250→║      渐进式信息收集，价值前置                                                 ║
   251→║                                                                               ║
   252→║   4. SEAMLESS CROSS-SKILL EXPERIENCE                                          ║
   253→║      无缝的跨 Skill 体验流转                                                  ║
   254→║                                                                               ║
   255→╚═══════════════════════════════════════════════════════════════════════════════╝
   256→```
   257→
   258→## 2.2 Vibe ID 架构
   259→
   260→```
   261→┌─────────────────────────────────────────────────────────────────────────────┐
   262→│                                                                             │
   263→│   VIBE ID ARCHITECTURE                                                      │
   264→│                                                                             │
   265→│   ═══════════════════════════════════════════════════════════════════════   │
   266→│                                                                             │
   267→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   268→│   │                                                                     │   │
   269→│   │                     AUTHENTICATION LAYER                            │   │
   270→│   │                                                                     │   │
   271→│   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                │   │
   272→│   │   │   Social    │  │   Magic     │  │   Email/    │                │   │
   273→│   │   │   OAuth     │  │    Link     │  │   Password  │                │   │
   274→│   │   │             │  │             │  │             │                │   │
   275→│   │   │ • WeChat    │  │ • 零密码    │  │ • 传统登录  │                │   │
   276→│   │   │ • Apple     │  │ • 邮件链接  │  │ • MFA 支持  │                │   │
   277→│   │   │ • Google    │  │ • 短信验证  │  │             │                │   │
   278→│   │   └─────────────┘  └─────────────┘  └─────────────┘                │   │
   279→│   │                                                                     │   │
   280→│   └───────────────────────────────┬─────────────────────────────────────┘   │
   281→│                                   │                                         │
   282→│                                   ▼                                         │
   283→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   284→│   │                                                                     │   │
   285→│   │                     IDENTITY CORE                                   │   │
   286→│   │                                                                     │   │
   287→│   │   ┌─────────────────────────────────────────────────────────────┐   │   │
   288→│   │   │                                                             │   │   │
   289→│   │   │   VIBE ID                                                   │   │   │
   290→│   │   │   ─────────────────────────────────────────────────────     │   │   │
   291→│   │   │                                                             │   │   │
   292→│   │   │   ID: vibe_2xK9mN4pLq8                                      │   │   │
   293→│   │   │   Created: 2026-01-05                                       │   │   │
   294→│   │   │                                                             │   │   │
   295→│   │   │   ┌─────────────────────────────────────────────────────┐   │   │   │
   296→│   │   │   │  Core Profile (跨站共享)                            │   │   │   │
   297→│   │   │   │  • display_name: "Alex"                             │   │   │   │
   298→│   │   │   │  • avatar_url: "..."                                │   │   │   │
   299→│   │   │   │  • birth_datetime: "1990-03-15T08:30:00"           │   │   │   │
   300→│   │   │   │  • birth_location: "Shanghai, China"               │   │   │   │
   301→│   │   │   │  • timezone: "Asia/Shanghai"                        │   │   │   │
   302→│   │   │   │  • language: "zh-CN"                                │   │   │   │
   303→│   │   │   └─────────────────────────────────────────────────────┘   │   │   │
   304→│   │   │                                                             │   │   │
   305→│   │   │   ┌─────────────────────────────────────────────────────┐   │   │   │
   306→│   │   │   │  Skill Profiles (各站独立)                          │   │   │   │
   307→│   │   │   │                                                     │   │   │   │
   308→│   │   │   │  astra: { natal_chart: {...}, readings: [...] }    │   │   │   │
   309→│   │   │   │  bazi:  { chart: {...}, dayun: [...] }             │   │   │   │
   310→│   │   │   │  mbti:  { type: "INTJ", assessments: [...] }       │   │   │   │
   311→│   │   │   │  attach: { style: "anxious", sessions: [...] }     │   │   │   │
   312→│   │   │   └─────────────────────────────────────────────────────┘   │   │   │
   313→│   │   │                                                             │   │   │
   314→│   │   │   ┌─────────────────────────────────────────────────────┐   │   │   │
   315→│   │   │   │  Cross-Skill Insights (洞察整合)                    │   │   │   │
   316→│   │   │   │                                                     │   │   │   │
   317→│   │   │   │  • unified_personality_model: {...}                 │   │   │   │
   318→│   │   │   │  • growth_journey: {...}                            │   │   │   │
   319→│   │   │   │  • vibe_score_history: [...]                        │   │   │   │
   320→│   │   │   └─────────────────────────────────────────────────────┘   │   │   │
   321→│   │   │                                                             │   │   │
   322→│   │   └─────────────────────────────────────────────────────────────┘   │   │
   323→│   │                                                                     │   │
   324→│   └───────────────────────────────┬─────────────────────────────────────┘   │
   325→│                                   │                                         │
   326→│                                   ▼                                         │
   327→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   328→│   │                                                                     │   │
   329→│   │                     DATA SOVEREIGNTY LAYER                          │   │
   330→│   │                                                                     │   │
   331→│   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                │   │
   332→│   │   │   DATA      │  │   CONSENT   │  │   EXPORT    │                │   │
   333→│   │   │   VAULT     │  │   MANAGER   │  │   ENGINE    │                │   │
   334→│   │   │             │  │             │  │             │                │   │
   335→│   │   │ • 加密存储  │  │ • 授权管理  │  │ • 数据导出  │                │   │
   336→│   │   │ • 审计日志  │  │ • 共享控制  │  │ • 完全删除  │                │   │
   337→│   │   │ • 版本历史  │  │ • 细粒度    │  │ • GDPR合规  │                │   │
   338→│   │   └─────────────┘  └─────────────┘  └─────────────┘                │   │
   339→│   │                                                                     │   │
   340→│   └─────────────────────────────────────────────────────────────────────┘   │
   341→│                                                                             │
   342→└─────────────────────────────────────────────────────────────────────────────┘
   343→```
   344→
   345→## 2.3 跨站点 SSO 流程
   346→
   347→```
   348→┌─────────────────────────────────────────────────────────────────────────────┐
   349→│                                                                             │
   350→│   CROSS-SITE SSO FLOW                                                       │
   351→│                                                                             │
   352→│   ═══════════════════════════════════════════════════════════════════════   │
   353→│                                                                             │
   354→│   场景：用户从 astra.vibelife.app 跳转到 bazi.vibelife.app                  │
   355→│                                                                             │
   356→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   357→│   │                                                                     │   │
   358→│   │   1. 用户在 astra 点击 "也看看八字分析"                              │   │
   359→│   │      ─────────────────────────────────────────────────────────      │   │
   360→│   │                                                                     │   │
   361→│   │      astra.vibelife.app                    id.vibelife.app          │   │
   362→│   │            │                                      │                 │   │
   363→│   │            │  ①  检查本地 session                  │                 │   │
   364→│   │            │──────────────────────────────────────▶│                 │   │
   365→│   │            │                                      │                 │   │
   366→│   │            │  ②  返回 cross-site token            │                 │   │
   367→│   │            │◀──────────────────────────────────────│                 │   │
   368→│   │            │                                      │                 │   │
   369→│   │                                                                     │   │
   370→│   │   2. 带 token 跳转到 bazi                                           │   │
   371→│   │      ─────────────────────────────────────────────────────────      │   │
   372→│   │                                                                     │   │
   373→│   │            │                                                        │   │
   374→│   │            │  ③  redirect: bazi.vibelife.app?sso_token=xxx          │   │
   375→│   │            │────────────────────────────────────────────────────────│   │
   376→│   │                                                                     │   │
   377→│   │      bazi.vibelife.app                     id.vibelife.app          │   │
   378→│   │            │                                      │                 │   │
   379→│   │            │  ④  验证 sso_token                   │                 │   │
   380→│   │            │──────────────────────────────────────▶│                 │   │
   381→│   │            │                                      │                 │   │
   382→│   │            │  ⑤  返回用户信息 + 授权范围           │                 │   │
   383→│   │            │◀──────────────────────────────────────│                 │   │
   384→│   │            │                                      │                 │   │
   385→│   │   3. bazi 无缝登录，保持上下文                                       │   │
   386→│   │      ─────────────────────────────────────────────────────────      │   │
   387→│   │                                                                     │   │
   388→│   │            │  ⑥  建立本地 session                                   │   │
   389→│   │            │                                                        │   │
   390→│   │            │  ⑦  获取 bazi skill profile（如已存在）                │   │
   391→│   │            │                                                        │   │
   392→│   │            │  ⑧  显示 bazi 界面，已知用户出生信息                    │   │
   393→│   │            │                                                        │   │
   394→│   └─────────────────────────────────────────────────────────────────────┘   │
   395→│                                                                             │
   396→│   用户感知：无需重新登录，出生日期已自动填入                                │
   397→│                                                                             │
   398→└─────────────────────────────────────────────────────────────────────────────┘
   399→```
   400→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
