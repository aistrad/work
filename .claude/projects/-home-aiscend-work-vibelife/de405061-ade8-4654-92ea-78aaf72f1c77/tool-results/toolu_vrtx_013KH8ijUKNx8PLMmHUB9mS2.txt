     1→/**
     2→ * Journey Types - 基于 CoreAgent SKILL_DATA_ARCHITECTURE
     3→ *
     4→ * 数据结构对应后端 skill_data.lifecoach
     5→ * 参考: docs/components/coreagent/SKILL_DATA_ARCHITECTURE.md
     6→ */
     7→
     8→// ═══════════════════════════════════════════════════════════════════════════
     9→// North Star (北极星愿景) - Dan Koe 协议核心输出
    10→// ═══════════════════════════════════════════════════════════════════════════
    11→
    12→export interface NorthStar {
    13→  /** 愿景场景 - 3年后的周二 */
    14→  vision_scene?: string;
    15→  /** 愿景时间框架 */
    16→  vision_timeframe?: string;
    17→  /** 反愿景场景 - 5年后的周二 */
    18→  anti_vision_scene?: string;
    19→  /** 持续的不满/痛点 */
    20→  pain_points?: string[];
    21→}
    22→
    23→// ═══════════════════════════════════════════════════════════════════════════
    24→// Yearly Goals (年度目标)
    25→// ═══════════════════════════════════════════════════════════════════════════
    26→
    27→export interface YearlyGoal {
    28→  /** 目标 ID */
    29→  id: string;
    30→  /** 目标标题 */
    31→  title: string;
    32→  /** 目标描述 */
    33→  description?: string;
    34→  /** 目标类别 */
    35→  category?: "career" | "health" | "relationship" | "wealth" | "growth" | "other";
    36→  /** 进度 0-100 */
    37→  progress: number;
    38→  /** 状态 */
    39→  status: "pending" | "in_progress" | "completed" | "abandoned";
    40→  /** 目标年份 */
    41→  year?: number;
    42→  /** 里程碑 */
    43→  milestones?: Milestone[];
    44→}
    45→
    46→export interface Milestone {
    47→  /** 里程碑 ID */
    48→  id: string;
    49→  /** 里程碑标题 */
    50→  title: string;
    51→  /** 是否完成 */
    52→  completed: boolean;
    53→  /** 完成时间 */
    54→  completed_at?: string;
    55→}
    56→
    57→// ═══════════════════════════════════════════════════════════════════════════
    58→// Roadmap (路线图)
    59→// ═══════════════════════════════════════════════════════════════════════════
    60→
    61→export interface Roadmap {
    62→  /** 年度目标列表 */
    63→  goals?: YearlyGoal[];
    64→  /** 创建时间 */
    65→  created_at?: string;
    66→  /** 更新时间 */
    67→  updated_at?: string;
    68→}
    69→
    70→// ══════════════════════��════════════════════════════════════════════════════
    71→// Monthly Boss (月度 Boss)
    72→// ═══════════════════════════════════════════════════════════════════════════
    73→
    74→export interface MonthlyBoss {
    75→  /** Boss ID */
    76→  id?: string;
    77→  /** Boss 名称/主题 */
    78→  title: string;
    79→  /** 描述 */
    80→  description?: string;
    81→  /** 月份 YYYY-MM */
    82→  month: string;
    83→  /** 进度 0-100 */
    84→  progress: number;
    85→  /** 状态 */
    86→  status: "pending" | "in_progress" | "completed" | "failed";
    87→  /** 关联的年度目标 ID */
    88→  goal_id?: string;
    89→  /** 里程碑 */
    90→  milestones?: Milestone[];
    91→}
    92→
    93→// ═══════════════════════════════════════════════════════════════════════════
    94→// Daily Levers (每日杠杆)
    95→// ═══════════════════════════════════════════════════════════════════════════
    96→
    97→export interface DailyLever {
    98→  /** 杠杆 ID */
    99→  id: string;
   100→  /** 任务描述 */
   101→  task: string;
   102→  /** 状态 */
   103→  status: "pending" | "completed" | "skipped";
   104→  /** 完成时间 */
   105→  completed_at?: string;
   106→  /** 跳过原因 */
   107→  skip_reason?: string;
   108→  /** 关联的周大石头 ID */
   109→  rock_id?: string;
   110→}
   111→
   112→export interface DailyLevers {
   113→  /** 日期 YYYY-MM-DD */
   114→  date: string;
   115→  /** 杠杆列表 */
   116→  levers: DailyLever[];
   117→  /** 能量等级 1-10 */
   118→  energy_level?: number;
   119→  /** 今日意图 */
   120→  intention?: string;
   121→  /** 统计 */
   122→  stats?: {
   123→    total: number;
   124→    completed: number;
   125→    completion_rate: number;
   126→  };
   127→}
   128→
   129→// ═══════════════════════════════════════════════════════════════════════════
   130→// Identity (身份转换) - Dan Koe 协议核心输出
   131→// ═══════════════════════════════════════════════════════════════════════════
   132→
   133→export interface Identity {
   134→  /** 旧身份 - "我是那种会..." */
   135→  current?: string;
   136→  /** 新身份 - "我是那种..." */
   137→  target?: string;
   138→  /** 角色列表 */
   139→  roles?: string[];
   140→}
   141→
   142→// ═══════════════════════════════════════════════════════════════════════════
   143→// Weekly (本周行动) - Dan Koe 协议核心输出
   144→// ═══════════════════════════════════════════════════════════════════════════
   145→
   146→export interface WeeklyAction {
   147→  /** 任务 ID */
   148→  id?: string;
   149→  /** 任务描述 */
   150→  task: string;
   151→  /** 状态 */
   152→  status: "pending" | "in_progress" | "completed";
   153→  /** 进度 0-100 */
   154→  progress?: number;
   155→  /** 完成时间 */
   156→  completed_at?: string;
   157→}
   158→
   159→export interface Weekly {
   160→  /** 周开始日期 */
   161→  week_start?: string;
   162→  /** 本周大石头/行动 */
   163→  rocks?: WeeklyAction[];
   164→  /** 本周主题 */
   165→  theme?: string;
   166→  /** 能量预算 */
   167→  energy_budget?: number;
   168→  /** 统计 */
   169→  stats?: {
   170→    total: number;
   171→    completed: number;
   172→    in_progress: number;
   173→    completion_rate: number;
   174→  };
   175→}
   176→
   177→// ═══════════════════════════════════════════════════════════════════════════
   178→// System State (系统状态)
   179→// ═══════════════════════════════════════════════════════════════════════════
   180→
   181→export interface LifecoachSystemState {
   182→  /** 当前使用的方法论 */
   183→  active_framework?: "dankoe" | "covey" | "yangming" | "liaofan" | null;
   184→  /** 初始化时间 */
   185→  initialized_at?: string;
   186→  /** 最后交互时间 */
   187→  last_interaction?: string;
   188→}
   189→
   190→// ═══════════════════════════════════════════════════════════════════════════
   191→// Progress (进度统计)
   192→// ═══════════════════════════════════════════════════════════════════════════
   193→
   194→export interface Progress {
   195→  /** 当前连续天数 */
   196→  current_streak: number;
   197→  /** 最长连续天数 */
   198→  longest_streak: number;
   199→  /** 总签到次数 */
   200→  total_checkins: number;
   201→  /** 最后签到日期 */
   202→  last_checkin_date?: string;
   203→  /** 任务完成数 */
   204→  tasks_completed?: number;
   205→  /** 本周完成率 */
   206→  weekly_completion_rate?: number;
   207→  /** 今日是否已签到 */
   208→  today_checked_in?: boolean;
   209→  /** 成就列表 */
   210→  achievements?: string[];
   211→}
   212→
   213→// ═══════════════════════════════════════════════════════════════════════════
   214→// LifecoachSkillData - 完整的 skill_data.lifecoach 结构
   215→// ═══════════════════════════════════════════════════════════════════════════
   216→
   217→export interface LifecoachSkillData {
   218→  /** 北极星愿景 */
   219→  north_star?: NorthStar;
   220→  /** 身份转换 */
   221→  identity?: Identity;
   222→  /** 路线图 (年度目标) */
   223→  roadmap?: Roadmap;
   224→  /** 年度目标 (兼容旧格式) */
   225→  goals?: YearlyGoal[];
   226→  /** 本周行动 */
   227→  weekly?: Weekly;
   228→  /** 周大石头 (新格式) */
   229→  weekly_rocks?: Weekly;
   230→  /** 月度 Boss */
   231→  monthly_boss?: MonthlyBoss;
   232→  /** 每日杠杆 */
   233→  daily_levers?: DailyLevers;
   234→  /** 进度统计 */
   235→  progress?: Progress;
   236→  /** 系统状态 */
   237→  _state?: LifecoachSystemState;
   238→  /** 元数据 */
   239→  _meta?: {
   240→    version: number;
   241→    created_at?: string;
   242→    updated_at?: string;
   243→  };
   244→}
   245→
   246→// ═══════════════════════════════════════════════════════════════════════════
   247→// Journey Page State (页面状态机)
   248→// ═══════════════════════════════════════════════════════════════════════════
   249→
   250→/**
   251→ * Journey 页面状态 - 4 状态渐进系统
   252→ * - empty: 未设置北极星，引导开始
   253→ * - north_star_set: 有北极星，无路线图，引导制定路线图
   254→ * - planned: 有路线图，无周大石头，引导设定本周大石头
   255→ * - executing: 有周大石头，展示完整执行仪表盘
   256→ */
   257→export type JourneyState = "empty" | "north_star_set" | "planned" | "executing";
   258→
   259→/**
   260→ * 根据 skill_data 判断页面状态
   261→ */
   262→export function getJourneyState(data: LifecoachSkillData | null | undefined): JourneyState {
   263→  // State 0: empty - 没有北极星愿景
   264→  if (!data?.north_star?.vision_scene) {
   265→    return "empty";
   266→  }
   267→
   268→  // State 1: north_star_set - 有北极星，但没有路线图/年度目标
   269→  const hasRoadmap = (data.roadmap?.goals?.length ?? 0) > 0 || (data.goals?.length ?? 0) > 0;
   270→  if (!hasRoadmap) {
   271→    return "north_star_set";
   272→  }
   273→
   274→  // State 2: planned - 有路线图，但没有周大石头
   275→  const hasWeeklyRocks = (data.weekly?.rocks?.length ?? 0) > 0 || (data.weekly_rocks?.rocks?.length ?? 0) > 0;
   276→  if (!hasWeeklyRocks) {
   277→    return "planned";
   278→  }
   279→
   280→  // State 3: executing - 完整执行状态
   281→  return "executing";
   282→}
   283→
   284→// ═══════════════════════════════════════════════════════════════════════════
   285→// API Response Types
   286→// ═══════════════════════════════════════════════════════════════════════════
   287→
   288→export interface ReadLifecoachStateResponse {
   289→  status: "success" | "empty" | "error";
   290→  message?: string;
   291→  data: LifecoachSkillData;
   292→  version?: number;
   293→  updated_at?: string;
   294→}
   295→
   296→// ═══════════════════════════════════════════════════════════════════════════
   297→// show_dankoe Tool Response (Chat 中的卡片数据)
   298→// ═══════════════════════════════════════════════════════════════════════════
   299→
   300→export interface DankoeCardData {
   301→  card_type: "dankoe";
   302→  data: {
   303→    vision: {
   304→      statement?: string;
   305→      scene?: string;
   306→      identity?: string;
   307→    };
   308→    anti_vision: {
   309→      statement?: string;
   310→      scene?: string;
   311→    };
   312→    game: {
   313→      win_condition?: string;
   314→      lose_condition?: string;
   315→      main_mission?: string;
   316→      current_boss?: string;
   317→      daily_quests?: string[];
   318→      rules?: string[];
   319→    };
   320→    generated_at?: string;
   321→  };
   322→}
   323→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
