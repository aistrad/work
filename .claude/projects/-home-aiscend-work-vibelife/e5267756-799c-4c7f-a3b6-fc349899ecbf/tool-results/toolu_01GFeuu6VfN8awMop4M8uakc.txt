     1→# Vibe 同步配置 - v11
     2→#
     3→# Vibe 层主动控制从哪些 Skill 抽取哪些数据
     4→# 修改此配置无需改代码，重启服务即可生效
     5→#
     6→# 数据流：
     7→#   Skill 工具调用 → update_skill_data → sync_skill_to_vibe → Vibe 层更新
     8→#
     9→# 文档：docs/archive/v9/LLM_DRIVEN_ARCHITECTURE.md#15
    10→
    11→version: "1.0"
    12→
    13→# ═══════════════════════════════════════════════════════════════
    14→# Vibe.insight 的数据来源（我是谁）
    15→# ═══════════════════════════════════════════════════════════════
    16→
    17→insight:
    18→  # 本质 (essence)
    19→  essence:
    20→    # 原型 (archetype) - 多来源，按优先级
    21→    archetype:
    22→      sources:
    23→        - skill: bazi
    24→          trigger: chart.day_master  # 当此路径有值时触发
    25→          priority: 1  # 优先级最高
    26→          transform: element_to_archetype
    27→          mapping:
    28→            wood: { primary: "成长者", traits: ["创新", "进取", "仁慈"] }
    29→            fire: { primary: "表达者", traits: ["热情", "领导", "直觉"] }
    30→            earth: { primary: "稳定者", traits: ["务实", "包容", "信守"] }
    31→            metal: { primary: "完善者", traits: ["精准", "公正", "坚韧"] }
    32→            water: { primary: "智慧者", traits: ["灵活", "深思", "洞察"] }
    33→        - skill: zodiac
    34→          trigger: chart.sun_sign
    35→          priority: 2
    36→          transform: sign_to_archetype
    37→          mapping:
    38→            aries: { primary: "开拓者", traits: ["勇敢", "主动", "独立"] }
    39→            taurus: { primary: "稳定者", traits: ["稳定", "务实", "享受"] }
    40→            gemini: { primary: "沟通者", traits: ["灵活", "沟通", "好奇"] }
    41→            cancer: { primary: "守护者", traits: ["敏感", "关怀", "保护"] }
    42→            leo: { primary: "领袖者", traits: ["自信", "慷慨", "创造"] }
    43→            virgo: { primary: "完善者", traits: ["细致", "服务", "分析"] }
    44→            libra: { primary: "和谐者", traits: ["和谐", "公正", "社交"] }
    45→            scorpio: { primary: "洞察者", traits: ["深度", "洞察", "转化"] }
    46→            sagittarius: { primary: "探索者", traits: ["乐观", "探索", "哲学"] }
    47→            capricorn: { primary: "成就者", traits: ["务实", "责任", "成就"] }
    48→            aquarius: { primary: "创新者", traits: ["创新", "独立", "人道"] }
    49→            pisces: { primary: "直觉者", traits: ["直觉", "同情", "艺术"] }
    50→        - skill: jungastro
    51→          trigger: analysis.archetype
    52→          priority: 3
    53→          transform: direct  # 直接使用
    54→          path: analysis.archetype
    55→
    56→    # 命盘特征 (chart_features)
    57→    chart_features:
    58→      bazi:
    59→        trigger: chart
    60→        fields:
    61→          - source: chart.day_master
    62→            dest: bazi.day_master
    63→          - source: chart.pillars
    64→            dest: bazi.pillars
    65→          - source: chart.five_elements
    66→            dest: bazi.five_elements
    67→          - source: chart.pattern
    68→            dest: bazi.pattern
    69→      zodiac:
    70→        trigger: chart
    71→        fields:
    72→          - source: chart.sun_sign
    73→            dest: zodiac.sun_sign
    74→          - source: chart.moon_sign
    75→            dest: zodiac.moon_sign
    76→          - source: chart.rising_sign
    77→            dest: zodiac.rising_sign
    78→          - source: chart.dominant_element
    79→            dest: zodiac.dominant_element
    80→
    81→    # 特质 (traits) - 合并多来源
    82→    traits:
    83→      merge_strategy: append_unique  # 去重追加，保留 source 字段
    84→      max_items: 5
    85→      sources:
    86→        - skill: bazi
    87→          trigger: chart.day_master
    88→          transform: extract_bazi_traits
    89→          intensity: 0.8
    90→        - skill: zodiac
    91→          trigger: chart.sun_sign
    92→          transform: extract_zodiac_traits
    93→          intensity: 0.7
    94→
    95→  # 动态 (dynamic) - 由 ProfileExtractor 定时更新
    96→  dynamic:
    97→    emotion:
    98→      source: extracted.emotion  # 从 ProfileExtractor 抽取
    99→    energy:
   100→      source: extracted.energy
   101→
   102→  # 规律 (pattern) - 由 ProfileExtractor 定时更新
   103→  pattern:
   104→    behaviors:
   105→      source: extracted.behaviors
   106→    insights:
   107→      source: extracted.insights
   108→
   109→# ═══════════════════════════════════════════════════════════════
   110→# Vibe.target 的数据来源（我要成为谁）
   111→# ═══════════════════════════════════════════════════════════════
   112→
   113→target:
   114→  # 北极星 (north_star)
   115→  north_star:
   116→    skill: lifecoach
   117→    trigger: north_star
   118→    fields:
   119→      - source: north_star.vision_scene
   120→        dest: vision_scene
   121→      - source: north_star.anti_vision
   122→        dest: anti_vision
   123→      - source: north_star.statement
   124→        dest: statement
   125→
   126→  # 目标 (goals)
   127→  goals:
   128→    skill: lifecoach
   129→    trigger: goals
   130→    fields:
   131→      - source: goals
   132→        dest: goals
   133→        transform: direct
   134→
   135→  # 聚焦 (focus)
   136→  focus:
   137→    skill: lifecoach
   138→    trigger: current
   139→    fields:
   140→      - source: current.month.goal_id
   141→        dest: primary
   142→      - source: current.week.rocks
   143→        dest: active_rocks
   144→        transform: extract_first_goal_id
   145→
   146→  # 里程碑 (milestones)
   147→  milestones:
   148→    skill: lifecoach
   149→    trigger: progress
   150→    fields:
   151→      - source: progress.streak
   152→        dest: streak
   153→      - source: progress.total_checkins
   154→        dest: total_checkins
   155→
   156→# ═══════════════════════════════════════════════════════════════
   157→# Transform 函数定义（在 sync.py 中实现）
   158→# ═══════════════════════════════════════════════════════════════
   159→
   160→transforms:
   161→  element_to_archetype:
   162→    description: "五行元素 → 人格原型"
   163→    input: "wood | fire | earth | metal | water"
   164→    output: "{ primary: string, traits: string[] }"
   165→
   166→  sign_to_archetype:
   167→    description: "星座 → 人格原型"
   168→    input: "aries | taurus | ... | pisces"
   169→    output: "{ primary: string, traits: string[] }"
   170→
   171→  extract_bazi_traits:
   172→    description: "从八字日主提取特质"
   173→    input: "chart.day_master"
   174→    output: "[{ trait: string, intensity: float, source: 'bazi' }]"
   175→
   176→  extract_zodiac_traits:
   177→    description: "从星座提取特质"
   178→    input: "chart.sun_sign"
   179→    output: "[{ trait: string, intensity: float, source: 'zodiac' }]"
   180→
   181→  extract_first_goal_id:
   182→    description: "从列表中提取第一个 goal_id"
   183→    input: "[{ goal_id: string, ... }]"
   184→    output: "string | null"
   185→
   186→  direct:
   187→    description: "直接使用，不转换"
   188→    input: "any"
   189→    output: "any"
   190→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
