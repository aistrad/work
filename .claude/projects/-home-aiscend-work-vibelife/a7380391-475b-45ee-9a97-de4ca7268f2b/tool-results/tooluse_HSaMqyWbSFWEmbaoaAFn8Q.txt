     1â†’# VibeLife 30ç§’ Onboarding æµç¨‹åŸå‹è®¾è®¡
     2â†’
     3â†’> **æ–‡æ¡£ç‰ˆæœ¬**: v1.0
     4â†’> **è®¾è®¡æ—¥æœŸ**: 2026-01-07
     5â†’> **è®¾è®¡åŸåˆ™**: Aha Moment ä¼˜å…ˆï¼Œå…ˆç»™ä»·å€¼å†è¦ä¿¡æ¯
     6â†’> **æ ¸å¿ƒç›®æ ‡**: 30ç§’å†…è®©ç”¨æˆ·äº§ç”Ÿ"å“‡ï¼Œè¿™ä¸œè¥¿çœŸå‡†"çš„é¡¿æ‚Ÿæ—¶åˆ»
     7â†’
     8â†’---
     9â†’
    10â†’## 1. è®¾è®¡å“²å­¦
    11â†’
    12â†’### 1.1 ä¼ ç»Ÿæµç¨‹ vs ä¼˜åŒ–æµç¨‹å¯¹æ¯”
    13â†’
    14â†’```
    15â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    16â†’â”‚                    ä¼ ç»Ÿ Onboarding æµç¨‹ï¼ˆé—®é¢˜ç‰ˆï¼‰                â”‚
    17â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    18â†’â”‚                                                                  â”‚
    19â†’â”‚   ç”¨æˆ·è¿›å…¥ â†’ å¼ºåˆ¶è®¿è°ˆ(10ä¸ªé—®é¢˜) â†’ ç­‰å¾…åˆ†æ â†’ çœ‹åˆ°ç»“æœ            â”‚
    20â†’â”‚       â”‚            â”‚                  â”‚           â”‚             â”‚
    21â†’â”‚       â–¼            â–¼                  â–¼           â–¼             â”‚
    22â†’â”‚    æ³¨å†Œèµ·ç‚¹    æµå¤±ç‡60%+         æµå¤±ç‡40%+    Aha Moment      â”‚
    23â†’â”‚                                                                  â”‚
    24â†’â”‚   é—®é¢˜ï¼šå¤§å¤šæ•°ç”¨æˆ·åœ¨Aha Momentå‰å°±æµå¤±äº†                         â”‚
    25â†’â”‚                                                                  â”‚
    26â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    27â†’
    28â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    29â†’â”‚                    ä¼˜åŒ–å Onboarding æµç¨‹                       â”‚
    30â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    31â†’â”‚                                                                  â”‚
    32â†’â”‚   ç”¨æˆ·è¿›å…¥ â†’ å¿«é€Ÿé€‰æ‹©(1é¢˜) â†’ ç«‹å³çœ‹åˆ°å‘½ç›˜ â†’ ä»Šæ—¥è¿åŠ¿ â†’ ğŸ”¥Aha!   â”‚
    33â†’â”‚       â”‚           â”‚              â”‚            â”‚       â”‚         â”‚
    34â†’â”‚       â–¼           â–¼              â–¼            â–¼       â–¼         â”‚
    35â†’â”‚    æ³¨å†Œèµ·ç‚¹    æµå¤±ç‡<10%     æµå¤±ç‡<15%   å…è´¹ä»·å€¼  é¡¿æ‚Ÿæ—¶åˆ»    â”‚
    36â†’â”‚                                                                  â”‚
    37â†’â”‚   æ ¸å¿ƒæ”¹å˜ï¼šå…ˆç»™ä»·å€¼ï¼Œå»ºç«‹ä¿¡ä»»ï¼Œå†è¦æ·±åº¦ä¿¡æ¯                     â”‚
    38â†’â”‚                                                                  â”‚
    39â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    40â†’```
    41â†’
    42â†’### 1.2 æ ¸å¿ƒè®¾è®¡åŸåˆ™
    43â†’
    44â†’| åŸåˆ™ | è¯´æ˜ | å®ç° |
    45â†’|------|------|------|
    46â†’| **30ç§’æ³•åˆ™** | Aha Momentå¿…é¡»åœ¨30ç§’å†…å‘ç”Ÿ | å¿«é€Ÿé—®é¢˜ + å³æ—¶åé¦ˆ |
    47â†’| **ä»·å€¼å…ˆè¡Œ** | å…ˆå±•ç¤ºèƒ½åŠ›ï¼Œå†ç´¢å–ä¿¡æ¯ | å‘½ç›˜é¢„è§ˆæ— éœ€è®¿è°ˆ |
    48â†’| **æ¸è¿›å¼æŠ«éœ²** | ä¿¡æ¯é€æ­¥äº¤æ¢ï¼Œé™ä½é—¨æ§› | å…ˆ3é¢˜å¿«é€Ÿï¼Œå10é¢˜æ·±åº¦ |
    49â†’| **è§†è§‰å†²å‡»** | ç¬¬ä¸€çœ¼å¿…é¡»"å“‡" | ä¸“ä¸šå‘½ç›˜+åŠ¨æ€æ•ˆæœ |
    50â†’| **å…è´¹ä»·å€¼æ˜ç¡®** | å…è´¹ç”¨æˆ·ä¹Ÿæ„Ÿåˆ°ç‰©è¶…æ‰€å€¼ | ä»Šæ—¥è¿åŠ¿+è½»åº¦è§£è¯» |
    51â†’| **ä»˜è´¹è§¦å‘è‡ªç„¶** | å½“ç”¨æˆ·æƒ³è¦æ›´å¤šæ—¶æ‰ä»˜è´¹ | ä¸»åŠ¨è¯·æ±‚æ·±åº¦åˆ†æ |
    52â†’
    53â†’---
    54â†’
    55â†’## 2. ç§’çº§æµç¨‹è¯¦è§£
    56â†’
    57â†’### 2.1 å®Œæ•´30ç§’æµç¨‹æ—¶é—´è½´
    58â†’
    59â†’```
    60â†’æ—¶é—´è½´      ç”¨æˆ·æ“ä½œ                    ç³»ç»Ÿå“åº”                  è®¾è®¡æ„å›¾
    61â†’â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    62â†’ 0s        ç‚¹å‡»"å¼€å§‹å¯¹è¯"               è·³è½¬åˆ°å¿«é€Ÿé€‰æ‹©é¡µé¢          é™ä½é—¨æ§›
    63â†’  â”‚
    64â†’ 3s        é€‰æ‹©ä»Šæ—¥å…³æ³¨ç‚¹               ç«‹å³å¼€å§‹è®¡ç®—å‘½ç›˜            å•é€‰é™ä½è®¤çŸ¥è´Ÿæ‹…
    65â†’ â”‚          â”œâ”€ æ„Ÿæƒ…è¿åŠ¿              (åå°ä½¿ç”¨ç®€åŒ–çš„å…«å­—ç®—æ³•)
    66â†’ â”‚          â”œâ”€ èŒä¸šå‘å±•
    67â†’ â”‚          â””â”€ è‡ªæˆ‘è®¤çŸ¥
    68â†’ â”‚
    69â†’ 8s        çœ‹åˆ°å‘½ç›˜å¯è§†åŒ–ï¼ˆåŠ è½½åŠ¨ç”»ï¼‰    "æ­£åœ¨ä¸ºä½ ç»˜åˆ¶å‘½ç›˜..."       åˆ¶é€ æœŸå¾…æ„Ÿ
    70â†’ â”‚          â–¼                                                     â”‚
    71â†’12s        ğŸ”¥ Aha Moment #1             "ä½ æ˜¯ä¸™ç«æ—¥ä¸»ï¼Œ            è§†è§‰å†²å‡»+
    72â†’ â”‚          ä¸“ä¸šå‘½ç›˜å±•ç¤º                å¤©ç”Ÿæ¸©æš–æ˜äº®..."            å³æ—¶ä¸ªæ€§åŒ–
    73â†’ â”‚            â”œâ”€ å››æŸ±å…«å­—                                        â”‚
    74â†’ â”‚            â”œâ”€ äº”è¡Œé…è‰²                                        â”‚
    75â†’ â”‚            â””â”€ æ—¥ä¸»çªå‡ºæ˜¾ç¤º                                    â”‚
    76â†’ â”‚
    77â†’18s        çœ‹åˆ°ä»Šæ—¥è¿åŠ¿å¡ç‰‡             "æœ¬å‘¨ä½ çš„è´µäººè¿â¬†ï¸ï¼Œ        å…è´¹ä»·å€¼+
    78â†’ â”‚          (æ»šåŠ¨å‡ºç°)                 é€‚åˆä¸»åŠ¨å‡ºå‡»..."            å®ç”¨å»ºè®®
    79â†’ â”‚            â”œâ”€ è¿åŠ¿æŒ‡æ•°(65/100)                               â”‚
    80â†’ â”‚            â”œâ”€ ä»Šæ—¥å®œå¿Œ                                        â”‚
    81â†’ â”‚            â””â”€ ä¸€å¥è¯é‡‘å¥                                     â”‚
    82â†’ â”‚
    83â†’25s        è‡ªåŠ¨å¼¹å‡ºå¼•å¯¼                 "æƒ³è¦æ›´æ·±åº¦è§£è¯»å—ï¼Ÿ        è‡ªç„¶å¼•å¯¼ï¼Œ
    84â†’ â”‚          (éå¼ºåˆ¶)                    åªéœ€3ä¸ªé—®é¢˜..."            ä¸æ‰“æ–­ä½“éªŒ
    85â†’ â”‚           â”œâ”€ "ç»§ç»­æ·±åº¦è§£è¯»"æŒ‰é’®                              â”‚
    86â†’ â”‚           â””â”€ "æš‚æ—¶å…ˆçœ‹çœ‹"è·³è¿‡æŒ‰é’®                             â”‚
    87â†’ â”‚
    88â†’30s        ğŸ”¥ Aha Moment #2             ç”¨æˆ·æ„Ÿå—åˆ°ï¼š"è¿™ä¸œè¥¿        æƒ…æ„Ÿè¿æ¥
    89â†’ â”‚          (å¦‚æœç‚¹å‡»ç»§ç»­)               çœŸçš„æ‡‚æˆ‘ï¼"               å»ºç«‹ä¿¡ä»»
    90â†’ â”‚          å¼€å§‹æ·±åº¦è®¿è°ˆ(3ä¸ªé—®é¢˜)                                 â”‚
    91â†’ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    92â†’```
    93â†’
    94â†’### 2.2 å…³é”®çŠ¶æ€æœºè®¾è®¡
    95â†’
    96â†’```
    97â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    98â†’â”‚                        ç”¨æˆ·çŠ¶æ€è½¬æ¢                              â”‚
    99â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   100â†’â”‚                                                                  â”‚
   101â†’â”‚   STATE_NEW (æ–°ç”¨æˆ·)                                            â”‚
   102â†’â”‚        â”‚                                                        â”‚
   103â†’â”‚        â–¼ é€‰æ‹©å…³æ³¨ç‚¹                                             â”‚
   104â†’â”‚   STATE_QUICK_ANSWER (å¿«é€Ÿå›ç­”)                                  â”‚
   105â†’â”‚        â”‚                                                        â”‚
   106â†’â”‚        â–¼ çœ‹åˆ°å‘½ç›˜é¢„è§ˆ                                           â”‚
   107â†’â”‚   STATE_AHA_VISUAL (è§†è§‰é¡¿æ‚Ÿ)                                    â”‚
   108â†’â”‚        â”‚                                                        â”‚
   109â†’â”‚        â–¼ çœ‹åˆ°ä»Šæ—¥è¿åŠ¿                                           â”‚
   110â†’â”‚   STATE_AHA_VALUE (ä»·å€¼é¡¿æ‚Ÿ)                                     â”‚
   111â†’â”‚        â”‚                                                        â”‚
   112â†’â”‚        â”œâ”€â”€ è·³è¿‡ â”€â”€â–º STATE_LIGHT_USER (è½»åº¦ç”¨æˆ·)                 â”‚
   113â†’â”‚        â”‚           - ç»§ç»­æµè§ˆ                                   â”‚
   114â†’â”‚        â”‚           - å¯èƒ½åˆ†äº«                                   â”‚
   115â†’â”‚        â”‚           - æœªæ¥å¯èƒ½è½¬åŒ–                               â”‚
   116â†’â”‚        â”‚                                                        â”‚
   117â†’â”‚        â””â”€â”€ ç»§ç»­ â”€â”€â–º STATE_DEEP_INTERVIEW (æ·±åº¦è®¿è°ˆ)             â”‚
   118â†’â”‚                    â”‚                                            â”‚
   119â†’â”‚                    â–¼ å®Œæˆ3ä¸ªæ ¸å¿ƒé—®é¢˜                            â”‚
   120â†’â”‚                STATE_ENGAGED (å·²æŠ•å…¥ç”¨æˆ·)                        â”‚
   121â†’â”‚                        â”‚                                        â”‚
   122â†’â”‚                        â–¼ çœ‹åˆ°ä»˜è´¹å¢™                             â”‚
   123â†’â”‚                    STATE_CONVERT (è½¬åŒ–å†³ç­–)                     â”‚
   124â†’â”‚                        â”œâ”€â”€ ä»˜è´¹ â”€â”€â–º PAID_USER                   â”‚
   125â†’â”‚                        â””â”€â”€ ç¦»å¼€ â”€â”€â–º è®°å½•è¡Œä¸ºï¼Œåç»­å¬å›           â”‚
   126â†’â”‚                                                                  â”‚
   127â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   128â†’```
   129â†’
   130â†’---
   131â†’
   132â†’## 3. é¡µé¢çº§äº¤äº’è®¾è®¡
   133â†’
   134â†’### 3.1 Landing é¡µé¢ä¼˜åŒ–
   135â†’
   136â†’**ç›®æ ‡**: 5ç§’å†…ä¼ è¾¾"è¿™æ˜¯ä»€ä¹ˆ"+"èƒ½ä¸ºæˆ‘åšä»€ä¹ˆ"
   137â†’
   138â†’```typescript
   139â†’// apps/web/src/app/(bazi)/page.tsx
   140â†’export default function BaziLandingPage() {
   141â†’  return (
   142â†’    <div className="min-h-screen bg-gradient-to-b from-amber-50 to-vellum">
   143â†’      {/* Hero Section - 3ç§’ä¼ è¾¾æ ¸å¿ƒä»·å€¼ */}
   144â†’      <section className="container mx-auto px-4 py-16 text-center">
   145â†’        <h1 className="text-5xl font-serif text-ink mb-4">
   146â†’          AI å…«å­—å‘½ç†
   147â†’        </h1>
   148â†’        <p className="text-xl text-ink/70 mb-8">
   149â†’          åƒå¤§å¸ˆä¸€æ ·ä¸“ä¸šï¼Œåƒé—ºèœœä¸€æ ·æ‡‚ä½ 
   150â†’        </p>
   151â†’
   152â†’        {/* 3ä¸ªå¿«é€Ÿé—®é¢˜ - é™ä½é—¨æ§› */}
   153â†’        <QuickSelectionCard />
   154â†’      </section>
   155â†’
   156â†’      {/* ç¤¾ä¼šè¯æ˜ - å»ºç«‹ä¿¡ä»» */}
   157â†’      <section className="py-8 border-t border-vellum-200">
   158â†’        <SocialProof stats={{
   159â†’          users: "10,000+",
   160â†’          accuracy: "94%æ»¡æ„",
   161â†’          rating: "4.9æ˜Ÿ"
   162â†’        }} />
   163â†’      </section>
   164â†’    </div>
   165â†’  );
   166â†’}
   167â†’```
   168â†’
   169â†’### 3.2 å¿«é€Ÿé€‰æ‹©ç»„ä»¶ï¼ˆå…³é”®ç»„ä»¶ï¼‰
   170â†’
   171â†’```typescript
   172â†’// apps/web/src/components/onboarding/QuickSelectionCard.tsx
   173â†’'use client';
   174â†’
   175â†’import { useState } from 'react';
   176â†’import { useRouter } from 'next/navigation';
   177â†’import { useSkill } from '@/providers/SkillProvider';
   178â†’
   179â†’const FOCUS_OPTIONS = [
   180â†’  {
   181â†’    id: 'relationship',
   182â†’    label: 'æ„Ÿæƒ…è¿åŠ¿',
   183â†’    icon: 'â¤ï¸',
   184â†’    description: 'çˆ±æƒ…ã€å©šå§»ã€æ¡ƒèŠ±',
   185â†’    color: 'from-rose-400 to-pink-500'
   186â†’  },
   187â†’  {
   188â†’    id: 'career',
   189â†’    label: 'èŒä¸šå‘å±•',
   190â†’    icon: 'ğŸ’¼',
   191â†’    description: 'äº‹ä¸šã€è´¢è¿ã€å‡èŒ',
   192â†’    color: 'from-blue-400 to-indigo-500'
   193â†’  },
   194â†’  {
   195â†’    id: 'self',
   196â†’    label: 'è‡ªæˆ‘è®¤çŸ¥',
   197â†’    icon: 'ğŸ”®',
   198â†’    description: 'æ€§æ ¼ã€å¤©èµ‹ã€ä½¿å‘½',
   199â†’    color: 'from-purple-400 to-violet-500'
   200â†’  }
   201â†’];
   202â†’
   203â†’export function QuickSelectionCard() {
   204â†’  const [selected, setSelected] = useState<string | null>(null);
   205â†’  const [loading, setLoading] = useState(false);
   206â†’  const router = useRouter();
   207â†’  const { skill } = useSkill();
   208â†’
   209â†’  const handleSelect = async (focusId: string) => {
   210â†’    setSelected(focusId);
   211â†’    setLoading(true);
   212â†’
   213â†’    // ç«‹å³è·³è½¬åˆ°å‘½ç›˜é¢„è§ˆé¡µé¢ï¼ˆä¸éœ€è¦ç­‰å¾…ï¼‰
   214â†’    // ä½¿ç”¨ç®€åŒ–çš„ç”Ÿæ—¥è®¡ç®—ï¼ˆé»˜è®¤ä¸ºä»Šæ—¥ï¼Œåç»­å¯è°ƒæ•´ï¼‰
   215â†’    router.push(`/${skill}/preview?focus=${focusId}`);
   216â†’  };
   217â†’
   218â†’  return (
   219â†’    <div className="max-w-2xl mx-auto">
   220â†’      <h2 className="text-2xl font-medium text-ink mb-6">
   221â†’        ä½ ä»Šå¤©æœ€æƒ³äº†è§£ä»€ä¹ˆï¼Ÿ
   222â†’      </h2>
   223â†’
   224â†’      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
   225â†’        {FOCUS_OPTIONS.map((option) => (
   226â†’          <button
   227â†’            key={option.id}
   228â†’            onClick={() => handleSelect(option.id)}
   229â†’            disabled={loading}
   230â†’            className={`
   231â†’              relative p-6 rounded-2xl border-2 transition-all
   232â†’              ${selected === option.id
   233â†’                ? `border-ink bg-gradient-to-br ${option.color} text-white`
   234â†’                : 'border-vellum-300 hover:border-ink/30 bg-white'
   235â†’              }
   236â†’              ${loading ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}
   237â†’            `}
   238â†’          >
   239â†’            <div className="text-4xl mb-3">{option.icon}</div>
   240â†’            <div className="text-lg font-medium mb-1">{option.label}</div>
   241â†’            <div className={`text-sm ${selected === option.id ? 'text-white/90' : 'text-ink/60'}`}>
   242â†’              {option.description}
   243â†’            </div>
   244â†’
   245â†’            {loading && selected === option.id && (
   246â†’              <div className="absolute inset-0 flex items-center justify-center bg-white/20 rounded-2xl">
   247â†’                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-white" />
   248â†’              </div>
   249â†’            )}
   250â†’          </button>
   251â†’        ))}
   252â†’      </div>
   253â†’
   254â†’      <p className="text-sm text-ink/50 mt-4">
   255â†’        æ— éœ€å¡«å†™ä»»ä½•ä¿¡æ¯ï¼Œç«‹å³æŸ¥çœ‹ä½ çš„å‘½ç›˜
   256â†’      </p>
   257â†’    </div>
   258â†’  );
   259â†’}
   260â†’```
   261â†’
   262â†’### 3.3 å‘½ç›˜é¢„è§ˆé¡µé¢ï¼ˆAha Moment #1ï¼‰
   263â†’
   264â†’**è¿™æ˜¯æœ€é‡è¦çš„é¡µé¢ï¼Œå¿…é¡»åœ¨12ç§’å†…å±•ç¤º**
   265â†’
   266â†’```typescript
   267â†’// apps/web/src/app/(bazi)/preview/page.tsx
   268â†’'use client';
   269â†’
   270â†’import { useEffect, useState } from 'react';
   271â†’import { useSearchParams } from 'next/navigation';
   272â†’import { BaziChart } from '@/components/bazi/BaziChart';
   273â†’import { FortuneCard } from '@/components/fortune/FortuneCard';
   274â†’import { DeepInterviewModal } from '@/components/interview/DeepInterviewModal';
   275â†’
   276â†’export default function BaziPreviewPage() {
   277â†’  const searchParams = useSearchParams();
   278â†’  const focus = searchParams.get('focus') || 'self';
   279â†’
   280â†’  const [loading, setLoading] = useState(true);
   281â†’  const [showInterview, setShowInterview] = useState(false);
   282â†’  const [baziData, setBaziData] = useState(null);
   283â†’
   284â†’  useEffect(() => {
   285â†’    // å¿«é€Ÿè®¡ç®—å…«å­—ï¼ˆä½¿ç”¨é»˜è®¤ç”Ÿæ—¥æˆ–ç®€åŒ–ç®—æ³•ï¼‰
   286â†’    const calculateQuickBazi = async () => {
   287â†’      // æ¨¡æ‹ŸåŠ è½½æ—¶é—´ï¼ˆåˆ¶é€ æœŸå¾…æ„Ÿï¼‰
   288â†’      await new Promise(resolve => setTimeout(resolve, 1500));
   289â†’
   290â†’      // è°ƒç”¨åç«¯å¿«é€Ÿè®¡ç®—API
   291â†’      const response = await fetch('/api/v1/bazi/quick-calculate', {
   292â†’        method: 'POST',
   293â†’        body: JSON.stringify({ focus })
   294â†’      });
   295â†’
   296â†’      const data = await response.json();
   297â†’      setBaziData(data);
   298â†’      setLoading(false);
   299â†’    };
   300â†’
   301â†’    calculateQuickBazi();
   302â†’  }, [focus]);
   303â†’
   304â†’  if (loading) {
   305â†’    return <LoadingScreen />;
   306â†’  }
   307â†’
   308â†’  return (
   309â†’    <div className="min-h-screen bg-gradient-to-b from-amber-50 to-vellum">
   310â†’      {/* Aha Moment #1: å‘½ç›˜å¯è§†åŒ– */}
   311â†’      <section className="container mx-auto px-4 py-8">
   312â†’        <div className="text-center mb-8">
   313â†’          <h1 className="text-3xl font-serif text-ink mb-2">
   314â†’            ä½ çš„å‘½ç›˜
   315â†’          </h1>
   316â†’          <p className="text-lg text-ink/70">
   317â†’            {baziData.dayMasterInsight}
   318â†’          </p>
   319â†’        </div>
   320â†’
   321â†’        {/* ä¸“ä¸šå‘½ç›˜ - è§†è§‰å†²å‡» */}
   322â†’        <div className="max-w-4xl mx-auto mb-8">
   323â†’          <BaziChart
   324â†’            data={baziData.chart}
   325â†’            highlight="dayMaster"
   326â†’            animated={true}
   327â†’          />
   328â†’        </div>
   329â†’
   330â†’        {/* Aha Moment #2: ä»Šæ—¥è¿åŠ¿ - å…è´¹ä»·å€¼ */}
   331â†’        <div className="max-w-2xl mx-auto mb-12">
   332â†’          <FortuneCard
   333â†’            focus={focus}
   334â†’            dailyFortune={baziData.dailyFortune}
   335â†’            lite={true}
   336â†’          />
   337â†’        </div>
   338â†’
   339â†’        {/* è‡ªç„¶å¼•å¯¼ï¼šæƒ³è¦æ›´æ·±åº¦è§£è¯»å—ï¼Ÿ */}
   340â†’        <div className="max-w-2xl mx-auto">
   341â†’          <DeepGuideCard
   342â†’            onContinue={() => setShowInterview(true)}
   343â†’            onSkip={() => {/* è·³è¿‡ï¼Œè®°å½•ä¸ºè½»åº¦ç”¨æˆ· */}}
   344â†’          />
   345â†’        </div>
   346â†’      </section>
   347â†’
   348â†’      {/* æ·±åº¦è®¿è°ˆæ¨¡æ€æ¡† */}
   349â†’      {showInterview && (
   350â†’        <DeepInterviewModal
   351â†’          focus={focus}
   352â†’          onClose={() => setShowInterview(false)}
   353â†’          onComplete={(fullProfile) => {
   354â†’            // è·³è½¬åˆ°å®Œæ•´æŠ¥å‘Šé¡µé¢
   355â†’            router.push(`/${skill}/report?profile=${fullProfile.id}`);
   356â†’          }}
   357â†’        />
   358â†’      )}
   359â†’    </div>
   360â†’  );
   361â†’}
   362â†’
   363â†’// åŠ è½½å±å¹•ï¼ˆåˆ¶é€ æœŸå¾…æ„Ÿï¼‰
   364â†’function LoadingScreen() {
   365â†’  return (
   366â†’    <div className="min-h-screen flex items-center justify-center bg-gradient-to-b from-amber-50 to-vellum">
   367â†’      <div className="text-center">
   368â†’        <div className="relative w-24 h-24 mx-auto mb-6">
   369â†’          {/* VibeGlyph åŠ¨ç”» */}
   370â†’          <div className="absolute inset-0 animate-spin">
   371â†’            <VibeGlyph />
   372â†’          </div>
   373â†’        </div>
   374â†’        <h2 className="text-2xl font-serif text-ink mb-2">
   375â†’          æ­£åœ¨ä¸ºä½ ç»˜åˆ¶å‘½ç›˜...
   376â†’        </h2>
   377â†’        <p className="text-ink/60">
   378â†’          åˆ†æä½ çš„äº”è¡Œèƒ½é‡åˆ†å¸ƒ
   379â†’        </p>
   380â†’      </div>
   381â†’    </div>
   382â†’  );
   383â†’}
   384â†’```
   385â†’
   386â†’### 3.4 æ·±åº¦å¼•å¯¼å¡ç‰‡
   387â†’
   388â†’```typescript
   389â†’// apps/web/src/components/onboarding/DeepGuideCard.tsx
   390â†’'use client';
   391â†’
   392â†’import { useState } from 'react';
   393â†’
   394â†’export function DeepGuideCard({ onContinue, onSkip }) {
   395â†’  const [dismissed, setDismissed] = useState(false);
   396â†’
   397â†’  if (dismissed) return null;
   398â†’
   399â†’  return (
   400â†’    <div className="bg-white rounded-2xl shadow-lg border border-vellum-200 p-8">
   401â†’      <div className="flex items-start gap-6">
   402â†’        {/* AI å¤´åƒ */}
   403â†’        <div className="flex-shrink-0">
   404â†’          <div className="w-16 h-16 rounded-full bg-gradient-to-br from-amber-400 to-orange-500 flex items-center justify-center text-3xl">
   405â†’            ğŸ”®
   406â†’          </div>
   407â†’        </div>
   408â†’
   409â†’        {/* å¼•å¯¼æ–‡æ¡ˆ */}
   410â†’        <div className="flex-1">
   411â†’          <h3 className="text-xl font-serif text-ink mb-2">
   412â†’            æƒ³è¦æ›´æ·±åº¦è§£è¯»å—ï¼Ÿ
   413â†’          </h3>
   414â†’          <p className="text-ink/70 mb-4">
   415â†’            æˆ‘åˆšä¸ºä½ ç”Ÿæˆäº†åŸºç¡€å‘½ç›˜ï¼Œä½†å¦‚æœèƒ½äº†è§£ä½ çš„å‡ºç”Ÿæ—¶é—´ï¼Œ
   416â†’            æˆ‘å¯ä»¥ä¸ºä½ æä¾›æ›´ç²¾å‡†çš„æ€§æ ¼åˆ†æã€äººç”ŸKçº¿å’Œå®Œæ•´çš„è§£è¯»æŠ¥å‘Šã€‚
   417â†’          </p>
   418â†’
   419â†’          {/* ä»·å€¼æ‰¿è¯º */}
   420â†’          <div className="grid grid-cols-3 gap-4 mb-6">
   421â†’            <div className="text-center p-3 bg-vellum-50 rounded-lg">
   422â†’              <div className="text-2xl mb-1">ğŸ“Š</div>
   423â†’              <div className="text-sm text-ink/70">äººç”ŸKçº¿å›¾</div>
   424â†’            </div>
   425â†’            <div className="text-center p-3 bg-vellum-50 rounded-lg">
   426â†’              <div className="text-2xl mb-1">ğŸ”®</div>
   427â†’              <div className="text-sm text-ink/70">ä¸‰å…ƒæ£±é•œ</div>
   428â†’            </div>
   429â†’            <div className="text-center p-3 bg-vellum-50 rounded-lg">
   430â†’              <div className="text-2xl mb-1">ğŸ“</div>
   431â†’              <div className="text-sm text-ink/70">å®Œæ•´æŠ¥å‘Š</div>
   432â†’            </div>
   433â†’          </div>
   434â†’
   435â†’          {/* è¡ŒåŠ¨æŒ‰é’® */}
   436â†’          <div className="flex gap-3">
   437â†’            <button
   438â†’              onClick={onContinue}
   439â†’              className="flex-1 bg-gradient-to-r from-amber-500 to-orange-500 text-white px-6 py-3 rounded-xl font-medium hover:shadow-lg transition-all"
   440â†’            >
   441â†’              åªéœ€3ä¸ªé—®é¢˜ï¼Œç»§ç»­æ·±åº¦è§£è¯» â†’
   442â†’            </button>
   443â†’            <button
   444â†’              onClick={() => {
   445â†’                onSkip();
   446â†’                setDismissed(true);
   447â†’              }}
   448â†’              className="px-6 py-3 text-ink/60 hover:text-ink transition-colors"
   449â†’            >
   450â†’              æš‚æ—¶å…ˆçœ‹çœ‹
   451â†’            </button>
   452â†’          </div>
   453â†’        </div>
   454â†’      </div>
   455â†’    </div>
   456â†’  );
   457â†’}
   458â†’```
   459â†’
   460â†’### 3.5 æ·±åº¦è®¿è°ˆæµç¨‹ï¼ˆç®€åŒ–ç‰ˆï¼‰
   461â†’
   462â†’```typescript
   463â†’// apps/web/src/components/interview/DeepInterviewModal.tsx
   464â†’'use client';
   465â†’
   466â†’import { useState } from 'react';
   467â†’import { useRouter } from 'next/navigation';
   468â†’
   469â†’const QUESTIONS = [
   470â†’  {
   471â†’    id: 'birth_datetime',
   472â†’    question: 'ä½ çš„å‡ºç”Ÿæ—¶é—´ï¼Ÿ',
   473â†’    type: 'datetime',
   474â†’    required: true,
   475â†’    placeholder: 'é€‰æ‹©æˆ–è¾“å…¥ä½ çš„å‡ºç”Ÿæ—¶é—´',
   476â†’    explanation: 'å‡†ç¡®çš„å‡ºç”Ÿæ—¶é—´èƒ½è®©å‘½ç›˜æ›´ç²¾ç¡®'
   477â†’  },
   478â†’  {
   479â†’    id: 'birth_location',
   480â†’    question: 'ä½ çš„å‡ºç”Ÿåœ°ç‚¹ï¼Ÿ',
   481â†’    type: 'location',
   482â†’    required: true,
   483â†’    placeholder: 'è¾“å…¥åŸå¸‚æˆ–é€‰æ‹©åœ°ç‚¹',
   484â†’    explanation: 'å‡ºç”Ÿåœ°ç‚¹å½±å“æ—¶åŒºè®¡ç®—'
   485â†’  },
   486â†’  {
   487â†’    id: 'current_focus',
   488â†’    question: 'ä½ ç°åœ¨æœ€å…³å¿ƒçš„æ˜¯ä»€ä¹ˆï¼Ÿ',
   489â†’    type: 'choice',
   490â†’    required: true,
   491â†’    options: [
   492â†’      { value: 'relationship', label: 'æ„Ÿæƒ…é—®é¢˜' },
   493â†’      { value: 'career', label: 'äº‹ä¸šå‘å±•' },
   494â†’      { value: 'fortune', label: 'è´¢è¿è¿åŠ¿' },
   495â†’      { value: 'health', label: 'å¥åº·å…»ç”Ÿ' },
   496â†’      { value: 'growth', label: 'ä¸ªäººæˆé•¿' }
   497â†’    ]
   498â†’  }
   499â†’];
   500â†’
   501â†’export function DeepInterviewModal({ focus, onClose, onComplete }) {
   502â†’  const [currentStep, setCurrentStep] = useState(0);
   503â†’  const [answers, setAnswers] = useState({});
   504â†’  const [loading, setLoading] = useState(false);
   505â†’  const router = useRouter();
   506â†’
   507â†’  const currentQuestion = QUESTIONS[currentStep];
   508â†’  const progress = ((currentStep + 1) / QUESTIONS.length) * 100;
   509â†’
   510â†’  const handleNext = async (answer) => {
   511â†’    const newAnswers = { ...answers, [currentQuestion.id]: answer };
   512â†’    setAnswers(newAnswers);
   513â†’
   514â†’    if (currentStep < QUESTIONS.length - 1) {
   515â†’      setCurrentStep(currentStep + 1);
   516â†’    } else {
   517â†’      // å®Œæˆè®¿è°ˆï¼Œæäº¤åˆ°åç«¯
   518â†’      setLoading(true);
   519â†’      try {
   520â†’        const response = await fetch('/api/v1/interview/complete', {
   521â†’          method: 'POST',
   522â†’          body: JSON.stringify({
   523â†’            skill: 'bazi',
   524â†’            answers: newAnswers,
   525â†’            focus
   526â†’          })
   527â†’        });
   528â†’
   529â†’        const { profile_id, report_id } = await response.json();
   530â†’        onComplete({ id: profile_id, report_id });
   531â†’      } catch (error) {
   532â†’        console.error('Interview submission failed:', error);
   533â†’      } finally {
   534â†’        setLoading(false);
   535â†’      }
   536â†’    }
   537â†’  };
   538â†’
   539â†’  return (
   540â†’    <div className="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
   541â†’      <div className="bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden">
   542â†’        {/* å¤´éƒ¨ï¼šè¿›åº¦æ¡ */}
   543â†’        <div className="px-6 py-4 border-b border-vellum-200">
   544â†’          <div className="flex items-center justify-between mb-2">
   545â†’            <span className="text-sm text-ink/60">
   546â†’              æ·±åº¦è§£è¯» {currentStep + 1}/{QUESTIONS.length}
   547â†’            </span>
   548â†’            <button onClick={onClose} className="text-ink/60 hover:text-ink">
   549â†’              âœ•
   550â†’            </button>
   551â†’          </div>
   552â†’          <div className="w-full bg-vellum-200 rounded-full h-2">
   553â†’            <div
   554â†’              className="bg-gradient-to-r from-amber-500 to-orange-500 h-2 rounded-full transition-all duration-500"
   555â†’              style={{ width: `${progress}%` }}
   556â†’            />
   557â†’          </div>
   558â†’        </div>
   559â†’
   560â†’        {/* é—®é¢˜å†…å®¹ */}
   561â†’        <div className="p-6">
   562â†’          <h2 className="text-2xl font-serif text-ink mb-2">
   563â†’            {currentQuestion.question}
   564â†’          </h2>
   565â†’          {currentQuestion.explanation && (
   566â†’            <p className="text-ink/60 mb-6">
   567â†’              {currentQuestion.explanation}
   568â†’            </p>
   569â†’          )}
   570â†’
   571â†’          {/* æ ¹æ®é—®é¢˜ç±»å‹æ¸²æŸ“ä¸åŒçš„è¾“å…¥ç»„ä»¶ */}
   572â†’          <QuestionInput
   573â†’            question={currentQuestion}
   574â†’            value={answers[currentQuestion.id]}
   575â†’            onChange={(value) => handleNext(value)}
   576â†’          />
   577â†’        </div>
   578â†’
   579â†’        {/* åº•éƒ¨ï¼šå¯¼èˆª */}
   580â†’        <div className="px-6 py-4 bg-vellum-50 border-t border-vellum-200">
   581â†’          <div className="flex justify-between">
   582â†’            <button
   583â†’              onClick={() => setCurrentStep(Math.max(0, currentStep - 1))}
   584â†’              disabled={currentStep === 0}
   585â†’              className="px-4 py-2 text-ink/60 hover:text-ink disabled:opacity-50"
   586â†’            >
   587â†’              â† ä¸Šä¸€æ­¥
   588â†’            </button>
   589â†’            <div className="flex gap-2">
   590â†’              {QUESTIONS.map((_, idx) => (
   591â†’                <div
   592â†’                  key={idx}
   593â†’                  className={`w-2 h-2 rounded-full ${
   594â†’                    idx === currentStep
   595â†’                      ? 'bg-amber-500'
   596â†’                      : idx < currentStep
   597â†’                      ? 'bg-amber-200'
   598â†’                      : 'bg-vellum-300'
   599â†’                  }`}
   600â†’                />
   601â†’              ))}
   602â†’            </div>
   603â†’          </div>
   604â†’        </div>
   605â†’      </div>
   606â†’    </div>
   607â†’  );
   608â†’}
   609â†’```
   610â†’
   611â†’---
   612â†’
   613â†’## 4. åç«¯ API è®¾è®¡
   614â†’
   615â†’### 4.1 å¿«é€Ÿè®¡ç®— APIï¼ˆæ— è®¿è°ˆï¼‰
   616â†’
   617â†’```python
   618â†’# apps/api/routes/bazi.py
   619â†’from fastapi import APIRouter, HTTPException
   620â†’from services.bazi import BaziCalculator
   621â†’from services.fortune import FortuneGenerator
   622â†’from pydantic import BaseModel
   623â†’
   624â†’router = APIRouter()
   625â†’
   626â†’class QuickCalculateRequest(BaseModel):
   627â†’    focus: str  # 'relationship', 'career', 'self'
   628â†’
   629â†’@router.post("/quick-calculate")
   630â†’async def quick_calculate(request: QuickCalculateRequest):
   631â†’    """
   632â†’    å¿«é€Ÿå…«å­—è®¡ç®—ï¼ˆæ— éœ€å®Œæ•´å‡ºç”Ÿä¿¡æ¯ï¼‰
   633â†’    ä½¿ç”¨ç®€åŒ–ç®—æ³•æˆ–é»˜è®¤å€¼ï¼Œç¡®ä¿12ç§’å†…è¿”å›
   634â†’    """
   635â†’
   636â†’    try:
   637â†’        # 1. ä½¿ç”¨ä»Šæ—¥æ—¥æœŸæˆ–ç®€åŒ–å…«å­—è®¡ç®—
   638â†’        calculator = BaziCalculator()
   639â†’        quick_chart = calculator.calculate_quick(
   640â†’            use_today=True,  # ä½¿ç”¨ä»Šæ—¥ä½œä¸ºç¤ºä¾‹
   641â†’            focus=request.focus
   642â†’        )
   643â†’
   644â†’        # 2. ç”Ÿæˆæ—¥ä¸»æ´å¯Ÿ
   645â†’        day_master_insight = calculator.get_day_master_insight(
   646â†’            quick_chart['day_master']
   647â†’        )
   648â†’
   649â†’        # 3. ç”Ÿæˆä»Šæ—¥è¿åŠ¿ï¼ˆå…è´¹ä»·å€¼ï¼‰
   650â†’        fortune_gen = FortuneGenerator()
   651â†’        daily_fortune = fortune_gen.generate_daily_fortune(
   652â†’            quick_chart,
   653â†’            focus=request.focus,
   654â†’            lite=True  # Liteç‰ˆæœ¬
   655â†’        )
   656â†’
   657â†’        return {
   658â†’            "chart": quick_chart,
   659â†’            "dayMasterInsight": day_master_insight,
   660â†’            "dailyFortune": daily_fortune,
   661â†’            "is_lite": True,  # æ ‡è®°ä¸ºç®€åŒ–ç‰ˆ
   662â†’            "upgrade_prompt": "æä¾›å‡ºç”Ÿæ—¶é—´å¯è·å¾—æ›´ç²¾å‡†åˆ†æ"
   663â†’        }
   664â†’
   665â†’    except Exception as e:
   666â†’        raise HTTPException(status_code=500, detail=str(e))
   667â†’```
   668â†’
   669â†’### 4.2 æ·±åº¦è®¿è°ˆæäº¤ API
   670â†’
   671â†’```python
   672â†’# apps/api/routes/interview.py
   673â†’from fastapi import APIRouter, HTTPException, Request
   674â†’from services.interview import InterviewService
   675â†’from services.portrait import PortraitService
   676â†’from pydantic import BaseModel
   677â†’
   678â†’router = APIRouter()
   679â†’
   680â†’class InterviewCompleteRequest(BaseModel):
   681â†’    skill: str
   682â†’    answers: dict
   683â†’    focus: str
   684â†’
   685â†’@router.post("/complete")
   686â†’async def complete_interview(
   687â†’    request: Request,
   688â†’    interview_data: InterviewCompleteRequest
   689â†’):
   690â†’    """
   691â†’    å®Œæˆæ·±åº¦è®¿è°ˆï¼Œåˆ›å»ºå®Œæ•´ç”¨æˆ·ç”»åƒ
   692â†’    """
   693â†’    user_id = request.state.user_id
   694â†’
   695â†’    try:
   696â†’        # 1. ä¿å­˜è®¿è°ˆæ•°æ®
   697â†’        interview_service = InterviewService()
   698â†’        interview = await interview_service.save_interview(
   699â†’            user_id=user_id,
   700â†’            skill=interview_data.skill,
   701â†’            answers=interview_data.answers
   702â†’        )
   703â†’
   704â†’        # 2. æ„å»ºå®Œæ•´ç”¨æˆ·ç”»åƒ
   705â†’        portrait_service = PortraitService()
   706â†’        profile = await portrait_service.create_profile(
   707â†’            user_id=user_id,
   708â†’            skill=interview_data.skill,
   709â†’            interview_id=interview.id,
   710â†’            focus=interview_data.focus
   711â†’        )
   712â†’
   713â†’        # 3. ç”Ÿæˆå®Œæ•´æŠ¥å‘Šï¼ˆåå°ä»»åŠ¡ï¼‰
   714â†’        report_id = await generate_full_report(
   715â†’            user_id=user_id,
   716â†’            profile_id=profile.id,
   717â†’            skill=interview_data.skill
   718â†’        )
   719â†’
   720â†’        return {
   721â†’            "profile_id": profile.id,
   722â†’            "report_id": report_id,
   723â†’            "redirect_to": f"/{interview_data.skill}/report?id={report_id}"
   724â†’        }
   725â†’
   726â†’    except Exception as e:
   727â†’        raise HTTPException(status_code=500, detail=str(e))
   728â†’```
   729â†’
   730â†’---
   731â†’
   732â†’## 5. A/B æµ‹è¯•æ¡†æ¶
   733â†’
   734â†’### 5.1 å…³é”®æµ‹è¯•å˜é‡
   735â†’
   736â†’```python
   737â†’# apps/api/services/experiment.py
   738â†’from enum import Enum
   739â†’
   740â†’class OnboardingVariant(Enum):
   741â†’    CONTROL = "control"  # åŸç‰ˆï¼šå¼ºåˆ¶è®¿è°ˆ
   742â†’    VARIANT_A = "quick_first"  # å¿«é€Ÿé€‰æ‹©ä¼˜å…ˆ
   743â†’    VARIANT_B = "visual_first"  # å¯è§†åŒ–ä¼˜å…ˆ
   744â†’    VARIANT_C = "fortune_first"  # è¿åŠ¿ä¼˜å…ˆ
   745â†’
   746â†’class ExperimentConfig:
   747â†’    ONBOARDING_EXPERIMENT = {
   748â†’        "name": "onboarding_flow_optimization",
   749â†’        "variants": [
   750â†’            {
   751â†’                "id": OnboardingVariant.CONTROL,
   752â†’                "weight": 0.2,  # 20% ç”¨æˆ·
   753â†’                "flow": "interview_first"
   754â†’            },
   755â†’            {
   756â†’                "id": OnboardingVariant.VARIANT_A,
   757â†’                "weight": 0.4,  # 40% ç”¨æˆ·
   758â†’                "flow": "quick_selection_first"
   759â†’            },
   760â†’            {
   761â†’                "id": OnboardingVariant.VARIANT_B,
   762â†’                "weight": 0.2,  # 20% ç”¨æˆ·
   763â†’                "flow": "visual_preview_first"
   764â†’            },
   765â†’            {
   766â†’                "id": OnboardingVariant.VARIANT_C,
   767â†’                "weight": 0.2,  # 20% ç”¨æˆ·
   768â†’                "flow": "daily_fortune_first"
   769â†’            }
   770â†’        ],
   771â†’        "metrics": [
   772â†’            "time_to_aha",
   773â†’            "aha_completion_rate",
   774â†’            "interview_start_rate",
   775â†’            "interview_completion_rate",
   776â†’            "free_to_paid_conversion"
   777â†’        ]
   778â†’    }
   779â†’```
   780â†’
   781â†’### 5.2 å‰ç«¯å˜ä½“å®ç°
   782â†’
   783â†’```typescript
   784â†’// apps/web/src/components/onboarding/OnboardingFlow.tsx
   785â†’'use client';
   786â†’
   787â†’import { useExperiment } from '@/hooks/useExperiment';
   788â†’import { QuickSelectionFlow } from './QuickSelectionFlow';
   789â†’import { VisualFirstFlow } from './VisualFirstFlow';
   790â†’import { InterviewFirstFlow } from './InterviewFirstFlow';
   791â†’
   792â†’export function OnboardingFlow() {
   793â†’  const { variant } = useExperiment('onboarding_flow_optimization');
   794â†’
   795â†’  switch (variant) {
   796â†’    case 'quick_first':
   797â†’      return <QuickSelectionFlow />;
   798â†’    case 'visual_first':
   799â†’      return <VisualFirstFlow />;
   800â†’    case 'fortune_first':
   801â†’      return <FortuneFirstFlow />;
   802â†’    case 'control':
   803â†’    default:
   804â†’      return <InterviewFirstFlow />;
   805â†’  }
   806â†’}
   807â†’```
   808â†’
   809â†’---
   810â†’
   811â†’## 6. æ•°æ®è¿½è¸ªåŸ‹ç‚¹
   812â†’
   813â†’### 6.1 å…³é”®äº‹ä»¶å®šä¹‰
   814â†’
   815â†’```typescript
   816â†’// apps/web/src/lib/analytics.ts
   817â†’export interface OnboardingEvent {
   818â†’  event_name: string;
   819â†’  timestamp: number;
   820â†’  user_id?: string;
   821â†’  session_id: string;
   822â†’  properties: Record<string, any>;
   823â†’}
   824â†’
   825â†’export const ONBOARDING_EVENTS = {
   826â†’  // æ¼æ–—é¡¶éƒ¨
   827â†’  ONBOARDING_START: 'onboarding_start',
   828â†’
   829â†’  // å¿«é€Ÿé€‰æ‹©é˜¶æ®µ
   830â†’  QUICK_SELECTION_SHOW: 'quick_selection_show',
   831â†’  QUICK_SELECTION_CLICK: 'quick_selection_click',
   832â†’
   833â†’  // å‘½ç›˜é¢„è§ˆé˜¶æ®µ
   834â†’  CHART_PREVIEW_START_LOAD: 'chart_preview_start_load',
   835â†’  CHART_PREVIEW_SHOWN: 'chart_preview_shown',
   836â†’  CHART_PREVIEW_INTERACTION: 'chart_preview_interaction',
   837â†’
   838â†’  // ä»Šæ—¥è¿åŠ¿é˜¶æ®µ
   839â†’  DAILY_FORTUNE_SHOWN: 'daily_fortune_shown',
   840â†’  DAILY_FORTUNE_SHARE: 'daily_fortune_share',
   841â†’
   842â†’  // æ·±åº¦è®¿è°ˆé˜¶æ®µ
   843â†’  DEEP_GUIDE_SHOW: 'deep_guide_show',
   844â†’  DEEP_GUIDE_CONTINUE: 'deep_guide_continue',
   845â†’  DEEP_GUIDE_SKIP: 'deep_guide_skip',
   846â†’
   847â†’  // è®¿è°ˆæµç¨‹
   848â†’  INTERVIEW_START: 'interview_start',
   849â†’  INTERVIEW_STEP_COMPLETE: 'interview_step_complete',
   850â†’  INTERVIEW_COMPLETE: 'interview_complete',
   851â†’
   852â†’  // Aha Moment
   853â†’  AHA_MOMENT_VISUAL: 'aha_moment_visual',
   854â†’  AHA_MOMENT_VALUE: 'aha_moment_value',
   855â†’
   856â†’  // è½¬åŒ–
   857â†’  PAYWALL_SHOW: 'paywall_show',
   858â†’  PAYWALL_CLICK_UPGRADE: 'paywall_click_upgrade',
   859â†’  PAYWALL_COMPLETE: 'paywall_complete'
   860â†’};
   861â†’
   862â†’// ä½¿ç”¨ç¤ºä¾‹
   863â†’export function trackOnboardingEvent(
   864â†’  eventName: string,
   865â†’  properties: Record<string, any> = {}
   866â†’) {
   867â†’  const event: OnboardingEvent = {
   868â†’    event_name: eventName,
   869â†’    timestamp: Date.now(),
   870â†’    session_id: getSessionId(),
   871â†’    properties: {
   872â†’      ...properties,
   873â†’      variant: getCurrentVariant(),
   874â†’      referrer: document.referrer,
   875â†’      utm_source: getUTMParameter('utm_source'),
   876â†’      utm_medium: getUTMParameter('utm_medium'),
   877â†’      utm_campaign: getUTMParameter('utm_campaign')
   878â†’    }
   879â†’  };
   880â†’
   881â†’  // å‘é€åˆ°åˆ†æå¹³å°
   882â†’  analytics.track(eventName, event);
   883â†’}
   884â†’```
   885â†’
   886â†’### 6.2 å…³é”®æŒ‡æ ‡è®¡ç®—
   887â†’
   888â†’```python
   889â†’# apps/api/services/analytics/metrics.py
   890â†’from datetime import datetime, timedelta
   891â†’
   892â†’class OnboardingMetrics:
   893â†’    """Onboarding å…³é”®æŒ‡æ ‡è®¡ç®—"""
   894â†’
   895â†’    def calculate_time_to_aha(self, user_id: str) -> float:
   896â†’        """
   897â†’        è®¡ç®—ä»æ³¨å†Œåˆ° Aha Moment çš„æ—¶é—´
   898â†’        ç›®æ ‡ï¼š< 30ç§’
   899â†’        """
   900â†’        start_time = self.get_event_time(user_id, 'onboarding_start')
   901â†’        aha_time = self.get_event_time(
   902â†’            user_id,
   903â†’            'aha_moment_value'  # ä»¥çœ‹åˆ°ä»Šæ—¥è¿åŠ¿ä¸ºå‡†
   904â†’        )
   905â†’
   906â†’        if start_time and aha_time:
   907â†’            return (aha_time - start_time).total_seconds()
   908â†’        return None
   909â†’
   910â†’    def calculate_aha_completion_rate(
   911â†’        self,
   912â†’        start_date: datetime,
   913â†’        end_date: datetime
   914â†’    ) -> float:
   915â†’        """
   916â†’        Aha Moment å®Œæˆç‡
   917â†’        ç›®æ ‡ï¼š> 70%
   918â†’        """
   919â†’        started = self.count_users_with_event(
   920â†’            'onboarding_start',
   921â†’            start_date,
   922â†’            end_date
   923â†’        )
   924â†’        aha_moment = self.count_users_with_event(
   925â†’            'aha_moment_value',
   926â†’            start_date,
   927â†’            end_date
   928â†’        )
   929â†’
   930â†’        return (aha_moment / started * 100) if started > 0 else 0
   931â†’
   932â†’    def calculate_interview_start_rate(self) -> float:
   933â†’        """
   934â†’        æ·±åº¦è®¿è°ˆå¯åŠ¨ç‡
   935â†’        ç›®æ ‡ï¼š> 40%ï¼ˆä» Aha Momentï¼‰
   936â†’        """
   937â†’        aha_users = self.get_users_with_event('aha_moment_value')
   938â†’        interview_users = self.get_users_with_event('interview_start')
   939â†’
   940â†’        return (len(interview_users) / len(aha_users) * 100) if aha_users else 0
   941â†’
   942â†’    def calculate_drop_off_points(self) -> dict:
   943â†’        """
   944â†’        æµå¤±ç‚¹åˆ†æ
   945â†’        """
   946â†’        funnel = {
   947â†’            'start': self.count_users_with_event('onboarding_start'),
   948â†’            'quick_select': self.count_users_with_event('quick_selection_click'),
   949â†’            'chart_preview': self.count_users_with_event('chart_preview_shown'),
   950â†’            'aha_value': self.count_users_with_event('aha_moment_value'),
   951â†’            'deep_guide': self.count_users_with_event('deep_guide_show'),
   952â†’            'interview_start': self.count_users_with_event('interview_start'),
   953â†’            'interview_complete': self.count_users_with_event('interview_complete')
   954â†’        }
   955â†’
   956â†’        drop_off = {}
   957â†’        prev_count = None
   958â†’
   959â†’        for step, count in funnel.items():
   960â†’            if prev_count:
   961â†’                drop_off[step] = {
   962â†’                    'count': count,
   963â†’                    'drop_off_count': prev_count - count,
   964â†’                    'drop_off_rate': ((prev_count - count) / prev_count * 100)
   965â†’                }
   966â†’            prev_count = count
   967â†’
   968â†’        return drop_off
   969â†’```
   970â†’
   971â†’---
   972â†’
   973â†’## 7. ç§»åŠ¨ç«¯ä¼˜åŒ–
   974â†’
   975â†’### 7.1 ç§»åŠ¨ç«¯å…³é”®å·®å¼‚
   976â†’
   977â†’```css
   978â†’/* apps/web/src/styles/mobile-onboarding.css */
   979â†’/* åŸºäº70%æµé‡æ¥è‡ªç§»åŠ¨ç«¯çš„ä¼˜åŒ– */
   980â†’
   981â†’@media (max-width: 768px) {
   982â†’  /* å¿«é€Ÿé€‰æ‹©å¡ç‰‡ï¼šå‚ç›´å †å  */
   983â†’  .quick-selection-grid {
   984â†’    grid-template-columns: 1fr;
   985â†’    gap: 12px;
   986â†’  }
   987â†’
   988â†’  /* å‘½ç›˜å¯è§†åŒ–ï¼šå…¨å±å±•ç¤º */
   989â†’  .chart-preview {
   990â†’    position: fixed;
   991â†’    inset: 0;
   992â†’    z-index: 50;
   993â†’  }
   994â†’
   995â†’  /* æ·±åº¦å¼•å¯¼ï¼šåº•éƒ¨å¡ç‰‡ */
   996â†’  .deep-guide-card {
   997â†’    position: fixed;
   998â†’    bottom: 0;
   999â†’    left: 0;
  1000â†’    right: 0;
  1001â†’    border-radius: 20px 20px 0 0;
  1002â†’    box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
  1003â†’  }
  1004â†’
  1005â†’  /* æŒ‰é’®ï¼šæ‹‡æŒ‡å‹å¥½ */
  1006â†’  .action-button {
  1007â†’    min-height: 48px;
  1008â†’    font-size: 16px;
  1009â†’  }
  1010â†’
  1011â†’  /* è¿åŠ¿å¡ç‰‡ï¼šå¯æ»‘åŠ¨ */
  1012â†’  .fortune-card {
  1013â†’    scroll-snap-type: x mandatory;
  1014â†’    overflow-x: scroll;
  1015â†’  }
  1016â†’}
  1017â†’```
  1018â†’
  1019â†’### 7.2 PWA æ”¯æŒ
  1020â†’
  1021â†’```typescript
  1022â†’// apps/web/public/manifest.json
  1023â†’{
  1024â†’  "name": "VibeLife - AI å…«å­—å‘½ç†",
  1025â†’  "short_name": "VibeLife",
  1026â†’  "description": "åƒå¤§å¸ˆä¸€æ ·ä¸“ä¸šï¼Œåƒé—ºèœœä¸€æ ·æ‡‚ä½ ",
  1027â†’  "start_url": "/?source=pwa",
  1028â†’  "display": "standalone",
  1029â†’  "background_color": "#FAF9F7",
  1030â†’  "theme_color": "#D97706",
  1031â†’  "orientation": "portrait",
  1032â†’  "icons": [
  1033â†’    {
  1034â†’      "src": "/icons/icon-192x192.png",
  1035â†’      "sizes": "192x192",
  1036â†’      "type": "image/png",
  1037â†’      "purpose": "any maskable"
  1038â†’    },
  1039â†’    {
  1040â†’      "src": "/icons/icon-512x512.png",
  1041â†’      "sizes": "512x512",
  1042â†’      "type": "image/png",
  1043â†’      "purpose": "any maskable"
  1044â†’    }
  1045â†’  ],
  1046â†’  "categories": ["lifestyle", "entertainment"],
  1047â†’  "shortcuts": [
  1048â†’    {
  1049â†’      "name": "ä»Šæ—¥è¿åŠ¿",
  1050â†’      "short_name": "è¿åŠ¿",
  1051â†’      "description": "æŸ¥çœ‹ä»Šæ—¥è¿åŠ¿",
  1052â†’      "url": "/bazi/fortune?source=pwa",
  1053â†’      "icons": [{ "src": "/icons/fortune.png", "sizes": "96x96" }]
  1054â†’    },
  1055â†’    {
  1056â†’      "name": "å¼€å§‹å¯¹è¯",
  1057â†’      "short_name": "å¯¹è¯",
  1058â†’      "description": "ä¸AIå‘½ç†å¸ˆå¯¹è¯",
  1059â†’      "url": "/bazi/chat?source=pwa",
  1060â†’      "icons": [{ "src": "/icons/chat.png", "sizes": "96x96" }]
  1061â†’    }
  1062â†’  ]
  1063â†’}
  1064â†’```
  1065â†’
  1066â†’---
  1067â†’
  1068â†’## 8. å®æ–½æ£€æŸ¥æ¸…å•
  1069â†’
  1070â†’### Week 1: æ ¸å¿ƒæµç¨‹
  1071â†’
  1072â†’```
  1073â†’å‰ç«¯å¼€å‘
  1074â†’â”œâ”€â”€ [ ] QuickSelectionCard ç»„ä»¶
  1075â†’â”œâ”€â”€ [ ] å‘½ç›˜é¢„è§ˆé¡µé¢ï¼ˆBaziPreviewPageï¼‰
  1076â†’â”œâ”€â”€ [ ] FortuneCard ç»„ä»¶ï¼ˆLiteç‰ˆæœ¬ï¼‰
  1077â†’â”œâ”€â”€ [ ] DeepGuideCard ç»„ä»¶
  1078â†’â”œâ”€â”€ [ ] DeepInterviewModal ç»„ä»¶
  1079â†’â””â”€â”€ [ ] ç§»åŠ¨ç«¯é€‚é…
  1080â†’
  1081â†’åç«¯å¼€å‘
  1082â†’â”œâ”€â”€ [ ] POST /api/v1/bazi/quick-calculate
  1083â†’â”œâ”€â”€ [ ] POST /api/v1/interview/complete
  1084â†’â”œâ”€â”€ [ ] ç®€åŒ–å…«å­—è®¡ç®—é€»è¾‘
  1085â†’â””â”€â”€ [ ] Liteç‰ˆè¿åŠ¿ç”Ÿæˆé€»è¾‘
  1086â†’
  1087â†’æ•°æ®è¿½è¸ª
  1088â†’â”œâ”€â”€ [ ] åŸ‹ç‚¹äº‹ä»¶å®šä¹‰
  1089â†’â”œâ”€â”€ [ ] Analytics é›†æˆ
  1090â†’â””â”€â”€ [ ] Dashboard æ­å»º
  1091â†’```
  1092â†’
  1093â†’### Week 2: A/B æµ‹è¯•
  1094â†’
  1095â†’```
  1096â†’å®éªŒé…ç½®
  1097â†’â”œâ”€â”€ [ ] A/Bæµ‹è¯•æ¡†æ¶æ­å»º
  1098â†’â”œâ”€â”€ [ ] å˜ä½“æµé‡åˆ†é…
  1099â†’â”œâ”€â”€ [ ] æ§åˆ¶ç»„å®ç°
  1100â†’â””â”€â”€ [ ] å®éªŒæŒ‡æ ‡å®šä¹‰
  1101â†’
  1102â†’æ•°æ®éªŒè¯
  1103â†’â”œâ”€â”€ [ ] æ—¶é—´è¿½è¸ªå‡†ç¡®æ€§
  1104â†’â”œâ”€â”€ [ ] äº‹ä»¶è§¦å‘éªŒè¯
  1105â†’â””â”€â”€ [ ] æ¼æ–—æ•°æ®å¯è§†åŒ–
  1106â†’```
  1107â†’
  1108â†’### Week 3: ä¼˜åŒ–è¿­ä»£
  1109â†’
  1110â†’```
  1111â†’æ•°æ®åˆ†æ
  1112â†’â”œâ”€â”€ [ ] Week 1 æ•°æ®å›é¡¾
  1113â†’â”œâ”€â”€ [ ] æµå¤±ç‚¹è¯†åˆ«
  1114â†’â”œâ”€â”€ [ ] ç”¨æˆ·åé¦ˆæ”¶é›†
  1115â†’â””â”€â”€ [ ] ä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡
  1116â†’
  1117â†’å¿«é€Ÿè¿­ä»£
  1118â†’â”œâ”€â”€ [ ] æ–‡æ¡ˆä¼˜åŒ–
  1119â†’â”œâ”€â”€ [ ] åŠ è½½é€Ÿåº¦ä¼˜åŒ–
  1120â†’â”œâ”€â”€ [ ] UIå¾®è°ƒ
  1121â†’â””â”€â”€ [ ] ç§»åŠ¨ç«¯ä½“éªŒæå‡
  1122â†’```
  1123â†’
  1124â†’---
  1125â†’
  1126â†’## 9. æˆåŠŸæ ‡å‡†
  1127â†’
  1128â†’### 9.1 åŒ—ææ˜ŸæŒ‡æ ‡
  1129â†’
  1130â†’```python
  1131â†’SUCCESS_METRICS = {
  1132â†’    "time_to_aha": {
  1133â†’        "target": "< 30ç§’",
  1134â†’        "current": "å¾…æµ‹é‡",
  1135â†’        "status": "å…³é”®æŒ‡æ ‡"
  1136â†’    },
  1137â†’    "aha_completion_rate": {
  1138â†’        "target": "> 70%",
  1139â†’        "current": "å¾…æµ‹é‡",
  1140â†’        "status": "å…³é”®æŒ‡æ ‡"
  1141â†’    },
  1142â†’    "interview_start_rate": {
  1143â†’        "target": "> 40%",
  1144â†’        "current": "å¾…æµ‹é‡",
  1145â†’        "status": "é‡è¦æŒ‡æ ‡"
  1146â†’    },
  1147â†’    "free_user_satisfaction": {
  1148â†’        "target": "> 60%",
  1149â†’        "current": "å¾…æµ‹é‡",
  1150â†’        "status": "é‡è¦æŒ‡æ ‡"
  1151â†’    }
  1152â†’}
  1153â†’```
  1154â†’
  1155â†’### 9.2 é˜¶æ®µæ€§ç›®æ ‡
  1156â†’
  1157â†’| é˜¶æ®µ | æ—¶é—´ | ç›®æ ‡ | éªŒè¯æ–¹å¼ |
  1158â†’|------|------|------|----------|
  1159â†’| **MVPä¸Šçº¿** | Week 1 | 30ç§’Aha Momentè¾¾æˆç‡ >50% | æ•°æ®è¿½è¸ª |
  1160â†’| **ä¼˜åŒ–è¿­ä»£** | Week 2 | 30ç§’Aha Momentè¾¾æˆç‡ >70% | A/Bæµ‹è¯• |
  1161â†’| **PMFéªŒè¯** | Week 4 | æ¬¡æ—¥ç•™å­˜ >40% | ç•™å­˜åˆ†æ |
  1162â†’
  1163â†’---
  1164â†’
  1165â†’## 10. é£é™©ä¸ç¼“è§£
  1166â†’
  1167â†’| é£é™© | å½±å“ | ç¼“è§£ç­–ç•¥ |
  1168â†’|------|------|----------|
  1169â†’| ç®€åŒ–ç®—æ³•å‡†ç¡®åº¦ä½ | ç”¨æˆ·è´¨ç–‘ä¸“ä¸šæ€§ | æ˜ç¡®æ ‡æ³¨"é¢„è§ˆç‰ˆ"ï¼Œå¼•å¯¼å®Œæ•´è®¿è°ˆ |
  1170â†’| ç§»åŠ¨ç«¯åŠ è½½æ…¢ | æµå¤±ç‡ä¸Šå‡ | å›¾è¡¨æ‡’åŠ è½½ã€éª¨æ¶å±ã€CDNåŠ é€Ÿ |
  1171â†’| ç”¨æˆ·ä¸æ„¿æ„ç»™ä¿¡æ¯ | è½¬åŒ–ç‡ä½ | åˆ†æ­¥ç´¢å–ï¼Œå…ˆç»™ä»·å€¼å†è¦ä¿¡æ¯ |
  1172â†’| A/Bæµ‹è¯•æµé‡ä¸è¶³ | ç»“æœä¸æ˜¾è‘— | é›†ä¸­æµé‡ï¼Œå¿«é€Ÿå†³ç­– |
  1173â†’
  1174â†’---
  1175â†’
  1176â†’## é™„å½•ï¼šæŠ€æœ¯æ ˆå‚è€ƒ
  1177â†’
  1178â†’```
  1179â†’Frontend
  1180â†’â”€â”€â”€â”€â”€â”€â”€â”€
  1181â†’â€¢ Next.js 14 (App Router)
  1182â†’â€¢ Framer Motion (åŠ¨ç”»)
  1183â†’â€¢ React Hook Form (è¡¨å•)
  1184â†’â€¢ Zustand (çŠ¶æ€ç®¡ç†)
  1185â†’
  1186â†’Backend
  1187â†’â”€â”€â”€â”€â”€â”€â”€
  1188â†’â€¢ FastAPI (Python)
  1189â†’â€¢ Redis (ç¼“å­˜)
  1190â†’â€¢ PostgreSQL (æŒä¹…åŒ–)
  1191â†’
  1192â†’Analytics
  1193â†’â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1194â†’â€¢ Mixpanel/Amplitude (äº‹ä»¶è¿½è¸ª)
  1195â†’â€¢ Supabase (ç”¨æˆ·æ•°æ®)
  1196â†’â€¢ Google Analytics 4 (ç½‘é¡µåˆ†æ)
  1197â†’```
  1198â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
