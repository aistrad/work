     1â†’'use client'
     2â†’
     3â†’/**
     4â†’ * Home Page - V8 è·¯ç”±åˆ†å‘
     5â†’ *
     6â†’ * V8 å˜æ›´:
     7â†’ * - å·²ç™»å½•ç”¨æˆ·é‡å®šå‘åˆ° Dashboard
     8â†’ * - æœªç™»å½•ç”¨æˆ·æ˜¾ç¤º Landing Page
     9â†’ */
    10â†’
    11â†’import { useEffect } from 'react'
    12â†’import { useRouter } from 'next/navigation'
    13â†’import { useAuth } from '@/providers'
    14â†’
    15â†’// Landing page components (lazy loaded for unauthenticated users)
    16â†’import { useState, useMemo, useCallback, memo } from 'react'
    17â†’import { PCLayout } from '@/components/layout/PCLayout'
    18â†’import { Card } from '@/components/ui/Card'
    19â†’import { Button } from '@/components/ui/Button'
    20â†’import {
    21â†’  LandingHero,
    22â†’  FeatureCard,
    23â†’  SkillPreview,
    24â†’  SectionTitle,
    25â†’  RecentChatCard,
    26â†’} from '@/components/landing'
    27â†’
    28â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    29â†’// Constants
    30â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    31â†’
    32â†’const FEATURES = [
    33â†’  { id: 'bazi', name: 'å…«å­—å‘½ç›˜', subtitle: 'BaZi Chart', icon: 'ğŸŒŸ', available: true, desc: 'æ¢ç´¢ä½ çš„å‘½ç†å¯†ç ï¼Œäº†è§£å¤©èµ‹ä¸è¿åŠ¿' },
    34â†’  { id: 'zodiac', name: 'æ˜Ÿåº§è§£è¯»', subtitle: 'Zodiac Reading', icon: 'ğŸ”®', available: true, desc: 'æ˜Ÿè±¡æŒ‡å¼•ï¼Œæ´å¯Ÿäººç”Ÿæ–¹å‘ä¸æœºé‡' },
    35â†’  { id: 'tarot', name: 'å¡”ç½—å åœ', subtitle: 'Tarot Reading', icon: 'ğŸƒ', available: false, desc: 'æ¢ç´¢å‘½è¿çš„æŒ‡å¼•ï¼Œè·å–æ™ºæ…§å¯ç¤º' },
    36â†’  { id: 'career', name: 'èŒä¸šè§„åˆ’', subtitle: 'Career Planning', icon: 'ğŸ§­', available: false, desc: 'å‘ç°èŒä¸šæ–¹å‘ï¼Œè§„åˆ’æˆé•¿è·¯å¾„' },
    37â†’]
    38â†’
    39â†’const RECENT_CHATS = [
    40â†’  { id: '1', title: 'å…³äºèŒä¸šå‘å±•çš„è®¨è®º', summary: 'æˆ‘ä»¬èŠäº†å…³äºè½¬è¡Œåˆ°ç§‘æŠ€è¡Œä¸šçš„å¯èƒ½æ€§ï¼Œç»“åˆä½ çš„å…«å­—åˆ†æ...', time: '2å°æ—¶å‰' },
    41â†’  { id: '2', title: 'æœ¬æœˆè¿åŠ¿åˆ†æ', summary: 'æ ¹æ®æµæœˆå¤©å¹²åœ°æ”¯ä¸ä½ æœ¬å‘½ç›˜çš„å…³ç³»ï¼Œè¿™ä¸ªæœˆçš„é‡ç‚¹åœ¨äº...', time: 'æ˜¨å¤©' },
    42â†’  { id: '3', title: 'æ„Ÿæƒ…å›°æ‰°å’¨è¯¢', summary: 'å…³äºä½ æåˆ°çš„æ„Ÿæƒ…é—®é¢˜ï¼Œä»æ˜Ÿåº§ç›¸ä½æ¥çœ‹...', time: '3å¤©å‰' },
    43â†’]
    44â†’
    45â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    46â†’// Helper Functions
    47â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    48â†’
    49â†’function getGreeting(): string {
    50â†’  const hour = new Date().getHours()
    51â†’  if (hour < 6) return 'å¤œæ·±äº†'
    52â†’  if (hour < 12) return 'æ—©ä¸Šå¥½'
    53â†’  if (hour < 18) return 'ä¸‹åˆå¥½'
    54â†’  return 'æ™šä¸Šå¥½'
    55â†’}
    56â†’
    57â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    58â†’// Aside Content - PC ç«¯å³ä¾§æ 
    59â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    60â†’
    61â†’interface AsideContentProps {
    62â†’  isPremium: boolean
    63â†’  onNavigate: (path: string) => void
    64â†’}
    65â†’
    66â†’const AsideContent = memo(function AsideContent({ isPremium, onNavigate }: AsideContentProps) {
    67â†’  return (
    68â†’    <div className="space-y-6">
    69â†’      {/* ä»Šæ—¥è¿åŠ¿ */}
    70â†’      <Card variant="default" padding="md" hover={false}>
    71â†’        <div className="flex items-center gap-2 mb-3">
    72â†’          <span className="text-lg">ğŸŒ…</span>
    73â†’          <h3 className="text-sm font-semibold text-text-primary">ä»Šæ—¥è¿åŠ¿</h3>
    74â†’        </div>
    75â†’        <div className="p-3 rounded-lg bg-gradient-to-br from-vellum-100 to-vellum-200">
    76â†’          <p className="text-sm text-text-primary mb-1">ç”²å­æ—¥ Â· æ°´æ°”æ—ºç››</p>
    77â†’          <p className="text-xs text-text-secondary">é€‚åˆå¤„ç†æ²Ÿé€šã€å­¦ä¹ ç›¸å…³äº‹åŠ¡</p>
    78â†’        </div>
    79â†’        {!isPremium && (
    80â†’          <button
    81â†’            onClick={() => onNavigate('/membership')}
    82â†’            className="mt-3 w-full text-xs text-accent-primary font-medium hover:underline"
    83â†’          >
    84â†’            å‡çº§ Premium è§£é”è¯¦ç»†åˆ†æ â†’
    85â†’          </button>
    86â†’        )}
    87â†’      </Card>
    88â†’
    89â†’      {/* èº«ä»½ç”»åƒ */}
    90â†’      <Card
    91â†’        variant="elevated"
    92â†’        padding="md"
    93â†’        hover
    94â†’        className="cursor-pointer"
    95â†’        onClick={() => onNavigate('/identity')}
    96â†’      >
    97â†’        <div className="flex items-center gap-3 mb-3">
    98â†’          <div className="w-10 h-10 rounded-xl bg-gradient-to-br from-mystic-400 to-mystic-600 flex items-center justify-center">
    99â†’            <span className="text-xl">ğŸ’</span>
   100â†’          </div>
   101â†’          <div>
   102â†’            <h3 className="text-sm font-semibold text-text-primary">èº«ä»½ç”»åƒ</h3>
   103â†’            <p className="text-xs text-text-secondary">Identity Prism</p>
   104â†’          </div>
   105â†’        </div>
   106â†’        <div className="mb-3">
   107â†’          <div className="text-xs text-text-secondary mb-1.5">å·²äº†è§£ä½ çš„ 68%</div>
   108â†’          <div className="h-2 bg-bg-secondary rounded-full overflow-hidden">
   109â†’            <div
   110â†’              className="h-full bg-gradient-to-r from-accent-primary to-accent-secondary rounded-full transition-all duration-slow"
   111â†’              style={{ width: '68%' }}
   112â†’            />
   113â†’          </div>
   114â†’        </div>
   115â†’        <span className="text-xs text-accent-primary font-medium">æŸ¥çœ‹å¤šç»´åº¦èåˆç”»åƒ â†’</span>
   116â†’      </Card>
   117â†’
   118â†’      {/* é€šçŸ¥ */}
   119â†’      <Card variant="flat" padding="md" hover={false}>
   120â†’        <div className="flex items-center gap-2 mb-3">
   121â†’          <span className="text-lg">ğŸ””</span>
   122â†’          <h3 className="text-sm font-semibold text-text-primary">é€šçŸ¥</h3>
   123â†’        </div>
   124â†’        <div className="space-y-2">
   125â†’          <div className="p-2 rounded-lg bg-bg-secondary">
   126â†’            <p className="text-xs text-text-primary">æ˜æ—¥è¿åŠ¿æé†’å·²å¼€å¯</p>
   127â†’            <p className="text-xs text-text-tertiary mt-0.5">æ¯æ—¥ 8:00 æ¨é€</p>
   128â†’          </div>
   129â†’        </div>
   130â†’      </Card>
   131â†’    </div>
   132â†’  )
   133â†’})
   134â†’
   135â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   136â†’// Main Content
   137â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   138â†’
   139â†’interface MainContentProps {
   140â†’  greeting: string
   141â†’  userName: string
   142â†’  today: string
   143â†’  onNavigate: (path: string) => void
   144â†’  onFeatureClick: (id: string, available: boolean) => void
   145â†’  onChatClick: (id: string) => void
   146â†’}
   147â†’
   148â†’const MainContent = memo(function MainContent({
   149â†’  greeting,
   150â†’  userName,
   151â†’  today,
   152â†’  onNavigate,
   153â†’  onFeatureClick,
   154â†’  onChatClick,
   155â†’}: MainContentProps) {
   156â†’  return (
   157â†’    <div className="space-y-8">
   158â†’      {/* Hero Card - v7.1 æ¸å˜èƒŒæ™¯ */}
   159â†’      <Card
   160â†’        variant="default"
   161â†’        padding="lg"
   162â†’        hover={false}
   163â†’        className="relative overflow-hidden animate-fade-in"
   164â†’      >
   165â†’        {/* Background gradient */}
   166â†’        <div className="absolute inset-0 bg-gradient-to-br from-vellum-100/80 via-vellum-50/50 to-transparent pointer-events-none" />
   167â†’
   168â†’        <div className="relative z-10">
   169â†’          <div className="flex items-start justify-between mb-4">
   170â†’            <div>
   171â†’              <h1 className="font-serif text-2xl md:text-3xl text-text-primary mb-1">
   172â†’                ğŸ‘‹ {greeting}ï¼Œ{userName}
   173â†’              </h1>
   174â†’              <p className="text-sm text-text-secondary">{today}</p>
   175â†’            </div>
   176â†’          </div>
   177â†’          <p className="text-base text-text-secondary mb-5 max-w-xl">
   178â†’            ä»Šå¤©æ˜¯ç”²å­æ—¥ï¼Œæ°´æ°”æ—ºç››ã€‚å¯¹äºæˆŠåœŸæ—¥ä¸»çš„ä½ æ¥è¯´ï¼Œä»Šå¤©é€‚åˆå¤„ç†ä¸æ²Ÿé€šã€å­¦ä¹ ç›¸å…³çš„äº‹åŠ¡ã€‚
   179â†’          </p>
   180â†’          <Button
   181â†’            variant="primary"
   182â†’            onClick={() => onNavigate('/chat?q=ä»Šæ—¥è¿åŠ¿')}
   183â†’          >
   184â†’            æŸ¥çœ‹ä»Šæ—¥è¯¦ç»†è¿åŠ¿
   185â†’          </Button>
   186â†’        </div>
   187â†’      </Card>
   188â†’
   189â†’      {/* Features Grid */}
   190â†’      <section>
   191â†’        <SectionTitle title="æ¢ç´¢åŠŸèƒ½" subtitle="é€‰æ‹©ä½ æ„Ÿå…´è¶£çš„é¢†åŸŸå¼€å§‹æ¢ç´¢" />
   192â†’        <div className="grid grid-cols-2 lg:grid-cols-4 gap-4">
   193â†’          {FEATURES.map((feature, i) => (
   194â†’            <FeatureCard
   195â†’              key={feature.id}
   196â†’              icon={feature.icon}
   197â†’              title={feature.name}
   198â†’              description={feature.desc}
   199â†’              disabled={!feature.available}
   200â†’              badge={feature.available ? 'å¯ç”¨' : undefined}
   201â†’              onClick={() => onFeatureClick(feature.id, feature.available)}
   202â†’              className="animate-fade-in-up"
   203â†’              style={{ animationDelay: `${i * 50}ms` } as React.CSSProperties}
   204â†’            />
   205â†’          ))}
   206â†’        </div>
   207â†’      </section>
   208â†’
   209â†’      {/* Mobile: Identity Card */}
   210â†’      <Card
   211â†’        variant="elevated"
   212â†’        padding="md"
   213â†’        hover
   214â†’        className="lg:hidden cursor-pointer animate-fade-in"
   215â†’        onClick={() => onNavigate('/identity')}
   216â†’      >
   217â†’        <div className="flex items-center gap-3">
   218â†’          <div className="w-12 h-12 rounded-xl bg-gradient-to-br from-mystic-400 to-mystic-600 flex items-center justify-center">
   219â†’            <span className="text-2xl">ğŸ’</span>
   220â†’          </div>
   221â†’          <div className="flex-1">
   222â†’            <h3 className="font-serif text-base font-semibold text-text-primary">æˆ‘çš„èº«ä»½ç”»åƒ</h3>
   223â†’            <p className="text-xs text-text-secondary">æŸ¥çœ‹å¤šç»´åº¦èåˆçš„ä¸“å±ç”»åƒ â†’</p>
   224â†’          </div>
   225â†’        </div>
   226â†’      </Card>
   227â†’
   228â†’      {/* Recent Chats - PC only */}
   229â†’      <section className="hidden lg:block">
   230â†’        <SectionTitle
   231â†’          title="æœ€è¿‘å¯¹è¯"
   232â†’          action={{ label: 'æŸ¥çœ‹å…¨éƒ¨', onClick: () => onNavigate('/chat') }}
   233â†’        />
   234â†’        <Card variant="default" padding="none" hover={false}>
   235â†’          <div className="divide-y divide-subtle/50">
   236â†’            {RECENT_CHATS.map((chat) => (
   237â†’              <RecentChatCard
   238â†’                key={chat.id}
   239â†’                {...chat}
   240â†’                onClick={() => onChatClick(chat.id)}
   241â†’              />
   242â†’            ))}
   243â†’          </div>
   244â†’        </Card>
   245â†’      </section>
   246â†’    </div>
   247â†’  )
   248â†’})
   249â†’
   250â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   251â†’// Mobile Layout
   252â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   253â†’
   254â†’interface MobileLayoutProps {
   255â†’  children: React.ReactNode
   256â†’  onOmnibarFocus: () => void
   257â†’}
   258â†’
   259â†’const MobileLayout = memo(function MobileLayout({ children, onOmnibarFocus }: MobileLayoutProps) {
   260â†’  return (
   261â†’    <div className="min-h-screen bg-bg-primary lg:hidden">
   262â†’      {/* Header */}
   263â†’      <header className="sticky top-0 z-40 h-14 px-4 flex items-center justify-between bg-bg-primary/95 backdrop-blur-md border-b border-subtle/30">
   264â†’        <div className="flex items-center gap-2">
   265â†’          <span className="text-2xl">ğŸŒŸ</span>
   266â†’          <div>
   267â†’            <h1 className="font-serif text-lg font-semibold text-text-primary">VibeLife</h1>
   268â†’          </div>
   269â†’        </div>
   270â†’        <div className="flex items-center gap-2">
   271â†’          <button className="p-2 rounded-lg text-text-secondary hover:bg-bg-secondary transition-colors">
   272â†’            ğŸ””
   273â†’          </button>
   274â†’          <button className="p-2 rounded-lg text-text-secondary hover:bg-bg-secondary transition-colors">
   275â†’            â˜°
   276â†’          </button>
   277â†’        </div>
   278â†’      </header>
   279â†’
   280â†’      {/* Content */}
   281â†’      <main className="px-4 py-6 pb-24">
   282â†’        {children}
   283â†’      </main>
   284â†’
   285â†’      {/* Bottom Omnibar */}
   286â†’      <div className="fixed bottom-0 left-0 right-0 p-4 bg-bg-primary border-t border-subtle/30 pb-safe">
   287â†’        <div className="max-w-lg mx-auto">
   288â†’          <div className="flex items-center gap-3 bg-bg-card shadow-card rounded-2xl px-4 py-2.5">
   289â†’            <input
   290â†’              type="text"
   291â†’              placeholder="Type '/' for commands..."
   292â†’              className="flex-1 bg-transparent text-text-primary placeholder:text-text-disabled focus:outline-none"
   293â†’              onFocus={onOmnibarFocus}
   294â†’            />
   295â†’            <button className="w-9 h-9 rounded-full bg-accent-primary text-text-inverse flex items-center justify-center">
   296â†’              â–¶
   297â†’            </button>
   298â†’          </div>
   299â†’        </div>
   300â†’      </div>
   301â†’    </div>
   302â†’  )
   303â†’})
   304â†’
   305â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   306â†’// Home Page
   307â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   308â†’
   309â†’export default function HomePage() {
   310â†’  const router = useRouter()
   311â†’  const { isAuthenticated, isLoading: authLoading } = useAuth()
   312â†’  const [isPremium] = useState(false)
   313â†’  const [userName] = useState('ç”¨æˆ·')
   314â†’  const [greeting] = useState(getGreeting)
   315â†’
   316â†’  // V8: Redirect authenticated users to Dashboard
   317â†’  useEffect(() => {
   318â†’    if (!authLoading && isAuthenticated) {
   319â†’      router.replace('/dashboard')
   320â†’    }
   321â†’  }, [isAuthenticated, authLoading, router])
   322â†’
   323â†’  // Show loading while checking auth
   324â†’  if (authLoading) {
   325â†’    return (
   326â†’      <div className="min-h-screen flex items-center justify-center bg-background">
   327â†’        <div className="animate-pulse text-muted-foreground">åŠ è½½ä¸­...</div>
   328â†’      </div>
   329â†’    )
   330â†’  }
   331â†’
   332â†’  // If authenticated, show nothing while redirecting
   333â†’  if (isAuthenticated) {
   334â†’    return null
   335â†’  }
   336â†’
   337â†’  const today = useMemo(
   338â†’    () => new Date().toLocaleDateString('zh-CN', { year: 'numeric', month: 'long', day: 'numeric' }),
   339â†’    []
   340â†’  )
   341â†’
   342â†’  const handleNavigate = useCallback((path: string) => {
   343â†’    router.push(path)
   344â†’  }, [router])
   345â†’
   346â†’  const handleFeatureClick = useCallback((id: string, available: boolean) => {
   347â†’    if (available) {
   348â†’      router.push(`/chat?skill=${id}`)
   349â†’    }
   350â†’  }, [router])
   351â†’
   352â†’  const handleChatClick = useCallback((id: string) => {
   353â†’    router.push(`/chat?id=${id}`)
   354â†’  }, [router])
   355â†’
   356â†’  const handleOmnibarFocus = useCallback(() => {
   357â†’    router.push('/chat')
   358â†’  }, [router])
   359â†’
   360â†’  const mainContent = (
   361â†’    <MainContent
   362â†’      greeting={greeting}
   363â†’      userName={userName}
   364â†’      today={today}
   365â†’      onNavigate={handleNavigate}
   366â†’      onFeatureClick={handleFeatureClick}
   367â†’      onChatClick={handleChatClick}
   368â†’    />
   369â†’  )
   370â†’
   371â†’  return (
   372â†’    <>
   373â†’      {/* PCç«¯: ä½¿ç”¨ PCLayout ä¸‰æ å¸ƒå±€ */}
   374â†’      <div className="hidden lg:block">
   375â†’        <PCLayout
   376â†’          breadcrumb={[{ label: 'é¦–é¡µ' }]}
   377â†’          aside={<AsideContent isPremium={isPremium} onNavigate={handleNavigate} />}
   378â†’        >
   379â†’          {mainContent}
   380â†’        </PCLayout>
   381â†’      </div>
   382â†’
   383â†’      {/* ç§»åŠ¨ç«¯: ç®€å•å•æ å¸ƒå±€ */}
   384â†’      <MobileLayout onOmnibarFocus={handleOmnibarFocus}>
   385â†’        {mainContent}
   386â†’      </MobileLayout>
   387â†’    </>
   388â†’  )
   389â†’}
   390â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
