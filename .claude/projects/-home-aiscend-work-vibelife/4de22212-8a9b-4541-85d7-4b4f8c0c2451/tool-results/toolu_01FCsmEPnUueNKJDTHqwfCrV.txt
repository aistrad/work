     1→# Proactive Reminders Configuration Schema
     2→# 文件位置: apps/api/skills/{skill_id}/reminders.yaml
     3→
     4→$schema: "http://json-schema.org/draft-07/schema#"
     5→title: Skill Reminders Configuration
     6→description: 定义 Skill 的主动推送配置
     7→
     8→type: object
     9→required:
    10→  - skill_id
    11→  - enabled
    12→  - reminders
    13→
    14→properties:
    15→  skill_id:
    16→    type: string
    17→    description: Skill 标识符，与 SKILL.md 的 id 一致
    18→    examples: ["bazi", "zodiac", "tarot"]
    19→
    20→  enabled:
    21→    type: boolean
    22→    description: 是否启用该 Skill 的主动推送
    23→    default: true
    24→
    25→  reminders:
    26→    type: array
    27→    description: 提醒配置列表
    28→    items:
    29→      $ref: "#/definitions/Reminder"
    30→
    31→definitions:
    32→  Reminder:
    33→    type: object
    34→    required:
    35→      - id
    36→      - name
    37→      - trigger
    38→      - content
    39→    properties:
    40→      id:
    41→        type: string
    42→        description: 提醒唯一标识
    43→        pattern: "^[a-z_]+$"
    44→        examples: ["daily_fortune", "dayun_transition"]
    45→
    46→      name:
    47→        type: string
    48→        description: 提醒名称（中文）
    49→        examples: ["每日运势", "大运交接"]
    50→
    51→      trigger:
    52→        $ref: "#/definitions/Trigger"
    53→
    54→      content:
    55→        $ref: "#/definitions/Content"
    56→
    57→      priority:
    58→        type: string
    59→        enum: ["high", "medium", "low"]
    60→        default: "medium"
    61→        description: 推送优先级
    62→
    63→  Trigger:
    64→    type: object
    65→    required:
    66→      - type
    67→    properties:
    68→      type:
    69→        type: string
    70→        enum: ["time_based", "event_based", "threshold_based"]
    71→        description: 触发器类型
    72→
    73→    oneOf:
    74→      - $ref: "#/definitions/TimeBasedTrigger"
    75→      - $ref: "#/definitions/EventBasedTrigger"
    76→      - $ref: "#/definitions/ThresholdBasedTrigger"
    77→
    78→  TimeBasedTrigger:
    79→    type: object
    80→    properties:
    81→      type:
    82→        const: "time_based"
    83→      schedule:
    84→        type: string
    85→        description: Cron 表达式
    86→        examples: ["0 4 * * *", "0 9 * * 1"]
    87→
    88→  EventBasedTrigger:
    89→    type: object
    90→    properties:
    91→      type:
    92→        const: "event_based"
    93→      event:
    94→        type: string
    95→        description: 事件类型
    96→        enum:
    97→          - dayun_change      # 大运交接
    98→          - liunian_change    # 流年交接
    99→          - solar_term        # 节气
   100→          - birthday          # 生日
   101→          - lunar_birthday    # 农历生日
   102→      advance_days:
   103→        type: array
   104→        items:
   105→          type: integer
   106→        description: 提前多少天提醒
   107→        examples: [[30, 7, 0], [7, 1, 0]]
   108→
   109→  ThresholdBasedTrigger:
   110→    type: object
   111→    properties:
   112→      type:
   113→        const: "threshold_based"
   114→      metric:
   115→        type: string
   116→        description: 检测的指标
   117→        examples: ["daily_fortune_score", "health_score"]
   118→      condition:
   119→        type: string
   120→        enum: ["<", ">", "<=", ">=", "=="]
   121→        description: 比较条件
   122→      threshold:
   123→        type: number
   124→        description: 阈值
   125→      cooldown_days:
   126→        type: integer
   127→        default: 7
   128→        description: 触发后的冷却天数
   129→
   130→  Content:
   131→    type: object
   132→    properties:
   133→      generator:
   134→        type: string
   135→        description: 内容生成器，支持复用 rules/ 文件
   136→        examples: ["rules/daily-fortune.md", "rules/dayun-transition.md"]
   137→
   138→      card_type:
   139→        type: string
   140→        description: 前端卡片类型
   141→        enum:
   142→          - DailyFortuneCard
   143→          - InsightCard
   144→          - AlertCard
   145→
   146→      suggested_prompt:
   147→        type: string
   148→        description: 对话引导提示语
   149→        examples: ["想了解今天的运势详情？"]
   150→
   151→      quick_actions:
   152→        type: array
   153→        description: 快捷操作按钮
   154→        items:
   155→          type: object
   156→          required:
   157→            - label
   158→            - prompt
   159→          properties:
   160→            label:
   161→              type: string
   162→              description: 按钮文本
   163→              examples: ["今日宜忌", "开运建议"]
   164→            prompt:
   165→              type: string
   166→              description: 点击后发送的消息
   167→              examples: ["今天适合做什么？"]
   168→
   169→# 完整示例
   170→examples:
   171→  - skill_id: bazi
   172→    enabled: true
   173→    reminders:
   174→      - id: daily_fortune
   175→        name: 每日运势
   176→        trigger:
   177→          type: time_based
   178→          schedule: "0 4 * * *"
   179→        content:
   180→          generator: rules/daily-fortune.md
   181→          card_type: DailyFortuneCard
   182→          suggested_prompt: "想了解今天的运势详情？"
   183→          quick_actions:
   184→            - label: "今日宜忌"
   185→              prompt: "今天适合做什么？有什么需要注意的？"
   186→            - label: "开运建议"
   187→              prompt: "今天如何提升运势？"
   188→        priority: medium
   189→
   190→      - id: dayun_transition
   191→        name: 大运交接
   192→        trigger:
   193→          type: event_based
   194→          event: dayun_change
   195→          advance_days: [30, 7, 0]
   196→        content:
   197→          generator: rules/dayun-transition.md
   198→          card_type: InsightCard
   199→          suggested_prompt: "想了解新大运的详细分析？"
   200→          quick_actions:
   201→            - label: "大运解读"
   202→              prompt: "请详细分析我即将进入的新大运"
   203→        priority: high
   204→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
