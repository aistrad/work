     1â†’"use client";
     2â†’
     3â†’/**
     4â†’ * ChatContainer - v5.2 æ€§èƒ½ä¼˜åŒ–ç‰ˆ
     5â†’ *
     6â†’ * ä¼˜åŒ–ç‚¹:
     7â†’ * 1. ä½¿ç”¨ content-visibility ä¼˜åŒ–é•¿æ¶ˆæ¯åˆ—è¡¨ (Vercel rule: rendering-content-visibility)
     8â†’ * 2. Memoize ChatEmptyState ç»„ä»¶ (Vercel rule: rerender-extract-component)
     9â†’ * 3. ä½¿ç”¨ç¼“å­˜çš„ localStorage å·¥å…· (Vercel rule: js-cache-storage)
    10â†’ */
    11â†’
    12â†’import { useRef, useEffect, useMemo, useCallback, useState, memo } from "react";
    13â†’import type { Message } from "ai/react";
    14â†’import { toast } from "sonner";
    15â†’import { ChatMessage } from "./ChatMessage";
    16â†’import { ChatInput } from "./ChatInput";
    17â†’import { InsightCard, InsightType } from "@/components/insight/InsightCard";
    18â†’import { VibeGlyph, BreathAura, type SkillType } from "@/components/core";
    19â†’import { DailyGreeting } from "@/components/greeting/DailyGreeting";
    20â†’import { useVibeChat, type SkillId } from "@/hooks/useVibeChat";
    21â†’import { getLocalStorageJSON, getLocalStorage, setLocalStorage } from "@/utils/storage";
    22â†’
    23â†’interface InsightData {
    24â†’  id: string;
    25â†’  insight_type: InsightType;
    26â†’  title: string;
    27â†’  content: string;
    28â†’}
    29â†’
    30â†’/**
    31â†’ * Extract text content from AI SDK Message
    32â†’ */
    33â†’function getMessageContent(message: Message): string {
    34â†’  return message.content || '';
    35â†’}
    36â†’
    37â†’export type VoiceMode = "warm" | "sarcastic";
    38â†’
    39â†’export interface ChatContainerProps {
    40â†’  /**
    41â†’   * Skill ID - å¯é€‰
    42â†’   * - ä¼ å…¥æ—¶ï¼šåç«¯ç›´æ¥ä½¿ç”¨è¯¥ skill
    43â†’   * - ä¸ä¼ æ—¶ï¼šåç«¯ CoreAgent é€šè¿‡ LLM è‡ªåŠ¨è·¯ç”±
    44â†’   */
    45â†’  skillId?: string;
    46â†’  /**
    47â†’   * ç”¨äº UI å±•ç¤ºçš„ skillï¼ˆä¸»é¢˜ã€ç©ºçŠ¶æ€ç­‰ï¼‰
    48â†’   * å½“ skillId ä¸ä¼ æ—¶ï¼Œæ­¤å­—æ®µä»å¯ç”¨äº UI å±•ç¤º
    49â†’   */
    50â†’  skill?: SkillType;
    51â†’  conversationId?: string;
    52â†’  voiceMode?: VoiceMode;
    53â†’  onConversationStart?: (id: string) => void;
    54â†’}
    55â†’
    56â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    57â†’// ChatEmptyState - LUMINOUS PAPER Design System
    58â†’// ç©ºçŠ¶æ€ï¼šå±…ä¸­ VibeGlyph + æŠ€èƒ½æ„ŸçŸ¥æ–‡æ¡ˆ + å‘¼å¸å…‰æ™•
    59â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    60â†’
    61â†’const SKILL_EMPTY_STATE: Record<SkillType, { title: string; subtitle: string }> = {
    62â†’  bazi: {
    63â†’    title: "æ¢ç´¢ä½ çš„å‘½ç†",
    64â†’    subtitle: "åˆ†äº«ä½ çš„ç”Ÿè¾°ï¼Œå¼€å¯å…«å­—è§£è¯»ä¹‹æ—…",
    65â†’  },
    66â†’  zodiac: {
    67â†’    title: "å€¾å¬æ˜Ÿè¾°çš„å£°éŸ³",
    68â†’    subtitle: "è®©æ˜Ÿç›˜ä¸ºä½ æ­ç¤ºå®‡å®™çš„å¯†è¯­",
    69â†’  },
    70â†’  mbti: {
    71â†’    title: "å‘ç°çœŸå®çš„è‡ªå·±",
    72â†’    subtitle: "é€šè¿‡å¯¹è¯ï¼Œæ¢ç´¢ä½ çš„äººæ ¼ç‰¹è´¨",
    73â†’  },
    74â†’  attach: {
    75â†’    title: "ç†è§£ä½ çš„ä¾æ‹æ¨¡å¼",
    76â†’    subtitle: "æ¢ç´¢äº²å¯†å…³ç³»ä¸­çš„è‡ªæˆ‘",
    77â†’  },
    78â†’  career: {
    79â†’    title: "è§„åˆ’ä½ çš„èŒä¸šè“å›¾",
    80â†’    subtitle: "è®©æˆ‘ä»¬ä¸€èµ·æ¢ç´¢ä½ çš„èŒä¸šå‘å±•æ–¹å‘",
    81â†’  },
    82â†’};
    83â†’
    84â†’// Quick prompts for each skill with icons and categories
    85â†’interface QuickPromptItem {
    86â†’  icon: string;
    87â†’  category: string;
    88â†’  question: string;
    89â†’  gradient: string;
    90â†’}
    91â†’
    92â†’const SKILL_QUICK_PROMPTS: Record<SkillType, QuickPromptItem[]> = {
    93â†’  bazi: [
    94â†’    { icon: "ğŸ‚", category: "ç”Ÿè¾°ä¿¡æ¯", question: "æˆ‘æ˜¯1990å¹´5æœˆ15æ—¥æ—©ä¸Š8ç‚¹å‡ºç”Ÿçš„", gradient: "from-blue-500/10 to-cyan-500/10" },
    95â†’    { icon: "ğŸ“ˆ", category: "è¿åŠ¿åˆ†æ", question: "å¸®æˆ‘åˆ†æä»Šå¹´çš„è¿åŠ¿", gradient: "from-purple-500/10 to-pink-500/10" },
    96â†’    { icon: "ğŸ’¼", category: "äº‹ä¸šå‘å±•", question: "æˆ‘çš„äº‹ä¸šè¿å¦‚ä½•ï¼Ÿ", gradient: "from-orange-500/10 to-red-500/10" },
    97â†’    { icon: "â°", category: "æ—¶æœºé€‰æ‹©", question: "ä»€ä¹ˆæ—¶å€™é€‚åˆåšé‡å¤§å†³å®šï¼Ÿ", gradient: "from-green-500/10 to-teal-500/10" },
    98â†’  ],
    99â†’  zodiac: [
   100â†’    { icon: "â­", category: "è¿åŠ¿æŸ¥è¯¢", question: "æˆ‘æ˜¯åŒå­åº§ï¼Œå¸®æˆ‘çœ‹çœ‹æœ¬å‘¨è¿åŠ¿", gradient: "from-purple-500/10 to-pink-500/10" },

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
