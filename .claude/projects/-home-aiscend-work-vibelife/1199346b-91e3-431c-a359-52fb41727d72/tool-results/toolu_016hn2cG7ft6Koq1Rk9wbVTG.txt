     1→# Dashboard 组件实现指南
     2→
     3→> **Version**: 2.0 | 2026-01-19
     4→> **关联文档**: DESIGN.md (视觉规格)
     5→
     6→---
     7→
     8→## 核心组件 ASCII 详图
     9→
    10→### 1. AmbientHeader
    11→
    12→```
    13→┌─────────────────────────────────────────────────────────────────────────────────┐
    14→│                              AmbientHeader                                       │
    15→├─────────────────────────────────────────────────────────────────────────────────┤
    16→│                                                                                  │
    17→│   ┌──────────────────────────────────────────────────────────────────────────┐  │
    18→│   │                                                                          │  │
    19→│   │  ☀️ 早安，{用户名}                              2026年1月19日 大寒前3天   │  │
    20→│   │  ───────────────────────────────────────────────────────────────────     │  │
    21→│   │  "{智能名言}"                                              — {作者}      │  │
    22→│   │                                                                          │  │
    23→│   │  🔥 {streak}天连续   💪 能量 {energy}%   {status}        [ 签到 ]       │  │
    24→│   │                                                                          │  │
    25→│   └──────────────────────────────────────────────────────────────────────────┘  │
    26→│                                                                                  │
    27→│   子组件:                                                                        │
    28→│   ├── Greeting: 时间问候 + 用户名                                              │
    29→│   ├── DateDisplay: 日期 + 节气                                                 │
    30→│   ├── QuoteDisplay: 智能名言                                                   │
    31→│   └── StatusBar: 签到状态 + 连续天数 + 能量                                    │
    32→│       ├── StreakBadge: 🔥 连续天数                                             │
    33→│       ├── EnergyIndicator: 💪 能量值                                           │
    34→│       ├── CheckedStatus: ✓ 已签到 / □ 未签到                                  │
    35→│       └── CheckInButton: [ 签到 ]                                              │
    36→│                                                                                  │
    37→└─────────────────────────────────────────────────────────────────────────────────┘
    38→```
    39→
    40→**智能名言系统:**
    41→
    42→```typescript
    43→// src/lib/dashboard/quotes.ts
    44→
    45→/**
    46→ * 名言库 - 按主题分类
    47→ * 设计原则：触动人心、简洁有力、与用户状态共鸣
    48→ */
    49→
    50→// ═══════════════════════════════════════════════════════════════
    51→// 1. 愿景与目标
    52→// ═══════════════════════════════════════════════════════════════
    53→const VISION_QUOTES = [
    54→  { text: "你的愿景正在等待你的行动。", author: null },
    55→  { text: "种一棵树最好的时间是十年前，其次是现在。", author: "中国谚语" },
    56→  { text: "不是因为看见了才相信，而是因为相信了才看见。", author: null },
    57→  { text: "你不必看清整个楼梯，只需迈出第一步。", author: "马丁·路德·金" },
    58→  { text: "今天做的每一件小事，都是明天大事的预演。", author: null },
    59→  { text: "目标不是用来达成的，而是用来指引方向的。", author: "布鲁斯·李" },
    60→  { text: "梦想不会逃跑，逃跑的永远是自己。", author: "村上春树" },
    61→  { text: "最慢的步伐不是跬步，而是徘徊。", author: null },
    62→];
    63→
    64→// ═══════════════════════════════════════════════════════════════
    65→// 2. 坚持与毅力
    66→// ═══════════════════════════════════════════════════════════════
    67→const PERSISTENCE_QUOTES = [
    68→  { text: "滴水穿石，不是力量大，而是功夫深。", author: null },
    69→  { text: "每一次你想放弃的时候，想想为什么开始。", author: null },
    70→  { text: "成功的秘诀在于坚持。坚持的秘诀在于热爱。", author: null },
    71→  { text: "复利效应：今天的1%进步，一年后是37倍。", author: null },
    72→  { text: "不是强者才能坚持，而是坚持了才会变强。", author: null },
    73→  { text: "你已经走了这么远，不要忘记为什么出发。", author: null },
    74→  { text: "日拱一卒，功不唐捐。", author: "曾国藩" },
    75→];
    76→
    77→// ═══════════════════════════════════════════════════════════════
    78→// 3. 自我认知 (荣格相关)
    79→// ═══════════════════════════════════════════════════════════════
    80→const SELF_AWARENESS_QUOTES = [
    81→  { text: "认识你自己。", author: "苏格拉底" },
    82→  { text: "你是谁，比你做什么更重要。", author: null },
    83→  { text: "真正的自由是成为你自己。", author: null },
    84→  { text: "接纳自己，是改变的起点。", author: null },
    85→  { text: "每个人都是自己生命的作者。", author: null },
    86→  { text: "最深的井，往往有最甜的水。", author: "尼采" },
    87→  { text: "你内心的答案，比任何外在的声音都重要。", author: null },
    88→  { text: "向内求，是所有外在成就的起点。", author: null },
    89→  { text: "你的任务不是去寻找爱，而是去寻找并拆除你内心所有阻挡爱的障碍。", author: "荣格" },
    90→  { text: "凡是你所抗拒的，都会持续。", author: "荣格" },
    91→  { text: "往外看的人在做梦，往内看的人正清醒。", author: "荣格" },
    92→];
    93→
    94→// ═══════════════════════════════════════════════════════════════
    95→// 4. 行动与当下
    96→// ═══════════════════════════════════════════════════════════════
    97→const ACTION_QUOTES = [
    98→  { text: "千里之行，始于足下。", author: "老子" },
    99→  { text: "想都是问题，做才是答案。", author: null },
   100→  { text: "最好的准备就是立刻开始。", author: null },
   101→  { text: "完成比完美更重要。", author: null },
   102→  { text: "今天是余生中最年轻的一天。", author: null },
   103→  { text: "你不需要很厉害才能开始，但需要开始才能很厉害。", author: null },
   104→  { text: "行动是治愈恐惧的良药。", author: null },
   105→  { text: "先完成，再完美。", author: null },
   106→];
   107→
   108→// ═══════════════════════════════════════════════════════════════
   109→// 5. 成长与变化
   110→// ═══════════════════════════════════════════════════════════════
   111→const GROWTH_QUOTES = [
   112→  { text: "舒适区的边缘，是成长发生的地方。", author: null },
   113→  { text: "蜕变总是伴随着不舒服。", author: null },
   114→  { text: "你不是在变老，而是在变好。", author: null },
   115→  { text: "今天的你比昨天的你更接近目标。", author: null },
   116→  { text: "每一次跌倒，都是在学习如何站得更稳。", author: null },
   117→  { text: "不是环境造就人，而是人选择如何回应环境。", author: "维克多·弗兰克尔" },
   118→  { text: "成长是一个过程，不是一个事件。", author: null },
   119→];
   120→
   121→// ═══════════════════════════════════════════════════════════════
   122→// 6. 休息与平衡
   123→// ═══════════════════════════════════════════════════════════════
   124→const REST_QUOTES = [
   125→  { text: "休息不是放弃，而是为了走更远的路。", author: null },
   126→  { text: "张弛有度，方能长久。", author: null },
   127→  { text: "有时候，慢下来才能看清方向。", author: null },
   128→  { text: "照顾好自己，才能照顾好世界。", author: null },
   129→  { text: "留白是为了让重要的事物更突出。", author: null },
   130→  { text: "能量管理比时间管理更重要。", author: null },
   131→];
   132→
   133→// ═══════════════════════════════════════════════════════════════
   134→// 7. 困境与突破
   135→// ═══════════════════════════════════════════════════════════════
   136→const BREAKTHROUGH_QUOTES = [
   137→  { text: "山重水复疑无路，柳暗花明又一村。", author: "陆游" },
   138→  { text: "在你准备放弃的那一刻，往往离成功最近。", author: null },
   139→  { text: "困难是化了妆的礼物。", author: null },
   140→  { text: "没有到不了的明天。", author: null },
   141→  { text: "冬天来了，春天还会远吗？", author: "雪莱" },
   142→  { text: "你现在经历的，都会成为你未来的力量。", author: null },
   143→];
   144→
   145→// ═══════════════════════════════════════════════════════════════
   146→// 8. 周期性名言（特殊时间点）
   147→// ═══════════════════════════════════════════════════════════════
   148→const PERIODIC_QUOTES = {
   149→  monday: [
   150→    { text: "新的一周，新的可能。", author: null },
   151→    { text: "周一是重新开始的好时机。", author: null },
   152→    { text: "这周，你想成为什么样的人？", author: null },
   153→    { text: "每个周一都是52次重新开始的机会。", author: null },
   154→  ],
   155→  friday: [
   156→    { text: "回顾这周，你离目标更近了一步。", author: null },
   157→    { text: "这周的你，比上周的你更强了。", author: null },
   158→  ],
   159→  weekend: [
   160→    { text: "周末是给灵魂充电的时间。", author: null },
   161→    { text: "休息好，才能走得更远。", author: null },
   162→    { text: "好好休息，也是一种自律。", author: null },
   163→  ],
   164→  month_start: [
   165→    { text: "新的一月，新的篇章。", author: null },
   166→    { text: "这个月，你想完成什么？", author: null },
   167→  ],
   168→  month_end: [
   169→    { text: "月底了，回顾一下这个月的收获。", author: null },
   170→    { text: "无论结果如何，感谢这个月努力的自己。", author: null },
   171→  ],
   172→};
   173→
   174→// ═══════════════════════════════════════════════════════════════
   175→// 智能选择算法
   176→// ═══════════════════════════════════════════════════════════════
   177→
   178→interface QuoteContext {
   179→  hour: number;
   180→  dayOfWeek: number;        // 0=周日, 1=周一, ...
   181→  dayOfMonth: number;
   182→  month: number;
   183→  streak: number;
   184→  checkedIn: boolean;
   185→  weekProgress: number;     // 0-1
   186→  subscribedSkills: string[];  // 用户订阅的 Skill
   187→}
   188→
   189→function selectQuote(context: QuoteContext): { text: string; author: string | null } {
   190→  const {
   191→    hour, dayOfWeek, dayOfMonth, month,
   192→    streak, checkedIn, weekProgress, subscribedSkills
   193→  } = context;
   194→
   195→  let candidatePool: Array<{ text: string; author: string | null; weight: number }> = [];
   196→
   197→  // 1. 周期性名言优先（特殊时间点）
   198→  if (dayOfWeek === 1) {
   199→    candidatePool.push(...PERIODIC_QUOTES.monday.map(q => ({ ...q, weight: 10 })));
   200→  } else if (dayOfWeek === 5) {
   201→    candidatePool.push(...PERIODIC_QUOTES.friday.map(q => ({ ...q, weight: 10 })));
   202→  } else if (dayOfWeek === 0 || dayOfWeek === 6) {
   203→    candidatePool.push(...PERIODIC_QUOTES.weekend.map(q => ({ ...q, weight: 10 })));
   204→  }
   205→
   206→  if (dayOfMonth <= 3) {
   207→    candidatePool.push(...PERIODIC_QUOTES.month_start.map(q => ({ ...q, weight: 12 })));
   208→  } else if (dayOfMonth >= 28) {
   209→    candidatePool.push(...PERIODIC_QUOTES.month_end.map(q => ({ ...q, weight: 12 })));
   210→  }
   211→
   212→  // 2. 基于用户订阅 Skill 选择
   213→  if (subscribedSkills.includes('jungian')) {
   214→    candidatePool.push(...SELF_AWARENESS_QUOTES.map(q => ({ ...q, weight: 8 })));
   215→  }
   216→
   217→  // 3. 基于用户状态选择
   218→  if (streak >= 7) {
   219→    candidatePool.push(...PERSISTENCE_QUOTES.map(q => ({ ...q, weight: 8 })));
   220→  }
   221→
   222→  if (!checkedIn && hour >= 6 && hour < 12) {
   223→    candidatePool.push(...ACTION_QUOTES.map(q => ({ ...q, weight: 8 })));
   224→  }
   225→
   226→  if (weekProgress >= 0.7) {
   227→    candidatePool.push(...GROWTH_QUOTES.map(q => ({ ...q, weight: 6 })));
   228→  }
   229→
   230→  if (weekProgress < 0.3 && dayOfWeek >= 4) {
   231→    candidatePool.push(...BREAKTHROUGH_QUOTES.map(q => ({ ...q, weight: 8 })));
   232→  }
   233→
   234→  if (hour >= 20 || dayOfWeek === 0 || dayOfWeek === 6) {
   235→    candidatePool.push(...REST_QUOTES.map(q => ({ ...q, weight: 5 })));
   236→  }
   237→
   238→  // 4. 默认池补充
   239→  candidatePool.push(...VISION_QUOTES.map(q => ({ ...q, weight: 3 })));
   240→  candidatePool.push(...SELF_AWARENESS_QUOTES.map(q => ({ ...q, weight: 3 })));
   241→
   242→  // 5. 加权随机选择（使用日期作为种子，同一天返回相同名言）
   243→  const seed = new Date().toDateString();
   244→  const totalWeight = candidatePool.reduce((sum, q) => sum + q.weight, 0);
   245→  const targetWeight = (hashCode(seed) % totalWeight + totalWeight) % totalWeight;
   246→
   247→  let cumulative = 0;
   248→  for (const quote of candidatePool) {
   249→    cumulative += quote.weight;
   250→    if (cumulative >= targetWeight) {
   251→      return { text: quote.text, author: quote.author };
   252→    }
   253→  }
   254→
   255→  return VISION_QUOTES[0];
   256→}
   257→
   258→function hashCode(str: string): number {
   259→  let hash = 0;
   260→  for (let i = 0; i < str.length; i++) {
   261→    hash = ((hash << 5) - hash) + str.charCodeAt(i);
   262→    hash |= 0;
   263→  }
   264→  return hash;
   265→}
   266→```
   267→
   268→---
   269→
   270→### 2. LifecoachCard (合并卡片)
   271→
   272→```
   273→┌─────────────────────────────────────────────────────────────────────────────────┐
   274→│                              LifecoachCard                                       │
   275→├─────────────────────────────────────────────────────────────────────────────────┤
   276→│                                                                                  │
   277→│   ┌──────────────────────────────────────────────────────────────────────────┐  │
   278→│   │                                                                          │  │
   279→│   │  🧭 LIFECOACH                                                            │  │
   280→│   │  ─────────────                                                           │  │
   281→│   │                                                                          │  │
   282→│   │  ⭐ 北极星: "{vision}"                                                   │  │
   283→│   │                                                                          │  │
   284→│   │  ┌──────────────────────────┐  ┌──────────────────────────┐             │  │
   285→│   │  │  📊 月度项目              │  │  ☀️ 今日杠杆              │             │  │
   286→│   │  │  {project_name}          │  │  □ {lever_1}              │             │  │
   287→│   │  │  ████████░░░░░░ {%}     │  │  □ {lever_2}              │             │  │
   288→│   │  │  还剩 {days} 天          │  │  □ {lever_3}              │             │  │
   289→│   │  │                          │  │  ────────────             │             │  │
   290→│   │  │                          │  │  进度: {done}/{total}     │             │  │
   291→│   │  └──────────────────────────┘  └──────────────────────────┘             │  │
   292→│   │                                                                          │  │
   293→│   │  📅 本周大石头 ({done}/{total})                                          │  │
   294→│   │  ┌────────────────────────────────────────────────────────────────────┐ │  │
   295→│   │  │ ✓ {rock_1}  │  ○ {rock_2}  │  ○ {rock_3}  │  ○ {rock_4}           │ │  │
   296→│   │  │  ({role})   │    ({role})  │    ({role})  │    ({role})           │ │  │
   297→│   │  └────────────────────────────────────────────────────────────────────┘ │  │
   298→│   │                                                                          │  │
   299→│   └──────────────────────────────────────────────────────────────────────────┘  │
   300→│                                                                                  │
   301→│   子组件:                                                                        │
   302→│   ├── NorthStarSection: 北极星愿景展示                                          │
   303→│   ├── MonthlyProgressSection: 月度项目 + 进度条                                 │
   304→│   │   └── ProgressBar: 进度条组件                                              │
   305→│   ├── TodayLeversSection: 今日杠杆行动列表                                      │
   306→│   │   └── LeverItem × n: 单个杠杆项                                            │
   307→│   └── WeekRocksSection: 本周大石头                                              │
   308→│       └── RockChip × n: 单个大石头标签                                          │
   309→│                                                                                  │
   310→│   交互:                                                                          │
   311→│   ├── 点击 LeverItem → 勾选/取消勾选                                           │
   312→│   ├── 点击 RockChip → 勾选/取消勾选                                            │
   313→│   └── 点击北极星 → 进入 Lifecoach 对话                                          │
   314→│                                                                                  │
   315→└─────────────────────────────────────────────────────────────────────────────────┘
   316→```
   317→
   318→**LeverItem 状态变体:**
   319→
   320→```
   321→未完成:                      已完成:
   322→┌────────────────────────┐   ┌────────────────────────┐
   323→│ □ 完成3.2节初稿         │   │ ☑ 完成3.2节初稿         │
   324→└────────────────────────┘   └────────────────────────┘
   325→  默认样式                      文字划线 + 淡化
   326→```
   327→
   328→**RockChip 状态变体:**
   329→
   330→```
   331→未完成:                      已完成:
   332→┌───────────────────┐        ┌───────────────────┐
   333→│ ○ 周三带孩子       │        │ ✓ 完成3.2节初稿    │
   334→│   (父亲)          │        │   (创作者)        │
   335→└───────────────────┘        └───────────────────┘
   336→  边框淡色                      边框绿色 + 背景淡绿
   337→```
   338→
   339→---
   340→
   341→### 3. SkillCarousel (My Skills)
   342→
   343→```
   344→┌─────────────────────────────────────────────────────────────────────────────────┐
   345→│                              SkillCarousel                                       │
   346→├─────────────────────────────────────────────────────────────────────────────────┤
   347→│                                                                                  │
   348→│   ┌──────────────────────────────────────────────────────────────────────────┐  │
   349→│   │                                                                          │  │
   350→│   │  🎯 MY SKILLS                                              ← 滑动 →     │  │
   351→│   │  ─────────────                                                           │  │
   352→│   │                                                                          │  │
   353→│   │  ┌───────────────────┐ ┌───────────────────┐ ┌───────────────────┐      │  │
   354→│   │  │                   │ │                   │ │                   │ ···  │  │
   355→│   │  │  🎭 荣格原型洞察   │ │  🌙 八字今日运势   │ │  ⭐ 星座能量       │      │  │
   356→│   │  │  ─────────────    │ │  ─────────────    │ │  ─────────────    │      │  │
   357→│   │  │                   │ │                   │ │                   │      │  │
   358→│   │  │  今日: 创造者     │ │  整体: ★★★★☆    │ │  水瓶座           │      │  │
   359→│   │  │                   │ │  事业: ★★★★★    │ │                   │      │  │
   360→│   │  │  💡 能量旺盛      │ │                   │ │  💫 灵感爆发日    │      │  │
   361→│   │  │                   │ │  宜: 创作、学习   │ │                   │      │  │
   362→│   │  │  ⚠️ 注意批评者    │ │  忌: 冲动消费     │ │                   │      │  │
   363→│   │  │                   │ │                   │ │                   │      │  │
   364→│   │  │ [与原型对话 →]   │ │ [查看详情 →]     │ │ [查看详情 →]     │      │  │
   365→│   │  │                   │ │                   │ │                   │      │  │
   366→│   │  └───────────────────┘ └───────────────────┘ └───────────────────┘      │  │
   367→│   │                                                                          │  │
   368→│   │                            ● ○ ○                                         │  │
   369→│   │                                                                          │  │
   370→│   └──────────────────────────────────────────────────────────────────────────┘  │
   371→│                                                                                  │
   372→│   子组件:                                                                        │
   373→│   ├── CarouselHeader: 标题 + 滑动提示                                          │
   374→│   ├── CarouselTrack: 横滑轨道容器                                              │
   375→│   │   └── SkillCard × n: 已订阅 Skill 卡片                                     │
   376→│   └── CarouselIndicator: 圆点指示器                                            │
   377→│                                                                                  │
   378→│   Props:                                                                         │
   379→│   ├── skills: SkillCardData[]                                                  │
   380→│   ├── onCardClick: (skillId: string) => void                                   │
   381→│   └── cardWidth: number (default 280)                                          │
   382→│                                                                                  │
   383→└─────────────────────────────────────────────────────────────────────────────────┘
   384→```
   385→
   386→**SkillCard 组件详图:**
   387→
   388→```
   389→┌─────────────────────────────────────────────────────────────────────────────────┐
   390→│                              SkillCard                                           │
   391→├─────────────────────────────────────────────────────────────────────────────────┤
   392→│                                                                                  │
   393→│   通用型 (荣格/塔罗等):                                                         │
   394→│   ┌───────────────────────────────┐                                            │
   395→│   │                               │                                            │
   396→│   │  🎭 荣格原型洞察               │  ← icon + title                            │
   397→│   │  ─────────────────────        │                                            │
   398→│   │                               │                                            │
   399→│   │  今日主导: 创造者              │  ← content.headline                        │
   400→│   │                               │                                            │
   401→│   │  💡 创意能量旺盛               │  ← content.insights[0]                     │
   402→│   │  适合完成创作性工作            │                                            │
   403→│   │                               │                                            │
   404→│   │  ⚠️ 注意内在批评者             │  ← content.insights[1]                     │
   405→│   │                               │                                            │
   406→│   │  ─────────────────────        │                                            │
   407→│   │                               │                                            │
   408→│   │  [ 与原型对话 → ]              │  ← actionLabel                             │
   409→│   │                               │                                            │
   410→│   └───────────────────────────────┘                                            │
   411→│                                                                                  │
   412→│   ─────────────────────────────────────────────────────────────────────────     │
   413→│                                                                                  │
   414→│   评分型 (八字/星座):                                                           │
   415→│   ┌───────────────────────────────┐                                            │
   416→│   │                               │                                            │
   417→│   │  🌙 八字今日运势               │                                            │
   418→│   │  ─────────────────────        │                                            │
   419→│   │                               │                                            │
   420→│   │  整体: ★★★★☆ 良好            │  ← content.rating.label                    │
   421→│   │  ─────────────────────        │                                            │
   422→│   │  事业: ★★★★★ 贵人相助        │  ← content.rating.details                  │
   423→│   │  感情: ★★★☆☆ 平稳            │                                            │
   424→│   │  健康: ★★★★☆ 稳定            │                                            │
   425→│   │  ─────────────────────        │                                            │
   426→│   │  宜: 创作、学习、见客户       │  ← content.suggestions.do                  │
   427→│   │  忌: 冲动消费、情绪决策       │  ← content.suggestions.avoid               │
   428→│   │                               │                                            │
   429→│   │  [ 查看详情 → ]               │                                            │
   430→│   │                               │                                            │
   431→│   └───────────────────────────────┘                                            │
   432→│                                                                                  │
   433→│   TypeScript 接口:                                                               │
   434→│   interface SkillCardProps {                                                     │
   435→│     skillId: string;                                                            │
   436→│     icon: string;                                                               │
   437→│     title: string;                                                              │
   438→│     content: SkillCardContent;                                                  │
   439→│     actionLabel: string;                                                        │
   440→│     actionRoute: string;                                                        │
   441→│     onClick?: () => void;                                                       │
   442→│   }                                                                             │
   443→│                                                                                  │
   444→└─────────────────────────────────────────────────────────────────────────────────┘
   445→```
   446→
   447→---
   448→
   449→### 4. DiscoverCarousel (发现更多)
   450→
   451→```
   452→┌─────────────────────────────────────────────────────────────────────────────────┐
   453→│                              DiscoverCarousel                                    │
   454→├─────────────────────────────────────────────────────────────────────────────────┤
   455→│                                                                                  │
   456→│   ┌──────────────────────────────────────────────────────────────────────────┐  │
   457→│   │                                                                          │  │
   458→│   │  ✨ 发现更多                                               ← 滑动 →     │  │
   459→│   │  ──────────                                                              │  │
   460→│   │                                                                          │  │
   461→│   │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐ ┌─────────┐│  │
   462→│   │  │                 │ │                 │ │                 │ │         ││  │
   463→│   │  │  🔮 塔罗        │ │  🧘 冥想        │ │  💰 财富        │ │  ❤️ 关系 ││  │
   464→│   │  │  ─────────      │ │  ─────────      │ │  ─────────      │ │ ─────── ││  │
   465→│   │  │  每日一牌       │ │  正念指导       │ │  理财建议       │ │ 亲密关系││  │
   466→│   │  │  洞察潜意识     │ │  减压放松       │ │  财务自由       │ │ 关系改善││  │
   467→│   │  │                 │ │                 │ │                 │ │         ││  │
   468→│   │  │  [ + 订阅 ]     │ │  [ + 订阅 ]     │ │  [ + 订阅 ]     │ │[+ 订阅] ││  │
   469→│   │  │                 │ │                 │ │                 │ │         ││  │
   470→│   │  └─────────────────┘ └─────────────────┘ └─────────────────┘ └─────────┘│  │
   471→│   │                                                                          │  │
   472→│   │                            ● ○ ○ ○                                       │  │
   473→│   │                                                                          │  │
   474→│   └──────────────────────────────────────────────────────────────────────────┘  │
   475→│                                                                                  │
   476→│   子组件:                                                                        │
   477→│   ├── CarouselHeader: 标题 + 滑动提示                                          │
   478→│   ├── CarouselTrack: 横滑轨道容器                                              │
   479→│   │   └── DiscoverCard × n: 未订阅 Skill 卡片                                  │
   480→│   └── CarouselIndicator: 圆点指示器                                            │
   481→│                                                                                  │
   482→└─────────────────────────────────────────────────────────────────────────────────┘
   483→```
   484→
   485→**DiscoverCard 组件详图:**
   486→
   487→```
   488→┌─────────────────────────────────────────────────────────────────────────────────┐
   489→│                              DiscoverCard                                        │
   490→├─────────────────────────────────────────────────────────────────────────────────┤
   491→│                                                                                  │
   492→│   ┌─────────────────────┐                                                       │
   493→│   │                     │                                                       │
   494→│   │  🔮 塔罗             │  ← icon + title                                       │
   495→│   │  ─────────────      │                                                       │
   496→│   │  每日一牌           │  ← tagline                                            │
   497→│   │  洞察潜意识         │  ← description                                        │
   498→│   │                     │                                                       │
   499→│   │  ─────────────      │                                                       │
   500→│   │                     │                                                       │
   501→│   │  [ + 订阅 ]         │  ← subscribe button                                   │
   502→│   │                     │                                                       │
   503→│   └─────────────────────┘                                                       │
   504→│                                                                                  │
   505→│   状态变体:                                                                      │
   506→│                                                                                  │
   507→│   Default:              Hover:                   Subscribing:                    │
   508→│   ┌─────────────┐       ┌─────────────┐         ┌─────────────┐                │
   509→│   │  🔮 塔罗    │       │  🔮 塔罗    │         │  🔮 塔罗    │                │
   510→│   │  ─────     │       │  ─────     │  scale  │  ─────     │                │
   511→│   │  每日一牌  │  ──▶  │  每日一牌  │  1.02   │  ⏳ 订阅中...│                │
   512→│   │            │       │            │         │            │                │
   513→│   │ [ + 订阅 ] │       │ [ + 订阅 ] │         │ [ ······ ] │                │
   514→│   └─────────────┘       └─────────────┘         └─────────────┘                │
   515→│     虚线边框              边框高亮                 加载状态                       │
   516→│                                                                                  │
   517→│   TypeScript 接口:                                                               │
   518→│   interface DiscoverCardProps {                                                  │
   519→│     skillId: string;                                                            │
   520→│     icon: string;                                                               │
   521→│     title: string;                                                              │
   522→│     tagline: string;                                                            │
   523→│     description: string;                                                        │
   524→│     onSubscribe: (skillId: string) => Promise<void>;                            │
   525→│   }                                                                             │
   526→│                                                                                  │
   527→└─────────────────────────────────────────────────────────────────────────────────┘
   528→```
   529→
   530→---
   531→
   532→### 5. CarouselTrack (通用横滑组件)
   533→
   534→```
   535→┌─────────────────────────────────────────────────────────────────────────────────┐
   536→│                              CarouselTrack                                       │
   537→├─────────────────────────────────────────────────────────────────────────────────┤
   538→│                                                                                  │
   539→│   ┌──────────────────────────────────────────────────────────────────────────┐  │
   540→│   │                                                                          │  │
   541→│   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐           │  │
   542→│   │  │         │ │         │ │         │ │         │ │         │ ···       │  │
   543→│   │  │ Card 1  │ │ Card 2  │ │ Card 3  │ │ Card 4  │ │ Card 5  │           │  │
   544→│   │  │         │ │         │ │         │ │         │ │         │           │  │
   545→│   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘           │  │
   546→│   │  ◀───────────────────── 可滑动区域 ─────────────────────▶               │  │
   547→│   │                                                                          │  │
   548→│   └──────────────────────────────────────────────────────────────────────────┘  │
   549→│                                                                                  │
   550→│   实现方式:                                                                      │
   551→│   ├── CSS: overflow-x: auto + scroll-snap-type: x mandatory                    │
   552→│   ├── 每个卡片: scroll-snap-align: start                                       │
   553→│   └── 隐藏滚动条: scrollbar-hide                                               │
   554→│                                                                                  │
   555→│   交互增强:                                                                      │
   556→│   ├── Touch: 原生滑动                                                          │
   557→│   ├── Mouse: 可拖拽 (optional)                                                 │
   558→│   └── 边缘提示: 下一张卡片露出 20px                                             │
   559→│                                                                                  │
   560→└─────────────────────────────────────────────────────────────────────────────────┘
   561→```
   562→
   563→**Tailwind 实现:**
   564→
   565→```tsx
   566→// src/components/dashboard/shared/CarouselTrack.tsx
   567→
   568→interface CarouselTrackProps {
   569→  children: React.ReactNode;
   570→  gap?: number;       // default 16
   571→  padding?: number;   // default 16
   572→  className?: string;
   573→}
   574→
   575→const CarouselTrack: React.FC<CarouselTrackProps> = ({
   576→  children,
   577→  gap = 16,
   578→  padding = 16,
   579→  className
   580→}) => {
   581→  return (
   582→    <div
   583→      className={cn(
   584→        "overflow-x-auto scrollbar-hide",
   585→        "snap-x snap-mandatory",
   586→        "-mx-4 px-4",  // 负边距 + 内边距实现边缘露出
   587→        className
   588→      )}
   589→      style={{
   590→        scrollPaddingLeft: padding,
   591→        scrollPaddingRight: padding
   592→      }}
   593→    >
   594→      <div
   595→        className="flex"
   596→        style={{ gap }}
   597→      >
   598→        {React.Children.map(children, (child) => (
   599→          <div className="flex-shrink-0 snap-start">
   600→            {child}
   601→          </div>
   602→        ))}
   603→      </div>
   604→    </div>
   605→  );
   606→};
   607→```
   608→
   609→---
   610→
   611→## 响应式布局矩阵
   612→
   613→```
   614→┌─────────────────────────────────────────────────────────────────────────────────┐
   615→│                              响应式断点                                          │
   616→├─────────────────────────────────────────────────────────────────────────────────┤
   617→│                                                                                  │
   618→│   Mobile (<640px)                                                                │
   619→│   ═══════════════                                                                │
   620→│                                                                                  │
   621→│   ┌─────────────────────────┐                                                   │
   622→│   │      AmbientHeader      │                                                   │
   623→│   ├─────────────────────────┤                                                   │
   624→│   │      LifecoachCard      │  ← 垂直布局 (月度 → 今日 → 本周)                  │
   625→│   ├─────────────────────────┤                                                   │
   626→│   │    SkillCarousel        │  ← 1.5 张可见                                     │
   627→│   ├─────────────────────────┤                                                   │
   628→│   │    DiscoverCarousel     │  ← 2.5 张可见                                     │
   629→│   ├─────────────────────────┤                                                   │
   630→│   │     MobileBottomNav     │                                                   │
   631→│   └─────────────────────────┘                                                   │
   632→│                                                                                  │
   633→│   Tablet (640px - 1024px)                                                        │
   634→│   ═══════════════════════════                                                    │
   635→│                                                                                  │
   636→│   ┌─────────────────────────────────────────────┐                               │
   637→│   │              AmbientHeader                  │                               │
   638→│   ├─────────────────────────────────────────────┤                               │
   639→│   │            LifecoachCard                    │  ← 2列布局 (月度|今日)         │
   640→│   ├─────────────────────────────────────────────┤                               │
   641→│   │          SkillCarousel                      │  ← 2 张可见                   │
   642→│   ├─────────────────────────────────────────────┤                               │
   643→│   │         DiscoverCarousel                    │  ← 3 张可见                   │
   644→│   └─────────────────────────────────────────────┘                               │
   645→│                                                                                  │
   646→│   Desktop (>1024px)                                                              │
   647→│   ═════════════════════                                                          │
   648→│                                                                                  │
   649→│   ┌─────────────────────────────────────────────────────────────────────────┐   │
   650→│   │                           AmbientHeader                                  │   │
   651→│   ├─────────────────────────────────────────────────────────────────────────┤   │
   652→│   │                          LifecoachCard                                   │   │
   653→│   │  ┌─────────────────────────────┬─────────────────────────────────────┐  │   │
   654→│   │  │        月度项目             │          今日杠杆                    │  │   │
   655→│   │  └─────────────────────────────┴─────────────────────────────────────┘  │   │
   656→│   │  ┌───────────────────────────────────────────────────────────────────┐  │   │
   657→│   │  │                         本周大石头                                 │  │   │
   658→│   │  └───────────────────────────────────────────────────────────────────┘  │   │
   659→│   ├─────────────────────────────────────────────────────────────────────────┤   │
   660→│   │                          SkillCarousel                                   │   │
   661→│   │  ← 3 张可见，右侧露出提示 →                                              │   │
   662→│   ├─────────────────────────────────────────────────────────────────────────┤   │
   663→│   │                         DiscoverCarousel                                 │   │
   664→│   │  ← 4 张可见，右侧露出提示 →                                              │   │
   665→│   └─────────────────────────────────────────────────────────────────────────┘   │
   666→│                                                                                  │
   667→└─────────────────────────────────────────────────────────────────────────────────┘
   668→```
   669→
   670→---
   671→
   672→## 动画规格
   673→
   674→```typescript
   675→// src/lib/dashboard/animations.ts
   676→
   677→export const animations = {
   678→  // 卡片入场
   679→  cardEnter: {
   680→    initial: { opacity: 0, y: 20 },
   681→    animate: { opacity: 1, y: 0 },
   682→    transition: { duration: 0.3, ease: [0.4, 0, 0.2, 1] }
   683→  },
   684→
   685→  // 卡片悬停
   686→  cardHover: {
   687→    scale: 1.02,
   688→    y: -2,
   689→    transition: { duration: 0.2, ease: "easeOut" }
   690→  },
   691→
   692→  // 签到动画
   693→  checkIn: {
   694→    scale: [1, 1.2, 1],
   695→    transition: { duration: 0.5, ease: "easeInOut" }
   696→  },
   697→
   698→  // 数字跳动
   699→  numberBounce: {
   700→    scale: [1, 1.3, 1],
   701→    transition: { duration: 0.3, ease: "easeOut" }
   702→  },
   703→
   704→  // 进度条填充
   705→  progressFill: {
   706→    initial: { scaleX: 0 },
   707→    animate: { scaleX: 1 },
   708→    transition: { duration: 0.8, ease: [0.4, 0, 0.2, 1] }
   709→  },
   710→
   711→  // 横滑吸附
   712→  snapScroll: {
   713→    transition: {
   714→      type: "spring",
   715→      stiffness: 300,
   716→      damping: 30
   717→    }
   718→  },
   719→
   720→  // 订阅成功
   721→  subscribeSuccess: {
   722→    scale: [1, 1.1, 1],
   723→    backgroundColor: ["#fff", "#dcfce7", "#fff"],
   724→    transition: { duration: 0.6 }
   725→  }
   726→};
   727→```
   728→
   729→**签到按钮动画序列:**
   730→
   731→```
   732→点击 "签到" 按钮:
   733→
   734→Frame 0 (0ms):        Frame 1 (100ms):      Frame 2 (300ms):      Frame 3 (500ms):
   735→┌─────────────┐       ┌─────────────┐       ┌─────────────┐       ┌─────────────┐
   736→│   [ 签到 ]  │  ──▶  │  ●          │  ──▶  │     ✨      │  ──▶  │   🔥 8天    │
   737→└─────────────┘       └─────────────┘       │   🔥 8天    │       │             │
   738→                      loading 动画           │     ✨      │       │   太棒了！  │
   739→                                            └─────────────┘       └─────────────┘
   740→                                            数字跳动 7→8          完成状态
   741→```
   742→
   743→---
   744→
   745→## 错误边界与降级
   746→
   747→```
   748→┌─────────────────────────────────────────────────────────────────────────────────┐
   749→│                              错误处理策略                                        │
   750→├─────────────────────────────────────────────────────────────────────────────────┤
   751→│                                                                                  │
   752→│   场景 1: 数据加载失败                                                           │
   753→│   ────────────────────                                                           │
   754→│                                                                                  │
   755→│   ┌──────────────────────────────────────────┐                                  │
   756→│   │                                          │                                  │
   757→│   │         ⚠️ 加载数据时出错                │                                  │
   758→│   │                                          │                                  │
   759→│   │         请稍后再试                        │                                  │
   760→│   │                                          │                                  │
   761→│   │         [ 重试 ]                         │                                  │
   762→│   │                                          │                                  │
   763→│   └──────────────────────────────────────────┘                                  │
   764→│                                                                                  │
   765→│   场景 2: Skill Card 加载失败                                                    │
   766→│   ────────────────────────                                                       │
   767→│                                                                                  │
   768→│   ┌───────────────────┐ ┌───────────────────┐ ┌───────────────────┐            │
   769→│   │                   │ │                   │ │                   │            │
   770→│   │  🎭 荣格原型       │ │  ⚠️ 加载失败       │ │  ⭐ 星座能量       │            │
   771→│   │  今日: 创造者     │ │                   │ │  水瓶座           │            │
   772→│   │  ...             │ │  [ 重试 ]         │ │  ...             │            │
   773→│   │                   │ │                   │ │                   │            │
   774→│   └───────────────────┘ └───────────────────┘ └───────────────────┘            │
   775→│                                                                                  │
   776→│   单个卡片失败不影响其他卡片                                                      │
   777→│                                                                                  │
   778→│   场景 3: 网络离线                                                               │
   779→│   ────────────────────                                                           │
   780→│                                                                                  │
   781→│   ┌─────────────────────────────────────────────────────────────────────────┐   │
   782→│   │  📶 当前离线 - 显示缓存数据                                              │   │
   783→│   └─────────────────────────────────────────────────────────────────────────┘   │
   784→│                                                                                  │
   785→│   使用 SWR 的 fallbackData 显示上次成功获取的数据                                │
   786→│                                                                                  │
   787→└─────────────────────────────────────────────────────────────────────────────────┘
   788→```
   789→
   790→---
   791→
   792→## Hooks
   793→
   794→```typescript
   795→// src/hooks/useDashboard.ts
   796→
   797→import useSWR from 'swr';
   798→
   799→export function useDashboard() {
   800→  const { data, error, isLoading, mutate } = useSWR<DashboardDTO>(
   801→    '/api/dashboard',
   802→    fetcher,
   803→    {
   804→      revalidateOnFocus: false,
   805→      dedupingInterval: 60000,
   806→    }
   807→  );
   808→
   809→  const checkIn = async () => {
   810→    // 乐观更新
   811→    mutate(
   812→      {
   813→        ...data!,
   814→        status: { ...data!.status, checkedIn: true, streak: data!.status.streak + 1 }
   815→      },
   816→      false
   817→    );
   818→
   819→    const result = await api.post('/api/dashboard/checkin');
   820→    mutate();
   821→    return result;
   822→  };
   823→
   824→  const toggleLever = async (leverId: string) => {
   825→    // 乐观更新
   826→    const newLevers = data!.lifecoach.todayLevers.map(l =>
   827→      l.id === leverId ? { ...l, completed: !l.completed } : l
   828→    );
   829→    mutate(
   830→      { ...data!, lifecoach: { ...data!.lifecoach, todayLevers: newLevers } },
   831→      false
   832→    );
   833→
   834→    await api.patch(`/api/dashboard/lever/${leverId}`);
   835→    mutate();
   836→  };
   837→
   838→  return {
   839→    data,
   840→    error,
   841→    isLoading,
   842→    checkIn,
   843→    toggleLever,
   844→  };
   845→}
   846→
   847→// src/hooks/useCarousel.ts
   848→
   849→export function useCarousel(itemCount: number) {
   850→  const [currentIndex, setCurrentIndex] = useState(0);
   851→  const containerRef = useRef<HTMLDivElement>(null);
   852→
   853→  const scrollTo = (index: number) => {
   854→    if (containerRef.current) {
   855→      const scrollLeft = index * (cardWidth + gap);
   856→      containerRef.current.scrollTo({ left: scrollLeft, behavior: 'smooth' });
   857→      setCurrentIndex(index);
   858→    }
   859→  };
   860→
   861→  const handleScroll = useCallback(() => {
   862→    if (containerRef.current) {
   863→      const index = Math.round(containerRef.current.scrollLeft / (cardWidth + gap));
   864→      setCurrentIndex(index);
   865→    }
   866→  }, []);
   867→
   868→  return {
   869→    containerRef,
   870→    currentIndex,
   871→    scrollTo,
   872→    handleScroll,
   873→  };
   874→}
   875→```
   876→
   877→---
   878→
   879→> **Version**: 2.0 | 2026-01-19
   880→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
