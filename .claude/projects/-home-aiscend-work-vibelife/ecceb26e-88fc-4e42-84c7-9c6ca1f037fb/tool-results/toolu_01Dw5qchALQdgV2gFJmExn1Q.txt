     1â†’import { NextResponse } from "next/server";
     2â†’import type { DashboardDTO, DashboardResponse } from "@/types/dashboard";
     3â†’
     4â†’/**
     5â†’ * Dashboard API Route - Mock Data
     6â†’ *
     7â†’ * TODO: Replace with actual backend proxy when backend endpoint is ready
     8â†’ */
     9â†’
    10â†’function getGreeting(): string {
    11â†’  const hour = new Date().getHours();
    12â†’  if (hour < 6) return "å¤œæ·±äº†";
    13â†’  if (hour < 12) return "æ—©ä¸Šå¥½";
    14â†’  if (hour < 18) return "ä¸‹åˆå¥½";
    15â†’  return "æ™šä¸Šå¥½";
    16â†’}
    17â†’
    18â†’function getTodayDate(): string {
    19â†’  return new Date().toLocaleDateString("zh-CN", {
    20â†’    year: "numeric",
    21â†’    month: "long",
    22â†’    day: "numeric",
    23â†’    weekday: "long",
    24â†’  });
    25â†’}
    26â†’
    27â†’const MOCK_DASHBOARD: DashboardDTO = {
    28â†’  userId: "mock-user",
    29â†’  generatedAt: new Date().toISOString(),
    30â†’
    31â†’  ambient: {
    32â†’    greeting: getGreeting(),
    33â†’    quote: {
    34â†’      text: "çŸ¥è¡Œåˆä¸€ï¼Œè‡´è‰¯çŸ¥",
    35â†’      author: "ç‹é˜³æ˜",
    36â†’    },
    37â†’    date: getTodayDate(),
    38â†’    solarTerm: "å¤§å¯’",
    39â†’  },
    40â†’
    41â†’  status: {
    42â†’    streak: 7,
    43â†’    checkedIn: false,
    44â†’    energy: 85,
    45â†’  },
    46â†’
    47â†’  lifecoach: {
    48â†’    northStar: "æˆä¸ºä¸€ä¸ªæœ‰å½±å“åŠ›çš„åˆ›ä½œè€…",
    49â†’    monthlyProject: {
    50â†’      name: "å®Œæˆä¸ªäººç½‘ç«™é‡æ„",
    51â†’      progress: 65,
    52â†’      daysRemaining: 11,
    53â†’    },
    54â†’    todayLevers: [
    55â†’      { id: "lever-1", text: "å®Œæˆ Dashboard ç»„ä»¶å¼€å‘", completed: false },
    56â†’      { id: "lever-2", text: "é˜…è¯» 30 åˆ†é’Ÿ", completed: true },
    57â†’      { id: "lever-3", text: "è¿åŠ¨ 20 åˆ†é’Ÿ", completed: false },
    58â†’    ],
    59â†’    weekRocks: [
    60â†’      { id: "rock-1", text: "å‘å¸ƒæ–°ç‰ˆæœ¬", role: "åˆ›ä½œè€…", completed: false },
    61â†’      { id: "rock-2", text: "å®¶åº­èšé¤", role: "å®¶äºº", completed: true },
    62â†’      { id: "rock-3", text: "å®Œæˆé¡¹ç›®ææ¡ˆ", role: "èŒåœºäºº", completed: false },
    63â†’    ],
    64â†’  },
    65â†’
    66â†’  mySkills: [
    67â†’    {
    68â†’      skillId: "bazi",
    69â†’      cardId: "bazi-daily",
    70â†’      title: "å…«å­—å‘½ç›˜",
    71â†’      icon: "ğŸŒŸ",
    72â†’      content: {
    73â†’        headline: "ä»Šæ—¥è¿åŠ¿ï¼šæœ¨æ°”æ—ºç››",
    74â†’        insights: [
    75â†’          "é€‚åˆå¤„ç†åˆ›æ„ç›¸å…³å·¥ä½œ",
    76â†’          "äººé™…å…³ç³»é¡ºç•…",
    77â†’          "è´¢è¿å¹³ç¨³",
    78â†’        ],
    79â†’        rating: {
    80â†’          overall: 4,
    81â†’          label: "å‰",
    82â†’          details: {
    83â†’            äº‹ä¸š: 5,
    84â†’            è´¢è¿: 4,
    85â†’            æ„Ÿæƒ…: 4,
    86â†’          },
    87â†’        },
    88â†’      },
    89â†’      computedAt: new Date().toISOString(),
    90â†’      actionLabel: "æŸ¥çœ‹è¯¦æƒ…",
    91â†’      actionRoute: "/chat?skill=bazi",
    92â†’    },
    93â†’  ],
    94â†’
    95â†’  discover: [
    96â†’    {
    97â†’      skillId: "tarot",
    98â†’      title: "å¡”ç½—å åœ",
    99â†’      icon: "ğŸƒ",
   100â†’      tagline: "æ¢ç´¢å‘½è¿çš„æŒ‡å¼•",
   101â†’      description: "é€šè¿‡å¡”ç½—ç‰Œè·å–æ™ºæ…§å¯ç¤ºï¼Œæ´å¯Ÿäººç”Ÿæ–¹å‘",
   102â†’    },
   103â†’    {
   104â†’      skillId: "zodiac",
   105â†’      title: "æ˜Ÿåº§è§£è¯»",
   106â†’      icon: "ğŸ”®",
   107â†’      tagline: "æ˜Ÿè±¡æŒ‡å¼•äººç”Ÿ",
   108â†’      description: "äº†è§£æ˜Ÿåº§è¿åŠ¿ï¼ŒæŠŠæ¡æœºé‡ä¸æŒ‘æˆ˜",
   109â†’    },
   110â†’  ],
   111â†’};
   112â†’
   113â†’// Performance: ç¼“å­˜ç­–ç•¥ - 60 ç§’å†…é‡ç”¨æ•°æ®
   114â†’let cachedData: DashboardResponse | null = null;
   115â†’let cacheTimestamp = 0;
   116â†’const CACHE_TTL = 60 * 1000; // 60 ç§’
   117â†’
   118â†’export async function GET() {
   119â†’  const now = Date.now();
   120â†’
   121â†’  // æ£€æŸ¥ç¼“å­˜æ˜¯å¦æœ‰æ•ˆ
   122â†’  if (cachedData && now - cacheTimestamp < CACHE_TTL) {
   123â†’    return NextResponse.json({
   124â†’      ...cachedData,
   125â†’      meta: {
   126â†’        cached: true,
   127â†’        generatedAt: cachedData.meta?.generatedAt ?? new Date().toISOString(),
   128â†’        cachedAt: new Date(cacheTimestamp).toISOString(),
   129â†’      },
   130â†’    });
   131â†’  }
   132â†’
   133â†’  // Simulate network delay (reduced from 300ms to 100ms)
   134â†’  await new Promise((resolve) => setTimeout(resolve, 100));
   135â†’
   136â†’  const response: DashboardResponse = {
   137â†’    success: true,
   138â†’    data: {
   139â†’      ...MOCK_DASHBOARD,
   140â†’      generatedAt: new Date().toISOString(),
   141â†’      ambient: {
   142â†’        ...MOCK_DASHBOARD.ambient,
   143â†’        greeting: getGreeting(),
   144â†’        date: getTodayDate(),
   145â†’      },
   146â†’    },
   147â†’    meta: {
   148â†’      cached: false,
   149â†’      generatedAt: new Date().toISOString(),
   150â†’    },
   151â†’  };
   152â†’
   153â†’  // æ›´æ–°ç¼“å­˜
   154â†’  cachedData = response;
   155â†’  cacheTimestamp = now;
   156â†’
   157â†’  return NextResponse.json(response);
   158â†’}
   159â†’
   160â†’// Next.js Route Segment Config - å¯ç”¨åŠ¨æ€æ¸²æŸ“ + çŸ­æœŸç¼“å­˜
   161â†’export const dynamic = 'force-dynamic';
   162â†’export const revalidate = 60; // 60 ç§’åé‡æ–°ç”Ÿæˆ
   163â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
