     1→# VibeProfile
     2→
     3→用户画像数据层，描述用户是谁（WHO）。属于 UserDataSpace 的核心组件。
     4→
     5→## 核心概念
     6→
     7→```
     8→UserDataSpace
     9→├── VibeProfile (WHO) ← 本文档
    10→│   └── unified_profiles.profile (JSONB)
    11→└── Operational (WHAT)
    12→    ├── conversations, messages
    13→    ├── reports, relationships
    14→    └── subscriptions, payments
    15→```
    16→
    17→## 快速开始
    18→
    19→```python
    20→from stores.vibe_profile_repo import VibeProfileRepository
    21→
    22→# 读取
    23→profile = await VibeProfileRepository.get_profile(user_id)
    24→goals = profile["life_context"]["goals"]
    25→
    26→# 写入
    27→await VibeProfileRepository.update_state(user_id, {"emotion": "content"})
    28→await VibeProfileRepository.add_goal(user_id, {"title": "学习英语", "category": "learning"})
    29→```
    30→
    31→## 数据结构
    32→
    33→```yaml
    34→profile:
    35→  account: { vibe_id, display_name, email, tier, status }
    36→  identity: { birth_info }
    37→  state: { emotion, focus, life_stage }
    38→  preferences:
    39→    voice_mode, language, push_enabled, push_hour
    40→    subscribed_skills: []
    41→    data_retention: { conversations: "1y" }  # 用户可选: 1y | 3y | forever
    42→  skill_data: { bazi, zodiac, tarot, career }
    43→  extracted: { facts, goals, concerns }
    44→  life_context:
    45→    occupation, focus_areas
    46→    goals: []      # 目标
    47→    tasks: []      # 任务
    48→    checkins: {}   # 打卡 (30天)
    49→    reminders: []  # 提醒
    50→```
    51→
    52→## Skill 访问规则
    53→
    54→| Skill | 可读 | 可写 |
    55→|-------|------|------|
    56→| core/lifecoach/mindfulness | 全部 | state, extracted, life_context |
    57→| bazi/zodiac/tarot/career | identity, state | 各自 skill_data |
    58→
    59→## 数据生命周期
    60→
    61→| 领域 | 默认 | 用户可选 |
    62→|------|------|---------|
    63→| VibeProfile | 永久 | checkins 30天 |
    64→| Conversations | 1年 | 1年/3年/永久 |
    65→| Billing | 7年 | 不可更改 |
    66→
    67→## 文档
    68→
    69→- [SPEC.md](./SPEC.md) - 完整设计
    70→- [ARCHITECTURE.md](./ARCHITECTURE.md) - 架构图
    71→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
