     1â†’/**
     2â†’ * QuestionCard - é—®ç­”å¡ç‰‡
     3â†’ *
     4â†’ * ç”¨äº ask_user_question å·¥å…·ï¼Œæ”¯æŒé€‰é¡¹é€‰æ‹©å’Œè‡ªç”±æ–‡æœ¬è¾“å…¥
     5â†’ * card_type: "question_card"
     6â†’ */
     7â†’
     8â†’"use client";
     9â†’
    10â†’import { useState } from "react";
    11â†’import { motion } from "framer-motion";
    12â†’import { registerCard } from "@/skills/CardRegistry";
    13â†’
    14â†’interface QuestionCardProps {
    15â†’  data: {
    16â†’    question: string;
    17â†’    options?: string[];
    18â†’    placeholder?: string;
    19â†’    allowFreeText?: boolean;
    20â†’  };
    21â†’  onSubmit?: (answer: string) => void;
    22â†’}
    23â†’
    24â†’function QuestionCard({ data, onSubmit }: QuestionCardProps) {
    25â†’  const { question, options = [], placeholder = "è¾“å…¥ä½ çš„å›ç­”...", allowFreeText = true } = data;
    26â†’  const [selectedOption, setSelectedOption] = useState<string | null>(null);
    27â†’  const [freeText, setFreeText] = useState("");
    28â†’  const [showFreeText, setShowFreeText] = useState(false);
    29â†’  const [submitted, setSubmitted] = useState(false);
    30â†’
    31â†’  const handleOptionClick = (option: string) => {
    32â†’    if (submitted) return;
    33â†’    setSelectedOption(option);
    34â†’    setShowFreeText(false);
    35â†’  };
    36â†’
    37â†’  const handleSubmit = () => {
    38â†’    if (submitted) return;
    39â†’
    40â†’    const answer = showFreeText ? freeText : selectedOption;
    41â†’    if (!answer) return;
    42â†’
    43â†’    setSubmitted(true);
    44â†’    onSubmit?.(answer);
    45â†’  };
    46â†’
    47â†’  const handleFreeTextToggle = () => {
    48â†’    setShowFreeText(true);
    49â†’    setSelectedOption(null);
    50â†’  };
    51â†’
    52â†’  if (!question) return null;
    53â†’
    54â†’  return (
    55â†’    <motion.div
    56â†’      initial={{ opacity: 0, y: 20 }}
    57â†’      animate={{ opacity: 1, y: 0 }}
    58â†’      transition={{ duration: 0.4 }}
    59â†’      className="question-card bg-gradient-to-br from-indigo-50 to-purple-50 dark:from-slate-800 dark:to-indigo-900 rounded-xl border border-indigo-200 dark:border-indigo-500/30 p-4 my-2"
    60â†’    >
    61â†’      {/* Question */}
    62â†’      <div className="flex items-start gap-2 mb-4">
    63â†’        <span className="text-xl">ğŸ’¬</span>
    64â†’        <p className="text-base font-medium text-gray-800 dark:text-white leading-relaxed">
    65â†’          {question}
    66â†’        </p>
    67â†’      </div>
    68â†’
    69â†’      {/* Options */}
    70â†’      {options.length > 0 && !submitted && (
    71â†’        <div className="space-y-2 mb-4">
    72â†’          {options.map((option, index) => (
    73â†’            <motion.button
    74â†’              key={index}
    75â†’              initial={{ opacity: 0, x: -10 }}
    76â†’              animate={{ opacity: 1, x: 0 }}
    77â†’              transition={{ delay: index * 0.1 }}
    78â†’              onClick={() => handleOptionClick(option)}
    79â†’              className={`w-full text-left px-4 py-3 rounded-lg border transition-all ${
    80â†’                selectedOption === option
    81â†’                  ? "bg-indigo-500 text-white border-indigo-500"
    82â†’                  : "bg-white dark:bg-slate-700 text-gray-700 dark:text-gray-200 border-gray-200 dark:border-slate-600 hover:border-indigo-300 dark:hover:border-indigo-500"
    83â†’              }`}
    84â†’            >
    85â†’              <span className="flex items-center gap-2">
    86â†’                <span className={`w-5 h-5 rounded-full border-2 flex items-center justify-center ${
    87â†’                  selectedOption === option
    88â†’                    ? "border-white bg-white"
    89â†’                    : "border-gray-300 dark:border-gray-500"
    90â†’                }`}>
    91â†’                  {selectedOption === option && (
    92â†’                    <span className="w-2.5 h-2.5 rounded-full bg-indigo-500" />
    93â†’                  )}
    94â†’                </span>
    95â†’                {option}
    96â†’              </span>
    97â†’            </motion.button>
    98â†’          ))}
    99â†’
   100â†’          {/* Free text option */}
   101â†’          {allowFreeText && (
   102â†’            <motion.button
   103â†’              initial={{ opacity: 0, x: -10 }}
   104â†’              animate={{ opacity: 1, x: 0 }}
   105â†’              transition={{ delay: options.length * 0.1 }}
   106â†’              onClick={handleFreeTextToggle}
   107â†’              className={`w-full text-left px-4 py-3 rounded-lg border transition-all ${
   108â†’                showFreeText
   109â†’                  ? "bg-indigo-500 text-white border-indigo-500"
   110â†’                  : "bg-white dark:bg-slate-700 text-gray-500 dark:text-gray-400 border-gray-200 dark:border-slate-600 hover:border-indigo-300 dark:hover:border-indigo-500"
   111â†’              }`}
   112â†’            >
   113â†’              <span className="flex items-center gap-2">
   114â†’                <span className="text-lg">âœï¸</span>
   115â†’                è‡ªå·±è¾“å…¥...
   116â†’              </span>
   117â†’            </motion.button>
   118â†’          )}
   119â†’        </div>
   120â†’      )}
   121â†’
   122â†’      {/* Free text input */}
   123â†’      {showFreeText && !submitted && (
   124â†’        <motion.div
   125â†’          initial={{ opacity: 0, height: 0 }}
   126â†’          animate={{ opacity: 1, height: "auto" }}
   127â†’          className="mb-4"
   128â†’        >
   129â†’          <textarea
   130â†’            value={freeText}
   131â†’            onChange={(e) => setFreeText(e.target.value)}
   132â†’            placeholder={placeholder}
   133â†’            className="w-full px-4 py-3 rounded-lg border border-gray-200 dark:border-slate-600 bg-white dark:bg-slate-700 text-gray-800 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none"
   134â†’            rows={3}
   135â†’            autoFocus
   136â†’          />
   137â†’        </motion.div>
   138â†’      )}
   139â†’
   140â†’      {/* Submit button */}
   141â†’      {!submitted && (selectedOption || (showFreeText && freeText.trim())) && (
   142â†’        <motion.button
   143â†’          initial={{ opacity: 0, y: 10 }}
   144â†’          animate={{ opacity: 1, y: 0 }}
   145â†’          onClick={handleSubmit}
   146â†’          className="w-full py-3 rounded-lg bg-indigo-500 hover:bg-indigo-600 text-white font-medium transition-colors"
   147â†’        >
   148â†’          ç¡®è®¤
   149â†’        </motion.button>
   150â†’      )}
   151â†’
   152â†’      {/* Submitted state */}
   153â†’      {submitted && (
   154â†’        <motion.div
   155â†’          initial={{ opacity: 0 }}
   156â†’          animate={{ opacity: 1 }}
   157â†’          className="flex items-center gap-2 text-green-600 dark:text-green-400"
   158â†’        >
   159â†’          <span>âœ“</span>
   160â†’          <span>å·²æäº¤: {showFreeText ? freeText : selectedOption}</span>
   161â†’        </motion.div>
   162â†’      )}
   163â†’    </motion.div>
   164â†’  );
   165â†’}
   166â†’
   167â†’registerCard("question_card", QuestionCard);
   168â†’
   169â†’export default QuestionCard;
   170â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
