     1â†’/**
     2â†’ * ZodiacChartCard - æ˜Ÿç›˜å¡ç‰‡
     3â†’ *
     4â†’ * ä» show-zodiac-chart.tsx æå–çš„çº¯æ¸²æŸ“ç»„ä»¶
     5â†’ * é€šè¿‡ CardRegistry æ³¨å†Œï¼Œç”± card_type: "zodiac_chart" è§¦å‘
     6â†’ */
     7â†’
     8â†’"use client";
     9â†’
    10â†’import { useState, useRef } from "react";
    11â†’import { useRouter } from "next/navigation";
    12â†’import { History, Share2, Image as ImageIcon, Link2 } from "lucide-react";
    13â†’import { registerCard } from "@/skills/CardRegistry";
    14â†’import { useImageShare } from "@/hooks/useImageShare";
    15â†’
    16â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    17â†’// Types
    18â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    19â†’
    20â†’interface PlanetPosition {
    21â†’  planet: string;
    22â†’  sign: string;
    23â†’  degree: number;
    24â†’  house: number;
    25â†’  retrograde?: boolean;
    26â†’}
    27â†’
    28â†’interface Aspect {
    29â†’  planet1: string;
    30â†’  planet2: string;
    31â†’  type: string;
    32â†’  orb: number;
    33â†’}
    34â†’
    35â†’interface ZodiacChartData {
    36â†’  userId?: string;
    37â†’  birthInfo?: { date?: string; time?: string; place?: string };
    38â†’  birth_info?: { date?: string; time?: string; place?: string };
    39â†’  sunSign?: string;
    40â†’  sun_sign?: string;
    41â†’  moonSign?: string;
    42â†’  moon_sign?: string;
    43â†’  risingSign?: string;
    44â†’  rising_sign?: string;
    45â†’  planets?: PlanetPosition[];
    46â†’  aspects?: Aspect[];
    47â†’  dominantElement?: string;
    48â†’  dominant_element?: string;
    49â†’  dominantModality?: string;
    50â†’  dominant_modality?: string;
    51â†’}
    52â†’
    53â†’interface ZodiacChartCardProps {
    54â†’  data: ZodiacChartData;
    55â†’  cardProps?: Record<string, unknown>;
    56â†’}
    57â†’
    58â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    59â†’// Constants
    60â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    61â†’
    62â†’// è¡Œæ˜Ÿä¸­æ–‡åæ˜ å°„ï¼ˆæ”¯æŒå„ç§æ ¼å¼ï¼‰
    63â†’const PLANET_CN: Record<string, string> = {
    64â†’  sun: "å¤ªé˜³", Sun: "å¤ªé˜³", å¤ªé˜³: "å¤ªé˜³",
    65â†’  moon: "æœˆäº®", Moon: "æœˆäº®", æœˆäº®: "æœˆäº®",
    66â†’  mercury: "æ°´æ˜Ÿ", Mercury: "æ°´æ˜Ÿ", æ°´æ˜Ÿ: "æ°´æ˜Ÿ",
    67â†’  venus: "é‡‘æ˜Ÿ", Venus: "é‡‘æ˜Ÿ", é‡‘æ˜Ÿ: "é‡‘æ˜Ÿ",
    68â†’  mars: "ç«æ˜Ÿ", Mars: "ç«æ˜Ÿ", ç«æ˜Ÿ: "ç«æ˜Ÿ",
    69â†’  jupiter: "æœ¨æ˜Ÿ", Jupiter: "æœ¨æ˜Ÿ", æœ¨æ˜Ÿ: "æœ¨æ˜Ÿ",
    70â†’  saturn: "åœŸæ˜Ÿ", Saturn: "åœŸæ˜Ÿ", åœŸæ˜Ÿ: "åœŸæ˜Ÿ",
    71â†’  uranus: "å¤©ç‹æ˜Ÿ", Uranus: "å¤©ç‹æ˜Ÿ", å¤©ç‹æ˜Ÿ: "å¤©ç‹æ˜Ÿ",
    72â†’  neptune: "æµ·ç‹æ˜Ÿ", Neptune: "æµ·ç‹æ˜Ÿ", æµ·ç‹æ˜Ÿ: "æµ·ç‹æ˜Ÿ",
    73â†’  pluto: "å†¥ç‹æ˜Ÿ", Pluto: "å†¥ç‹æ˜Ÿ", å†¥ç‹æ˜Ÿ: "å†¥ç‹æ˜Ÿ",
    74â†’};
    75â†’
    76â†’// æ˜Ÿåº§ä¸­æ–‡åæ˜ å°„ï¼ˆæ”¯æŒå„ç§æ ¼å¼ï¼‰
    77â†’const SIGN_CN: Record<string, string> = {
    78â†’  aries: "ç™½ç¾Šåº§", Aries: "ç™½ç¾Šåº§", ç™½ç¾Šåº§: "ç™½ç¾Šåº§",
    79â†’  taurus: "é‡‘ç‰›åº§", Taurus: "é‡‘ç‰›åº§", é‡‘ç‰›åº§: "é‡‘ç‰›åº§",
    80â†’  gemini: "åŒå­åº§", Gemini: "åŒå­åº§", åŒå­åº§: "åŒå­åº§",
    81â†’  cancer: "å·¨èŸ¹åº§", Cancer: "å·¨èŸ¹åº§", å·¨èŸ¹åº§: "å·¨èŸ¹åº§",
    82â†’  leo: "ç‹®å­åº§", Leo: "ç‹®å­åº§", ç‹®å­åº§: "ç‹®å­åº§",
    83â†’  virgo: "å¤„å¥³åº§", Virgo: "å¤„å¥³åº§", å¤„å¥³åº§: "å¤„å¥³åº§",
    84â†’  libra: "å¤©ç§¤åº§", Libra: "å¤©ç§¤åº§", å¤©ç§¤åº§: "å¤©ç§¤åº§",
    85â†’  scorpio: "å¤©èåº§", Scorpio: "å¤©èåº§", å¤©èåº§: "å¤©èåº§",
    86â†’  sagittarius: "å°„æ‰‹åº§", Sagittarius: "å°„æ‰‹åº§", å°„æ‰‹åº§: "å°„æ‰‹åº§",
    87â†’  capricorn: "æ‘©ç¾¯åº§", Capricorn: "æ‘©ç¾¯åº§", æ‘©ç¾¯åº§: "æ‘©ç¾¯åº§",
    88â†’  aquarius: "æ°´ç“¶åº§", Aquarius: "æ°´ç“¶åº§", æ°´ç“¶åº§: "æ°´ç“¶åº§",
    89â†’  pisces: "åŒé±¼åº§", Pisces: "åŒé±¼åº§", åŒé±¼åº§: "åŒé±¼åº§",
    90â†’};
    91â†’
    92â†’// å…ƒç´ ä¸­æ–‡åæ˜ å°„
    93â†’const ELEMENT_CN: Record<string, string> = {
    94â†’  fire: "ç«", Fire: "ç«", ç«: "ç«",
    95â†’  earth: "åœŸ", Earth: "åœŸ", åœŸ: "åœŸ",
    96â†’  air: "é£", Air: "é£", é£: "é£",
    97â†’  water: "æ°´", Water: "æ°´", æ°´: "æ°´",
    98â†’};
    99â†’
   100â†’// æ¨¡å¼ä¸­æ–‡åæ˜ å°„
   101â†’const MODALITY_CN: Record<string, string> = {
   102â†’  cardinal: "å¼€åˆ›", Cardinal: "å¼€åˆ›", å¼€åˆ›: "å¼€åˆ›",
   103â†’  fixed: "å›ºå®š", Fixed: "å›ºå®š", å›ºå®š: "å›ºå®š",
   104â†’  mutable: "å˜åŠ¨", Mutable: "å˜åŠ¨", å˜åŠ¨: "å˜åŠ¨",
   105â†’};
   106â†’
   107â†’const PLANET_SYMBOLS: Record<string, string> = {
   108â†’  å¤ªé˜³: "â˜€ï¸", æœˆäº®: "ğŸŒ™", æ°´æ˜Ÿ: "â˜¿", é‡‘æ˜Ÿ: "â™€", ç«æ˜Ÿ: "â™‚",
   109â†’  æœ¨æ˜Ÿ: "â™ƒ", åœŸæ˜Ÿ: "â™„", å¤©ç‹æ˜Ÿ: "â™…", æµ·ç‹æ˜Ÿ: "â™†", å†¥ç‹æ˜Ÿ: "â™‡",
   110â†’};
   111â†’
   112â†’const SIGN_EMOJI: Record<string, string> = {
   113â†’  ç™½ç¾Šåº§: "â™ˆ", é‡‘ç‰›åº§: "â™‰", åŒå­åº§: "â™Š", å·¨èŸ¹åº§: "â™‹",
   114â†’  ç‹®å­åº§: "â™Œ", å¤„å¥³åº§: "â™", å¤©ç§¤åº§: "â™", å¤©èåº§: "â™",
   115â†’  å°„æ‰‹åº§: "â™", æ‘©ç¾¯åº§: "â™‘", æ°´ç“¶åº§: "â™’", åŒé±¼åº§: "â™“",
   116â†’};
   117â†’
   118â†’const ELEMENT_EMOJI: Record<string, string> = {
   119â†’  ç«: "ğŸ”¥", åœŸ: "ğŸŒ", é£: "ğŸ’¨", æ°´: "ğŸ’§",
   120â†’};
   121â†’
   122â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   123â†’// Helpers
   124â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   125â†’
   126â†’function getSignElement(sign: string): string | null {
   127â†’  // å…ˆè½¬æ¢ä¸ºä¸­æ–‡æ˜Ÿåº§å
   128â†’  const signCn = SIGN_CN[sign] || sign;
   129â†’
   130â†’  const fireSign = ["ç™½ç¾Šåº§", "ç‹®å­åº§", "å°„æ‰‹åº§"];
   131â†’  const earthSign = ["é‡‘ç‰›åº§", "å¤„å¥³åº§", "æ‘©ç¾¯åº§"];
   132â†’  const airSign = ["åŒå­åº§", "å¤©ç§¤åº§", "æ°´ç“¶åº§"];
   133â†’  const waterSign = ["å·¨èŸ¹åº§", "å¤©èåº§", "åŒé±¼åº§"];
   134â†’
   135â†’  if (fireSign.includes(signCn)) return "ç«";
   136â†’  if (earthSign.includes(signCn)) return "åœŸ";
   137â†’  if (airSign.includes(signCn)) return "é£";
   138â†’  if (waterSign.includes(signCn)) return "æ°´";
   139â†’  return null;
   140â†’}
   141â†’
   142â†’function getElementBarColor(element: string): string {
   143â†’  const colors: Record<string, string> = {
   144â†’    ç«: "#ef4444", åœŸ: "#eab308", é£: "#0ea5e9", æ°´: "#3b82f6",
   145â†’  };
   146â†’  return colors[element] || "#888";
   147â†’}
   148â†’
   149â†’function getElementStyle(element: string): string {
   150â†’  const styles: Record<string, string> = {
   151â†’    ç«: "bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300",
   152â†’    åœŸ: "bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300",
   153â†’    é£: "bg-sky-100 dark:bg-sky-900/30 text-sky-700 dark:text-sky-300",
   154â†’    æ°´: "bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",
   155â†’  };
   156â†’  return styles[element] || "bg-muted";
   157â†’}
   158â†’
   159â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   160â†’// Component
   161â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   162â†’
   163â†’function ZodiacChartCard({ data }: ZodiacChartCardProps) {
   164â†’  const [expandedPlanet, setExpandedPlanet] = useState<string | null>(null);
   165â†’  const [showShareMenu, setShowShareMenu] = useState(false);
   166â†’  const router = useRouter();
   167â†’  const cardRef = useRef<HTMLDivElement>(null);
   168â†’  const { openScreenshotMode, captureElement, downloadImage, state: imageState } = useImageShare();
   169â†’
   170â†’  // å…¼å®¹ snake_case å’Œ camelCaseï¼Œå¹¶è½¬æ¢ä¸ºä¸­æ–‡
   171â†’  const birthInfo = data.birthInfo || data.birth_info || {};
   172â†’  const sunSign = SIGN_CN[data.sunSign || data.sun_sign || ""] || data.sunSign || data.sun_sign || "";
   173â†’  const moonSign = SIGN_CN[data.moonSign || data.moon_sign || ""] || data.moonSign || data.moon_sign || "";
   174â†’  const risingSign = SIGN_CN[data.risingSign || data.rising_sign || ""] || data.risingSign || data.rising_sign || "";
   175â†’  const planets = data.planets || [];
   176â†’  const aspects = data.aspects || [];
   177â†’  const dominantElement = ELEMENT_CN[data.dominantElement || data.dominant_element || ""] || data.dominantElement || data.dominant_element || "";
   178â†’  const dominantModality = MODALITY_CN[data.dominantModality || data.dominant_modality || ""] || data.dominantModality || data.dominant_modality || "";
   179â†’
   180â†’  // è®¡ç®—å…ƒç´ åˆ†å¸ƒ
   181â†’  const elementCounts = planets.reduce((acc, p) => {
   182â†’    const element = getSignElement(p.sign);
   183â†’    if (element) {
   184â†’      acc[element] = (acc[element] || 0) + 1;
   185â†’    }
   186â†’    return acc;
   187â†’  }, {} as Record<string, number>);
   188â†’
   189â†’  const totalPlanets = Object.values(elementCounts).reduce((sum, val) => sum + val, 0) || 1;
   190â†’
   191â†’  const handleImageShare = async () => {
   192â†’    if (!cardRef.current) return;
   193â†’
   194â†’    // Try to capture and download
   195â†’    const blob = await captureElement(cardRef.current);
   196â†’    if (blob) {
   197â†’      downloadImage(blob, `æ˜Ÿç›˜åˆ†æ_${sunSign}_${new Date().toISOString().slice(0,10)}.png`);
   198â†’    } else {
   199â†’      // Fallback to screenshot mode
   200â†’      openScreenshotMode(cardRef.current);
   201â†’    }
   202â†’    setShowShareMenu(false);
   203â†’  };
   204â†’
   205â†’  const handleLinkShare = async () => {
   206â†’    // For now, just copy the current URL
   207â†’    // In the future, this could create a share link through the API
   208â†’    try {
   209â†’      await navigator.clipboard.writeText(window.location.href);
   210â†’      alert('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
   211â†’    } catch {
   212â†’      alert('å¤åˆ¶é“¾æ¥å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶æµè§ˆå™¨åœ°å€æ ä¸­çš„é“¾æ¥');
   213â†’    }
   214â†’    setShowShareMenu(false);
   215â†’  };
   216â†’
   217â†’  return (
   218â†’    <div ref={cardRef} className="zodiac-chart-card bg-gradient-to-br from-orange-50/80 to-amber-50/60 dark:from-orange-950/20 dark:to-amber-950/20 rounded-2xl border border-orange-100 dark:border-orange-900/50 p-5 my-2 overflow-hidden animate-fade-in shadow-[var(--shadow-card)]">
   219â†’      {/* Header */}
   220â†’      <div className="flex items-center justify-between mb-4">
   221â†’        <h3 className="text-lg font-semibold text-text-primary flex items-center gap-2">
   222â†’          <span>âœ¨</span>
   223â†’          <span>æœ¬å‘½æ˜Ÿç›˜</span>
   224â†’        </h3>
   225â†’        <span className="text-sm text-text-secondary">
   226â†’          {birthInfo.date || ""}
   227â†’        </span>
   228â†’      </div>
   229â†’
   230â†’      {/* Big Three */}
   231â†’      <div className="grid grid-cols-3 gap-3 mb-4">
   232â†’        {[
   233â†’          { label: "å¤ªé˜³", sign: sunSign, icon: "â˜€ï¸" },
   234â†’          { label: "æœˆäº®", sign: moonSign, icon: "ğŸŒ™" },
   235â†’          { label: "ä¸Šå‡", sign: risingSign, icon: "â¬†ï¸" },
   236â†’        ].map((item) => (
   237â†’          <div
   238â†’            key={item.label}
   239â†’            className="text-center p-3 bg-white/60 dark:bg-black/30 rounded-lg cursor-pointer hover:bg-white/80 dark:hover:bg-black/40 transition-all"
   240â†’          >
   241â†’            <div className="text-xs text-muted-foreground mb-1">{item.icon} {item.label}</div>
   242â†’            <div className="text-2xl font-medium">{SIGN_EMOJI[item.sign] || "â˜…"}</div>
   243â†’            <div className="text-sm font-medium">{item.sign}</div>
   244â†’          </div>
   245â†’        ))}
   246â†’      </div>
   247â†’
   248â†’      {/* Planets */}
   249â†’      <div className="bg-white/40 dark:bg-black/20 rounded-lg p-3 mb-3">
   250â†’        <div className="text-sm font-medium mb-2">è¡Œæ˜Ÿåˆ†å¸ƒ</div>
   251â†’        <div className="space-y-1">
   252â†’          {planets.slice(0, 10).map((planet) => {
   253â†’            const isExpanded = expandedPlanet === planet.planet;
   254â†’            const planetAspects = aspects.filter(
   255â†’              a => a.planet1 === planet.planet || a.planet2 === planet.planet
   256â†’            );
   257â†’            // è½¬æ¢ä¸ºä¸­æ–‡æ˜¾ç¤º
   258â†’            const planetCn = PLANET_CN[planet.planet] || planet.planet;
   259â†’            const signCn = SIGN_CN[planet.sign] || planet.sign;
   260â†’
   261â†’            return (
   262â†’              <div key={planet.planet}>
   263â†’                <div
   264â†’                  onClick={() => setExpandedPlanet(isExpanded ? null : planet.planet)}
   265â†’                  className={`flex items-center justify-between p-2 rounded-xl cursor-pointer transition-all ${
   266â†’                    isExpanded ? "bg-orange-100/80 dark:bg-orange-900/20" : "hover:bg-white/60 dark:hover:bg-black/30"
   267â†’                  }`}
   268â†’                >
   269â†’                  <div className="flex items-center gap-2">
   270â†’                    <span className="w-6 text-center">{PLANET_SYMBOLS[planetCn] || "â˜…"}</span>
   271â†’                    <span className="text-sm font-medium">{planetCn}</span>
   272â†’                  </div>
   273â†’                  <div className="flex items-center gap-2 text-sm">
   274â†’                    <span>{SIGN_EMOJI[signCn] || ""} {signCn}</span>
   275â†’                    <span className="text-muted-foreground">{planet.house}å®«</span>
   276â†’                    {planet.retrograde && <span className="text-orange-500 text-xs">â„</span>}
   277â†’                  </div>
   278â†’                </div>
   279â†’
   280â†’                {/* Expanded planet details */}
   281â†’                {isExpanded && planetAspects.length > 0 && (
   282â†’                  <div className="pl-8 pr-2 py-2 text-xs text-muted-foreground animate-fade-in">
   283â†’                    <div className="font-medium mb-1">ç›¸ä½å…³ç³»ï¼š</div>
   284â†’                    {planetAspects.slice(0, 3).map((aspect, i) => {
   285â†’                      const otherPlanet = aspect.planet1 === planet.planet ? aspect.planet2 : aspect.planet1;
   286â†’                      const otherPlanetCn = PLANET_CN[otherPlanet] || otherPlanet;
   287â†’                      return (
   288â†’                        <div key={i} className="flex items-center gap-1">
   289â†’                          <span>{aspect.type}</span>
   290â†’                          <span>{otherPlanetCn}</span>
   291â†’                          <span className="text-muted-foreground/50">({aspect.orb.toFixed(1)}Â°)</span>
   292â†’                        </div>
   293â†’                      );
   294â†’                    })}
   295â†’                  </div>
   296â†’                )}
   297â†’              </div>
   298â†’            );
   299â†’          })}
   300â†’        </div>
   301â†’      </div>
   302â†’
   303â†’      {/* Element Distribution */}
   304â†’      <div className="mb-3">
   305â†’        <div className="text-sm font-medium mb-2">å…ƒç´ åˆ†å¸ƒ</div>
   306â†’        <div className="grid grid-cols-4 gap-2">
   307â†’          {(["ç«", "åœŸ", "é£", "æ°´"] as const).map((element) => {
   308â†’            const count = elementCounts[element] || 0;
   309â†’            const percentage = Math.round((count / totalPlanets) * 100);
   310â†’            return (
   311â†’              <div key={element} className="text-center">
   312â†’                <div className="text-lg mb-1">{ELEMENT_EMOJI[element]}</div>
   313â†’                <div className="h-2 bg-white/50 dark:bg-black/20 rounded-full overflow-hidden">
   314â†’                  <div
   315â†’                    className="h-full rounded-full transition-all duration-500"
   316â†’                    style={{ width: `${percentage}%`, backgroundColor: getElementBarColor(element) }}
   317â†’                  />
   318â†’                </div>
   319â†’                <div className="text-xs text-muted-foreground mt-1">{percentage}%</div>
   320â†’              </div>
   321â†’            );
   322â†’          })}
   323â†’        </div>
   324â†’      </div>
   325â†’
   326â†’      {/* Dominant Element */}
   327â†’      <div className="flex items-center justify-between text-sm">
   328â†’        <div className="flex items-center gap-2">
   329â†’          <span className="text-muted-foreground">ä¸»å¯¼å…ƒç´ :</span>
   330â†’          <span className={`px-2 py-0.5 rounded ${getElementStyle(dominantElement)}`}>
   331â†’            {ELEMENT_EMOJI[dominantElement] || ""} {dominantElement}
   332â†’          </span>
   333â†’        </div>
   334â†’        {dominantModality && (
   335â†’          <div className="flex items-center gap-2">
   336â†’            <span className="text-muted-foreground">ä¸»å¯¼æ¨¡å¼:</span>
   337â†’            <span className="px-2 py-0.5 bg-orange-100 dark:bg-orange-900/20 rounded-lg text-[var(--accent-primary)]">
   338â†’              {dominantModality}
   339â†’            </span>
   340â†’          </div>
   341â†’        )}
   342â†’      </div>
   343â†’
   344â†’      {/* Hint */}
   345â†’      <div className="mt-3 text-xs text-center text-muted-foreground">
   346â†’        ğŸ’¡ ç‚¹å‡»è¡Œæ˜ŸæŸ¥çœ‹ç›¸ä½å…³ç³»
   347â†’      </div>
   348â†’
   349â†’      {/* Action Buttons */}
   350â†’      <div className="mt-4 pt-3 border-t border-orange-100 dark:border-orange-900/30 flex items-center justify-center gap-4">
   351â†’        <button
   352â†’          onClick={() => router.push('/zodiac/history')}
   353â†’          className="flex items-center gap-1.5 px-3 py-1.5 text-sm text-[var(--accent-primary)] hover:bg-orange-100 dark:hover:bg-orange-900/20 rounded-xl transition-colors"
   354â†’        >
   355â†’          <History className="w-4 h-4" />
   356â†’          <span>æŸ¥çœ‹å†å²</span>
   357â†’        </button>
   358â†’
   359â†’        {/* Share Dropdown */}
   360â†’        <div className="relative">
   361â†’          <button
   362â†’            onClick={() => setShowShareMenu(!showShareMenu)}
   363â†’            className="flex items-center gap-1.5 px-3 py-1.5 text-sm text-[var(--accent-primary)] hover:bg-orange-100 dark:hover:bg-orange-900/20 rounded-xl transition-colors"
   364â†’          >
   365â†’            <Share2 className="w-4 h-4" />
   366â†’            <span>åˆ†äº«</span>
   367â†’          </button>
   368â†’
   369â†’          {showShareMenu && (
   370â†’            <div className="absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-40 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-orange-100 dark:border-orange-900/50 overflow-hidden z-10 animate-fade-in">
   371â†’              <button
   372â†’                onClick={handleLinkShare}
   373â†’                className="w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors"
   374â†’              >
   375â†’                <Link2 className="w-4 h-4" />
   376â†’                <span>å¤åˆ¶é“¾æ¥</span>
   377â†’              </button>
   378â†’              <button
   379â†’                onClick={handleImageShare}
   380â†’                disabled={imageState.isGenerating}
   381â†’                className="w-full flex items-center gap-2 px-3 py-2 text-sm hover:bg-orange-50 dark:hover:bg-orange-900/20 transition-colors disabled:opacity-50"
   382â†’              >
   383â†’                <ImageIcon className="w-4 h-4" />
   384â†’                <span>{imageState.isGenerating ? 'ç”Ÿæˆä¸­â€¦' : 'ä¿å­˜å›¾ç‰‡'}</span>
   385â†’              </button>
   386â†’            </div>
   387â†’          )}
   388â†’        </div>
   389â†’      </div>
   390â†’    </div>
   391â†’  );
   392â†’}
   393â†’
   394â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   395â†’// Register to CardRegistry
   396â†’// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   397â†’
   398â†’registerCard("zodiac_chart", ZodiacChartCard);
   399â†’
   400â†’export default ZodiacChartCard;
   401â†’

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
