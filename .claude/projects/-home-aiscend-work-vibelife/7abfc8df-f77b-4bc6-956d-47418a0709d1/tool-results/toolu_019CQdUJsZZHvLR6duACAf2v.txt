The file /home/aiscend/work/vibelife/docs/archive/v9/LLM_DRIVEN_ARCHITECTURE.md has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
   703→**时间**：3 天
   704→
   705→---
   706→
   707→## 10. Profile 注入（三层架构 v3.0）
   708→
   709→### 10.1 设计原则
   710→
   711→**核心理念**：Identity + Skills + Vibe 三层架构
   712→
   713→```
   714→┌─────────────────────────────────────────────────────────────┐
   715→│                  Profile 注入架构                            │
   716→├─────────────────────────────────────────────────────────────┤
   717→│                                                             │
   718→│  Layer 1: Identity（所有 Skill 共享，~200 tokens）          │
   719→│  ───────────────────────────────────────────────────────    │
   720→│  • identity.birth_info（如有）                               │
   721→│  • identity.display_name                                    │
   722→│                                                             │
   723→│  Layer 2: Skills（当前 Skill 专属，~300 tokens）            │
   724→│  ───────────────────────────────────────────────────────    │
   725→│  • skills.{skill_id}                                        │
   726→│    - bazi → skills.bazi                                     │
   727→│    - zodiac → skills.zodiac                                 │
   728→│    - lifecoach → skills.lifecoach                           │
   729→│                                                             │
   730→│  Layer 3: Vibe（共享深度信息，~200 tokens）                  │
   731→│  ───────────────────────────────────────────────────────    │
   732→│  • vibe.insight（我是谁：本质+动态+规律）                    │
   733→│  • vibe.target（我要成为谁：目标+聚焦+里程碑）               │
   734→│                                                             │
   735→└─────────────────────────────────────────────────────────────┘
   736→```
   737→
   738→### 10.2 实现
   739→
   740→**单一函数**：`ContextManager.get_profile_context(user_id, skill_id)`
   741→
   742→```python
   743→async def get_profile_context(self, user_id: str, skill_id: str) -> Dict:
   744→    """三层架构 Profile 注入"""
   745→    profile = await UnifiedProfileRepository.get_profile(UUID(user_id))
   746→    if not profile:
   747→        return {}
   748→
   749→    return {
   750→        # Layer 1: Identity（共享）
   751→        "user": {
   752→            "name": profile.get("identity", {}).get("display_name"),
   753→            "birth": profile.get("identity", {}).get("birth_info"),
   754→        },
   755→        # Layer 2: Skills（当前 Skill 专属）
   756→        "skill_data": profile.get("skills", {}).get(skill_id, {}),
   757→        # Layer 3: Vibe（共享深度信息）
   758→        "vibe": {
   759→            "insight": profile.get("vibe", {}).get("insight", {}),
   760→            "target": profile.get("vibe", {}).get("target", {}),
   761→        }
   762→    }
   763→```
   764→
   765→### 10.3 三层架构说明
   766→
   767→| 层级 | 内容 | 来源 | 所有 Skill 可读 |
   768→|------|------|------|----------------|
   769→| **Identity** | birth_info, display_name | 用户填写 | ✅ |
   770→| **Skills** | 各 Skill 原始数据 | Skill 实时写入 | ❌（仅当前 Skill） |
   771→| **Vibe** | insight + target | ProfileExtractor | ✅ |
   772→
   773→### 10.4 跨 Skill 数据配置
   774→
   775→**配置驱动**（在 SKILL.md frontmatter 中声明）：
   776→
   777→```yaml
   778→# skills/jungastro/SKILL.md
   779→---
   780→name: jungastro
   781→requires_skills: [bazi, zodiac]  # 声明需要的其他 Skill 数据
   782→---
   783→```
   784→
   785→**代码实现**：
   786→
   787→```python
   788→# skill_loader.py
   789→def get_skill_required_data(skill_id: str) -> List[str]:
   790→    """从 SKILL.md 配置读取需要的 skills"""
   791→    skill = load_skill(skill_id)
   792→    if skill and skill.requires_skills:
   793→        return skill.requires_skills
   794→    return [skill_id]  # 默认只需自身
   795→
   796→# prompt_builder.py - 使用配置
   797→skill_ids = get_skill_required_data(skill_id)  # 配置驱动，非硬编码
   798→for sid in skill_ids:
   799→    skill_data = profile.get("skills", {}).get(sid, {})
   800→```
   801→
   802→---
   803→
   804→## 11. 架构原则
   805→
   806→### 11.1 LLM 驱动