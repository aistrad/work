     1→ VibeLife 架构重构方案：实现 VibeInsight + VibeTarget                                                                │                  
     2→     │                                                                                                                     │                  
     3→     │ 基于 V9 VIBELIFE_TOPLEVEL_ARCHITECTURE.md                                                                           │                  
     4→     │ 预计时间：8 天 | 2026-01-21                                                                                         │                  
     5→     │                                                                                                                     │                  
     6→     │ ---                                                                                                                 │                  
     7→     │ 一、方案概述                                                                                                        │                  
     8→     │                                                                                                                     │                  
     9→     │ 核心目标                                                                                                            │                  
    10→     │                                                                                                                     │                  
    11→     │ 将 VibeLife 从"对话工具"升级为"自我认知平台"，实现 V9 架构的四大支柱中的后两个：                                    │                  
    12→     │                                                                                                                     │                  
    13→     │ 1. Me + VibeInsight：跨维度融合的自我认知（命理 + 对话 + 行为）                                                     │                  
    14→     │ 2. VibeTarget：对话驱动的目标管理与成长陪伴                                                                         │                  
    15→     │                                                                                                                     │                  
    16→     │ 当前差距 → 目标状态                                                                                                 │                  
    17→     │ ┌──────────────────┬──────────────────────────────────────────────┬─────────────────────────────────────────┐       │                  
    18→     │ │       组件       │                     当前                     │                  目标                   │       │                  
    19→     │ ├──────────────────┼──────────────────────────────────────────────┼─────────────────────────────────────────┤       │                  
    20→     │ │ 数据层           │ Layer 1-2 完整，Layer 3 表空，Layer 4 不存在 │ 四层完整，ProfileExtractor 自动生成     │       │                  
    21→     │ ├──────────────────┼──────────────────────────────────────────────┼─────────────────────────────────────────┤       │                  
    22→     │ │ ProfileExtractor │ 基础抽取（facts/goals）                      │ VibeInsight 三维 + VibeTarget 三维      │       │                  
    23→     │ ├──────────────────┼──────────────────────────────────────────────┼─────────────────────────────────────────┤       │                  
    24→     │ │ API              │ /account/profile 基础                        │ /api/v1/me/dashboard + /api/v1/target/* │       │                  
    25→     │ ├──────────────────┼──────────────────────────────────────────────┼─────────────────────────────────────────┤       │                  
    26→     │ │ 前端             │ Settings 基础                                │ Me 页三维洞察 + Journey 页目标强化      │       │                  
    27→     │ └──────────────────┴──────────────────────────────────────────────┴─────────────────────────────────────────┘       │                  
    28→     │ ---                                                                                                                 │                  
    29→     │ 二、技术设计                                                                                                        │                  
    30→     │                                                                                                                     │                  
    31→     │ 2.1 数据结构                                                                                                        │                  
    32→     │                                                                                                                     │                  
    33→     │ VibeInsight 三维模型（存储在 unified_profiles.profile.vibe_insight）                                                │                  
    34→     │                                                                                                                     │                  
    35→     │ {                                                                                                                   │                  
    36→     │   "essence": {                                                                                                      │                  
    37→     │     "archetype": {                                                                                                  │                  
    38→     │       "primary": "creator",                                                                                         │                  
    39→     │       "secondary": "explorer",                                                                                      │                  
    40→     │       "shadow": "ruler"                                                                                             │                  
    41→     │     },                                                                                                              │                  
    42→     │     "traits": [                                                                                                     │                  
    43→     │       {"source": "bazi", "trait": "表达力强"},                                                                      │                  
    44→     │       {"source": "zodiac", "trait": "好奇心旺"}                                                                     │                  
    45→     │     ]                                                                                                               │                  
    46→     │   },                                                                                                                │                  
    47→     │   "dynamic": {                                                                                                      │                  
    48→     │     "emotion": {"current": "calm", "intensity": 0.6},                                                               │                  
    49→     │     "energy": {"level": 0.7, "focus": ["career"]},                                                                  │                  
    50→     │     "active_archetype": "creator",                                                                                  │                  
    51→     │     "trend": {                                                                                                      │                  
    52→     │       "archetype_shift": {"rising": "pioneer", "delta": 0.05},                                                      │                  
    53→     │       "emotion_trend": "stable",                                                                                    │                  
    54→     │       "direction": "expansion"                                                                                      │                  
    55→     │     }                                                                                                               │                  
    56→     │   },                                                                                                                │                  
    57→     │   "pattern": {                                                                                                      │                  
    58→     │     "behaviors": [{"pattern": "晚间活跃", "confidence": 0.8}],                                                      │                  
    59→     │     "insights": ["创意灵感常在深夜涌现"]                                                                            │                  
    60→     │   },                                                                                                                │                  
    61→     │   "updated_at": "2026-01-21T03:00:00Z"                                                                              │                  
    62→     │ }                                                                                                                   │                  
    63→     │                                                                                                                     │                  
    64→     │ VibeTarget 三维模型（存储在 unified_profiles.profile.vibe_target）                                                  │                  
    65→     │                                                                                                                     │                  
    66→     │ {                                                                                                                   │                  
    67→     │   "goals": [                                                                                                        │                  
    68→     │     {                                                                                                               │                  
    69→     │       "id": "goal_001",                                                                                             │                  
    70→     │       "title": "完成写作项目",                                                                                      │                  
    71→     │       "source": "对话抽取",                                                                                         │                  
    72→     │       "status": "in_progress",                                                                                      │                  
    73→     │       "progress": 0.6,                                                                                              │                  
    74→     │       "created_at": "2026-01-10",                                                                                   │                  
    75→     │       "check_ins": [{"date": "2026-01-18", "note": "写了3章"}]                                                      │                  
    76→     │     }                                                                                                               │                  
    77→     │   ],                                                                                                                │                  
    78→     │   "focus": {                                                                                                        │                  
    79→     │     "primary": "career",                                                                                            │                  
    80→     │     "secondary": ["growth"],                                                                                        │                  
    81→     │     "active_goal": "goal_001",                                                                                      │                  
    82→     │     "heat_map": {"career": 0.8, "growth": 0.5}                                                                      │                  
    83→     │   },                                                                                                                │                  
    84→     │   "milestones": {                                                                                                   │                  
    85→     │     "achieved": [],                                                                                                 │                  
    86→     │     "streak": {"current": 7, "best": 14},                                                                           │                  
    87→     │     "moments": []                                                                                                   │                  
    88→     │   },                                                                                                                │                  
    89→     │   "updated_at": "2026-01-21T03:00:00Z"                                                                              │                  
    90→     │ }                                                                                                                   │                  
    91→     │                                                                                                                     │                  
    92→     │ 2.2 ProfileExtractor 升级                                                                                           │                  
    93→     │                                                                                                                     │                  
    94→     │ 新增核心函数                                                                                                        │                  
    95→     │                                                                                                                     │                  
    96→     │ 文件：apps/api/workers/profile_extractor.py                                                                         │                  
    97→     │                                                                                                                     │                  
    98→     │ 1. generate_vibe_insight(user_id) - 生成 VibeInsight 三维模型                                                       │                  
    99→     │   - essence：基础映射规则（bazi 日主 → 主原型） + LLM 融合微调                                                      │                  
   100→     │   - dynamic：最近 7 天对话情绪分析 + 能量趋势                                                                       │                  
   101→     │   - pattern：历史时间分布 + 对话主题频率分析                                                                        │                  
   102→     │ 2. generate_vibe_target(user_id) - 生成 VibeTarget 三维模型                                                         │                  
   103→     │   - goals：从 extracted.goals 结构化，补充进度和状态                                                                │                  
   104→     │   - focus：基于对话关键词匹配计算热力图                                                                             │                  
   105→     │   - milestones：目标完成事件 + 连续打卡统计                                                                         │                  
   106→     │                                                                                                                     │                  
   107→     │ 原型映射策略（混合方式）                                                                                            │                  
   108→     │                                                                                                                     │                  
   109→     │ # 1. 基础映射规则（硬编码表）                                                                                       │                  
   110→     │ BAZI_ARCHETYPE_MAP = {                                                                                              │                  
   111→     │     "甲木": "creator",      # 创造者                                                                                │                  
   112→     │     "乙木": "innocent",     # 天真者                                                                                │                  
   113→     │     "丙火": "explorer",     # 探险家                                                                                │                  
   114→     │     "丁火": "lover",        # 恋人                                                                                  │                  
   115→     │     "戊土": "caregiver",    # 照顾者                                                                                │                  
   116→     │     "己土": "ruler",        # 统治者                                                                                │                  
   117→     │     "庚金": "hero",         # 英雄                                                                                  │                  
   118→     │     "辛金": "sage",         # 智者                                                                                  │                  
   119→     │     "壬水": "magician",     # 魔术师                                                                                │                  
   120→     │     "癸水": "jester"        # 弄臣                                                                                  │                  
   121→     │ }                                                                                                                   │                  
   122→     │                                                                                                                     │                  
   123→     │ # 2. LLM 微调 Prompt                                                                                                │                  
   124→     │ ARCHETYPE_REFINEMENT_PROMPT = """基于用户的八字日主 {daymaster} 和星座信息 {zodiac}，                               │                  
   125→     │ 从荣格12原型中选择最符合的 primary、secondary 和 shadow 原型。                                                      │                  
   126→     │                                                                                                                     │                  
   127→     │ 参考基础映射：{daymaster} → {base_archetype}                                                                        │                  
   128→     │ 但可以根据星座信息微调选择。                                                                                        │                  
   129→     │                                                                                                                     │                  
   130→     │ 12原型：innocent, explorer, sage, hero, outlaw, magician,                                                           │                  
   131→     │        lover, jester, caregiver, creator, ruler, everyman"""                                                        │                  
   132→     │                                                                                                                     │                  
   133→     │ 2.3 API 设计                                                                                                        │                  
   134→     │                                                                                                                     │                  
   135→     │ Me API（新建 routes/me.py）                                                                                         │                  
   136→     │                                                                                                                     │                  
   137→     │ @router.get("/v1/me/dashboard")                                                                                     │                  
   138→     │ async def get_me_dashboard(current_user: CurrentUser = Depends(get_current_user)):                                  │                  
   139→     │     """                                                                                                             │                  
   140→     │     返回：                                                                                                          │                  
   141→     │     {                                                                                                               │                  
   142→     │       "primary_insight": "你的创造者特质正在显化，近期频繁讨论写作与此呼应",                                        │                  
   143→     │       "vibe_insight": {                                                                                             │                  
   144→     │         "essence": {...},                                                                                           │                  
   145→     │         "dynamic": {...},                                                                                           │                  
   146→     │         "pattern": {...}                                                                                            │                  
   147→     │       },                                                                                                            │                  
   148→     │       "data_level": "A"  // A=完整，B=基础，C=缺失                                                                  │                  
   149→     │     }                                                                                                               │                  
   150→     │     """                                                                                                             │                  
   151→     │                                                                                                                     │                  
   152→     │ VibeTarget API（新建 routes/target.py）                                                                             │                  
   153→     │                                                                                                                     │                  
   154→     │ GET  /v1/target/dashboard           # 获取 VibeTarget 数据                                                          │                  
   155→     │ POST /v1/target/goals               # 手动添加目标                                                                  │                  
   156→     │ PUT  /v1/target/goals/{id}/check-in # 打卡                                                                          │                  
   157→     │ PUT  /v1/target/goals/{id}/complete # 完成目标                                                                      │                  
   158→     │ DELETE /v1/target/goals/{id}        # 删除目标                                                                      │                  
   159→     │                                                                                                                     │                  
   160→     │ 2.4 前端设计                                                                                                        │                  
   161→     │                                                                                                                     │                  
   162→     │ Me 页面（升级现有 MePanel.tsx）                                                                                     │                  
   163→     │                                                                                                                     │                  
   164→     │ 设计：                                                                                                              │                  
   165→     │ - 顶部：用户头像 + 一句话核心洞察                                                                                   │                  
   166→     │ - 主区域：三维画像卡片展开                                                                                          │                  
   167→     │   - 本质卡片（原型 + 特质）                                                                                         │                  
   168→     │   - 动态卡片（情绪 + 能量 + 趋势）                                                                                  │                  
   169→     │   - 规律卡片（行为模式 + 洞察）                                                                                     │                  
   170→     │ - 底部：设置区域（保持现有功能）                                                                                    │                  
   171→     │                                                                                                                     │                  
   172→     │ Journey 页面（强化目标功能）                                                                                        │                  
   173→     │                                                                                                                     │                  
   174→     │ 升级点：                                                                                                            │                  
   175→     │ - 增加目标列表展示（从 vibe_target.goals 读取）                                                                     │                  
   176→     │ - 目标打卡快捷入口                                                                                                  │                  
   177→     │ - 里程碑回顾时间线                                                                                                  │                  
   178→     │ - 聚焦领域热力图可视化                                                                                              │                  
   179→     │                                                                                                                     │                  
   180→     │ ---                                                                                                                 │                  
   181→     │ 三、实施计划（8 天）                                                                                                │                  
   182→     │                                                                                                                     │                  
   183→     │ Phase 1: ProfileExtractor 升级（3天）                                                                               │                  
   184→     │ ┌───────┬────────────────────────────────────┬──────────────────────┬─────────────────────────────────────────────┐ │                  
   185→     │ │  Day  │                任务                │       关键文件       │                  验证方式                   │ │                  
   186→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   187→     │ │ Day 1 │ VibeInsight essence 生成           │ profile_extractor.py │ 手动运行，检查 profile.vibe_insight.essence │ │                  
   188→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   189→     │ │       │ - 实现 BAZI_ARCHETYPE_MAP 映射表   │                      │                                             │ │                  
   190→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   191→     │ │       │ - 实现 LLM 融合微调逻辑            │                      │                                             │ │                  
   192→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   193→     │ │       │ - 从 skill_data.bazi + zodiac 读取 │                      │                                             │ │                  
   194→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   195→     │ │ Day 2 │ VibeInsight dynamic + pattern 生成 │ profile_extractor.py │ 运行后检查 dynamic 和 pattern 字段          │ │                  
   196→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   197→     │ │       │ - 最近 7 天对话情绪分析            │                      │                                             │ │                  
   198→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   199→     │ │       │ - 历史时间分布统计                 │                      │                                             │ │                  
   200→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   201→     │ │       │ - 话题频率分析                     │                      │                                             │ │                  
   202→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   203→     │ │ Day 3 │ VibeTarget 三维模型生成            │ profile_extractor.py │ 检查 profile.vibe_target 完整性             │ │                  
   204→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   205→     │ │       │ - goals 结构化                     │                      │                                             │ │                  
   206→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   207→     │ │       │ - focus 热力图计算                 │                      │                                             │ │                  
   208→     │ ├───────┼────────────────────────────────────┼──────────────────────┼─────────────────────────────────────────────┤ │                  
   209→     │ │       │ - milestones 统计                  │                      │                                             │ │                  
   210→     │ └───────┴────────────────────────────────────┴──────────────────────┴─────────────────────────────────────────────┘ │                  
   211→     │ Phase 2: Me 页 + API（2天）                                                                                         │                  
   212→     │ ┌───────┬─────────────────────────────┬──────────────────────┬────────────────────────┐                             │                  
   213→     │ │  Day  │            任务             │       关键文件       │        验证方式        │                             │                  
   214→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   215→     │ │ Day 4 │ Me API 实现                 │ routes/me.py（新建） │ curl 测试 API 返回结构 │                             │                  
   216→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   217→     │ │       │ - GET /v1/me/dashboard 端点 │                      │                        │                             │                  
   218→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   219→     │ │       │ - 数据完整度评估（A/B/C）   │                      │                        │                             │                  
   220→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   221→     │ │       │ - 一句话洞察生成            │                      │                        │                             │                  
   222→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   223→     │ │       │ - 路由注册到 main.py        │                      │                        │                             │                  
   224→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   225→     │ │ Day 5 │ Me 页前端升级               │ MePanel.tsx          │ 浏览器验证三维展示     │                             │                  
   226→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   227→     │ │       │ - 三维模型卡片组件          │                      │                        │                             │                  
   228→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   229→     │ │       │ - API 调用 hook             │                      │                        │                             │                  
   230→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   231→     │ │       │ - 响应式布局调整            │                      │                        │                             │                  
   232→     │ ├───────┼─────────────────────────────┼──────────────────────┼────────────────────────┤                             │                  
   233→     │ │       │ - 数据缺失时的引导          │                      │                        │                             │                  
   234→     │ └───────┴─────────────────────────────┴──────────────────────┴────────────────────────┘                             │                  
   235→     │ Phase 3: VibeTarget 页 + API（3天）                                                                                 │                  
   236→     │ ┌───────┬────────────────────────────┬──────────────────────────┬──────────────────────┐                            │                  
   237→     │ │  Day  │            任务            │         关键文件         │       验证方式       │                            │                  
   238→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   239→     │ │ Day 6 │ VibeTarget API 实现        │ routes/target.py（新建） │ Postman 测试完整流程 │                            │                  
   240→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   241→     │ │       │ - GET /dashboard           │                          │                      │                            │                  
   242→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   243→     │ │       │ - POST /goals              │                          │                      │                            │                  
   244→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   245→     │ │       │ - PUT /goals/{id}/check-in │                          │                      │                            │                  
   246→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   247→     │ │       │ - PUT /goals/{id}/complete │                          │                      │                            │                  
   248→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   249→     │ │ Day 7 │ Journey 页目标功能强化     │ JourneyPanel.tsx         │ 验证目标列表和打卡   │                            │                  
   250→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   251→     │ │       │ - 目标列表组件             │                          │                      │                            │                  
   252→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   253→     │ │       │ - 打卡界面                 │                          │                      │                            │                  
   254→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   255→     │ │       │ - API 集成                 │                          │                      │                            │                  
   256→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   257→     │ │ Day 8 │ 里程碑和热力图可视化       │ JourneyPanel.tsx         │ 完整端到端测试       │                            │                  
   258→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   259→     │ │       │ - 里程碑时间线组件         │                          │                      │                            │                  
   260→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   261→     │ │       │ - 聚焦领域热力图           │                          │                      │                            │                  
   262→     │ ├───────┼────────────────────────────┼──────────────────────────┼──────────────────────┤                            │                  
   263→     │ │       │ - 交互优化和调试           │                          │                      │                            │                  
   264→     │ └───────┴────────────────────────────┴──────────────────────────┴──────────────────────┘                            │                  
   265→     │ ---                                                                                                                 │                  
   266→     │ 四、关键文件清单                                                                                                    │                  
   267→     │                                                                                                                     │                  
   268→     │ 后端（5 个文件）                                                                                                    │                  
   269→     │                                                                                                                     │                  
   270→     │ 1. apps/api/workers/profile_extractor.py - ProfileExtractor 核心升级                                                │                  
   271→     │   - 添加 generate_vibe_insight() 和 generate_vibe_target()                                                          │                  
   272→     │   - 实现原型映射表和 LLM 融合逻辑                                                                                   │                  
   273→     │ 2. apps/api/routes/me.py - Me API（新建）                                                                           │                  
   274→     │   - GET /v1/me/dashboard                                                                                            │                  
   275→     │   - 数据完整度评估                                                                                                  │                  
   276→     │ 3. apps/api/routes/target.py - VibeTarget API（新建）                                                               │                  
   277→     │   - 目标 CRUD + 打卡 + 完成                                                                                         │                  
   278→     │ 4. apps/api/stores/unified_profile_repo.py - 数据访问层（微调）                                                     │                  
   279→     │   - 添加便捷方法：get_vibe_insight() 和 get_vibe_target()                                                           │                  
   280→     │ 5. apps/api/main.py - 路由注册                                                                                      │                  
   281→     │   - 注册 me.router 和 target.router                                                                                 │                  
   282→     │                                                                                                                     │                  
   283→     │ 前端（2 个文件）                                                                                                    │                  
   284→     │                                                                                                                     │                  
   285→     │ 6. apps/web/src/components/layout/panels/MePanel.tsx - Me 页升级                                                    │                  
   286→     │   - 三维模型卡片展示                                                                                                │                  
   287→     │   - API 调用集成                                                                                                    │                  
   288→     │ 7. apps/web/src/components/layout/panels/JourneyPanel.tsx - Journey 页强化                                          │                  
   289→     │   - 目标列表和打卡                                                                                                  │                  
   290→     │   - 里程碑时间线                                                                                                    │                  
   291→     │   - 聚焦热力图                                                                                                      │                  
   292→     │                                                                                                                     │                  
   293→     │ ---                                                                                                                 │                  
   294→     │ 五、验证计划                                                                                                        │                  
   295→     │                                                                                                                     │                  
   296→     │ 数据层验证                                                                                                          │                  
   297→     │                                                                                                                     │                  
   298→     │ # 1. 运行 ProfileExtractor                                                                                          │                  
   299→     │ python apps/api/workers/profile_extractor.py 7                                                                      │                  
   300→     │                                                                                                                     │                  
   301→     │ # 2. 检查数据生成                                                                                                   │                  
   302→     │ psql $VIBELIFE_DB_URL -c "                                                                                          │                  
   303→     │   SELECT                                                                                                            │                  
   304→     │     user_id,                                                                                                        │                  
   305→     │     profile->'vibe_insight'->'essence'->'archetype'->>'primary' as archetype,                                       │                  
   306→     │     profile->'vibe_target'->'focus'->>'primary' as focus                                                            │                  
   307→     │   FROM unified_profiles                                                                                             │                  
   308→     │   WHERE profile ? 'vibe_insight'                                                                                    │                  
   309→     │   LIMIT 5;                                                                                                          │                  
   310→     │ "                                                                                                                   │                  
   311→     │                                                                                                                     │                  
   312→     │ API 验证                                                                                                            │                  
   313→     │                                                                                                                     │                  
   314→     │ # Me API                                                                                                            │                  
   315→     │ curl -H "Authorization: Bearer $TOKEN" \                                                                            │                  
   316→     │   http://localhost:8100/api/v1/me/dashboard                                                                         │                  
   317→     │                                                                                                                     │                  
   318→     │ # VibeTarget API                                                                                                    │                  
   319→     │ curl -X POST -H "Authorization: Bearer $TOKEN" \                                                                    │                  
   320→     │   -H "Content-Type: application/json" \                                                                             │                  
   321→     │   -d '{"title": "完成项目", "description": "..."}' \                                                                │                  
   322→     │   http://localhost:8100/api/v1/target/goals                                                                         │                  
   323→     │                                                                                                                     │                  
   324→     │ 前端验证                                                                                                            │                  
   325→     │                                                                                                                     │                  
   326→     │ 1. 访问 /me 页面，验证三维洞察展示                                                                                  │                  
   327→     │ 2. 访问 /journey 页面，验证目标管理功能                                                                             │                  
   328→     │ 3. 执行打卡流程，验证数据更新                                                                                       │                  
   329→     │ 4. 检查响应式布局（PC + 移动端）                                                                                    │                  
   330→     │                                                                                                                     │                  
   331→     │ ---                                                                                                                 │                  
   332→     │ 六、风险与应对                                                                                                      │                  
   333→     │ ┌────────────────┬────────────────────────────┬────────────────────────────────┐                                    │                  
   334→     │ │      风险      │            影响            │              应对              │                                    │                  
   335→     │ ├────────────────┼────────────────────────────┼────────────────────────────────┤                                    │                  
   336→     │ │ LLM 成本       │ essence 生成频繁调用       │ 每日凌晨批量处理，非实时       │                                    │                  
   337→     │ ├────────────────┼────────────────────────────┼────────────────────────────────┤                                    │                  
   338→     │ │ 首次无数据     │ 新用户洞察为空             │ 提供默认值 + 引导填写          │                                    │                  
   339→     │ ├────────────────┼────────────────────────────┼────────────────────────────────┤                                    │                  
   340→     │ │ 原型映射主观   │ archetype 不准确           │ 基础规则 + LLM 微调 + 用户反馈 │                                    │                  
   341→     │ ├────────────────┼────────────────────────────┼────────────────────────────────┤                                    │                  
   342→     │ │ 目标抽取误判   │ extracted.goals 包含非目标 │ 用户确认 + 手动编辑            │                                    │                  
   343→     │ ├────────────────┼────────────────────────────┼────────────────────────────────┤                                    │                  
   344→     │ │ 前端集成复杂度 │ Journey 页功能过载         │ 渐进式加载 + 折叠设计          │                                    │                  
   345→     │ └────────────────┴────────────────────────────┴────────────────────────────────┘                                    │                  
   346→     │ ---                                                                                                                 │                  
   347→     │ 七、未解决问题（可延后）                                                                                            │                  
   348→     │                                                                                                                     │                  
   349→     │ 1. 连续打卡定义：是否每天都要打卡，还是每周 3 次即可？                                                              │                  
   350→     │   - 建议：从简单开始（每周 3 次），后续可配置                                                                       │                  
   351→     │ 2. 命理与目标融合时机：何时主动推荐命理视角？                                                                       │                  
   352→     │   - 建议：用户在目标设定时可选"查看命理建议"                                                                        │                  
   353→     │ 3. 数据完整度阈值：A/B/C 分级的具体标准？                                                                           │                  
   354→     │   - 建议：A=有 bazi+zodiac+对话，B=有 bazi 或 zodiac，C=仅对话                                                      │                  
   355→     │ 4. 洞察刷新频率：是否允许用户手动刷新？                                                                             │                  
   356→     │   - 建议：Phase 1 仅每日自动，Phase 2 可添加手动刷新                                                                │                  
   357→     │                                                                                                                     │                  
   358→     │ ---                                                                                                                 │                  
   359→     │ 最后更新：2026-01-21                                                                                                │                  
   360→     │ 预计完成：2026-01-29（8 个工作日）                                                         

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
