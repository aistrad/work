     1→# VibeLife Dashboard 设计规格
     2→
     3→> **Version**: 1.0 | 2026-01-19
     4→> **定位**: 用户人生仪表盘 - 一眼看见"我是谁、我在哪、我要去哪"
     5→> **设计理念**: Linear 精致度 + 温暖东方美学 + 主动关怀体验
     6→
     7→---
     8→
     9→## 核心设计哲学
    10→
    11→```
    12→┌─────────────────────────────────────────────────────────────────────────────┐
    13→│                                                                             │
    14→│   传统 Dashboard: 展示数据                                                  │
    15→│   ─────────────────────────────                                             │
    16→│   用户来看数据，然后离开                                                     │
    17→│                                                                             │
    18→│   VibeLife Dashboard: 镜像与陪伴                                            │
    19→│   ─────────────────────────────                                             │
    20→│   "每次打开，都感觉被理解、被记住、被关心"                                   │
    21→│                                                                             │
    22→│   不是看数据的地方，是每天遇见更好自己的地方                                 │
    23→│                                                                             │
    24→└─────────────────────────────────────────────────────────────────────────────┘
    25→```
    26→
    27→### 设计三问
    28→
    29→1. **用户为什么要来 Dashboard？**
    30→   - 不是为了看数据，是为了"被提醒我是谁"
    31→   - 早晨：确认今天的方向
    32→   - 晚上：看看自己走了多远
    33→
    34→2. **Dashboard 如何让用户感到被理解？**
    35→   - 个性化问候（基于时间 + 状态 + 历史）
    36→   - 智能卡片排序（基于当前最需要关注的）
    37→   - 主动推送融入界面（不打扰，但在那里）
    38→
    39→3. **用户离开时应该带走什么？**
    40→   - 清晰：今天最重要的一件事
    41→   - 力量：被认可的感觉
    42→   - 期待：想明天再来
    43→
    44→---
    45→
    46→## 信息架构
    47→
    48→```
    49→┌─────────────────────────────────────────────────────────────────────────────┐
    50→│                         Dashboard 信息层次                                   │
    51→├─────────────────────────────────────────────────────────────────────────────┤
    52→│                                                                             │
    53→│   Layer 0: 情境感知 (Ambient)                                               │
    54→│   ═══════════════════════════                                               │
    55→│   • 时间问候 + 天气/节气                                                    │
    56→│   • 用户状态感知（连续登录、今日已签到等）                                   │
    57→│   • 主动推送预览                                                            │
    58→│                                                                             │
    59→│   Layer 1: 身份镜像 (WHO I AM)                                              │
    60→│   ═══════════════════════════                                               │
    61→│   • VibeProfile 卡片（四维原型）                                            │
    62→│   • 身份宣言（Lifecoach）                                                   │
    63→│   • 当前状态标签                                                            │
    64→│                                                                             │
    65→│   Layer 2: 人生地图 (WHERE I'M GOING)                                       │
    66→│   ═══════════════════════════                                               │
    67→│   • 北极星愿景                                                              │
    68→│   • 月度项目进度                                                            │
    69→│   • 本周大石头                                                              │
    70→│                                                                             │
    71→│   Layer 3: 今日行动 (WHAT TO DO TODAY)                                      │
    72→│   ═══════════════════════════                                               │
    73→│   • 今日杠杆行动                                                            │
    74→│   • 签到状态                                                                │
    75→│   • 主动推送提醒                                                            │
    76→│                                                                             │
    77→│   Layer 4: 成长轨迹 (HOW FAR I'VE COME)                                     │
    78→│   ═══════════════════════════                                               │
    79→│   • 连续签到天数                                                            │
    80→│   • 目标完成率                                                              │
    81→│   • 里程碑时间线                                                            │
    82→│                                                                             │
    83→└─────────────────────────────────────────────────────────────────────────────┘
    84→```
    85→
    86→---
    87→
    88→## 页面布局 (Desktop)
    89→
    90→```
    91→┌─────────────────────────────────────────────────────────────────────────────────────────┐
    92→│  VibeLife                                         🔔  ⚙️   头像                         │
    93→├─────────────────────────────────────────────────────────────────────────────────────────┤
    94→│                                                                                          │
    95→│  ┌─────────────────────────────────────────────────────────────────────────────────┐   │
    96→│  │                                                                                   │   │
    97→│  │   早安，小薇                                              2026年1月19日 周日      │   │
    98→│  │   ─────────────────────────────────────────────────────────────────────────────   │   │
    99→│  │   "新的一周开始了，你的愿景正在等待你的行动。"                                    │   │
   100→│  │                                                                                   │   │
   101→│  │   📍 小寒第三候 · 宜静心规划                                                      │   │
   102→│  │                                                                                   │   │
   103→│  └─────────────────────────────────────────────────────────────────────────────────┘   │
   104→│                                                                                          │
   105→│  ┌──────────────────────────────────┐  ┌──────────────────────────────────────────┐   │
   106→│  │                                  │  │                                          │   │
   107→│  │   TODAY'S VIBE                   │  │   TODAY'S FOCUS                          │   │
   108→│  │   ════════════                   │  │   ═════════════                          │   │
   109→│  │                                  │  │                                          │   │
   110→│  │   今日能量 78/100                │  │   ☀️ 今日杠杆行动                         │   │
   111→│  │   ████████████████░░░░ 🔥       │  │                                          │   │
   112→│  │                                  │  │   □ 完成3.2节初稿                         │   │
   113→│  │   ┌────┬────┬────┬────┐        │  │   □ 回复小明的邮件                        │   │
   114→│  │   │事业│感情│健康│财运│        │  │   □ 30分钟阅读                            │   │
   115→│  │   │ 85 │ 62 │ 70 │ 75 │        │  │                                          │   │
   116→│  │   └────┴────┴────┴────┘        │  │   ─────────────────────────────────────  │   │
   117→│  │                                  │  │                                          │   │
   118→│  │   ☀️ 宜: 创意工作、头脑风暴     │  │   🔥 连续签到: 7天                        │   │
   119→│  │   ⚠️ 慎: 重大财务决定           │  │                                          │   │
   120→│  │                                  │  │   [ 开始今天 ]                            │   │
   121→│  │   💡 "甲木得火生发，想法易落地"  │  │                                          │   │
   122→│  │                                  │  │                                          │   │
   123→│  └──────────────────────────────────┘  └──────────────────────────────────────────┘   │
   124→│                                                                                          │
   125→│  ┌──────────────────────────────────┐  ┌──────────────────────────────────────────┐   │
   126→│  │                                  │  │                                          │   │
   127→│  │   NORTH STAR                     │  │   THIS WEEK                              │   │
   128→│  │   ──────────                     │  │   ─────────                              │   │
   129→│  │                                  │  │                                          │   │
   130→│  │   "我想成为一个用文字帮助         │  │   本周大石头                             │   │
   131→│  │    他人找到方向的创作者"          │  │                                          │   │
   132→│  │                                  │  │   ✓ 完成3.2节初稿 (创作者)               │   │
   133→│  │   ─────────────────────────────  │  │   ○ 周三带孩子去公园 (父亲)              │   │
   134→│  │                                  │  │   ○ 周六约会 (丈夫)                      │   │
   135→│  │   月度项目: 完成书籍第3章         │  │   ○ 跑步3次 (个人)                       │   │
   136→│  │                                  │  │                                          │   │
   137→│  │   ████████░░░░░░░░░░ 40%         │  │   角色平衡:                              │   │
   138→│  │                                  │  │   创作 ████████░░ 80%                    │   │
   139→│  │   距离月底还有 12 天              │  │   父亲 ██████░░░░ 60%                    │   │
   140→│  │                                  │  │   丈夫 ████░░░░░░ 40%                    │   │
   141→│  │                                  │  │   个人 ██░░░░░░░░ 20%                    │   │
   142→│  │                                  │  │                                          │   │
   143→│  └──────────────────────────────────┘  └──────────────────────────────────────────┘   │
   144→│                                                                                          │
   145→│  ┌─────────────────────────────────────────────────────────────────────────────────┐   │
   146→│  │                                                                                   │   │
   147→│  │   GROWTH TIMELINE                                                                 │   │
   148→│  │   ───────────────                                                                 │   │
   149→│  │                                                                                   │   │
   150→│  │   2026.01.01 ──●── 设定年度愿景                                                  │   │
   151→│  │               │                                                                   │   │
   152→│  │   2026.01.07 ──●── 完成第一周签到                                                │   │
   153→│  │               │                                                                   │   │
   154→│  │   2026.01.15 ──●── 第2章定稿                                                     │   │
   155→│  │               │                                                                   │   │
   156→│  │   2026.01.19 ──○── 今天                                                          │   │
   157→│  │               │                                                                   │   │
   158→│  │   2026.01.31 ──◇── 月度目标: 第3章完成                                           │   │
   159→│  │                                                                                   │   │
   160→│  └─────────────────────────────────────────────────────────────────────────────────┘   │
   161→│                                                                                          │
   162→└─────────────────────────────────────────────────────────────────────────────────────────┘
   163→```
   164→
   165→---
   166→
   167→## 页面布局 (Mobile)
   168→
   169→```
   170→┌─────────────────────────────────┐
   171→│  VibeLife          🔔    👤     │
   172→├─────────────────────────────────┤
   173→│                                 │
   174→│  早安，小薇                     │
   175→│  "新的一周，新的可能"           │
   176→│                                 │
   177→│  ┌─────────────────────────┐   │
   178→│  │                         │   │
   179→│  │  ☀️ 今日杠杆行动         │   │
   180→│  │                         │   │
   181→│  │  □ 完成3.2节初稿        │   │
   182→│  │  □ 回复小明的邮件       │   │
   183→│  │  □ 30分钟阅读           │   │
   184→│  │                         │   │
   185→│  │  🔥 7天   [ 开始今天 ]  │   │
   186→│  │                         │   │
   187→│  └─────────────────────────┘   │
   188→│                                 │
   189→│  ┌─────────────────────────┐   │
   190→│  │                         │   │
   191→│  │  WHO I AM               │   │
   192→│  │                         │   │
   193→│  │  ┌──┐ ┌──┐ ┌──┐ ┌──┐   │   │
   194→│  │  │🎨│ │💕│ │🧭│ │⚔️│   │   │
   195→│  │  └──┘ └──┘ └──┘ └──┘   │   │
   196→│  │                         │   │
   197→│  │  "我是一个每天都在      │   │
   198→│  │   创造的人"             │   │
   199→│  │                         │   │
   200→│  └─────────────────────────┘   │
   201→│                                 │
   202→│  ┌─────────────────────────┐   │
   203→│  │                         │   │
   204→│  │  本周大石头  2/4        │   │
   205→│  │                         │   │
   206→│  │  ✓ 完成3.2节初稿        │   │
   207→│  │  ○ 周三带孩子去公园     │   │
   208→│  │  ○ 周六约会             │   │
   209→│  │  ○ 跑步3次              │   │
   210→│  │                         │   │
   211→│  └─────────────────────────┘   │
   212→│                                 │
   213→│  ┌─────────────────────────┐   │
   214→│  │                         │   │
   215→│  │  月度进度               │   │
   216→│  │  ████████░░░░ 40%       │   │
   217→│  │  第3章 · 还剩12天       │   │
   218→│  │                         │   │
   219→│  └─────────────────────────┘   │
   220→│                                 │
   221→├─────────────────────────────────┤
   222→│  🏠    💬    📊    👤           │
   223→│ Home  Chat  Stats Profile       │
   224→└─────────────────────────────────┘
   225→```
   226→
   227→---
   228→
   229→## 数据流架构
   230→
   231→```
   232→┌─────────────────────────────────────────────────────────────────────────────────────────┐
   233→│                              Dashboard 数据流                                            │
   234→├─────────────────────────────────────────────────────────────────────────────────────────┤
   235→│                                                                                          │
   236→│   ┌───────────────────────────────────────────────────────────────────────────────────┐ │
   237→│   │                              Frontend (Next.js)                                    │ │
   238→│   │                                                                                    │ │
   239→│   │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                  │ │
   240→│   │   │  DashboardPage  │  │  useDashboard   │  │   Zustand       │                  │ │
   241→│   │   │    (RSC)        │──│     Hook        │──│    Store        │                  │ │
   242→│   │   └─────────────────┘  └─────────────────┘  └─────────────────┘                  │ │
   243→│   │          │                     │                    │                              │ │
   244→│   │          │              ┌──────┴──────┐            │                              │ │
   245→│   │          │              │             │            │                              │ │
   246→│   │          ▼              ▼             ▼            ▼                              │ │
   247→│   │   ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐                │ │
   248→│   │   │  SWR Cache  │ │  SWR Cache  │ │  SWR Cache  │ │  SWR Cache  │                │ │
   249→│   │   │ VibeProfile │ │ Lifecoach   │ │ Proactive   │ │   Stats     │                │ │
   250→│   │   └──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘                │ │
   251→│   │          │               │               │               │                        │ │
   252→│   └──────────┼───────────────┼───────────────┼───────────────┼────────────────────────┘ │
   253→│              │               │               │               │                          │
   254→│              └───────────────┴───────────────┴───────────────┘                          │
   255→│                                      │                                                   │
   256→│                                      ▼                                                   │
   257→│   ┌───────────────────────────────────────────────────────────────────────────────────┐ │
   258→│   │                              API Layer                                             │ │
   259→│   │                                                                                    │ │
   260→│   │   GET /api/dashboard                                                               │ │
   261→│   │   ├── 聚合多个数据源                                                               │ │
   262→│   │   ├── 计算派生数据 (进度、状态)                                                    │ │
   263→│   │   └── 返回 DashboardDTO                                                            │ │
   264→│   │                                                                                    │ │
   265→│   │   或分离调用:                                                                       │ │
   266→│   │   ├── GET /api/vibe-profile/{user_id}                                              │ │
   267→│   │   ├── GET /api/lifecoach/state/{user_id}                                           │ │
   268→│   │   ├── GET /api/proactive/today/{user_id}                                           │ │
   269→│   │   └── GET /api/stats/overview/{user_id}                                            │ │
   270→│   │                                                                                    │ │
   271→│   └───────────────────────────────────────────────────────────────────────────────────┘ │
   272→│                                      │                                                   │
   273→│                                      ▼                                                   │
   274→│   ┌───────────────────────────────────────────────────────────────────────────────────┐ │
   275→│   │                              Backend Services                                      │ │
   276→│   │                                                                                    │ │
   277→│   │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                  │ │
   278→│   │   │ VibeProfile     │  │   Lifecoach     │  │   Proactive     │                  │ │
   279→│   │   │ Repository      │  │   Service       │  │   Engine        │                  │ │
   280→│   │   └────────┬────────┘  └────────┬────────┘  └────────┬────────┘                  │ │
   281→│   │            │                    │                    │                            │ │
   282→│   │            └────────────────────┴────────────────────┘                            │ │
   283→│   │                                 │                                                  │ │
   284→│   │                                 ▼                                                  │ │
   285→│   │                        ┌─────────────────┐                                        │ │
   286→│   │                        │   PostgreSQL    │                                        │ │
   287→│   │                        │ unified_profiles│                                        │ │
   288→│   │                        │   + 相关表      │                                        │ │
   289→│   │                        └─────────────────┘                                        │ │
   290→│   │                                                                                    │ │
   291→│   └───────────────────────────────────────────────────────────────────────────────────┘ │
   292→│                                                                                          │
   293→└─────────────────────────────────────────────────────────────────────────────────────────┘
   294→```
   295→
   296→---
   297→
   298→## 数据模型
   299→
   300→### DashboardDTO
   301→
   302→```typescript
   303→// src/types/dashboard.ts
   304→
   305→interface DashboardDTO {
   306→  // Meta
   307→  userId: string;
   308→  generatedAt: string;
   309→
   310→  // Layer 0: Ambient
   311→  ambient: {
   312→    greeting: string;           // "早安，小薇"
   313→    message: string;            // 个性化消息
   314→    date: string;               // "2026年1月19日 周日"
   315→    solarTerm?: string;         // "小寒第三候"
   316→    suggestion?: string;        // "宜静心规划"
   317→  };
   318→
   319→  // Layer 1: WHO I AM
   320→  identity: {
   321→    archetypes: {
   322→      core: ArchetypeId;
   323→      inner: ArchetypeId;
   324→      outer: ArchetypeId;
   325→      shadow: ArchetypeId;
   326→    };
   327→    statement?: string;         // 身份宣言
   328→    currentState?: string;      // 当前状态
   329→    tags?: string[];            // 状态标签
   330→  };
   331→
   332→  // Layer 2: WHERE I'M GOING
   333→  northStar: {
   334→    vision?: string;            // 北极星愿景
   335→    monthlyProject?: {
   336→      name: string;
   337→      progress: number;         // 0-100
   338→      daysRemaining: number;
   339→    };
   340→    yearGoal?: string;
   341→  };
   342→
   343→  // Layer 3: TODAY'S FOCUS
   344→  today: {
   345→    levers: Array<{
   346→      id: string;
   347→      text: string;
   348→      completed: boolean;
   349→    }>;
   350→    streak: number;             // 连续签到天数
   351→    checkedIn: boolean;         // 今日是否已签到
   352→    proactiveMessage?: string;  // 今日主动推送
   353→  };
   354→
   355→  // Layer 4: THIS WEEK
   356→  week: {
   357→    rocks: Array<{
   358→      id: string;
   359→      text: string;
   360→      role: string;             // 角色
   361→      completed: boolean;
   362→    }>;
   363→    roleBalance: Record<string, number>;  // 角色 → 完成度
   364→  };
   365→
   366→  // Layer 5: GROWTH
   367→  growth: {
   368→    milestones: Array<{
   369→      date: string;
   370→      title: string;
   371→      type: 'past' | 'today' | 'future';
   372→    }>;
   373→    stats: {
   374→      totalDays: number;        // 使用总天数
   375→      goalsCompleted: number;   // 完成目标数
   376→      insightsGained: number;   // 获得洞察数
   377→    };
   378→  };
   379→}
   380→```
   381→
   382→---
   383→
   384→## 组件架构
   385→
   386→```
   387→┌─────────────────────────────────────────────────────────────────────────────┐
   388→│                         Dashboard 组件树                                     │
   389→├─────────────────────────────────────────────────────────────────────────────┤
   390→│                                                                             │
   391→│   DashboardPage (RSC)                                                       │
   392→│   │                                                                         │
   393→│   ├── DashboardProvider (Client - Context + State)                          │
   394→│   │   │                                                                     │
   395→│   │   ├── AmbientHeader                                                     │
   396→│   │   │   ├── Greeting                                                      │
   397→│   │   │   ├── DateDisplay                                                   │
   398→│   │   │   └── SolarTermBadge                                                │
   399→│   │   │                                                                     │
   400→│   │   ├── DashboardGrid                                                     │
   401→│   │   │   │                                                                 │
   402→│   │   │   ├── IdentityCard (WHO I AM)                                       │
   403→│   │   │   │   ├── ArchetypeQuad                                             │
   404→│   │   │   │   │   └── ArchetypeBadge × 4                                    │
   405→│   │   │   │   ├── IdentityStatement                                         │
   406→│   │   │   │   └── CurrentStateTag                                           │
   407→│   │   │   │                                                                 │
   408→│   │   │   ├── TodayCard (TODAY'S FOCUS)                                     │
   409→│   │   │   │   ├── LeverList                                                 │
   410→│   │   │   │   │   └── LeverItem × n                                         │
   411→│   │   │   │   ├── StreakBadge                                               │
   412→│   │   │   │   └── CheckInButton                                             │
   413→│   │   │   │                                                                 │
   414→│   │   │   ├── NorthStarCard (NORTH STAR)                                    │
   415→│   │   │   │   ├── VisionQuote                                               │
   416→│   │   │   │   ├── MonthlyProgress                                           │
   417→│   │   │   │   │   └── ProgressBar                                           │
   418→│   │   │   │   └── Countdown                                                 │
   419→│   │   │   │                                                                 │
   420→│   │   │   └── WeekCard (THIS WEEK)                                          │
   421→│   │   │       ├── RockList                                                  │
   422→│   │   │       │   └── RockItem × n                                          │
   423→│   │   │       └── RoleBalance                                               │
   424→│   │   │           └── RoleBar × n                                           │
   425→│   │   │                                                                     │
   426→│   │   └── GrowthTimeline                                                    │
   427→│   │       └── MilestoneNode × n                                             │
   428→│   │                                                                         │
   429→│   └── MobileBottomNav (Client - Mobile Only)                                │
   430→│                                                                             │
   431→└─────────────────────────────────────────────────────────────────────────────┘
   432→```
   433→
   434→---
   435→
   436→## 卡片设计规范
   437→
   438→### 卡片视觉语言
   439→
   440→```
   441→┌─────────────────────────────────────────────────────────────────────────────┐
   442→│                         卡片设计系统                                         │
   443→├─────────────────────────────────────────────────────────────────────────────┤
   444→│                                                                             │
   445→│   基础卡片                                                                   │
   446→│   ──────────                                                                │
   447→│                                                                             │
   448→│   ┌─────────────────────────────────────┐                                  │
   449→│   │                                     │                                  │
   450→│   │  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │  ← 顶部微妙渐变 (4px)             │
   451→│   │                                     │                                  │
   452→│   │   CARD TITLE                        │  ← 标题: 12px, 字重 500, 灰色    │
   453→│   │   ───────────                       │                                  │
   454→│   │                                     │                                  │
   455→│   │   主要内容区域                       │  ← 内容: 14-16px, 正常字重       │
   456→│   │                                     │                                  │
   457→│   │                                     │                                  │
   458→│   │   [ Action Button ]                 │  ← 操作按钮: 底部对齐            │
   459→│   │                                     │                                  │
   460→│   └─────────────────────────────────────┘                                  │
   461→│                                                                             │
   462→│   样式规范:                                                                  │
   463→│   • 圆角: 16px (大卡片) / 12px (小卡片)                                     │
   464→│   • 阴影: 多层柔和阴影 (Linear 风格)                                        │
   465→│   • 背景: rgba(255, 255, 255, 0.8) + backdrop-blur                          │
   466→│   • 边框: 无边框，用阴影分隔                                                 │
   467→│   • 内边距: 20px (大) / 16px (中) / 12px (小)                               │
   468→│   • hover: translateY(-2px) + 阴影加深                                      │
   469→│                                                                             │
   470→│   ─────────────────────────────────────────────────────────────────────     │
   471→│                                                                             │
   472→│   状态变体                                                                   │
   473→│   ──────────                                                                │
   474→│                                                                             │
   475→│   Default    完成       高亮        需关注                                  │
   476→│   ┌─────┐   ┌─────┐   ┌─────┐    ┌─────┐                                   │
   477→│   │     │   │ ✓   │   │ ★   │    │ !   │                                   │
   478→│   │     │   │     │   │     │    │     │                                   │
   479→│   └─────┘   └─────┘   └─────┘    └─────┘                                   │
   480→│   白底      浅绿边     金色光晕    橙色脉冲                                  │
   481→│                                                                             │
   482→└─────────────────────────────────────────────────────────────────────────────┘
   483→```
   484→
   485→### Tailwind 实现
   486→
   487→```css
   488→/* 基础卡片样式 */
   489→.dashboard-card {
   490→  @apply relative rounded-2xl p-5
   491→         bg-white/80 backdrop-blur-sm
   492→         shadow-[0_1px_2px_rgba(0,0,0,0.04),0_4px_8px_rgba(0,0,0,0.04),0_8px_16px_rgba(0,0,0,0.02)]
   493→         transition-all duration-200 ease-out
   494→         hover:translate-y-[-2px]
   495→         hover:shadow-[0_2px_4px_rgba(0,0,0,0.06),0_8px_16px_rgba(0,0,0,0.06),0_16px_32px_rgba(0,0,0,0.04)];
   496→}
   497→
   498→/* 顶部渐变装饰 */
   499→.dashboard-card::before {
   500→  @apply absolute top-0 left-0 right-0 h-1 rounded-t-2xl
   501→         bg-gradient-to-r from-primary-400 to-primary-600
   502→         opacity-60;
   503→  content: '';
   504→}
   505→
   506→/* 完成状态 */
   507→.dashboard-card--completed {
   508→  @apply border-2 border-green-200;
   509→}
   510→
   511→/* 高亮状态 */
   512→.dashboard-card--highlight {
   513→  @apply ring-2 ring-amber-300 ring-offset-2;
   514→}
   515→
   516→/* 需关注状态 */
   517→.dashboard-card--attention {
   518→  @apply animate-pulse border-2 border-orange-300;
   519→}
   520→```
   521→
   522→---
   523→
   524→## 交互设计
   525→
   526→### 签到流程
   527→
   528→```
   529→┌─────────────────────────────────────────────────────────────────────────────┐
   530→│                           签到交互流程                                       │
   531→├─────────────────────────────────────────────────────────────────────────────┤
   532→│                                                                             │
   533→│   状态 1: 未签到                                                            │
   534→│   ────────────────                                                          │
   535→│                                                                             │
   536→│   ┌───────────────────────────────────┐                                    │
   537→│   │                                   │                                    │
   538→│   │  ☀️ 今日杠杆行动                   │                                    │
   539→│   │                                   │                                    │
   540→│   │  □ 完成3.2节初稿                  │                                    │
   541→│   │  □ 回复小明的邮件                 │                                    │
   542→│   │  □ 30分钟阅读                     │                                    │
   543→│   │                                   │                                    │
   544→│   │  🔥 7天   [ 开始今天 ]  ← 主按钮  │                                    │
   545→│   │                                   │                                    │
   546→│   └───────────────────────────────────┘                                    │
   547→│                                                                             │
   548→│           │ 点击 "开始今天"                                                 │
   549→│           ▼                                                                 │
   550→│                                                                             │
   551→│   状态 2: 签到动画                                                          │
   552→│   ────────────────                                                          │
   553→│                                                                             │
   554→│   ┌───────────────────────────────────┐                                    │
   555→│   │                                   │                                    │
   556→│   │              ✨                    │                                    │
   557→│   │           🔥 8天                   │ ← 数字跳动 + 火焰放大              │
   558→│   │              ✨                    │                                    │
   559→│   │                                   │                                    │
   560→│   │  "新的一天，新的开始！"           │ ← 鼓励语                           │
   561→│   │                                   │                                    │
   562→│   └───────────────────────────────────┘                                    │
   563→│                                                                             │
   564→│           │ 1.5s 后自动过渡                                                 │
   565→│           ▼                                                                 │
   566→│                                                                             │
   567→│   状态 3: 已签到                                                            │
   568→│   ────────────────                                                          │
   569→│                                                                             │
   570→│   ┌───────────────────────────────────┐                                    │
   571→│   │                                   │                                    │
   572→│   │  ✓ 今日杠杆行动                   │ ← 标题变绿                         │
   573→│   │                                   │                                    │
   574→│   │  ☑ 完成3.2节初稿      ← 可勾选   │                                    │
   575→│   │  □ 回复小明的邮件                 │                                    │
   576→│   │  □ 30分钟阅读                     │                                    │
   577→│   │                                   │                                    │
   578→│   │  🔥 8天   进度 1/3                │ ← 显示完成进度                     │
   579→│   │                                   │                                    │
   580→│   └───────────────────────────────────┘                                    │
   581→│                                                                             │
   582→└─────────────────────────────────────────────────────────────────────────────┘
   583→```
   584→
   585→### 卡片交互
   586→
   587→```
   588→┌─────────────────────────────────────────────────────────────────────────────┐
   589→│                           卡片交互模式                                       │
   590→├─────────────────────────────────────────────────────────────────────────────┤
   591→│                                                                             │
   592→│   悬停展开 (Desktop)                                                        │
   593→│   ──────────────────                                                        │
   594→│                                                                             │
   595→│   Normal:                          Hover:                                   │
   596→│   ┌──────────────────┐             ┌──────────────────┐                    │
   597→│   │                  │             │                  │ ↑ translate(-2px)  │
   598→│   │  WHO I AM        │   ────▶    │  WHO I AM        │                    │
   599→│   │  🎨 💕 🧭 ⚔️      │             │  🎨 💕 🧭 ⚔️      │                    │
   600→│   │                  │             │                  │                    │
   601→│   └──────────────────┘             │  ──────────────  │                    │
   602→│                                    │  查看详情 →      │ ← 显示操作         │
   603→│                                    │                  │                    │
   604→│                                    └──────────────────┘                    │
   605→│                                                                             │
   606→│   点击展开详情 (Modal)                                                       │
   607→│   ────────────────────                                                      │
   608→│                                                                             │
   609→│   ┌─────────────────────────────────────────────────────────────────────┐  │
   610→│   │                                                                     │  │
   611→│   │   WHO I AM                                                    ✕     │  │
   612→│   │   ═══════════                                                       │  │
   613→│   │                                                                     │  │
   614→│   │   ┌────────────────────────────────────────────────────────────┐   │  │
   615→│   │   │                                                            │   │  │
   616→│   │   │        🎨                    💕                            │   │  │
   617→│   │   │      创造者                  情人                          │   │  │
   618→│   │   │       核心                   内在                          │   │  │
   619→│   │   │                                                            │   │  │
   620→│   │   │        🧭                    ⚔️                            │   │  │
   621→│   │   │      探索者                  英雄                          │   │  │
   622→│   │   │       外在                   阴影                          │   │  │
   623→│   │   │                                                            │   │  │
   624→│   │   └────────────────────────────────────────────────────────────┘   │  │
   625→│   │                                                                     │  │
   626→│   │   身份宣言                                                          │  │
   627→│   │   ──────────                                                        │  │
   628→│   │   "我是一个每天都在创造、用作品连接世界的人"                        │  │
   629→│   │                                                                     │  │
   630→│   │   核心优势                                                          │  │
   631→│   │   ──────────                                                        │  │
   632→│   │   • 将想象变为现实的能力                                            │  │
   633→│   │   • 深度连接与感受美的能力                                          │  │
   634→│   │                                                                     │  │
   635→│   │   成长方向                                                          │  │
   636→│   │   ──────────                                                        │  │
   637→│   │   • 完成而非只是开始                                                │  │
   638→│   │   • 保持独立自我                                                    │  │
   639→│   │                                                                     │  │
   640→│   │                               [ 与 AI 深入探索 ]                    │  │
   641→│   │                                                                     │  │
   642→│   └─────────────────────────────────────────────────────────────────────┘  │
   643→│                                                                             │
   644→└─────────────────────────────────────────────────────────────────────────────┘
   645→```
   646→
   647→---
   648→
   649→## 智能排序算法
   650→
   651→```typescript
   652→// src/lib/dashboard/card-priority.ts
   653→
   654→interface CardPriority {
   655→  cardId: string;
   656→  score: number;
   657→  reason: string;
   658→}
   659→
   660→/**
   661→ * 计算卡片优先级
   662→ * 原则：最需要关注的在前面
   663→ */
   664→function calculateCardPriorities(data: DashboardDTO): CardPriority[] {
   665→  const priorities: CardPriority[] = [];
   666→  const now = new Date();
   667→  const hour = now.getHours();
   668→
   669→  // 1. 今日卡片 - 早晨优先
   670→  if (!data.today.checkedIn) {
   671→    priorities.push({
   672→      cardId: 'today',
   673→      score: hour < 12 ? 100 : 80,  // 中午前更高优先级
   674→      reason: '未签到'
   675→    });
   676→  } else {
   677→    const completedCount = data.today.levers.filter(l => l.completed).length;
   678→    const totalCount = data.today.levers.length;
   679→    priorities.push({
   680→      cardId: 'today',
   681→      score: 50 + (1 - completedCount / totalCount) * 30,
   682→      reason: `${completedCount}/${totalCount} 完成`
   683→    });
   684→  }
   685→
   686→  // 2. 身份卡片 - 稳定显示
   687→  priorities.push({
   688→    cardId: 'identity',
   689→    score: 70,
   690→    reason: '核心身份'
   691→  });
   692→
   693→  // 3. 本周卡片 - 周末提升优先级
   694→  const dayOfWeek = now.getDay();
   695→  const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
   696→  const weekProgress = data.week.rocks.filter(r => r.completed).length / data.week.rocks.length;
   697→
   698→  priorities.push({
   699→    cardId: 'week',
   700→    score: isWeekend ? 90 : (60 + (1 - weekProgress) * 20),
   701→    reason: isWeekend ? '周末复盘' : `${Math.round(weekProgress * 100)}% 完成`
   702→  });
   703→
   704→  // 4. 北极星卡片 - 月末提升优先级
   705→  const dayOfMonth = now.getDate();
   706→  const isEndOfMonth = dayOfMonth > 25;
   707→
   708→  priorities.push({
   709→    cardId: 'northStar',
   710→    score: isEndOfMonth ? 85 : 55,
   711→    reason: isEndOfMonth ? '月末冲刺' : '长期愿景'
   712→  });
   713→
   714→  // 5. 成长时间线 - 有里程碑临近时提升
   715→  const upcomingMilestone = data.growth.milestones.find(
   716→    m => m.type === 'future' && new Date(m.date).getTime() - now.getTime() < 7 * 24 * 60 * 60 * 1000
   717→  );
   718→
   719→  priorities.push({
   720→    cardId: 'growth',
   721→    score: upcomingMilestone ? 75 : 40,
   722→    reason: upcomingMilestone ? '里程碑临近' : '成长记录'
   723→  });
   724→
   725→  return priorities.sort((a, b) => b.score - a.score);
   726→}
   727→```
   728→
   729→---
   730→
   731→## 主动推送集成
   732→
   733→```
   734→┌─────────────────────────────────────────────────────────────────────────────┐
   735→│                      Dashboard 主动推送集成                                  │
   736→├─────────────────────────────────────────────────────────────────────────────┤
   737→│                                                                             │
   738→│   触发场景                                                                   │
   739→│   ──────────                                                                │
   740→│                                                                             │
   741→│   1. 每日签到提醒 (08:00)                                                   │
   742→│      └─ 嵌入 Today 卡片顶部                                                 │
   743→│                                                                             │
   744→│   2. 周复盘引导 (周日 20:00)                                                │
   745→│      └─ 浮动卡片 + Week 卡片高亮                                            │
   746→│                                                                             │
   747→│   3. 月度检查 (月初)                                                        │
   748→│      └─ NorthStar 卡片高亮 + Modal 引导                                     │
   749→│                                                                             │
   750→│   4. 关怀询问 (连续3天未登录)                                               │
   751→│      └─ 全屏温暖问候                                                        │
   752→│                                                                             │
   753→│   ─────────────────────────────────────────────────────────────────────     │
   754→│                                                                             │
   755→│   视觉呈现                                                                   │
   756→│   ──────────                                                                │
   757→│                                                                             │
   758→│   嵌入式:                                                                   │
   759→│   ┌───────────────────────────────────┐                                    │
   760→│   │  ┌─────────────────────────────┐  │                                    │
   761→│   │  │ 💬 "早安！今天的杠杆行动..." │  │ ← 卡片内嵌消息                    │
   762→│   │  └─────────────────────────────┘  │                                    │
   763→│   │                                   │                                    │
   764→│   │  □ 完成3.2节初稿                  │                                    │
   765→│   │  □ 回复小明的邮件                 │                                    │
   766→│   │                                   │                                    │
   767→│   └───────────────────────────────────┘                                    │
   768→│                                                                             │
   769→│   浮动式:                                                                   │
   770→│   ┌───────────────────────────────────────────────────────────────────┐    │
   771→│   │                                                                   │    │
   772→│   │  ┌─────────────────────────────────────────────────────────────┐ │    │
   773→│   │  │                                                             │ │    │
   774→│   │  │  这周结束了                                                  │ │    │
   775→│   │  │  ──────────                                                 │ │    │
   776→│   │  │                                                             │ │    │
   777→│   │  │  "回顾过去7天，你完成了3/4个大石头。                        │ │    │
   778→│   │  │   想聊聊这周的收获吗？"                                     │ │    │
   779→│   │  │                                                             │ │    │
   780→│   │  │              [ 开始周复盘 ]  [ 稍后再说 ]                   │ │    │
   781→│   │  │                                                             │ │    │
   782→│   │  └─────────────────────────────────────────────────────────────┘ │    │
   783→│   │                                                                   │    │
   784→│   └───────────────────────────────────────────────────────────────────┘    │
   785→│                                                                             │
   786→└─────────────────────────────────────────────────────────────────────────────┘
   787→```
   788→
   789→---
   790→
   791→## 空状态设计
   792→
   793→```
   794→┌─────────────────────────────────────────────────────────────────────────────┐
   795→│                           空状态处理                                         │
   796→├─────────────────────────────────────────────────────────────────────────────┤
   797→│                                                                             │
   798→│   新用户 (无任何数据)                                                        │
   799→│   ────────────────────                                                      │
   800→│                                                                             │
   801→│   ┌─────────────────────────────────────────────────────────────────────┐  │
   802→│   │                                                                     │  │
   803→│   │                          🌱                                         │  │
   804→│   │                                                                     │  │
   805→│   │                    欢迎来到 VibeLife                                │  │
   806→│   │                                                                     │  │
   807→│   │         让我们一起开始这段理解自己的旅程                            │  │
   808→│   │                                                                     │  │
   809→│   │                                                                     │  │
   810→│   │         ┌─────────────────────────────────────────┐                │  │
   811→│   │         │                                         │                │  │
   812→│   │         │  第一步：和我聊聊你是谁                 │                │  │
   813→│   │         │                                         │                │  │
   814→│   │         │  我会通过对话了解你，帮你发现            │                │  │
   815→│   │         │  属于你的人格原型和人生方向              │                │  │
   816→│   │         │                                         │                │  │
   817→│   │         │         [ 开始对话 ]                    │                │  │
   818→│   │         │                                         │                │  │
   819→│   │         └─────────────────────────────────────────┘                │  │
   820→│   │                                                                     │  │
   821→│   └─────────────────────────────────────────────────────────────────────┘  │
   822→│                                                                             │
   823→│   ─────────────────────────────────────────────────────────────────────     │
   824→│                                                                             │
   825→│   部分数据缺失                                                               │
   826→│   ──────────────                                                            │
   827→│                                                                             │
   828→│   有 VibeProfile，无 Lifecoach:                                             │
   829→│                                                                             │
   830→│   ┌──────────────────────────────────┐  ┌──────────────────────────────┐   │
   831→│   │  WHO I AM           ✓           │  │  TODAY'S FOCUS               │   │
   832→│   │  ─────────                      │  │  ─────────────               │   │
   833→│   │                                 │  │                              │   │
   834→│   │  🎨 💕 🧭 ⚔️                     │  │  ┌──────────────────────┐   │   │
   835→│   │                                 │  │  │                      │   │   │
   836→│   │  "我是一个创造者"               │  │  │  还没有设定目标       │   │   │
   837→│   │                                 │  │  │                      │   │   │
   838→│   └──────────────────────────────────┘  │  │  [ 设定今日计划 ]    │   │   │
   839→│                                         │  │                      │   │   │
   840→│                                         │  └──────────────────────┘   │   │
   841→│                                         │                              │   │
   842→│                                         └──────────────────────────────┘   │
   843→│                                                                             │
   844→└─────────────────────────────────────────────────────────────────────────────┘
   845→```
   846→
   847→---
   848→
   849→## 性能优化策略
   850→
   851→```typescript
   852→// 性能优化清单
   853→
   854→/**
   855→ * 1. 数据获取优化
   856→ */
   857→// 使用 SWR 进行数据缓存和去重
   858→const { data } = useSWR('/api/dashboard', fetcher, {
   859→  revalidateOnFocus: false,
   860→  dedupingInterval: 60000,  // 1分钟内不重复请求
   861→});
   862→
   863→// 并行获取独立数据
   864→const [profile, lifecoach, proactive] = await Promise.all([
   865→  fetchProfile(userId),
   866→  fetchLifecoach(userId),
   867→  fetchProactive(userId),
   868→]);
   869→
   870→/**
   871→ * 2. 渲染优化
   872→ */
   873→// 使用 memo 防止不必要的重渲染
   874→const IdentityCard = memo(function IdentityCard({ archetypes }) {
   875→  // ...
   876→});
   877→
   878→// 虚拟化长列表 (如 milestones)
   879→<VirtualizedList
   880→  items={milestones}
   881→  itemHeight={60}
   882→  renderItem={(item) => <MilestoneNode {...item} />}
   883→/>
   884→
   885→/**
   886→ * 3. 代码分割
   887→ */
   888→// 动态导入模态框组件
   889→const IdentityModal = dynamic(() => import('./IdentityModal'), {
   890→  loading: () => <ModalSkeleton />,
   891→});
   892→
   893→/**
   894→ * 4. 骨架屏
   895→ */
   896→// 加载时显示骨架屏
   897→{isLoading ? (
   898→  <DashboardSkeleton />
   899→) : (
   900→  <DashboardContent data={data} />
   901→)}
   902→```
   903→
   904→---
   905→
   906→## 文件结构
   907→
   908→```
   909→apps/web/src/
   910→├── app/
   911→│   └── dashboard/
   912→│       ├── page.tsx                    # Dashboard 页面入口 (RSC)
   913→│       ├── loading.tsx                 # 加载状态
   914→│       └── error.tsx                   # 错误处理
   915→│
   916→├── components/
   917→│   └── dashboard/
   918→│       ├── DashboardProvider.tsx       # 状态管理 Provider
   919→│       ├── DashboardGrid.tsx           # 网格布局
   920→│       ├── AmbientHeader.tsx           # 问候区域
   921→│       │
   922→│       ├── cards/
   923→│       │   ├── IdentityCard.tsx        # WHO I AM 卡片
   924→│       │   ├── TodayCard.tsx           # 今日焦点卡片
   925→│       │   ├── NorthStarCard.tsx       # 北极星卡片
   926→│       │   ├── WeekCard.tsx            # 本周卡片
   927→│       │   └── GrowthTimeline.tsx      # 成长时间线
   928→│       │
   929→│       ├── shared/
   930→│       │   ├── DashboardCard.tsx       # 基础卡片组件
   931→│       │   ├── ProgressBar.tsx         # 进度条
   932→│       │   ├── StreakBadge.tsx         # 连续签到徽章
   933→│       │   └── CheckInButton.tsx       # 签到按钮
   934→│       │
   935→│       └── modals/
   936→│           ├── IdentityModal.tsx       # 身份详情弹窗
   937→│           ├── WeekReviewModal.tsx     # 周复盘弹窗
   938→│           └── ProactiveModal.tsx      # 主动推送弹窗
   939→│
   940→├── hooks/
   941→│   └── useDashboard.ts                 # Dashboard 数据 Hook
   942→│
   943→├── lib/
   944→│   └── dashboard/
   945→│       ├── card-priority.ts            # 卡片优先级算法
   946→│       └── greeting.ts                 # 问候语生成
   947→│
   948→├── stores/
   949→│   └── dashboardStore.ts               # Dashboard 状态存储
   950→│
   951→└── types/
   952→    └── dashboard.ts                    # TypeScript 类型定义
   953→```
   954→
   955→---
   956→
   957→## 实施优先级
   958→
   959→```
   960→┌─────────────────────────────────────────────────────────────────────────────┐
   961→│                           实施路线图                                         │
   962→├─────────────────────────────────────────────────────────────────────────────┤
   963→│                                                                             │
   964→│   Phase 1: MVP (P0) - 核心体验                                              │
   965→│   ════════════════════════════════                                          │
   966→│                                                                             │
   967→│   ✓ AmbientHeader (问候 + 日期)                                             │
   968→│   ✓ TodayCard (今日杠杆 + 签到)                                             │
   969→│   ✓ IdentityCard (四维原型 + 身份宣言)                                      │
   970→│   ✓ 基础响应式布局                                                          │
   971→│   ✓ useDashboard Hook                                                       │
   972→│                                                                             │
   973→│   ─────────────────────────────────────────────────────────────────────     │
   974→│                                                                             │
   975→│   Phase 2: 完整功能 (P1)                                                    │
   976→│   ════════════════════════                                                  │
   977→│                                                                             │
   978→│   □ NorthStarCard (愿景 + 月度进度)                                         │
   979→│   □ WeekCard (大石头 + 角色平衡)                                            │
   980→│   □ GrowthTimeline (里程碑)                                                 │
   981→│   □ 签到动画                                                                │
   982→│   □ 智能卡片排序                                                            │
   983→│                                                                             │
   984→│   ─────────────────────────────────────────────────────────────────────     │
   985→│                                                                             │
   986→│   Phase 3: 进阶体验 (P2)                                                    │
   987→│   ════════════════════════                                                  │
   988→│                                                                             │
   989→│   □ 主动推送集成                                                            │
   990→│   □ 详情弹窗                                                                │
   991→│   □ 数据可视化增强                                                          │
   992→│   □ 空状态引导                                                              │
   993→│   □ 性能优化                                                                │
   994→│                                                                             │
   995→└─────────────────────────────────────────────────────────────────────────────┘
   996→```
   997→
   998→---
   999→
  1000→## 附录: API 接口规格
  1001→
  1002→### GET /api/dashboard
  1003→
  1004→```typescript
  1005→// Request
  1006→GET /api/dashboard?user_id={user_id}
  1007→
  1008→// Response
  1009→{
  1010→  "success": true,
  1011→  "data": DashboardDTO,
  1012→  "meta": {
  1013→    "cached": boolean,
  1014→    "generatedAt": string
  1015→  }
  1016→}
  1017→```
  1018→
  1019→### POST /api/dashboard/checkin
  1020→
  1021→```typescript
  1022→// Request
  1023→POST /api/dashboard/checkin
  1024→{
  1025→  "user_id": string
  1026→}
  1027→
  1028→// Response
  1029→{
  1030→  "success": true,
  1031→  "data": {
  1032→    "streak": number,
  1033→    "message": string,
  1034→    "animation": "fire" | "confetti" | "sparkle"
  1035→  }
  1036→}
  1037→```
  1038→
  1039→### PATCH /api/dashboard/lever/:id
  1040→
  1041→```typescript
  1042→// Request
  1043→PATCH /api/dashboard/lever/{lever_id}
  1044→{
  1045→  "completed": boolean
  1046→}
  1047→
  1048→// Response
  1049→{
  1050→  "success": true,
  1051→  "data": {
  1052→    "lever": Lever,
  1053→    "todayProgress": {
  1054→      "completed": number,
  1055→      "total": number
  1056→    }
  1057→  }
  1058→}
  1059→```
  1060→
  1061→---
  1062→
  1063→> **Version**: 1.0 | 2026-01-19
  1064→> 设计师: Claude (World-class UI/UX)
  1065→> 愿景对齐: VibeLife-northstar-v8.md
  1066→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
