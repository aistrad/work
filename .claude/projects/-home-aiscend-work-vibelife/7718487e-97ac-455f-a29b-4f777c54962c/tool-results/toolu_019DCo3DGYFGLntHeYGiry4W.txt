The file /home/aiscend/work/vibelife/docs/components/dashboard/DATA-FLOW.md has been updated. Here's the result of running `cat -n` on a snippet of the edited file:
     1â†’# Dashboard æ•°æ®æµè®¾è®¡
     2â†’
     3â†’> **Version**: 2.0 | 2026-01-19
     4â†’> **å…³è”æ–‡æ¡£**: DESIGN.md, COMPONENTS.md
     5â†’
     6â†’---
     7â†’
     8â†’## æ•°æ®æºæ˜ å°„
     9â†’
    10â†’```
    11â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    12â†’â”‚                         Dashboard æ•°æ®æºå…¨æ™¯ v2.0                                â”‚
    13â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    14â†’â”‚                                                                                  â”‚
    15â†’â”‚   Dashboard                    æ•°æ®æº                       å­˜å‚¨ä½ç½®             â”‚
    16â†’â”‚   â•â•â•â•â•â•â•â•â•                    â•â•â•â•â•                        â•â•â•â•â•               â”‚
    17â†’â”‚                                                                                  â”‚
    18â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
    19â†’â”‚   â”‚ Ambient     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ç³»ç»Ÿæ—¶é—´ + èŠ‚æ°” API â”€â”€â”€â”€â”€â”€â”€â”€â–¶ å®æ—¶è®¡ç®—           â”‚
    20â†’â”‚   â”‚ Header      â”‚              Quote Library â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ static/quotes.ts   â”‚
    21â†’â”‚   â”‚             â”‚              ç”¨æˆ·åå¥½ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ preferences       â”‚
    22â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              Check-in çŠ¶æ€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ life_context       â”‚
    23â†’â”‚                                                                                  â”‚
    24â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
    25â†’â”‚   â”‚ Lifecoach   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ North Star â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ life_context       â”‚
    26â†’â”‚   â”‚ Card        â”‚              (vision, yearGoal)            ._paths.lifecoach  â”‚
    27â†’â”‚   â”‚ (Unified)   â”‚                                            .north_star        â”‚
    28â†’â”‚   â”‚             â”‚              Monthly Project â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ .current.month    â”‚
    29â†’â”‚   â”‚             â”‚              (name, progress, days)        .roadmap           â”‚
    30â†’â”‚   â”‚             â”‚                                                               â”‚
    31â†’â”‚   â”‚             â”‚              Today Levers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ .current.daily    â”‚
    32â†’â”‚   â”‚             â”‚              (3 levers, streak)            .progress          â”‚
    33â†’â”‚   â”‚             â”‚                                                               â”‚
    34â†’â”‚   â”‚             â”‚              Week Rocks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ .current.week     â”‚
    35â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              (rocks, roles)                .goals             â”‚
    36â†’â”‚                                                                                  â”‚
    37â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
    38â†’â”‚   â”‚ My Skills   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Subscribed Skills â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ user_skills       â”‚
    39â†’â”‚   â”‚ Carousel    â”‚              (skill_id list)               table              â”‚
    40â†’â”‚   â”‚             â”‚                                                               â”‚
    41â†’â”‚   â”‚             â”‚              Proactive Engine â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ skill_cards        â”‚
    42â†’â”‚   â”‚             â”‚              (computed content)            cache / realtime   â”‚
    43â†’â”‚   â”‚             â”‚                                                               â”‚
    44â†’â”‚   â”‚             â”‚              Skill Card Registry â”€â”€â”€â”€â”€â”€â”€â”€â–¶ skill_registry     â”‚
    45â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              (metadata, endpoints)         table              â”‚
    46â†’â”‚                                                                                  â”‚
    47â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
    48â†’â”‚   â”‚ Discover    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ All Skills - Subscribed â”€â”€â”€â”€â–¶ skill_registry    â”‚
    49â†’â”‚   â”‚ Carousel    â”‚              (unsubscribed list)           table              â”‚
    50â†’â”‚   â”‚             â”‚                                                               â”‚
    51â†’â”‚   â”‚             â”‚              Recommendation Engine â”€â”€â”€â”€â”€â”€â–¶ ML / Rules         â”‚
    52â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              (personalized ranking)                           â”‚
    53â†’â”‚                                                                                  â”‚
    54â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    55â†’```
    56â†’
    57â†’---
    58â†’
    59â†’## Skill æ•°æ®æµæ ¸å¿ƒ
    60â†’
    61â†’```
    62â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    63â†’â”‚                         Skill Card æ•°æ®æµ                                        â”‚
    64â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    65â†’â”‚                                                                                  â”‚
    66â†’â”‚   1. Skill æ³¨å†Œ (ç³»ç»Ÿå¯åŠ¨æ—¶)                                                     â”‚
    67â†’â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                      â”‚
    68â†’â”‚                                                                                  â”‚
    69â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    70â†’â”‚   â”‚                                                                         â”‚   â”‚
    71â†’â”‚   â”‚   skills/                                                               â”‚   â”‚
    72â†’â”‚   â”‚   â”œâ”€â”€ bazi/                                                            â”‚   â”‚
    73â†’â”‚   â”‚   â”‚   â”œâ”€â”€ SKILL.md                                                     â”‚   â”‚
    74â†’â”‚   â”‚   â”‚   â””â”€â”€ cards/                                                       â”‚   â”‚
    75â†’â”‚   â”‚   â”‚       â””â”€â”€ daily_fortune.yaml   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
    76â†’â”‚   â”‚   â”œâ”€â”€ zodiac/                                       â”‚                  â”‚   â”‚
    77â†’â”‚   â”‚   â”‚   â””â”€â”€ cards/                                    â”‚                  â”‚   â”‚
    78â†’â”‚   â”‚   â”‚       â””â”€â”€ weekly_horoscope.yaml â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚   â”‚
    79â†’â”‚   â”‚   â””â”€â”€ jungian/                                      â”‚                  â”‚   â”‚
    80â†’â”‚   â”‚       â””â”€â”€ cards/                                    â–¼                  â”‚   â”‚
    81â†’â”‚   â”‚           â””â”€â”€ archetype_insight.yaml â”€â”€â”€â”€â”€â”€â–¶ skill_registry           â”‚   â”‚
    82â†’â”‚   â”‚                                                                         â”‚   â”‚
    83â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
    84â†’â”‚                                                                                  â”‚
    85â†’â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
    86â†’â”‚                                                                                  â”‚
    87â†’â”‚   2. ç”¨æˆ·è®¢é˜…                                                                    â”‚
    88â†’â”‚   â•â•â•â•â•â•â•â•â•â•â•                                                                    â”‚
    89â†’â”‚                                                                                  â”‚
    90â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
    91â†’â”‚   â”‚                                                                         â”‚   â”‚
    92â†’â”‚   â”‚   POST /api/skills/subscribe                                            â”‚   â”‚
    93â†’â”‚   â”‚   { "skill_id": "jungian" }                                            â”‚   â”‚
    94â†’â”‚   â”‚                                                                         â”‚   â”‚
    95â†’â”‚   â”‚        â”‚                                                                â”‚   â”‚
    96â†’â”‚   â”‚        â–¼                                                                â”‚   â”‚
    97â†’â”‚   â”‚   user_skills table                                                     â”‚   â”‚
    98â†’â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
    99â†’â”‚   â”‚   â”‚ user_id      â”‚ skill_id    â”‚ subscribed_at     â”‚ config       â”‚   â”‚   â”‚
   100â†’â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
   101â†’â”‚   â”‚   â”‚ user_123     â”‚ bazi        â”‚ 2026-01-01        â”‚ {}           â”‚   â”‚   â”‚
   102â†’â”‚   â”‚   â”‚ user_123     â”‚ jungian     â”‚ 2026-01-19        â”‚ {}           â”‚   â”‚   â”‚
   103â†’â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
   104â†’â”‚   â”‚                                                                         â”‚   â”‚
   105â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   106â†’â”‚                                                                                  â”‚
   107â†’â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
   108â†’â”‚                                                                                  â”‚
   109â†’â”‚   3. Proactive Engine è®¡ç®—                                                       â”‚
   110â†’â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                       â”‚
   111â†’â”‚                                                                                  â”‚
   112â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   113â†’â”‚   â”‚                                                                         â”‚   â”‚
   114â†’â”‚   â”‚   è§¦å‘å™¨:                                                                â”‚   â”‚
   115â†’â”‚   â”‚   - å®šæ—¶ä»»åŠ¡ (daily/weekly)                                             â”‚   â”‚
   116â†’â”‚   â”‚   - ç”¨æˆ·è¯·æ±‚ Dashboard                                                  â”‚   â”‚
   117â†’â”‚   â”‚   - å¤–éƒ¨äº‹ä»¶ (èŠ‚æ°”å˜åŒ–ç­‰)                                               â”‚   â”‚
   118â†’â”‚   â”‚                                                                         â”‚   â”‚
   119â†’â”‚   â”‚        â”‚                                                                â”‚   â”‚
   120â†’â”‚   â”‚        â–¼                                                                â”‚   â”‚
   121â†’â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
   122â†’â”‚   â”‚   â”‚                     Proactive Engine                             â”‚ â”‚   â”‚
   123â†’â”‚   â”‚   â”‚                                                                  â”‚ â”‚   â”‚
   124â†’â”‚   â”‚   â”‚   for skill in user.subscribed_skills:                          â”‚ â”‚   â”‚
   125â†’â”‚   â”‚   â”‚       card_def = skill_registry.get_card(skill.card_id)         â”‚ â”‚   â”‚
   126â†’â”‚   â”‚   â”‚                                                                  â”‚ â”‚   â”‚
   127â†’â”‚   â”‚   â”‚       if should_refresh(card_def.refresh):                      â”‚ â”‚   â”‚
   128â†’â”‚   â”‚   â”‚           content = await compute_card_content(                 â”‚ â”‚   â”‚
   129â†’â”‚   â”‚   â”‚               skill_id=skill.id,                                â”‚ â”‚   â”‚
   130â†’â”‚   â”‚   â”‚               user_profile=user.profile,                        â”‚ â”‚   â”‚
   131â†’â”‚   â”‚   â”‚               context=current_context                           â”‚ â”‚   â”‚
   132â†’â”‚   â”‚   â”‚           )                                                     â”‚ â”‚   â”‚
   133â†’â”‚   â”‚   â”‚           cache.set(f"card:{user.id}:{skill.card_id}", content) â”‚ â”‚   â”‚
   134â†’â”‚   â”‚   â”‚                                                                  â”‚ â”‚   â”‚
   135â†’â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
   136â†’â”‚   â”‚        â”‚                                                                â”‚   â”‚
   137â†’â”‚   â”‚        â–¼                                                                â”‚   â”‚
   138â†’â”‚   â”‚   skill_cards cache                                                     â”‚   â”‚
   139â†’â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
   140â†’â”‚   â”‚   â”‚ key                              â”‚ content          â”‚ ttl      â”‚   â”‚   â”‚
   141â†’â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
   142â†’â”‚   â”‚   â”‚ card:user_123:bazi_daily         â”‚ { ... }          â”‚ 24h      â”‚   â”‚   â”‚
   143â†’â”‚   â”‚   â”‚ card:user_123:jungian_insight    â”‚ { ... }          â”‚ 7d       â”‚   â”‚   â”‚
   144â†’â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
   145â†’â”‚   â”‚                                                                         â”‚   â”‚
   146â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   147â†’â”‚                                                                                  â”‚
   148â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   149â†’```
   150â†’
   151â†’---
   152â†’
   153â†’## èšåˆ API è®¾è®¡
   154â†’
   155â†’```
   156â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   157â†’â”‚                         Dashboard èšåˆ API v2.0                                  â”‚
   158â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   159â†’â”‚                                                                                  â”‚
   160â†’â”‚   GET /api/dashboard                                                             â”‚
   161â†’â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                            â”‚
   162â†’â”‚                                                                                  â”‚
   163â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   164â†’â”‚   â”‚                                                                         â”‚   â”‚
   165â†’â”‚   â”‚   async def get_dashboard(user_id: str) -> DashboardDTO:                â”‚   â”‚
   166â†’â”‚   â”‚                                                                         â”‚   â”‚
   167â†’â”‚   â”‚       # 1. å¹¶è¡Œè·å–åŸºç¡€æ•°æ®                                              â”‚   â”‚
   168â†’â”‚   â”‚       profile, lifecoach, subscriptions = await asyncio.gather(         â”‚   â”‚
   169â†’â”‚   â”‚           vibe_profile_repo.get_profile(user_id),                       â”‚   â”‚
   170â†’â”‚   â”‚           lifecoach_service.get_state(user_id),                         â”‚   â”‚
   171â†’â”‚   â”‚           skill_service.get_subscriptions(user_id)                      â”‚   â”‚
   172â†’â”‚   â”‚       )                                                                 â”‚   â”‚
   173â†’â”‚   â”‚                                                                         â”‚   â”‚
   174â†’â”‚   â”‚       # 2. è·å– Skill Cards (å·²è®¡ç®—çš„å†…å®¹)                               â”‚   â”‚
   175â†’â”‚   â”‚       my_skills = await proactive_engine.get_skill_cards(               â”‚   â”‚
   176â†’â”‚   â”‚           user_id=user_id,                                              â”‚   â”‚
   177â†’â”‚   â”‚           skill_ids=subscriptions.skill_ids                             â”‚   â”‚
   178â†’â”‚   â”‚       )                                                                 â”‚   â”‚
   179â†’â”‚   â”‚                                                                         â”‚   â”‚
   180â†’â”‚   â”‚       # 3. è·å– Discover æ¨è                                            â”‚   â”‚
   181â†’â”‚   â”‚       discover = await recommendation_service.get_skills(               â”‚   â”‚
   182â†’â”‚   â”‚           user_id=user_id,                                              â”‚   â”‚
   183â†’â”‚   â”‚           exclude=subscriptions.skill_ids,                              â”‚   â”‚
   184â†’â”‚   â”‚           limit=10                                                      â”‚   â”‚
   185â†’â”‚   â”‚       )                                                                 â”‚   â”‚
   186â†’â”‚   â”‚                                                                         â”‚   â”‚
   187â†’â”‚   â”‚       # 4. ç»„è£… DTO                                                      â”‚   â”‚
   188â†’â”‚   â”‚       return DashboardDTO(                                              â”‚   â”‚
   189â†’â”‚   â”‚           ambient=build_ambient(profile),                               â”‚   â”‚
   190â†’â”‚   â”‚           status=build_status(lifecoach),                               â”‚   â”‚
   191â†’â”‚   â”‚           lifecoach=build_lifecoach(lifecoach),                         â”‚   â”‚
   192â†’â”‚   â”‚           mySkills=my_skills,                                           â”‚   â”‚
   193â†’â”‚   â”‚           discover=discover                                             â”‚   â”‚
   194â†’â”‚   â”‚       )                                                                 â”‚   â”‚
   195â†’â”‚   â”‚                                                                         â”‚   â”‚
   196â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   197â†’â”‚                                                                                  â”‚
   198â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   199â†’```
   200â†’
   201â†’---
   202â†’
   203â†’## API è§„æ ¼è¯¦ç»†
   204â†’
   205â†’### GET /api/dashboard
   206â†’
   207â†’```typescript
   208â†’// è¯·æ±‚
   209â†’GET /api/dashboard
   210â†’Headers:
   211â†’  Authorization: Bearer {token}
   212â†’
   213â†’// å“åº”
   214â†’{
   215â†’  "success": true,
   216â†’  "data": {
   217â†’    "userId": "user_123",
   218â†’    "generatedAt": "2026-01-19T08:00:00Z",
   219â†’
   220â†’    "ambient": {
   221â†’      "greeting": "æ—©å®‰ï¼Œå°è–‡",
   222â†’      "quote": {
   223â†’        "text": "æ¯ä¸€ä¸ªä¸æ›¾èµ·èˆçš„æ—¥å­ï¼Œéƒ½æ˜¯å¯¹ç”Ÿå‘½çš„è¾œè´Ÿã€‚",
   224â†’        "author": "å°¼é‡‡",
   225â†’        "category": "growth"
   226â†’      },
   227â†’      "date": "2026å¹´1æœˆ19æ—¥ å‘¨æ—¥",
   228â†’      "solarTerm": "å°å¯’ç¬¬ä¸‰å€™"
   229â†’    },
   230â†’
   231â†’    "status": {
   232â†’      "streak": 7,
   233â†’      "checkedIn": false,
   234â†’      "energy": "high"
   235â†’    },
   236â†’
   237â†’    "lifecoach": {
   238â†’      "northStar": {
   239â†’        "vision": "ç”¨æ–‡å­—å¸®åŠ©ä»–äººæ‰¾åˆ°æ–¹å‘",
   240â†’        "yearGoal": "å‡ºç‰ˆç¬¬ä¸€æœ¬ä¹¦"
   241â†’      },
   242â†’      "monthlyProject": {
   243â†’        "name": "å®Œæˆä¹¦ç±ç¬¬3ç« ",
   244â†’        "progress": 40,
   245â†’        "daysRemaining": 12
   246â†’      },
   247â†’      "todayLevers": [
   248â†’        { "id": "lever_1", "text": "å®Œæˆ3.2èŠ‚åˆç¨¿", "completed": false },
   249â†’        { "id": "lever_2", "text": "å›å¤å°æ˜çš„é‚®ä»¶", "completed": false },
   250â†’        { "id": "lever_3", "text": "30åˆ†é’Ÿé˜…è¯»", "completed": false }
   251â†’      ],
   252â†’      "weekRocks": [
   253â†’        { "id": "rock_1", "text": "å®Œæˆ3.2èŠ‚åˆç¨¿", "role": "åˆ›ä½œè€…", "completed": true },
   254â†’        { "id": "rock_2", "text": "å‘¨ä¸‰å¸¦å­©å­å»å…¬å›­", "role": "çˆ¶äº²", "completed": false },
   255â†’        { "id": "rock_3", "text": "å‘¨å…­çº¦ä¼š", "role": "ä¸ˆå¤«", "completed": false }
   256â†’      ]
   257â†’    },
   258â†’
   259â†’    "mySkills": [
   260â†’      {
   261â†’        "skillId": "bazi",
   262â†’        "cardId": "daily_fortune",
   263â†’        "title": "ä»Šæ—¥è¿åŠ¿",
   264â†’        "icon": "â˜¯ï¸",
   265â†’        "content": {
   266â†’          "summary": "ä»Šæ—¥å®œé™ä¸å®œåŠ¨",
   267â†’          "detail": "ç”²å­æ—¥ï¼Œæ°´æœ¨ç›¸ç”Ÿ...",
   268â†’          "advice": "é€‚åˆè¯»ä¹¦ã€å†™ä½œï¼Œä¸å®œé‡å¤§å†³ç­–"
   269â†’        },
   270â†’        "actionLabel": "æŸ¥çœ‹è¯¦æƒ…",
   271â†’        "actionRoute": "/skills/bazi/daily",
   272â†’        "lastUpdated": "2026-01-19T00:00:00Z"
   273â†’      },
   274â†’      {
   275â†’        "skillId": "jungian",
   276â†’        "cardId": "archetype_insight",
   277â†’        "title": "åŸå‹æ´å¯Ÿ",
   278â†’        "icon": "ğŸ­",
   279â†’        "content": {
   280â†’          "archetype": "åˆ›é€ è€…",
   281â†’          "insight": "æœ¬å‘¨ä½ çš„åˆ›é€ è€…åŸå‹æ´»è·ƒåº¦å¾ˆé«˜",
   282â†’          "shadow": "æ³¨æ„ä¸è¦é™·å…¥å®Œç¾ä¸»ä¹‰çš„é™·é˜±"
   283â†’        },
   284â†’        "actionLabel": "æ·±å…¥æ¢ç´¢",
   285â†’        "actionRoute": "/skills/jungian/insight",
   286â†’        "lastUpdated": "2026-01-13T00:00:00Z"
   287â†’      }
   288â†’    ],
   289â†’
   290â†’    "discover": [
   291â†’      {
   292â†’        "skillId": "zodiac",
   293â†’        "title": "æ˜Ÿåº§è¿åŠ¿",
   294â†’        "icon": "â­",
   295â†’        "tagline": "æ¢ç´¢æ˜Ÿè±¡æ™ºæ…§",
   296â†’        "description": "æ¯å‘¨æ˜Ÿåº§è¿åŠ¿åˆ†æï¼Œäº†è§£è¡Œæ˜Ÿå¯¹ä½ çš„å½±å“",
   297â†’        "subscriberCount": 1234
   298â†’      },
   299â†’      {
   300â†’        "skillId": "mbti",
   301â†’        "title": "MBTI æ•™ç»ƒ",
   302â†’        "icon": "ğŸ§ ",
   303â†’        "tagline": "ç†è§£ä½ çš„è®¤çŸ¥åŠŸèƒ½",
   304â†’        "description": "åŸºäº MBTI çš„ä¸ªæ€§åŒ–å‘å±•å»ºè®®",
   305â†’        "subscriberCount": 890
   306â†’      }
   307â†’    ]
   308â†’  },
   309â†’  "meta": {
   310â†’    "cached": false,
   311â†’    "cacheKey": "dashboard:user_123:20260119"
   312â†’  }
   313â†’}
   314â†’```
   315â†’
   316â†’### POST /api/skills/subscribe
   317â†’
   318â†’```typescript
   319â†’// è¯·æ±‚
   320â†’POST /api/skills/subscribe
   321â†’Headers:
   322â†’  Authorization: Bearer {token}
   323â†’Body:
   324â†’  {
   325â†’    "skillId": "zodiac"
   326â†’  }
   327â†’
   328â†’// å“åº”
   329â†’{
   330â†’  "success": true,
   331â†’  "data": {
   332â†’    "subscription": {
   333â†’      "skillId": "zodiac",
   334â†’      "subscribedAt": "2026-01-19T10:00:00Z"
   335â†’    },
   336â†’    "card": {
   337â†’      "skillId": "zodiac",
   338â†’      "cardId": "weekly_horoscope",
   339â†’      "title": "æœ¬å‘¨è¿åŠ¿",
   340â†’      "icon": "â­",
   341â†’      "content": {
   342â†’        "sign": "æ°´ç“¶åº§",
   343â†’        "summary": "æœ¬å‘¨äº‹ä¸šè¿æ—ºç››...",
   344â†’        "luckyDay": "å‘¨ä¸‰"
   345â†’      },
   346â†’      "actionLabel": "æŸ¥çœ‹å®Œæ•´è¿åŠ¿",
   347â†’      "actionRoute": "/skills/zodiac/weekly"
   348â†’    }
   349â†’  }
   350â†’}
   351â†’```
   352â†’
   353â†’### DELETE /api/skills/subscribe/{skillId}
   354â†’
   355â†’```typescript
   356â†’// è¯·æ±‚
   357â†’DELETE /api/skills/subscribe/zodiac
   358â†’Headers:
   359â†’  Authorization: Bearer {token}
   360â†’
   361â†’// å“åº”
   362â†’{
   363â†’  "success": true,
   364â†’  "data": {
   365â†’    "unsubscribed": "zodiac",
   366â†’    "unsubscribedAt": "2026-01-19T11:00:00Z"
   367â†’  }
   368â†’}
   369â†’```
   370â†’
   371â†’### POST /api/dashboard/checkin
   372â†’
   373â†’```typescript
   374â†’// è¯·æ±‚
   375â†’POST /api/dashboard/checkin
   376â†’Headers:
   377â†’  Authorization: Bearer {token}
   378â†’Body:
   379â†’  {
   380â†’    "timestamp": "2026-01-19T08:30:00Z"
   381â†’  }
   382â†’
   383â†’// å“åº”
   384â†’{
   385â†’  "success": true,
   386â†’  "data": {
   387â†’    "streak": 8,
   388â†’    "message": "å¤ªæ£’äº†ï¼è¿ç»­ç¬¬8å¤©ç­¾åˆ°ï¼",
   389â†’    "animation": "fire",
   390â†’    "status": {
   391â†’      "checkedIn": true,
   392â†’      "checkinTime": "2026-01-19T08:30:00Z",
   393â†’      "streak": 8
   394â†’    }
   395â†’  }
   396â†’}
   397â†’```
   398â†’
   399â†’### PATCH /api/dashboard/lever/{lever_id}
   400â†’
   401â†’```typescript
   402â†’// è¯·æ±‚
   403â†’PATCH /api/dashboard/lever/lever_1
   404â†’Headers:
   405â†’  Authorization: Bearer {token}
   406â†’Body:
   407â†’  {
   408â†’    "completed": true
   409â†’  }
   410â†’
   411â†’// å“åº”
   412â†’{
   413â†’  "success": true,
   414â†’  "data": {
   415â†’    "lever": {
   416â†’      "id": "lever_1",
   417â†’      "text": "å®Œæˆ3.2èŠ‚åˆç¨¿",
   418â†’      "completed": true,
   419â†’      "completedAt": "2026-01-19T10:30:00Z"
   420â†’    },
   421â†’    "progress": {
   422â†’      "completed": 1,
   423â†’      "total": 3,
   424â†’      "percentage": 33
   425â†’    },
   426â†’    "allCompleted": false
   427â†’  }
   428â†’}
   429â†’```
   430â†’
   431â†’---
   432â†’
   433â†’## ç¼“å­˜ç­–ç•¥
   434â†’
   435â†’```
   436â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   437â†’â”‚                              ç¼“å­˜å±‚çº§ v2.0                                       â”‚
   438â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   439â†’â”‚                                                                                  â”‚
   440â†’â”‚   Layer 1: æµè§ˆå™¨ç¼“å­˜ (SWR)                                                      â”‚
   441â†’â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                    â”‚
   442â†’â”‚                                                                                  â”‚
   443â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   444â†’â”‚   â”‚                                                                         â”‚   â”‚
   445â†’â”‚   â”‚   // Dashboard ä¸»æ•°æ®                                                    â”‚   â”‚
   446â†’â”‚   â”‚   useSWR('/api/dashboard', fetcher, {                                   â”‚   â”‚
   447â†’â”‚   â”‚     revalidateOnFocus: false,                                           â”‚   â”‚
   448â†’â”‚   â”‚     revalidateOnReconnect: true,                                        â”‚   â”‚
   449â†’â”‚   â”‚     dedupingInterval: 60000,       // 1åˆ†é’Ÿå†…å»é‡                        â”‚   â”‚
   450â†’â”‚   â”‚     errorRetryCount: 3,                                                 â”‚   â”‚
   451â†’â”‚   â”‚   });                                                                   â”‚   â”‚
   452â†’â”‚   â”‚                                                                         â”‚   â”‚
   453â†’â”‚   â”‚   // Skill Cards ç‹¬ç«‹ç¼“å­˜ (æ”¯æŒç‹¬ç«‹åˆ·æ–°)                                 â”‚   â”‚
   454â†’â”‚   â”‚   useSWR(`/api/skills/${skillId}/card`, fetcher, {                      â”‚   â”‚
   455â†’â”‚   â”‚     dedupingInterval: 300000,      // 5åˆ†é’Ÿå†…å»é‡                        â”‚   â”‚
   456â†’â”‚   â”‚   });                                                                   â”‚   â”‚
   457â†’â”‚   â”‚                                                                         â”‚   â”‚
   458â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   459â†’â”‚                                                                                  â”‚
   460â†’â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
   461â†’â”‚                                                                                  â”‚
   462â†’â”‚   Layer 2: Skill Card ç¼“å­˜ (Redis)                                              â”‚
   463â†’â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚
   464â†’â”‚                                                                                  â”‚
   465â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   466â†’â”‚   â”‚                                                                         â”‚   â”‚
   467â†’â”‚   â”‚   # æŒ‰ Skill åˆ·æ–°å‘¨æœŸè®¾ç½® TTL                                            â”‚   â”‚
   468â†’â”‚   â”‚                                                                         â”‚   â”‚
   469â†’â”‚   â”‚   card_key = f"card:{user_id}:{skill_id}:{card_id}"                     â”‚   â”‚
   470â†’â”‚   â”‚                                                                         â”‚   â”‚
   471â†’â”‚   â”‚   TTL ç­–ç•¥:                                                              â”‚   â”‚
   472â†’â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
   473â†’â”‚   â”‚   â”‚ refresh ç±»å‹      â”‚ TTL        â”‚ ç¤ºä¾‹                          â”‚   â”‚   â”‚
   474â†’â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
   475â†’â”‚   â”‚   â”‚ daily             â”‚ 24 hours   â”‚ å…«å­—æ¯æ—¥è¿åŠ¿                   â”‚   â”‚   â”‚
   476â†’â”‚   â”‚   â”‚ weekly            â”‚ 7 days     â”‚ è£æ ¼å‘¨æ´å¯Ÿ                     â”‚   â”‚   â”‚
   477â†’â”‚   â”‚   â”‚ realtime          â”‚ 5 minutes  â”‚ çŠ¶æ€è¿½è¸ªç±»                     â”‚   â”‚   â”‚
   478â†’â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
   479â†’â”‚   â”‚                                                                         â”‚   â”‚
   480â†’â”‚   â”‚   # ç¼“å­˜å¤±æ•ˆè§¦å‘                                                         â”‚   â”‚
   481â†’â”‚   â”‚   - ç”¨æˆ·æ‰‹åŠ¨åˆ·æ–° Skill Card                                              â”‚   â”‚
   482â†’â”‚   â”‚   - å®šæ—¶ä»»åŠ¡ (æŒ‰ refresh å‘¨æœŸ)                                           â”‚   â”‚
   483â†’â”‚   â”‚   - å¤–éƒ¨äº‹ä»¶ (èŠ‚æ°”å˜åŒ–ã€ç”¨æˆ·æ•°æ®æ›´æ–°)                                    â”‚   â”‚
   484â†’â”‚   â”‚                                                                         â”‚   â”‚
   485â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   486â†’â”‚                                                                                  â”‚
   487â†’â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
   488â†’â”‚                                                                                  â”‚
   489â†’â”‚   Layer 3: Dashboard èšåˆç¼“å­˜                                                    â”‚
   490â†’â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                   â”‚
   491â†’â”‚                                                                                  â”‚
   492â†’â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
   493â†’â”‚   â”‚                                                                         â”‚   â”‚
   494â†’â”‚   â”‚   cache_key = f"dashboard:{user_id}:{date}"                             â”‚   â”‚
   495â†’â”‚   â”‚   ttl = 300  # 5 åˆ†é’Ÿ                                                   â”‚   â”‚
   496â†’â”‚   â”‚                                                                         â”‚   â”‚
   497â†’â”‚   â”‚   # å¤±æ•ˆæ¡ä»¶                                                             â”‚   â”‚
   498â†’â”‚   â”‚   - ç”¨æˆ·ç­¾åˆ° â†’ å¤±æ•ˆ status                                               â”‚   â”‚
   499â†’â”‚   â”‚   - ç”¨æˆ·æ›´æ–° lever/rock â†’ å¤±æ•ˆ lifecoach                                 â”‚   â”‚
   500â†’â”‚   â”‚   - ç”¨æˆ·è®¢é˜…/å–æ¶ˆ Skill â†’ å¤±æ•ˆ mySkills + discover                       â”‚   â”‚
   501â†’â”‚   â”‚   - æ¯æ—¥ 00:00 â†’ å…¨éƒ¨å¤±æ•ˆ                                                â”‚   â”‚
   502â†’â”‚   â”‚                                                                         â”‚   â”‚
   503â†’â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   504â†’â”‚                                                                                  â”‚
   505â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   506â†’```
   507â†’
   508â†’---
   509â†’
   510â†’## å‰ç«¯çŠ¶æ€ç®¡ç†
   511â†’
   512â†’```typescript
   513â†’// src/stores/dashboardStore.ts
   514â†’
   515â†’import { create } from 'zustand';
   516â†’import { persist } from 'zustand/middleware';
   517â†’import type { DashboardDTO, SkillCard, DiscoverSkill } from '@/types/dashboard';
   518â†’
   519â†’interface DashboardState {
   520â†’  // æ•°æ®
   521â†’  dashboard: DashboardDTO | null;
   522â†’  isLoading: boolean;
   523â†’  error: Error | null;
   524â†’
   525â†’  // æ“ä½œ
   526â†’  setDashboard: (data: DashboardDTO) => void;
   527â†’
   528â†’  // Status
   529â†’  setCheckedIn: (streak: number) => void;
   530â†’
   531â†’  // Lifecoach
   532â†’  toggleLever: (leverId: string) => void;
   533â†’  toggleRock: (rockId: string) => void;
   534â†’
   535â†’  // Skills
   536â†’  addSkillCard: (card: SkillCard) => void;
   537â†’  removeSkillCard: (skillId: string) => void;
   538â†’  updateSkillCard: (skillId: string, content: SkillCard['content']) => void;
   539â†’
   540â†’  // Discover
   541â†’  removeFromDiscover: (skillId: string) => void;
   542â†’}
   543â†’
   544â†’export const useDashboardStore = create<DashboardState>()(
   545â†’  persist(
   546â†’    (set) => ({
   547â†’      dashboard: null,
   548â†’      isLoading: false,
   549â†’      error: null,
   550â†’
   551â†’      setDashboard: (data) => set({ dashboard: data }),
   552â†’
   553â†’      setCheckedIn: (streak) => set((state) => ({
   554â†’        dashboard: state.dashboard ? {
   555â†’          ...state.dashboard,
   556â†’          status: { ...state.dashboard.status, checkedIn: true, streak }
   557â†’        } : null
   558â†’      })),
   559â†’
   560â†’      toggleLever: (leverId) => set((state) => {
   561â†’        if (!state.dashboard) return state;
   562â†’
   563â†’        const levers = state.dashboard.lifecoach.todayLevers.map(lever =>
   564â†’          lever.id === leverId
   565â†’            ? { ...lever, completed: !lever.completed }
   566â†’            : lever
   567â†’        );
   568â†’
   569â†’        return {
   570â†’          dashboard: {
   571â†’            ...state.dashboard,
   572â†’            lifecoach: { ...state.dashboard.lifecoach, todayLevers: levers }
   573â†’          }
   574â†’        };
   575â†’      }),
   576â†’
   577â†’      toggleRock: (rockId) => set((state) => {
   578â†’        if (!state.dashboard) return state;
   579â†’
   580â†’        const rocks = state.dashboard.lifecoach.weekRocks.map(rock =>
   581â†’          rock.id === rockId
   582â†’            ? { ...rock, completed: !rock.completed }
   583â†’            : rock
   584â†’        );
   585â†’
   586â†’        return {
   587â†’          dashboard: {
   588â†’            ...state.dashboard,
   589â†’            lifecoach: { ...state.dashboard.lifecoach, weekRocks: rocks }
   590â†’          }
   591â†’        };
   592â†’      }),
   593â†’
   594â†’      addSkillCard: (card) => set((state) => {
   595â†’        if (!state.dashboard) return state;
   596â†’        return {
   597â†’          dashboard: {
   598â†’            ...state.dashboard,
   599â†’            mySkills: [...state.dashboard.mySkills, card]
   600â†’          }
   601â†’        };
   602â†’      }),
   603â†’
   604â†’      removeSkillCard: (skillId) => set((state) => {
   605â†’        if (!state.dashboard) return state;
   606â†’        return {
   607â†’          dashboard: {
   608â†’            ...state.dashboard,
   609â†’            mySkills: state.dashboard.mySkills.filter(s => s.skillId !== skillId)
   610â†’          }
   611â†’        };
   612â†’      }),
   613â†’
   614â†’      updateSkillCard: (skillId, content) => set((state) => {
   615â†’        if (!state.dashboard) return state;
   616â†’        return {
   617â†’          dashboard: {
   618â†’            ...state.dashboard,
   619â†’            mySkills: state.dashboard.mySkills.map(card =>
   620â†’              card.skillId === skillId
   621â†’                ? { ...card, content, lastUpdated: new Date().toISOString() }
   622â†’                : card
   623â†’            )
   624â†’          }
   625â†’        };
   626â†’      }),
   627â†’
   628â†’      removeFromDiscover: (skillId) => set((state) => {
   629â†’        if (!state.dashboard) return state;
   630â†’        return {
   631â†’          dashboard: {
   632â†’            ...state.dashboard,
   633â†’            discover: state.dashboard.discover.filter(s => s.skillId !== skillId)
   634â†’          }
   635â†’        };
   636â†’      }),
   637â†’    }),
   638â†’    {
   639â†’      name: 'vibelife-dashboard-v2',
   640â†’      partialize: (state) => ({
   641â†’        dashboard: state.dashboard
   642â†’      })
   643â†’    }
   644â†’  )
   645â†’);
   646â†’```
   647â†’
   648â†’---
   649â†’
   650â†’## Skill è®¢é˜…æ•°æ®æµæ—¶åºå›¾
   651â†’
   652â†’```
   653â†’â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   654â†’â”‚                           Skill è®¢é˜…æµç¨‹                                         â”‚
   655â†’â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
   656â†’â”‚                                                                                  â”‚
   657â†’â”‚   User     Dashboard      Store        API       Proactive     DB               â”‚
   658â†’â”‚     â”‚          â”‚            â”‚           â”‚          Engine       â”‚               â”‚
   659â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   660â†’â”‚     â”‚  ç‚¹å‡»è®¢é˜… â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   661â†’â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   662â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   663â†’â”‚     â”‚          â”‚ ä¹è§‚æ›´æ–°    â”‚           â”‚            â”‚          â”‚               â”‚
   664â†’â”‚     â”‚          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚            â”‚          â”‚               â”‚
   665â†’â”‚     â”‚          â”‚            â”‚ ä» discoverâ”‚           â”‚          â”‚               â”‚
   666â†’â”‚     â”‚          â”‚            â”‚ ç§»åˆ° mySkills          â”‚          â”‚               â”‚
   667â†’â”‚     â”‚          â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ (placeholder)         â”‚          â”‚               â”‚
   668â†’â”‚     â”‚  çœ‹åˆ°ç§»åŠ¨ â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   669â†’â”‚     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   670â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   671â†’â”‚     â”‚          â”‚            â”‚   POST    â”‚            â”‚          â”‚               â”‚
   672â†’â”‚     â”‚          â”‚            â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚            â”‚          â”‚               â”‚
   673â†’â”‚     â”‚          â”‚            â”‚           â”‚ subscribe  â”‚          â”‚               â”‚
   674â†’â”‚     â”‚          â”‚            â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚          â”‚               â”‚
   675â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚ INSERT   â”‚               â”‚
   676â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚               â”‚
   677â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
   678â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   679â†’â”‚     â”‚          â”‚            â”‚           â”‚ compute_card          â”‚               â”‚
   680â†’â”‚     â”‚          â”‚            â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚          â”‚               â”‚
   681â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚ ç”Ÿæˆå†…å®¹ â”‚               â”‚
   682â†’â”‚     â”‚          â”‚            â”‚           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚               â”‚
   683â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   684â†’â”‚     â”‚          â”‚            â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ { card }   â”‚          â”‚               â”‚
   685â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   686â†’â”‚     â”‚          â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ æ›´æ–°çœŸå®å†…å®¹            â”‚          â”‚               â”‚
   687â†’â”‚     â”‚  å®Œæ•´å¡ç‰‡ â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   688â†’â”‚     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   689â†’â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
   690â†’â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   691â†’```
   692â†’
   693â†’---
   694â†’
   695â†’## é”™è¯¯å¤„ç†
   696â†’
   697â†’```typescript
   698â†’// src/hooks/useDashboard.ts
   699â†’
   700â†’import useSWR from 'swr';
   701â†’import { useDashboardStore } from '@/stores/dashboardStore';
   702â†’
   703â†’export function useDashboard() {
   704â†’  const store = useDashboardStore();
   705â†’
   706â†’  const { data, error, isLoading, mutate } = useSWR(
   707â†’    '/api/dashboard',
   708â†’    fetcher,
   709â†’    {
   710â†’      onSuccess: (data) => store.setDashboard(data),
   711â†’      fallbackData: store.dashboard, // ç¦»çº¿æ—¶ä½¿ç”¨ç¼“å­˜
   712â†’    }
   713â†’  );
   714â†’
   715â†’  // è®¢é˜… Skill
   716â†’  const subscribeSkill = async (skillId: string) => {
   717â†’    // 1. ä¹è§‚æ›´æ–°: ç§»åŠ¨åˆ° mySkills
   718â†’    const targetSkill = data?.discover.find(s => s.skillId === skillId);
   719â†’    if (targetSkill) {
   720â†’      store.removeFromDiscover(skillId);
   721â†’      store.addSkillCard({
   722â†’        skillId,
   723â†’        cardId: 'loading',
   724â†’        title: targetSkill.title,
   725â†’        icon: targetSkill.icon,
   726â†’        content: null, // placeholder
   727â†’        actionLabel: 'åŠ è½½ä¸­...',
   728â†’        actionRoute: '',
   729â†’      });
   730â†’    }
   731â†’
   732â†’    try {
   733â†’      // 2. å‘é€è¯·æ±‚
   734â†’      const result = await api.post('/api/skills/subscribe', { skillId });
   735â†’
   736â†’      // 3. æ›´æ–°çœŸå®å†…å®¹
   737â†’      store.updateSkillCard(skillId, result.card);
   738â†’    } catch (error) {
   739â†’      // 4. å›æ»š
   740â†’      if (targetSkill) {
   741â†’        store.removeSkillCard(skillId);
   742â†’        // æ¢å¤ discover éœ€è¦é‡æ–°è·å–
   743â†’        mutate();
   744â†’      }
   745â†’      throw error;
   746â†’    }
   747â†’  };
   748â†’
   749â†’  // ç­¾åˆ°
   750â†’  const checkIn = async () => {
   751â†’    const currentStreak = data?.status.streak || 0;
   752â†’
   753â†’    // 1. ä¹è§‚æ›´æ–°
   754â†’    store.setCheckedIn(currentStreak + 1);
   755â†’
   756â†’    try {
   757â†’      // 2. å‘é€è¯·æ±‚
   758â†’      const result = await api.post('/api/dashboard/checkin');
   759â†’
   760â†’      // 3. ç”¨æœåŠ¡ç«¯æ•°æ®éªŒè¯
   761â†’      store.setCheckedIn(result.streak);
   762â†’
   763â†’      return result;
   764â†’    } catch (error) {
   765â†’      // 4. å›æ»š
   766â†’      store.setCheckedIn(currentStreak);
   767â†’      throw error;
   768â†’    }
   769â†’  };
   770â†’
   771â†’  return {
   772â†’    dashboard: data,
   773â†’    isLoading,
   774â†’    error,
   775â†’    refresh: mutate,
   776â†’    subscribeSkill,
   777â†’    checkIn,
   778â†’  };
   779â†’}
   780â†’```
   781â†’
   782â†’---
   783â†’
   784â†’> **Version**: 2.0 | 2026-01-19
   785â†’