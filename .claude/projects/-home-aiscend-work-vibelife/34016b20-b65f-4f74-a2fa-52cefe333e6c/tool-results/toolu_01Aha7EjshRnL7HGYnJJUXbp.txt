     1→"use client";
     2→
     3→import { motion } from "framer-motion";
     4→import { cn } from "@/lib/utils";
     5→import { SimpleVibeGlyph } from "@/components/core";
     6→
     7→// ═══════════════════════════════════════════════════════════════════════════
     8→// ChatMessage - LUMINOUS PAPER Design System
     9→// 聊天消息气泡：墨色用户消息 + 卡片助手消息
    10→// ═══════════════════════════════════════════════════════════════════════════
    11→
    12→export interface ChatMessageProps {
    13→  role: "user" | "assistant";
    14→  content: string;
    15→  timestamp?: string;
    16→  isStreaming?: boolean;
    17→  showAvatar?: boolean;
    18→}
    19→
    20→export function ChatMessage({
    21→  role,
    22→  content,
    23→  timestamp,
    24→  isStreaming,
    25→  showAvatar = true,
    26→}: ChatMessageProps) {
    27→  const isUser = role === "user";
    28→
    29→  return (
    30→    <motion.div
    31→      initial={{ opacity: 0, y: 10 }}
    32→      animate={{ opacity: 1, y: 0 }}
    33→      transition={{ duration: 0.3, ease: [0.16, 1, 0.3, 1] }}
    34→      className={cn(
    35→        "flex w-full mb-4 gap-3",
    36→        isUser ? "flex-row-reverse" : "flex-row"
    37→      )}
    38→    >
    39→      {/* Avatar */}
    40→      {showAvatar && !isUser && (
    41→        <div className="flex-shrink-0 w-8 h-8 flex items-center justify-center">
    42→          <SimpleVibeGlyph size={24} skill="bazi" />
    43→        </div>
    44→      )}
    45→
    46→      {/* Message bubble */}
    47→      <div
    48→        className={cn(
    49→          isUser ? "chat-bubble-user" : "chat-bubble-assistant"
    50→        )}
    51→      >
    52→        <p className="whitespace-pre-wrap leading-relaxed">{content}</p>
    53→
    54→        {/* Streaming indicator */}
    55→        {isStreaming && (
    56→          <span className="inline-flex items-center gap-1 ml-1">
    57→            <span className="w-1.5 h-1.5 rounded-full bg-current animate-pulse" />
    58→            <span className="w-1.5 h-1.5 rounded-full bg-current animate-pulse animation-delay-150" />
    59→            <span className="w-1.5 h-1.5 rounded-full bg-current animate-pulse animation-delay-300" />
    60→          </span>
    61→        )}
    62→
    63→        {/* Timestamp */}
    64→        {timestamp && (
    65→          <p className="chat-timestamp">
    66→            {timestamp}
    67→          </p>
    68→        )}
    69→      </div>
    70→
    71→      {/* User avatar placeholder for alignment */}
    72→      {showAvatar && isUser && (
    73→        <div className="flex-shrink-0 w-8 h-8" />
    74→      )}
    75→    </motion.div>
    76→  );
    77→}
    78→
    79→// ═══════════════════════════════════════════════════════════════════════════
    80→// SystemMessage - For system notifications in chat
    81→// ═══════════════════════════════════════════════════════════════════════════
    82→
    83→interface SystemMessageProps {
    84→  content: string;
    85→  className?: string;
    86→}
    87→
    88→export function SystemMessage({ content, className }: SystemMessageProps) {
    89→  return (
    90→    <div
    91→      className={cn(
    92→        "flex justify-center my-4",
    93→        className
    94→      )}
    95→    >
    96→      <span className="px-3 py-1.5 text-xs text-muted-foreground bg-muted/50 rounded-full">
    97→        {content}
    98→      </span>
    99→    </div>
   100→  );
   101→}
   102→
   103→// ═══════════════════════════════════════════════════════════════════════════
   104→// TypingIndicator - Shows when assistant is thinking
   105→// ═══════════════════════════════════════════════════════════════════════════
   106→
   107→interface TypingIndicatorProps {
   108→  className?: string;
   109→}
   110→
   111→export function TypingIndicator({ className }: TypingIndicatorProps) {
   112→  return (
   113→    <motion.div
   114→      initial={{ opacity: 0, y: 10 }}
   115→      animate={{ opacity: 1, y: 0 }}
   116→      exit={{ opacity: 0, y: -10 }}
   117→      className={cn("flex items-center gap-3 mb-4", className)}
   118→    >
   119→      <div className="flex-shrink-0 w-8 h-8 flex items-center justify-center">
   120→        <SimpleVibeGlyph size={24} skill="bazi" />
   121→      </div>
   122→      <div className="chat-bubble-assistant">
   123→        <div className="flex items-center gap-1.5">
   124→          <span className="w-2 h-2 rounded-full bg-muted-foreground animate-bounce" style={{ animationDelay: "0ms" }} />
   125→          <span className="w-2 h-2 rounded-full bg-muted-foreground animate-bounce" style={{ animationDelay: "150ms" }} />
   126→          <span className="w-2 h-2 rounded-full bg-muted-foreground animate-bounce" style={{ animationDelay: "300ms" }} />
   127→        </div>
   128→      </div>
   129→    </motion.div>
   130→  );
   131→}
   132→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
