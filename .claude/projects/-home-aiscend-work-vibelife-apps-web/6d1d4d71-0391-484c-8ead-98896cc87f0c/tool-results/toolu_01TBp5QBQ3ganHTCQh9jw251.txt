     1→/**
     2→ * Skill Plugin System - Type Definitions
     3→ *
     4→ * AI SDK 6 Compatible Architecture
     5→ */
     6→
     7→import { ComponentType, ReactNode } from "react";
     8→import { LucideIcon } from "lucide-react";
     9→import { z } from "zod";
    10→
    11→// ═══════════════════════════════════════════════════════════════════════════
    12→// Skill ID
    13→// ═══════════════════════════════════════════════════════════════════════════
    14→
    15→export const SKILL_IDS = ["bazi", "zodiac", "mbti", "tarot", "attach", "career"] as const;
    16→export type SkillId = (typeof SKILL_IDS)[number];
    17→
    18→export function isValidSkillId(id: string): id is SkillId {
    19→  return SKILL_IDS.includes(id as SkillId);
    20→}
    21→
    22→// ═══════════════════════════════════════════════════════════════════════════
    23→// Panel Definitions
    24→// ═══════════════════════════════════════════════════════════════════════════
    25→
    26→export interface PanelProps {
    27→  skill: SkillId;
    28→  isActive: boolean;
    29→  onClose?: () => void;
    30→}
    31→
    32→export interface PanelDefinition {
    33→  /** Unique panel identifier */
    34→  id: string;
    35→  /** Display label */
    36→  label: string;
    37→  /** Panel icon */
    38→  icon: LucideIcon;
    39→  /** Panel component */
    40→  component: ComponentType<PanelProps>;
    41→  /** Sort order (lower = first) */
    42→  order?: number;
    43→  /** Badge content function */
    44→  badge?: () => string | number | null;
    45→  /** Requires authentication */
    46→  requireAuth?: boolean;
    47→  /** Requires paid subscription */
    48→  requirePaid?: boolean;
    49→}
    50→
    51→// ═══════════════════════════════════════════════════════════════════════════
    52→// AI SDK 6 Tool Definitions (Generative UI)
    53→// ═══════════════════════════════════════════════════════════════════════════
    54→
    55→export interface ToolExecuteContext {
    56→  skillId: SkillId;
    57→  userId?: string;
    58→  conversationId?: string;
    59→}
    60→
    61→export interface ToolDefinition<TParams = unknown, TResult = unknown> {
    62→  /** Tool name (used in AI calls) */
    63→  name: string;
    64→  /** Tool description for AI */
    65→  description: string;
    66→  /** Zod schema for parameters */
    67→  parameters: z.ZodSchema<TParams>;
    68→  /** Execute function */
    69→  execute: (params: TParams, context: ToolExecuteContext) => Promise<TResult>;
    70→  /** Generative UI: Render function */
    71→  render?: (result: TResult, context: ToolExecuteContext) => ReactNode;
    72→  /** Requires user approval before execution */
    73→  needsApproval?: boolean | ((params: TParams) => boolean);
    74→  /** Transform result before sending back to model (reduce tokens) */
    75→  toModelOutput?: (result: TResult) => string;
    76→}
    77→
    78→// Helper type for creating tools
    79→export type CreateToolDefinition<TParams, TResult> = ToolDefinition<TParams, TResult>;
    80→
    81→// ═══════════════════════════════════════════════════════════════════════════
    82→// Theme Configuration
    83→// ═══════════════════════════════════════════════════════════════════════════
    84→
    85→export interface SkillTheme {
    86→  /** Primary color (hex) */
    87→  primary: string;
    88→  /** Secondary color (hex) */
    89→  secondary: string;
    90→  /** Glow color (rgba) */
    91→  glow: string;
    92→  /** Gradient background */
    93→  gradient: string;
    94→}
    95→
    96→// ═══════════════════════════════════════════════════════════════════════════
    97→// Feature Configuration
    98→// ═══════════════════════════════════════════════════════════════════════════
    99→
   100→export interface SkillFeatures {
   101→  /** Quick prompt suggestions */
   102→  quickPrompts: string[];
   103→  /** Empty state configuration */
   104→  emptyState: {
   105→    title: string;
   106→    subtitle: string;
   107→    image?: string;
   108→  };
   109→}
   110→
   111→export interface SharedFeatureFlags {
   112→  /** Enable report generation */
   113→  report?: boolean;
   114→  /** Enable relationship analysis */
   115→  relationship?: boolean;
   116→  /** Enable daily greeting */
   117→  greeting?: boolean;
   118→  /** Enable AI interview */
   119→  interview?: boolean;
   120→  /** Enable K-line chart */
   121→  kline?: boolean;
   122→}
   123→
   124→// ═══════════════════════════════════════════════════════════════════════════
   125→// Input Form Configuration
   126→// ═══════════════════════════════════════════════════════════════════════════
   127→
   128→export type FormFieldType = "text" | "date" | "time" | "select" | "location" | "number";
   129→
   130→export interface FormFieldDefinition {
   131→  id: string;
   132→  type: FormFieldType;
   133→  label: string;
   134→  placeholder?: string;
   135→  required?: boolean;
   136→  options?: { value: string; label: string }[];
   137→  helperText?: string;
   138→}
   139→
   140→export interface InputFormConfig {
   141→  fields: FormFieldDefinition[];
   142→  required: string[];
   143→}
   144→
   145→// ═══════════════════════════════════════════════════════════════════════════
   146→// Skill Plugin - Complete Definition
   147→// ═══════════════════════════════════════════════════════════════════════════
   148→
   149→export interface SkillPlugin {
   150→  // ─── Basic Info ───────────────────────────────────────────────────────────
   151→  /** Unique skill identifier */
   152→  id: SkillId;
   153→  /** Display name */
   154→  name: string;
   155→  /** Subtitle/tagline */
   156→  subtitle: string;
   157→  /** Skill icon */
   158→  icon: LucideIcon;
   159→  /** Is skill enabled */
   160→  enabled: boolean;
   161→  /** Is skill in beta */
   162→  beta?: boolean;
   163→
   164→  // ─── Theme ────────────────────────────────────────────────────────────────
   165→  theme: SkillTheme;
   166→
   167→  // ─── Features ─────────────────────────────────────────────────────────────
   168→  features: SkillFeatures;
   169→
   170→  // ─── Shared Feature Flags ─────────────────────────────────────────────────
   171→  /** Override shared features (default: all enabled) */
   172→  sharedFeatures?: SharedFeatureFlags;
   173→
   174→  // ─── Skill-Specific Extensions ────────────────────────────────────────────
   175→  /** Skill-specific panels */
   176→  panels: PanelDefinition[];
   177→  /** Skill-specific AI tools (Generative UI) */
   178→  tools: ToolDefinition[];
   179→
   180→  // ─── Input Configuration ──────────────────────────────────────────────────
   181→  /** Input form configuration */
   182→  inputForm?: InputFormConfig;
   183→}
   184→
   185→// ═══════════════════════════════════════════════════════════════════════════
   186→// Skill Registry Interface
   187→// ═══════════════════════════════════════════════════════════════════════════
   188→
   189→export interface SkillRegistry {
   190→  /** Get all registered skills */
   191→  getAll(): SkillPlugin[];
   192→  /** Get skill by ID */
   193→  get(id: SkillId): SkillPlugin | undefined;
   194→  /** Get all enabled skills */
   195→  getEnabled(): SkillPlugin[];
   196→  /** Check if skill exists and is enabled */
   197→  isEnabled(id: SkillId): boolean;
   198→
   199→  // Panel helpers
   200→  /** Get skill-specific panels */
   201→  getSkillPanels(skillId: SkillId): PanelDefinition[];
   202→  /** Get all panels for a skill (shared + skill-specific) */
   203→  getAllPanels(skillId: SkillId): PanelDefinition[];
   204→
   205→  // Tool helpers
   206→  /** Get skill-specific tools */
   207→  getSkillTools(skillId: SkillId): ToolDefinition[];
   208→  /** Get all tools for a skill (shared + skill-specific) */
   209→  getAllTools(skillId: SkillId): ToolDefinition[];
   210→  /** Get a specific tool by name */
   211→  getTool(name: string): ToolDefinition | undefined;
   212→}
   213→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
