     1→# VibeLife 完整系统架构设计文档
     2→## The Living Companion Ecosystem
     3→
     4→**Version**: 1.0  
     5→**Date**: January 2026  
     6→**Domain**: vibelife.app
     7→
     8→---
     9→
    10→# 第一部分：战略架构总览
    11→
    12→## 1.1 核心战略定位
    13→
    14→```
    15→╔═══════════════════════════════════════════════════════════════════════════════╗
    16→║                                                                               ║
    17→║                              VIBELIFE                                         ║
    18→║                     THE LIVING COMPANION ECOSYSTEM                            ║
    19→║                                                                               ║
    20→║   ─────────────────────────────────────────────────────────────────────────   ║
    21→║                                                                               ║
    22→║   "每个人都值得被深度理解，每种成长都需要专业陪伴"                             ║
    23→║                                                                               ║
    24→║   ─────────────────────────────────────────────────────────────────────────   ║
    25→║                                                                               ║
    26→║   战略路径：                                                                  ║
    27→║                                                                               ║
    28→║   Phase 1: SKILL CONSTELLATION                                                ║
    29→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
    30→║   │                                                                         │ ║
    31→║   │    ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐    │ ║
    32→║   │    │  ASTRA  │  │  BAZI   │  │  MBTI   │  │ ATTACH  │  │ CAREER  │    │ ║
    33→║   │    │ .vibe   │  │ .vibe   │  │ .vibe   │  │ .vibe   │  │ .vibe   │    │ ║
    34→║   │    │ life.app│  │ life.app│  │ life.app│  │ life.app│  │ life.app│    │ ║
    35→║   │    └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘    │ ║
    36→║   │         │            │            │            │            │          │ ║
    37→║   │         └────────────┴─────┬──────┴────────────┴────────────┘          │ ║
    38→║   │                            │                                           │ ║
    39→║   │                   ┌────────▼────────┐                                  │ ║
    40→║   │                   │   VIBE ENGINE   │                                  │ ║
    41→║   │                   │   统一智能引擎   │                                  │ ║
    42→║   │                   └────────┬────────┘                                  │ ║
    43→║   │                            │                                           │ ║
    44→║   │                   ┌────────▼────────┐                                  │ ║
    45→║   │                   │    VIBE ID      │                                  │ ║
    46→║   │                   │   统一身份系统   │                                  │ ║
    47→║   │                   └─────────────────┘                                  │ ║
    48→║   │                                                                         │ ║
    49→║   │   "先去中心化做流量和能力验证"                                          │ ║
    50→║   └─────────────────────────────────────────────────────────────────────────┘ ║
    51→║                                                                               ║
    52→║   Phase 2: VIBELIFE CONSTELLATION HUB                                         ║
    53→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
    54→║   │                                                                         │ ║
    55→║   │                    ┌─────────────────────────┐                          │ ║
    56→║   │                    │                         │                          │ ║
    57→║   │                    │     VIBELIFE.APP        │                          │ ║
    58→║   │                    │     统一 AI Agent       │                          │ ║
    59→║   │                    │     Vibe Persona        │                          │ ║
    60→║   │                    │                         │                          │ ║
    61→║   │                    └───────────┬─────────────┘                          │ ║
    62→║   │                                │                                        │ ║
    63→║   │      ┌─────────┬─────────┬─────┴─────┬─────────┬─────────┐             │ ║
    64→║   │      ▼         ▼         ▼           ▼         ▼         ▼             │ ║
    65→║   │   [Astra]  [BaZi]    [MBTI]    [Attach]  [Career]   [...]             │ ║
    66→║   │                                                                         │ ║
    67→║   │   "再中心化做生态和长期留存"                                            │ ║
    68→║   └─────────────────────────────────────────────────────────────────────────┘ ║
    69→║                                                                               ║
    70→╚═══════════════════════════════════════════════════════════════════════════════╝
    71→```
    72→
    73→## 1.2 系统架构全景图
    74→
    75→```
    76→╔═══════════════════════════════════════════════════════════════════════════════╗
    77→║                                                                               ║
    78→║                    VIBELIFE SYSTEM ARCHITECTURE                               ║
    79→║                                                                               ║
    80→╠═══════════════════════════════════════════════════════════════════════════════╣
    81→║                                                                               ║
    82→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
    83→║   │                                                                         │ ║
    84→║   │   L1: SKILL CONSTELLATION LAYER (独立站群)                              │ ║
    85→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
    86→║   │                                                                         │ ║
    87→║   │   ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐         │ ║
    88→║   │   │  ASTRA  │ │  BAZI   │ │  MBTI   │ │ ATTACH  │ │ CAREER  │         │ ║
    89→║   │   │ 星座占星 │ │ 八字命理 │ │ 人格测评 │ │ 依恋分析 │ │ 职业发展 │         │ ║
    90→║   │   │         │ │         │ │         │ │         │ │         │         │ ║
    91→║   │   │ astra.  │ │ bazi.   │ │ mbti.   │ │ attach. │ │ career. │         │ ║
    92→║   │   │ vibelife│ │ vibelife│ │ vibelife│ │ vibelife│ │ vibelife│         │ ║
    93→║   │   │ .app    │ │ .app    │ │ .app    │ │ .app    │ │ .app    │         │ ║
    94→║   │   └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘ └────┬────┘         │ ║
    95→║   │        │           │           │           │           │              │ ║
    96→║   │        └───────────┴───────────┴───────────┴───────────┘              │ ║
    97→║   │                               │                                        │ ║
    98→║   │   统一模板引擎 │ 共享组件库 │ 一致用户体验 │ 统一商业化                │ ║
    99→║   │                                                                         │ ║
   100→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   101→║                                     │                                         ║
   102→║                                     ▼                                         ║
   103→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   104→║   │                                                                         │ ║
   105→║   │   L2: EXPERIENCE LAYER (体验标准层)                                     │ ║
   106→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   107→║   │                                                                         │ ║
   108→║   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │ ║
   109→║   │   │ THE LANDING │  │   STREAM    │  │  INSIGHT    │  │  JOURNEY    │   │ ║
   110→║   │   │  零摩擦入口  │  │  对话之流   │  │  洞察卡片   │  │  成长轨迹   │   │ ║
   111→║   │   │             │  │             │  │             │  │             │   │ ║
   112→║   │   │ • 即问即答   │  │ • 沉浸对话  │  │ • 可视化   │  │ • 长期追踪  │   │ ║
   113→║   │   │ • 渐进注册   │  │ • 主动关怀  │  │ • 深度解读  │  │ • 演化记录  │   │ ║
   114→║   │   │ • 价值前置   │  │ • 情绪感知  │  │ • 行动建议  │  │ • 个人成长  │   │ ║
   115→║   │   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │ ║
   116→║   │                                                                         │ ║
   117→║   │   INSIGHT → INTERACT → EVOLVE → EDUCATE                                 │ ║
   118→║   │   看见      陪伴        演化      觉知                                   │ ║
   119→║   │                                                                         │ ║
   120→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   121→║                                     │                                         ║
   122→║                                     ▼                                         ║
   123→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   124→║   │                                                                         │ ║
   125→║   │   L3: SKILL AGENT LAYER (智能代理层)                                    │ ║
   126→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   127→║   │                                                                         │ ║
   128→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
   129→║   │   │                     SKILL AGENT RUNTIME                         │   │ ║
   130→║   │   │                                                                 │   │ ║
   131→║   │   │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐   │   │ ║
   132→║   │   │  │  PERSONA  │  │  SKILL    │  │  TOOL     │  │  CONTEXT  │   │   │ ║
   133→║   │   │  │  ENGINE   │  │  ROUTER   │  │  EXECUTOR │  │  MANAGER  │   │   │ ║
   134→║   │   │  │           │  │           │  │           │  │           │   │   │ ║
   135→║   │   │  │ • 角色人设 │  │ • 意图识别 │  │ • 函数调用 │  │ • 上下文   │   │   │ ║
   136→║   │   │  │ • 风格适配 │  │ • 流程编排 │  │ • 计算执行 │  │ • 记忆管理 │   │   │ ║
   137→║   │   │  │ • 情绪感知 │  │ • 多轮对话 │  │ • 结果整合 │  │ • 会话状态 │   │   │ ║
   138→║   │   │  └───────────┘  └───────────┘  └───────────┘  └───────────┘   │   │ ║
   139→║   │   │                                                                 │   │ ║
   140→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
   141→║   │                                                                         │ ║
   142→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   143→║                                     │                                         ║
   144→║                                     ▼                                         ║
   145→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   146→║   │                                                                         │ ║
   147→║   │   L4: KNOWLEDGE LAYER (知识引擎层)                                      │ ║
   148→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   149→║   │                                                                         │ ║
   150→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
   151→║   │   │                    KNOWLEDGE ENGINE                             │   │ ║
   152→║   │   │                                                                 │   │ ║
   153→║   │   │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │   │ ║
   154→║   │   │  │  KNOWLEDGE  │    │   HYBRID    │    │  KNOWLEDGE  │         │   │ ║
   155→║   │   │  │  PIPELINE   │───▶│  RETRIEVAL  │───▶│   GRADER    │         │   │ ║
   156→║   │   │  │             │    │             │    │             │         │   │ ║
   157→║   │   │  │ • 知识采集   │    │ • 向量检索  │    │ • 相关性评估 │         │   │ ║
   158→║   │   │  │ • 结构化     │    │ • 关键词    │    │ • 质量打分   │         │   │ ║
   159→║   │   │  │ • 嵌入索引   │    │ • 图遍历    │    │ • 重排序     │         │   │ ║
   160→║   │   │  └─────────────┘    └─────────────┘    └─────────────┘         │   │ ║
   161→║   │   │                                                                 │   │ ║
   162→║   │   │  ┌────────────────────────────────────────────────────────┐    │   │ ║
   163→║   │   │  │              SKILL KNOWLEDGE STORES                     │    │   │ ║
   164→║   │   │  │                                                         │    │   │ ║
   165→║   │   │  │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐       │    │   │ ║
   166→║   │   │  │  │  ASTRA  │ │  BAZI   │ │  MBTI   │ │ ATTACH  │  ...  │    │   │ ║
   167→║   │   │  │  │   KB    │ │   KB    │ │   KB    │ │   KB    │       │    │   │ ║
   168→║   │   │  │  └─────────┘ └─────────┘ └─────────┘ └─────────┘       │    │   │ ║
   169→║   │   │  └────────────────────────────────────────────────────────┘    │   │ ║
   170→║   │   │                                                                 │   │ ║
   171→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
   172→║   │                                                                         │ ║
   173→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   174→║                                     │                                         ║
   175→║                                     ▼                                         ║
   176→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   177→║   │                                                                         │ ║
   178→║   │   L5: VIBE ENGINE (核心智能引擎)                                        │ ║
   179→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   180→║   │                                                                         │ ║
   181→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
   182→║   │   │                                                                 │   │ ║
   183→║   │   │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐   │   │ ║
   184→║   │   │  │    LLM    │  │  EMOTION  │  │  PATTERN  │  │  USER     │   │   │ ║
   185→║   │   │  │ ORCHESTR. │  │  SENSING  │  │ DETECTION │  │  MODEL    │   │   │ ║
   186→║   │   │  └───────────┘  └───────────┘  └───────────┘  └───────────┘   │   │ ║
   187→║   │   │                                                                 │   │ ║
   188→║   │   │  ┌───────────┐  ┌───────────┐  ┌───────────┐  ┌───────────┐   │   │ ║
   189→║   │   │  │ PROACTIVE │  │  INSIGHT  │  │   VIBE    │  │  GROWTH   │   │   │ ║
   190→║   │   │  │   AGENT   │  │ GENERATOR │  │   SCORE   │  │  TRACKER  │   │   │ ║
   191→║   │   │  └───────────┘  └───────────┘  └───────────┘  └───────────┘   │   │ ║
   192→║   │   │                                                                 │   │ ║
   193→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
   194→║   │                                                                         │ ║
   195→║   └─────────────────────────────────┬───────────────────────────────────────┘ ║
   196→║                                     │                                         ║
   197→║                                     ▼                                         ║
   198→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   199→║   │                                                                         │ ║
   200→║   │   L6: IDENTITY & DATA LAYER (身份与数据层)                              │ ║
   201→║   │   ═══════════════════════════════════════════════════════════════════   │ ║
   202→║   │                                                                         │ ║
   203→║   │   ┌───────────────────────────────────────────────────────────────────┐ │ ║
   204→║   │   │                         VIBE ID                                   │ │ ║
   205→║   │   │               统一身份认证与授权系统                               │ │ ║
   206→║   │   │                                                                   │ │ ║
   207→║   │   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐               │ │ ║
   208→║   │   │  │ SSO/OAuth   │  │  Profile    │  │ Data Vault  │               │ │ ║
   209→║   │   │  │ 单点登录     │  │  用户画像   │  │  数据金库   │               │ │ ║
   210→║   │   │  └─────────────┘  └─────────────┘  └─────────────┘               │ │ ║
   211→║   │   └───────────────────────────────────────────────────────────────────┘ │ ║
   212→║   │                                                                         │ ║
   213→║   │   ┌───────────────────────────────────────────────────────────────────┐ │ ║
   214→║   │   │                      DATA STORES                                  │ │ ║
   215→║   │   │                                                                   │ │ ║
   216→║   │   │  ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐    │ │ ║
   217→║   │   │  │PostgreSQL│ │Pinecone │ │  Neo4j  │ │  Redis  │ │   S3    │    │ │ ║
   218→║   │   │  │ Primary │ │ Vector  │ │  Graph  │ │  Cache  │ │  Assets │    │ │ ║
   219→║   │   │  └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘    │ │ ║
   220→║   │   └───────────────────────────────────────────────────────────────────┘ │ ║
   221→║   │                                                                         │ ║
   222→║   └─────────────────────────────────────────────────────────────────────────┘ ║
   223→║                                                                               ║
   224→╚═══════════════════════════════════════════════════════════════════════════════╝
   225→```
   226→
   227→---
   228→
   229→# 第二部分：统一身份系统 (Vibe ID)
   230→
   231→## 2.1 Vibe ID 核心设计
   232→
   233→```
   234→╔═══════════════════════════════════════════════════════════════════════════════╗
   235→║                                                                               ║
   236→║                              VIBE ID SYSTEM                                   ║
   237→║                      跨星座的统一身份与数据主权                                ║
   238→║                                                                               ║
   239→║   ─────────────────────────────────────────────────────────────────────────   ║
   240→║                                                                               ║
   241→║   设计原则：                                                                  ║
   242→║                                                                               ║
   243→║   1. ONE IDENTITY, ALL CONSTELLATIONS                                         ║
   244→║      一个身份，访问所有 Skill 站点                                            ║
   245→║                                                                               ║
   246→║   2. USER DATA SOVEREIGNTY                                                    ║
   247→║      用户完全掌控自己的数据                                                   ║
   248→║                                                                               ║
   249→║   3. PROGRESSIVE DISCLOSURE                                                   ║
   250→║      渐进式信息收集，价值前置                                                 ║
   251→║                                                                               ║
   252→║   4. SEAMLESS CROSS-SKILL EXPERIENCE                                          ║
   253→║      无缝的跨 Skill 体验流转                                                  ║
   254→║                                                                               ║
   255→╚═══════════════════════════════════════════════════════════════════════════════╝
   256→```
   257→
   258→## 2.2 Vibe ID 架构
   259→
   260→```
   261→┌─────────────────────────────────────────────────────────────────────────────┐
   262→│                                                                             │
   263→│   VIBE ID ARCHITECTURE                                                      │
   264→│                                                                             │
   265→│   ═══════════════════════════════════════════════════════════════════════   │
   266→│                                                                             │
   267→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   268→│   │                                                                     │   │
   269→│   │                     AUTHENTICATION LAYER                            │   │
   270→│   │                                                                     │   │
   271→│   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                │   │
   272→│   │   │   Social    │  │   Magic     │  │   Email/    │                │   │
   273→│   │   │   OAuth     │  │    Link     │  │   Password  │                │   │
   274→│   │   │             │  │             │  │             │                │   │
   275→│   │   │ • WeChat    │  │ • 零密码    │  │ • 传统登录  │                │   │
   276→│   │   │ • Apple     │  │ • 邮件链接  │  │ • MFA 支持  │                │   │
   277→│   │   │ • Google    │  │ • 短信验证  │  │             │                │   │
   278→│   │   └─────────────┘  └─────────────┘  └─────────────┘                │   │
   279→│   │                                                                     │   │
   280→│   └───────────────────────────────┬─────────────────────────────────────┘   │
   281→│                                   │                                         │
   282→│                                   ▼                                         │
   283→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   284→│   │                                                                     │   │
   285→│   │                     IDENTITY CORE                                   │   │
   286→│   │                                                                     │   │
   287→│   │   ┌─────────────────────────────────────────────────────────────┐   │   │
   288→│   │   │                                                             │   │   │
   289→│   │   │   VIBE ID                                                   │   │   │
   290→│   │   │   ─────────────────────────────────────────────────────     │   │   │
   291→│   │   │                                                             │   │   │
   292→│   │   │   ID: vibe_2xK9mN4pLq8                                      │   │   │
   293→│   │   │   Created: 2026-01-05                                       │   │   │
   294→│   │   │                                                             │   │   │
   295→│   │   │   ┌─────────────────────────────────────────────────────┐   │   │   │
   296→│   │   │   │  Core Profile (跨站共享)                            │   │   │   │
   297→│   │   │   │  • display_name: "Alex"                             │   │   │   │
   298→│   │   │   │  • avatar_url: "..."                                │   │   │   │
   299→│   │   │   │  • birth_datetime: "1990-03-15T08:30:00"           │   │   │   │
   300→│   │   │   │  • birth_location: "Shanghai, China"               │   │   │   │
   301→│   │   │   │  • timezone: "Asia/Shanghai"                        │   │   │   │
   302→│   │   │   │  • language: "zh-CN"                                │   │   │   │
   303→│   │   │   └─────────────────────────────────────────────────────┘   │   │   │
   304→│   │   │                                                             │   │   │
   305→│   │   │   ┌─────────────────────────────────────────────────────┐   │   │   │
   306→│   │   │   │  Skill Profiles (各站独立)                          │   │   │   │
   307→│   │   │   │                                                     │   │   │   │
   308→│   │   │   │  astra: { natal_chart: {...}, readings: [...] }    │   │   │   │
   309→│   │   │   │  bazi:  { chart: {...}, dayun: [...] }             │   │   │   │
   310→│   │   │   │  mbti:  { type: "INTJ", assessments: [...] }       │   │   │   │
   311→│   │   │   │  attach: { style: "anxious", sessions: [...] }     │   │   │   │
   312→│   │   │   └─────────────────────────────────────────────────────┘   │   │   │
   313→│   │   │                                                             │   │   │
   314→│   │   │   ┌─────────────────────────────────────────────────────┐   │   │   │
   315→│   │   │   │  Cross-Skill Insights (洞察整合)                    │   │   │   │
   316→│   │   │   │                                                     │   │   │   │
   317→│   │   │   │  • unified_personality_model: {...}                 │   │   │   │
   318→│   │   │   │  • growth_journey: {...}                            │   │   │   │
   319→│   │   │   │  • vibe_score_history: [...]                        │   │   │   │
   320→│   │   │   └─────────────────────────────────────────────────────┘   │   │   │
   321→│   │   │                                                             │   │   │
   322→│   │   └─────────────────────────────────────────────────────────────┘   │   │
   323→│   │                                                                     │   │
   324→│   └───────────────────────────────┬─────────────────────────────────────┘   │
   325→│                                   │                                         │
   326→│                                   ▼                                         │
   327→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   328→│   │                                                                     │   │
   329→│   │                     DATA SOVEREIGNTY LAYER                          │   │
   330→│   │                                                                     │   │
   331→│   │   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                │   │
   332→│   │   │   DATA      │  │   CONSENT   │  │   EXPORT    │                │   │
   333→│   │   │   VAULT     │  │   MANAGER   │  │   ENGINE    │                │   │
   334→│   │   │             │  │             │  │             │                │   │
   335→│   │   │ • 加密存储  │  │ • 授权管理  │  │ • 数据导出  │                │   │
   336→│   │   │ • 审计日志  │  │ • 共享控制  │  │ • 完全删除  │                │   │
   337→│   │   │ • 版本历史  │  │ • 细粒度    │  │ • GDPR合规  │                │   │
   338→│   │   └─────────────┘  └─────────────┘  └─────────────┘                │   │
   339→│   │                                                                     │   │
   340→│   └─────────────────────────────────────────────────────────────────────┘   │
   341→│                                                                             │
   342→└─────────────────────────────────────────────────────────────────────────────┘
   343→```
   344→
   345→## 2.3 跨站点 SSO 流程
   346→
   347→```
   348→┌─────────────────────────────────────────────────────────────────────────────┐
   349→│                                                                             │
   350→│   CROSS-SITE SSO FLOW                                                       │
   351→│                                                                             │
   352→│   ═══════════════════════════════════════════════════════════════════════   │
   353→│                                                                             │
   354→│   场景：用户从 astra.vibelife.app 跳转到 bazi.vibelife.app                  │
   355→│                                                                             │
   356→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   357→│   │                                                                     │   │
   358→│   │   1. 用户在 astra 点击 "也看看八字分析"                              │   │
   359→│   │      ─────────────────────────────────────────────────────────      │   │
   360→│   │                                                                     │   │
   361→│   │      astra.vibelife.app                    id.vibelife.app          │   │
   362→│   │            │                                      │                 │   │
   363→│   │            │  ①  检查本地 session                  │                 │   │
   364→│   │            │──────────────────────────────────────▶│                 │   │
   365→│   │            │                                      │                 │   │
   366→│   │            │  ②  返回 cross-site token            │                 │   │
   367→│   │            │◀──────────────────────────────────────│                 │   │
   368→│   │            │                                      │                 │   │
   369→│   │                                                                     │   │
   370→│   │   2. 带 token 跳转到 bazi                                           │   │
   371→│   │      ─────────────────────────────────────────────────────────      │   │
   372→│   │                                                                     │   │
   373→│   │            │                                                        │   │
   374→│   │            │  ③  redirect: bazi.vibelife.app?sso_token=xxx          │   │
   375→│   │            │────────────────────────────────────────────────────────│   │
   376→│   │                                                                     │   │
   377→│   │      bazi.vibelife.app                     id.vibelife.app          │   │
   378→│   │            │                                      │                 │   │
   379→│   │            │  ④  验证 sso_token                   │                 │   │
   380→│   │            │──────────────────────────────────────▶│                 │   │
   381→│   │            │                                      │                 │   │
   382→│   │            │  ⑤  返回用户信息 + 授权范围           │                 │   │
   383→│   │            │◀──────────────────────────────────────│                 │   │
   384→│   │            │                                      │                 │   │
   385→│   │   3. bazi 无缝登录，保持上下文                                       │   │
   386→│   │      ─────────────────────────────────────────────────────────      │   │
   387→│   │                                                                     │   │
   388→│   │            │  ⑥  建立本地 session                                   │   │
   389→│   │            │                                                        │   │
   390→│   │            │  ⑦  获取 bazi skill profile（如已存在）                │   │
   391→│   │            │                                                        │   │
   392→│   │            │  ⑧  显示 bazi 界面，已知用户出生信息                    │   │
   393→│   │            │                                                        │   │
   394→│   └─────────────────────────────────────────────────────────────────────┘   │
   395→│                                                                             │
   396→│   用户感知：无需重新登录，出生日期已自动填入                                │
   397→│                                                                             │
   398→└─────────────────────────────────────────────────────────────────────────────┘
   399→```
   400→
   401→## 2.4 数据共享授权机制
   402→
   403→```
   404→┌─────────────────────────────────────────────────────────────────────────────┐
   405→│                                                                             │
   406→│   DATA SHARING CONSENT FLOW                                                 │
   407→│                                                                             │
   408→│   ═══════════════════════════════════════════════════════════════════════   │
   409→│                                                                             │
   410→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   411→│   │                                                                     │   │
   412→│   │   bazi 想要访问你在 astra 的数据                                    │   │
   413→│   │   ─────────────────────────────────────────────────────────         │   │
   414→│   │                                                                     │   │
   415→│   │   "八字分析师发现你有星座数据。                                     │   │
   416→│   │    结合星座盘可以提供更准确的分析。                                 │   │
   417→│   │    允许共享吗？"                                                    │   │
   418→│   │                                                                     │   │
   419→│   │   ┌─────────────────────────────────────────────────────────────┐   │   │
   420→│   │   │                                                             │   │   │
   421→│   │   │   将共享的数据：                                            │   │   │
   422→│   │   │   ☑️ 出生信息（日期、时间、地点）                            │   │   │
   423→│   │   │   ☑️ 星座盘基础信息                                         │   │   │
   424→│   │   │   ☐ 完整星座解读报告                                        │   │   │
   425→│   │   │   ☐ 对话历史                                                │   │   │
   426→│   │   │                                                             │   │   │
   427→│   │   │   [ 允许选中项 ]      [ 全部允许 ]      [ 拒绝 ]            │   │   │
   428→│   │   │                                                             │   │   │
   429→│   │   └─────────────────────────────────────────────────────────────┘   │   │
   430→│   │                                                                     │   │
   431→│   │   你可以随时在 Vibe ID 设置中管理数据共享                           │   │
   432→│   │                                                                     │   │
   433→│   └─────────────────────────────────────────────────────────────────────┘   │
   434→│                                                                             │
   435→│   ─────────────────────────────────────────────────────────────────────     │
   436→│                                                                             │
   437→│   DATA SHARING MATRIX                                                       │
   438→│                                                                             │
   439→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   440→│   │                                                                     │   │
   441→│   │                  Astra  BaZi  MBTI  Attach  Career                 │   │
   442→│   │   ─────────────────────────────────────────────────────────────    │   │
   443→│   │   出生信息         ●      ●     ○      ○       ○                   │   │
   444→│   │   性格洞察         ●      ●     ●      ●       ●                   │   │
   445→│   │   关系模式         ○      ○     ○      ●       ○                   │   │
   446→│   │   职业倾向         ○      ●     ●      ○       ●                   │   │
   447→│   │   情绪模式         ○      ○     ○      ●       ○                   │   │
   448→│   │                                                                     │   │
   449→│   │   ● = 默认共享    ○ = 需要授权    ✕ = 不共享                       │   │
   450→│   │                                                                     │   │
   451→│   └─────────────────────────────────────────────────────────────────────┘   │
   452→│                                                                             │
   453→└─────────────────────────────────────────────────────────────────────────────┘
   454→```
   455→
   456→---
   457→
   458→# 第三部分：统一体验标准
   459→
   460→## 3.1 VibeLife 体验标准框架
   461→
   462→```
   463→╔═══════════════════════════════════════════════════════════════════════════════╗
   464→║                                                                               ║
   465→║   VIBELIFE EXPERIENCE STANDARD                                                ║
   466→║   所有 Skill 站点必须遵循的体验标准                                           ║
   467→║                                                                               ║
   468→║   ─────────────────────────────────────────────────────────────────────────   ║
   469→║                                                                               ║
   470→║   FOUR PILLARS OF VIBELIFE EXPERIENCE                                         ║
   471→║                                                                               ║
   472→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   473→║   │                                                                         │ ║
   474→║   │     INSIGHT          INTERACT         EVOLVE          EDUCATE          │ ║
   475→║   │      看见              陪伴             演化             觉知            │ ║
   476→║   │                                                                         │ ║
   477→║   │       │                 │                │                │            │ ║
   478→║   │       ▼                 ▼                ▼                ▼            │ ║
   479→║   │                                                                         │ ║
   480→║   │   ┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐         │ ║
   481→║   │   │         │     │         │     │         │     │         │         │ ║
   482→║   │   │ 深度    │     │ 沉浸式  │     │ 长期    │     │ 知识    │         │ ║
   483→║   │   │ 解读    │     │ AI对话  │     │ 追踪    │     │ 赋能    │         │ ║
   484→║   │   │         │     │         │     │         │     │         │         │ ║
   485→║   │   │ 数据→   │     │ Agent→  │     │ 模式→   │     │ 理解→   │         │ ║
   486→║   │   │ 意义    │     │ 关系    │     │ 成长    │     │ 自主    │         │ ║
   487→║   │   │         │     │         │     │         │     │         │         │ ║
   488→║   │   └─────────┘     └─────────┘     └─────────┘     └─────────┘         │ ║
   489→║   │                                                                         │ ║
   490→║   │   ─────────────────────────────────────────────────────────────────     │ ║
   491→║   │                                                                         │ ║
   492→║   │   INSIGHT: 我看见了自己从未注意到的                                     │ ║
   493→║   │   INTERACT: 我感受到被理解和陪伴                                        │ ║
   494→║   │   EVOLVE: 我能看到自己在成长                                            │ ║
   495→║   │   EDUCATE: 我学到了关于自己的知识                                       │ ║
   496→║   │                                                                         │ ║
   497→║   └─────────────────────────────────────────────────────────────────────────┘ ║
   498→║                                                                               ║
   499→╚═══════════════════════════════════════════════════════════════════════════════╝
   500→```
   501→
   502→## 3.2 The Landing - 零摩擦入口设计
   503→
   504→```
   505→┌─────────────────────────────────────────────────────────────────────────────┐
   506→│                                                                             │
   507→│   THE LANDING: ZERO FRICTION ENTRY                                          │
   508→│   即问即答，价值前置，渐进注册                                              │
   509→│                                                                             │
   510→│   ═══════════════════════════════════════════════════════════════════════   │
   511→│                                                                             │
   512→│   LANDING PAGE STRUCTURE (所有 Skill 站点统一)                              │
   513→│                                                                             │
   514→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   515→│   │                                                                     │   │
   516→│   │   ┌───────────────────────────────────────────────────────────────┐ │   │
   517→│   │   │                                                               │ │   │
   518→│   │   │   ☯️  八字命理                           bazi.vibelife.app    │ │   │
   519→│   │   │                                                               │ │   │
   520→│   │   └───────────────────────────────────────────────────────────────┘ │   │
   521→│   │                                                                     │   │
   522→│   │   ┌───────────────────────────────────────────────────────────────┐ │   │
   523→│   │   │                                                               │ │   │
   524→│   │   │                 了解命中注定的你                               │ │   │
   525→│   │   │                                                               │ │   │
   526→│   │   │         不是算命，是帮你"看见"自己                            │ │   │
   527→│   │   │                                                               │ │   │
   528→│   │   │   ┌─────────────────────────────────────────────────────────┐ │ │   │
   529→│   │   │   │                                                         │ │ │   │
   530→│   │   │   │   📅  输入出生日期，即刻开始                             │ │ │   │
   531→│   │   │   │                                                         │ │ │   │
   532→│   │   │   │   ┌───────────────────────────────────────────────────┐ │ │ │   │
   533→│   │   │   │   │  1990 年  3 月  15 日                              │ │ │ │   │
   534→│   │   │   │   └───────────────────────────────────────────────────┘ │ │ │   │
   535→│   │   │   │                                                         │ │ │   │
   536→│   │   │   │   ☐ 我知道出生时辰 → [ 时辰选择 ]                       │ │ │   │
   537→│   │   │   │                                                         │ │ │   │
   538→│   │   │   │              [ 看看我的八字 → ]                         │ │ │   │
   539→│   │   │   │                                                         │ │ │   │
   540→│   │   │   └─────────────────────────────────────────────────────────┘ │ │   │
   541→│   │   │                                                               │ │   │
   542→│   │   │         无需注册，立即体验                                    │ │   │
   543→│   │   │                                                               │ │   │
   544→│   │   └───────────────────────────────────────────────────────────────┘ │   │
   545→│   │                                                                     │   │
   546→│   │   ┌───────────────────────────────────────────────────────────────┐ │   │
   547→│   │   │                                                               │ │   │
   548→│   │   │   我能帮你看到                                                │ │   │
   549→│   │   │   ─────────────────────────────────────────────────────────   │ │   │
   550→│   │   │                                                               │ │   │
   551→│   │   │   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │ │   │
   552→│   │   │   │  性格   │  │  事业   │  │  感情   │  │  运势   │        │ │   │
   553→│   │   │   │  密码   │  │  方向   │  │  模式   │  │  周期   │        │ │   │
   554→│   │   │   └─────────┘  └─────────┘  └─────────┘  └─────────┘        │ │   │
   555→│   │   │                                                               │ │   │
   556→│   │   └───────────────────────────────────────────────────────────────┘ │   │
   557→│   │                                                                     │   │
   558→│   │   ┌───────────────────────────────────────────────────────────────┐ │   │
   559→│   │   │                                                               │ │   │
   560→│   │   │   真实对话示例                                                │ │   │
   561→│   │   │   ─────────────────────────────────────────────────────────   │ │   │
   562→│   │   │                                                               │ │   │
   563→│   │   │   用户: 我1990年3月15日出生，最近总觉得做事差一点...         │ │   │
   564→│   │   │                                                               │ │   │
   565→│   │   │   八字: 你是庚午年出生，日主是木...                          │ │   │
   566→│   │   │         最近走到"偏印"运，这个阶段...                        │ │   │
   567→│   │   │                                                               │ │   │
   568→│   │   │   [ 滑动查看更多 → ]                                         │ │   │
   569→│   │   │                                                               │ │   │
   570→│   │   └───────────────────────────────────────────────────────────────┘ │   │
   571→│   │                                                                     │   │
   572→│   │   ┌───────────────────────────────────────────────────────────────┐ │   │
   573→│   │   │                                                               │ │   │
   574→│   │   │   VibeLife 星座 · 更多理解自己的方式                          │ │   │
   575→│   │   │   ─────────────────────────────────────────────────────────   │ │   │
   576→│   │   │                                                               │ │   │
   577→│   │   │   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │ │   │
   578→│   │   │   │  ASTRA  │  │  MBTI   │  │ ATTACH  │  │ CAREER  │        │ │   │
   579→│   │   │   │  星座   │  │  人格   │  │  依恋   │  │  职业   │        │ │   │
   580→│   │   │   └─────────┘  └─────────┘  └─────────┘  └─────────┘        │ │   │
   581→│   │   │                                                               │ │   │
   582→│   │   └───────────────────────────────────────────────────────────────┘ │   │
   583→│   │                                                                     │   │
   584→│   └─────────────────────────────────────────────────────────────────────┘   │
   585→│                                                                             │
   586→└─────────────────────────────────────────────────────────────────────────────┘
   587→```
   588→
   589→## 3.3 主界面设计 - Stream 对话流
   590→
   591→```
   592→┌─────────────────────────────────────────────────────────────────────────────┐
   593→│                                                                             │
   594→│   MAIN INTERFACE: STREAM                                                    │
   595→│   所有 Skill 站点统一的对话界面                                             │
   596→│                                                                             │
   597→│   ═══════════════════════════════════════════════════════════════════════   │
   598→│                                                                             │
   599→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   600→│   │                                                                     │   │
   601→│   │   ┌───────────────────────────────────────────────────────────┐     │   │
   602→│   │   │  ☯️ 八字命理                    [Vibe ID: Alex]  ⚙️  👤   │     │   │
   603→│   │   └───────────────────────────────────────────────────────────┘     │   │
   604→│   │                                                                     │   │
   605→│   │   ═══════════════════════════════════════════════════════════════   │   │
   606→│   │                                                                     │   │
   607→│   │   ┌───────────────────────────────────────────────────────────┐     │   │
   608→│   │   │                                                           │     │   │
   609→│   │   │   YOUR BAZI INSIGHT                        Score: 72      │     │   │
   610→│   │   │                                                           │     │   │
   611→│   │   │   ┌─────────────────────────────────────────────────────┐ │     │   │
   612→│   │   │   │                                                     │ │     │   │
   613→│   │   │   │     年柱      月柱      日柱      时柱               │ │     │   │
   614→│   │   │   │     ────      ────      ────      ────               │ │     │   │
   615→│   │   │   │     庚        戊        甲        丙                 │ │     │   │
   616→│   │   │   │     午        寅        子        寅                 │ │     │   │
   617→│   │   │   │                                                     │ │     │   │
   618→│   │   │   │   日主: 甲木 | 格局: 偏印格 | 当前大运: 壬午         │ │     │   │
   619→│   │   │   │                                                     │ │     │   │
   620→│   │   │   └─────────────────────────────────────────────────────┘ │     │   │
   621→│   │   │                                                           │     │   │
   622→│   │   │   [ 查看完整命盘 → ]                                      │     │   │
   623→│   │   │                                                           │     │   │
   624→│   │   └───────────────────────────────────────────────────────────┘     │   │
   625→│   │                                                                     │   │
   626→│   │   ═══════════════════════════════════════════════════════════════   │   │
   627→│   │                           对话                                      │   │
   628→│   │   ═══════════════════════════════════════════════════════════════   │   │
   629→│   │                                                                     │   │
   630→│   │   ┌───────────────────────────────────────────────────────────┐     │   │
   631→│   │   │                                               Today       │     │   │
   632→│   │   │                                                           │     │   │
   633→│   │   │   [八字] ☯️                                                │     │   │
   634→│   │   │                                                           │     │   │
   635→│   │   │   你好，我已经看到你的命盘了。                             │     │   │
   636→│   │   │                                                           │     │   │
   637→│   │   │   甲木日主，生于寅月，木气旺盛。                          │     │   │
   638→│   │   │   这赋予你天生的成长欲望和扩展能力。                      │     │   │
   639→│   │   │                                                           │     │   │
   640→│   │   │   你现在走的是"壬午"大运，水火交战的阶段。                │     │   │
   641→│   │   │   这两年可能会感觉内心有些矛盾和拉扯。                    │     │   │
   642→│   │   │                                                           │     │   │
   643→│   │   │   想先聊聊哪个方面？                                       │     │   │
   644→│   │   │                                                           │     │   │
   645→│   │   │   ┌─────────────────────────────────────────────────────┐ │     │   │
   646→│   │   │   │ 🎯 事业  │  💕 感情  │  🌱 性格  │  📅 今年运势    │ │     │   │
   647→│   │   │   └─────────────────────────────────────────────────────┘ │     │   │
   648→│   │   │                                                           │     │   │
   649→│   │   └───────────────────────────────────────────────────────────┘     │   │
   650→│   │                                                                     │   │
   651→│   │   ┌───────────────────────────────────────────────────────────┐     │   │
   652→│   │   │                                               10:32 AM    │     │   │
   653→│   │   │                                                           │     │   │
   654→│   │   │   [我]                                                    │     │   │
   655→│   │   │                                                           │     │   │
   656→│   │   │   最近总觉得做事差一点点，是不是运势问题？                 │     │   │
   657→│   │   │                                                           │     │   │
   658→│   │   └───────────────────────────────────────────────────────────┘     │   │
   659→│   │                                                                     │   │
   660→│   │   ┌───────────────────────────────────────────────────────────┐     │   │
   661→│   │   │                                               10:33 AM    │     │   │
   662→│   │   │                                                           │     │   │
   663→│   │   │   [八字] ☯️                                                │     │   │
   664→│   │   │                                                           │     │   │
   665→│   │   │   这个感觉很有意思。让我看看。                             │     │   │
   666→│   │   │                                                           │     │   │
   667→│   │   │   ┌─────────────────────────────────────────────────────┐ │     │   │
   668→│   │   │   │  💡 INSIGHT                                         │ │     │   │
   669→│   │   │   │  ─────────────────────────────────────────────────  │ │     │   │
   670→│   │   │   │                                                     │ │     │   │
   671→│   │   │   │  你现在流年走到"偏印"运了。                         │ │     │   │
   672→│   │   │   │                                                     │ │     │   │
   673→│   │   │   │  偏印的特点：                                       │ │     │   │
   674→│   │   │   │  • 思考增多，行动减少                               │ │     │   │
   675→│   │   │   │  • 容易想太多，犹豫不决                             │ │     │   │
   676→│   │   │   │  • 学习能力增强，但执行力下降                       │ │     │   │
   677→│   │   │   │                                                     │ │     │   │
   678→│   │   │   │  这不是"运气不好"，而是需要"慢下来"的信号。         │ │     │   │
   679→│   │   │   │                                                     │ │     │   │
   680→│   │   │   └─────────────────────────────────────────────────────┘ │     │   │
   681→│   │   │                                                           │     │   │
   682→│   │   │   而且你的八字本身木旺，遇到偏印运会放大"想"的特点。     │     │   │
   683→│   │   │                                                           │     │   │
   684→│   │   │   最近有什么事让你特别着急想搞定的吗？                    │     │   │
   685→│   │   │                                                           │     │   │
   686→│   │   └───────────────────────────────────────────────────────────┘     │   │
   687→│   │                                                                     │   │
   688→│   │   ═══════════════════════════════════════════════════════════════   │   │
   689→│   │                                                                     │   │
   690→│   │   ┌────────────────────────────────────────────────────────────┐    │   │
   691→│   │   │                                                            │    │   │
   692→│   │   │  💬 说点什么...                              🎤  📷  😊   │    │   │
   693→│   │   │                                                            │    │   │
   694→│   │   └────────────────────────────────────────────────────────────┘    │   │
   695→│   │                                                                     │   │
   696→│   │   ─────────────────────────────────────────────────────────────     │   │
   697→│   │                                                                     │   │
   698→│   │   ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐                   │   │
   699→│   │   │  💬    │  │  📊    │  │  📓    │  │  👤    │                   │   │
   700→│   │   │  对话  │  │  命盘  │  │ 历程   │  │  我的  │                   │   │
   701→│   │   └────────┘  └────────┘  └────────┘  └────────┘                   │   │
   702→│   │                                                                     │   │
   703→│   └─────────────────────────────────────────────────────────────────────┘   │
   704→│                                                                             │
   705→└─────────────────────────────────────────────────────────────────────────────┘
   706→```
   707→
   708→## 3.4 Insight Card 系统
   709→
   710→```
   711→┌─────────────────────────────────────────────────────────────────────────────┐
   712→│                                                                             │
   713→│   INSIGHT CARD SYSTEM                                                       │
   714→│   标准化的洞察展示组件                                                      │
   715→│                                                                             │
   716→│   ═══════════════════════════════════════════════════════════════════════   │
   717→│                                                                             │
   718→│   CARD TYPES                                                                │
   719→│                                                                             │
   720→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   721→│   │                                                                     │   │
   722→│   │   TYPE 1: DISCOVERY CARD (发现卡)                                   │   │
   723→│   │   ─────────────────────────────────────────────────────────────     │   │
   724→│   │                                                                     │   │
   725→│   │   ┌─────────────────────────────────────────────────────────────┐   │   │
   726→│   │   │  💡 发现                                                    │   │   │
   727→│   │   │  ───────────────────────────────────────────────────────    │   │   │
   728→│   │   │                                                             │   │   │
   729→│   │   │  你的命盘显示：                                             │   │   │
   730→│   │   │  木旺而水弱，这意味着你天生善于开始，但需要学习"扎根"。     │   │   │
   731→│   │   │                                                             │   │   │
   732→│   │   │  过去一个月你提到了 3 次"差一点点"，这可能和木的特质有关。 │   │   │
   733→│   │   │                                                             │   │   │
   734→│   │   │  ┌────────────────────────────────────────────────────────┐ │   │   │
   735→│   │   │  │ [深入了解]  [记录这个发现]  [分享]                     │ │   │   │
   736→│   │   │  └────────────────────────────────────────────────────────┘ │   │   │
   737→│   │   │                                                             │   │   │
   738→│   │   └─────────────────────────────────────────────────────────────┘   │   │
   739→│   │                                                                     │   │
   740→│   └─────────────────────────────────────────────────────────────────────┘   │
   741→│                                                                             │
   742→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   743→│   │                                                                     │   │
   744→│   │   TYPE 2: PATTERN CARD (模式卡)                                     │   │
   745→│   │   ─────────────────────────────────────────────────────────────     │   │
   746→│   │                                                                     │   │
   747→│   │   ┌─────────────────────────────────────────────────────────────┐   │   │
   748→│   │   │  🔄 模式识别                                                │   │   │
   749→│   │   │  ───────────────────────────────────────────────────────    │   │   │
   750→│   │   │                                                             │   │   │
   751→│   │   │  ┌─────────────────────────────────────────────────────┐    │   │   │
   752→│   │   │  │                                                     │    │   │   │
   753→│   │   │  │    YOUR DECISION PATTERN                            │    │   │   │
   754→│   │   │  │                                                     │    │   │   │
   755→│   │   │  │    兴奋期 ───▶ 犹豫期 ───▶ 后悔期                   │    │   │   │
   756→│   │   │  │       │          │          │                       │    │   │   │
   757→│   │   │  │    (开始)     (想太多)   (错过)                      │    │   │   │
   758→│   │   │  │                                                     │    │   │   │
   759→│   │   │  │    这个模式在过去 3 个月出现了 4 次                  │    │   │   │
   760→│   │   │  │                                                     │    │   │   │
   761→│   │   │  └─────────────────────────────────────────────────────┘    │   │   │
   762→│   │   │                                                             │   │   │
   763→│   │   │  命理解释：偏印运 + 木旺                                    │   │   │
   764→│   │   │  建议：设定决策时限，强制自己在 X 天内做决定               │   │   │
   765→│   │   │                                                             │   │   │
   766→│   │   └─────────────────────────────────────────────────────────────┘   │   │
   767→│   │                                                                     │   │
   768→│   └─────────────────────────────────────────────────────────────────────┘   │
   769→│                                                                             │
   770→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   771→│   │                                                                     │   │
   772→│   │   TYPE 3: TIMING CARD (时机卡)                                      │   │
   773→│   │   ─────────────────────────────────────────────────────────────     │   │
   774→│   │                                                                     │   │
   775→│   │   ┌─────────────────────────────────────────────────────────────┐   │   │
   776→│   │   │  ⏰ 时机洞察                                                │   │   │
   777→│   │   │  ───────────────────────────────────────────────────────    │   │   │
   778→│   │   │                                                             │   │   │
   779→│   │   │  这个月（寅月）对你来说：                                   │   │   │
   780→│   │   │                                                             │   │   │
   781→│   │   │  ┌─────────────────────────────────────────────────────┐    │   │   │
   782→│   │   │  │  适合：                                              │    │   │   │
   783→│   │   │  │  ✓ 启动新项目（木旺助力）                            │    │   │   │
   784→│   │   │  │  ✓ 学习新技能（偏印带来的吸收力）                    │    │   │   │
   785→│   │   │  │                                                     │    │   │   │
   786→│   │   │  │  需要注意：                                          │    │   │   │
   787→│   │   │  │  ⚠️ 避免重大财务决策（财运不稳）                     │    │   │   │
   788→│   │   │  │  ⚠️ 多休息，水弱容易疲劳                            │    │   │   │
   789→│   │   │  └─────────────────────────────────────────────────────┘    │   │   │
   790→│   │   │                                                             │   │   │
   791→│   │   │  [ 设置提醒 ]  [ 查看下个月 ]                               │   │   │
   792→│   │   │                                                             │   │   │
   793→│   │   └─────────────────────────────────────────────────────────────┘   │   │
   794→│   │                                                                     │   │
   795→│   └─────────────────────────────────────────────────────────────────────┘   │
   796→│                                                                             │
   797→│   ┌─────────────────────────────────────────────────────────────────────┐   │
   798→│   │                                                                     │   │
   799→│   │   TYPE 4: GROWTH CARD (成长卡)                                      │   │
   800→│   │   ─────────────────────────────────────────────────────────────     │   │
   801→│   │                                                                     │   │
   802→│   │   ┌─────────────────────────────────────────────────────────────┐   │   │
   803→│   │   │  🌱 成长记录                                                │   │   │
   804→│   │   │  ───────────────────────────────────────────────────────    │   │   │
   805→│   │   │                                                             │   │   │
   806→│   │   │  "你注意到了吗？                                            │   │   │
   807→│   │   │                                                             │   │   │
   808→│   │   │   一个月前你说'我总是想太多，错过机会'，                   │   │   │
   809→│   │   │   但这周你提到主动约了投资人聊，                            │   │   │
   810→│   │   │   没有等到'完全准备好'。                                   │   │   │
   811→│   │   │                                                             │   │   │
   812→│   │   │   这是突破'偏印'困局的表现。                               │   │   │
   813→│   │   │   你在成长。🌱"                                             │   │   │
   814→│   │   │                                                             │   │   │
   815→│   │   │  [ 记录这个时刻 ]  [ 继续聊聊 ]                             │   │   │
   816→│   │   │                                                             │   │   │
   817→│   │   └─────────────────────────────────────────────────────────────┘   │   │
   818→│   │                                                                     │   │
   819→│   └─────────────────────────────────────────────────────────────────────┘   │
   820→│                                                                             │
   821→└─────────────────────────────────────────────────────────────────────────────┘
   822→```
   823→
   824→---
   825→
   826→# 第四部分：Skill Agent 系统
   827→
   828→## 4.1 Skill Agent 架构
   829→
   830→```
   831→╔═══════════════════════════════════════════════════════════════════════════════╗
   832→║                                                                               ║
   833→║   SKILL AGENT SYSTEM ARCHITECTURE                                             ║
   834→║   每个 Skill 独立站的智能代理系统                                             ║
   835→║                                                                               ║
   836→║   ─────────────────────────────────────────────────────────────────────────   ║
   837→║                                                                               ║
   838→║   ┌─────────────────────────────────────────────────────────────────────────┐ ║
   839→║   │                                                                         │ ║
   840→║   │                        SKILL AGENT RUNTIME                              │ ║
   841→║   │                                                                         │ ║
   842→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
   843→║   │   │                                                                 │   │ ║
   844→║   │   │                      AGENT CORE                                 │   │ ║
   845→║   │   │                                                                 │   │ ║
   846→║   │   │   ┌───────────────────────────────────────────────────────┐     │   │ ║
   847→║   │   │   │                                                       │     │   │ ║
   848→║   │   │   │                  LLM BACKBONE                         │     │   │ ║
   849→║   │   │   │              (Claude / GPT-4 / etc.)                  │     │   │ ║
   850→║   │   │   │                                                       │     │   │ ║
   851→║   │   │   └───────────────────────────────────────────────────────┘     │   │ ║
   852→║   │   │                           │                                     │   │ ║
   853→║   │   │         ┌─────────────────┼─────────────────┐                   │   │ ║
   854→║   │   │         │                 │                 │                   │   │ ║
   855→║   │   │         ▼                 ▼                 ▼                   │   │ ║
   856→║   │   │   ┌───────────┐   ┌───────────┐   ┌───────────┐                │   │ ║
   857→║   │   │   │  PERSONA  │   │   SKILL   │   │  CONTEXT  │                │   │ ║
   858→║   │   │   │  INJECTOR │   │  ROUTER   │   │  BUILDER  │                │   │ ║
   859→║   │   │   │           │   │           │   │           │                │   │ ║
   860→║   │   │   │ • 角色设定 │   │ • 意图识别 │   │ • 用户画像 │                │   │ ║
   861→║   │   │   │ • 风格指令 │   │ • 流程分发 │   │ • 对话历史 │                │   │ ║
   862→║   │   │   │ • 边界约束 │   │ • 状态管理 │   │ • 知识上文 │                │   │ ║
   863→║   │   │   └───────────┘   └───────────┘   └───────────┘                │   │ ║
   864→║   │   │                                                                 │   │ ║
   865→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
   866→║   │                                     │                                   │ ║
   867→║   │                                     ▼                                   │ ║
   868→║   │   ┌─────────────────────────────────────────────────────────────────┐   │ ║
   869→║   │   │                                                                 │   │ ║
   870→║   │   │                    CAPABILITY LAYER                             │   │ ║
   871→║   │   │                                                                 │   │ ║
   872→║   │   │   ┌───────────┐   ┌───────────┐   ┌───────────┐                │   │ ║
   873→║   │   │   │ KNOWLEDGE │   │   TOOL    │   │  OUTPUT   │                │   │ ║
   874→║   │   │   │ RETRIEVER │   │  EXECUTOR │   │ FORMATTER │                │   │ ║
   875→║   │   │   │           │   │           │   │           │                │   │ ║
   876→║   │   │   │ • 混合检索 │   │ • 函数调用 │   │ • 卡片生成 │                │   │ ║
   877→║   │   │   │ • 知识融合 │   │ • 计算执行 │   │ • 图表渲染 │                │   │ ║
   878→║   │   │   │ • 相关排序 │   │ • 外部API │   │ • 格式适配 │                │   │ ║
   879→║   │   │   └───────────┘   └───────────┘   └───────────┘                │   │ ║
   880→║   │   │                                                                 │   │ ║
   881→║   │   └─────────────────────────────────────────────────────────────────┘   │ ║
   882→║   │                                                                         │ ║
   883→║   └─────────────────────────────────────────────────────────────────────────┘ ║
   884→║                                                                               ║
   885→╚═══════════════════════════════════════════════════════════════════════════════╝
   886→```
   887→
   888→## 4.2 Skill Definition Standard
   889→
   890→```yaml
   891→# /skills/bazi/SKILL.yaml
   892→# 标准 Skill 定义格式
   893→
   894→skill:
   895→  id: bazi
   896→  name: 八字命理
   897→  version: "1.0.0"
   898→  domain: vibelife.app
   899→  subdomain: bazi
   900→
   901→# Agent Persona 定义
   902→persona:
   903→  name: 八字
   904→  identity: |
   905→    你是 VibeLife 八字命理分析师。
   906→    你用现代语言解读传统八字，帮助用户理解自己。
   907→    你不是算命的，而是帮用户"看见"自己的镜子。
   908→    
   909→  style:
   910→    tone: 沉稳智慧，温和但有分量
   911→    vocabulary: 现代化，避免晦涩古语
   912→    approach: 不预测具体事件，强调选择权
   913→    
   914→  boundaries:
   915→    - 不做具体事件预测（如"你明年会结婚"）
   916→    - 不贩卖焦虑
   917→    - 不说绝对的话
   918→    - 强调命理是参考，不是宿命
   919→    
   920→  example_responses:
   921→    - situation: 用户询问运势
   922→      bad: "你今年犯太岁，运势很差，要小心"
   923→      good: "今年是你的'调整年'，适合慢下来思考。有什么特别想完成的目标吗？"
   924→
   925→# 核心工作流
   926→workflows:
   927→  - id: initial_reading
   928→    name: 初始解读
   929→    trigger: 首次生成命盘
   930→    steps:
   931→      - collect_birth_info
   932→      - generate_chart
   933→      - personality_reading
   934→      - current_transit
   935→
   936→  - id: question_answering
   937→    name: 问题解答
   938→    trigger: 用户提问
   939→    steps:
   940→      - understand_intent
   941→      - retrieve_knowledge
   942→      - generate_insight
   943→      - suggest_action
   944→
   945→  - id: timing_consultation
   946→    name: 时机咨询
   947→    trigger: 用户询问时机
   948→    steps:
   949→      - analyze_transit
   950→      - evaluate_timing
   951→      - provide_suggestion
   952→
   953→# 知识库配置
   954→knowledge:
   955→  sources:
   956→    - path: /knowledge/bazi/theory/
   957→      type: structured
   958→      description: 八字理论基础
   959→      
   960→    - path: /knowledge/bazi/patterns/
   961→      type: structured
   962→      description: 格局和十神模式
   963→      
   964→    - path: /knowledge/bazi/transit/
   965→      type: structured
   966→      description: 大运流年解读
   967→      
   968→    - path: /knowledge/bazi/cases/
   969→      type: examples
   970→      description: 解读案例库
   971→      
   972→  retrieval:
   973→    strategy: hybrid
   974→    vector_weight: 0.6
   975→    keyword_weight: 0.2
   976→    graph_weight: 0.2
   977→
   978→# 工具函数
   979→tools:
   980→  - id: calculate_bazi
   981→    name: 八字排盘
   982→    description: 根据出生信息计算八字命盘
   983→    function: bazi.calculator.generate_chart
   984→    inputs:
   985→      - name: birth_date
   986→        type: date
   987→        required: true
   988→      - name: birth_time
   989→        type: time
   990→        required: false
   991→      - name: birth_location
   992→        type: location
   993→        required: false
   994→    outputs:
   995→      - name: chart
   996→        type: BaziChart
   997→        
   998→  - id: calculate_transit
   999→    name: 大运流年
  1000→    description: 计算当前大运流年

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
