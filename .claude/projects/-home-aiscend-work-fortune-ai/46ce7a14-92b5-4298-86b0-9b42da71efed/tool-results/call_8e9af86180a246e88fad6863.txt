     1→from __future__ import annotations
     2→
     3→import os
     4→from typing import Any, Dict, List, Optional, Tuple
     5→
     6→
     7→def _which_backend(hint: Optional[str]) -> str:
     8→    b = (hint or os.getenv("GEMINI_BACKEND", "gemini")).strip().lower()
     9→    return "cli" if b == "cli" else "gemini"
    10→
    11→
    12→def create_gemini_job(job_name: str, tasks: List[Dict], user_email: Optional[str] = None, *, backend: Optional[str] = None) -> Tuple[Optional[str], Optional[int], List[int]]:
    13→    b = _which_backend(backend)
    14→    if b == "cli":
    15→        from .cli_worker_repo import create_gemini_job as _create
    16→        return _create(job_name, tasks, user_email)
    17→    else:
    18→        from .gemini_repo import create_gemini_job as _create
    19→        return _create(job_name, tasks, user_email)
    20→
    21→
    22→def get_tasks_by_job_id(job_id: int, *, backend: Optional[str] = None) -> List[Dict]:
    23→    b = _which_backend(backend)
    24→    if b == "cli":
    25→        from .cli_worker_repo import get_tasks_by_job_id as _get
    26→        return _get(job_id)
    27→    if b == "gemini":
    28→        from .gemini_repo import get_tasks_by_job_id as _get
    29→        return _get(job_id)
    30→    # auto-fallback: try cli first, then gemini
    31→    try:
    32→        from .cli_worker_repo import get_tasks_by_job_id as _cli_get
    33→        tasks = _cli_get(job_id)
    34→        if tasks:
    35→            return tasks
    36→    except Exception:
    37→        pass
    38→    from .gemini_repo import get_tasks_by_job_id as _gm_get
    39→    return _gm_get(job_id)
    40→
    41→
    42→def get_gemini_job_by_job_name(job_name: str, *, backend: Optional[str] = None) -> Optional[Dict]:
    43→    b = _which_backend(backend)
    44→    if b == "cli":
    45→        from .cli_worker_repo import get_gemini_job_by_job_name as _get
    46→        return _get(job_name)
    47→    if b == "gemini":
    48→        from .gemini_repo import get_gemini_job_by_job_name as _get
    49→        return _get(job_name)
    50→    # auto fallback
    51→    try:
    52→        from .cli_worker_repo import get_gemini_job_by_job_name as _cli_get
    53→        r = _cli_get(job_name)
    54→        if r:
    55→            return r
    56→    except Exception:
    57→        pass
    58→    from .gemini_repo import get_gemini_job_by_job_name as _gm_get
    59→    return _gm_get(job_name)
    60→
    61→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
