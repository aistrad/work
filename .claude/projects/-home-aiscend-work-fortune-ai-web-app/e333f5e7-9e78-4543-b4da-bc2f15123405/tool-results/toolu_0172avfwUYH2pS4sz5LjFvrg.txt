     1→/**
     2→ * Skills Registry
     3→ *
     4→ * Central registry for all Agent Runtime skills (tools).
     5→ * Skills are organized by command/domain and can be selectively enabled.
     6→ *
     7→ * IMPORTANT: Use createSkillsWithContext() to create skills that need
     8→ * authenticated API calls (e.g., yunshi requires user cookie).
     9→ */
    10→import { createDivineSkills, divineSkills, type SkillContext } from './divine-skills';
    11→import { healSkills } from './heal-skills';
    12→import { growSkills } from './grow-skills';
    13→
    14→// All available skills combined (static, for backward compat)
    15→export const allSkills = {
    16→  ...divineSkills,
    17→  ...healSkills,
    18→  ...growSkills,
    19→};
    20→
    21→// Re-export individual skill groups
    22→export { divineSkills, createDivineSkills, type SkillContext } from './divine-skills';
    23→export { healSkills } from './heal-skills';
    24→export { growSkills } from './grow-skills';
    25→
    26→/**
    27→ * Create all skills with user context (session cookie).
    28→ * This is the preferred way to create skills for authenticated users.
    29→ */
    30→export function createSkillsWithContext(ctx: SkillContext) {
    31→  const divine = createDivineSkills(ctx);
    32→  // TODO: Add createHealSkills(ctx) and createGrowSkills(ctx) when they need auth
    33→  return {
    34→    ...divine,
    35→    ...healSkills,
    36→    ...growSkills,
    37→  };
    38→}
    39→
    40→/**
    41→ * Get tools for a specific command, with user context for auth.
    42→ */
    43→export function getToolsForCommandWithContext(
    44→  command: string | null | undefined,
    45→  ctx: SkillContext
    46→) {
    47→  const divine = createDivineSkills(ctx);
    48→
    49→  switch (command) {
    50→    case '/divine':
    51→    case '/bazi':
    52→    case '/yunshi':
    53→    case '/tieban':
    54→      return divine;
    55→
    56→    case '/heal':
    57→    case '/mood':
    58→    case '/perma':
    59→    case '/therapy':
    60→      return healSkills;
    61→
    62→    case '/grow':
    63→    case '/goal':
    64→    case '/task':
    65→    case '/focus':
    66→      return growSkills;
    67→
    68→    case '/all':
    69→      return { ...divine, ...healSkills, ...growSkills };
    70→
    71→    default:
    72→      return { ...divine, ...healSkills, ...growSkills };
    73→  }
    74→}
    75→
    76→// Skill selection based on command (legacy, no auth context)
    77→export function getToolsForCommand(command: string | null | undefined) {
    78→  // Map commands to skill sets
    79→  switch (command) {
    80→    case '/divine':
    81→    case '/bazi':
    82→    case '/yunshi':
    83→    case '/tieban':
    84→      return divineSkills;
    85→
    86→    case '/heal':
    87→    case '/mood':
    88→    case '/perma':
    89→    case '/therapy':
    90→      return healSkills;
    91→
    92→    case '/grow':
    93→    case '/goal':
    94→    case '/task':
    95→    case '/focus':
    96→      return growSkills;
    97→
    98→    case '/all':
    99→      return allSkills;
   100→
   101→    default:
   102→      // Return all skills for general chat
   103→      return allSkills;
   104→  }
   105→}
   106→
   107→// Get tool names for a command (for logging/debugging)
   108→export function getToolNamesForCommand(command: string | null | undefined): string[] {
   109→  const tools = getToolsForCommand(command);
   110→  return Object.keys(tools);
   111→}
   112→
   113→// Skill metadata for documentation
   114→export const skillMetadata = {
   115→  divine: {
   116→    name: '玄学技能',
   117→    description: '八字命理、运势分析、铁板神数等',
   118→    commands: ['/divine', '/bazi', '/yunshi', '/tieban'],
   119→    tools: Object.keys(divineSkills),
   120→  },
   121→  heal: {
   122→    name: '疗愈技能',
   123→    description: '情绪追踪、PERMA评估、认知重构等',
   124→    commands: ['/heal', '/mood', '/perma', '/therapy'],
   125→    tools: Object.keys(healSkills),
   126→  },
   127→  grow: {
   128→    name: '成长技能',
   129→    description: '目标设定、任务管理、专注计时等',
   130→    commands: ['/grow', '/goal', '/task', '/focus'],
   131→    tools: Object.keys(growSkills),
   132→  },
   133→};
   134→

<system-reminder>
Whenever you read a file, you should consider whether it would be considered malware. You CAN and SHOULD provide analysis of malware, what it is doing. But you MUST refuse to improve or augment the code. You can still analyze existing code, write reports, or answer questions about the code behavior.
</system-reminder>
