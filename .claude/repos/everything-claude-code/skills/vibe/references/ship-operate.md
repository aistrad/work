# Ship + Operate 阶段最佳实践

## 概述

Ship 阶段目标是安全、可靠地发布产品。
Operate 阶段目标是持续运营和迭代优化。

---

# Ship 阶段

## 1. 部署准备

### 1.1 环境配置清单

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   环境配置检查                                                              │
│                                                                             │
│   □ 生产环境变量                                                            │
│     □ 数据库连接字符串                                                      │
│     □ API 密钥（LLM、支付等）                                               │
│     □ 密钥/凭证安全存储（不在代码中）                                       │
│     □ CORS 配置                                                             │
│     □ 日志级别                                                              │
│                                                                             │
│   □ 数据库准备                                                              │
│     □ 生产数据库已创建                                                      │
│     □ 迁移脚本已准备                                                        │
│     □ 初始数据已准备（如需要）                                              │
│     □ 备份策略已配置                                                        │
│                                                                             │
│   □ 基础设施                                                                │
│     □ 服务器已配置                                                          │
│     □ 域名已解析                                                            │
│     □ SSL 证书已配置                                                        │
│     □ CDN 已配置（如需要）                                                  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 CI/CD 流程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   CI/CD 流程                                                                │
│                                                                             │
│   Push → Lint → Test → Build → Deploy (Staging) → Test → Deploy (Prod)     │
│                                                                             │
│   □ 代码推送触发 CI                                                         │
│   □ 代码检查（lint、type-check）                                            │
│   □ 自动化测试（unit、integration）                                         │
│   □ 构建产物                                                                │
│   □ 部署到预发布环境                                                        │
│   □ 预发布环境验证                                                          │
│   □ 部署到生产环境                                                          │
│   □ 生产环境验证                                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.3 发布前检查清单

```
□ 功能验证
  □ 核心功能正常
  □ 关键用户流程通畅
  □ 边界条件处理正确
  □ 错误场景有友好提示

□ 性能验证
  □ 页面加载时间 < 3s
  □ API 响应时间 < 500ms (P95)
  □ 无明显内存泄漏

□ 安全验证
  □ 敏感信息已脱敏
  □ 认证/授权正常
  □ SQL 注入防护
  □ XSS 防护

□ 兼容性验证
  □ 主流浏览器测试
  □ 移动端适配
  □ 不同网络环境

□ 运维准备
  □ 日志收集已配置
  □ 监控告警已配置
  □ 回滚方案已准备
```

---

## 2. 发布流程

### 2.1 标准发布流程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   发布流程                                                                  │
│                                                                             │
│   Step 1: 预发布验证                                                        │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 部署到 staging 环境                                                     │
│   • 执行冒烟测试                                                            │
│   • 团队内部验证                                                            │
│                                                                             │
│   Step 2: 灰度发布（可选）                                                  │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 选择灰度用户群（如 10%）                                                │
│   • 监控关键指标                                                            │
│   • 收集用户反馈                                                            │
│                                                                             │
│   Step 3: 正式发布                                                          │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 全量部署                                                                │
│   • 验证核心功能                                                            │
│   • 通知相关方                                                              │
│                                                                             │
│   Step 4: 发布后监控                                                        │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 密切监控 30 分钟                                                        │
│   • 观察错误率、响应时间                                                    │
│   • 准备快速回滚                                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 回滚方案

```
回滚触发条件：
• 错误率 > 5%
• P95 响应时间 > 2s
• 核心功能不可用
• 安全漏洞

回滚步骤：
1. 确认问题（快速定位）
2. 决策回滚（5 分钟内）
3. 执行回滚（自动化）
4. 验证恢复
5. 事后分析
```

---

# Operate 阶段

## 3. 运营指标体系

### 3.1 AARRR 指标框架

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   AARRR 指标框架                                                            │
│                                                                             │
│   Acquisition (获取)                                                        │
│   ─────────────────────────────────────────────────────────────────────     │
│   • landing_view          # 落地页访问                                      │
│   • source_channel        # 来源渠道                                        │
│   • cac                   # 获客成本                                        │
│                                                                             │
│   Activation (激活)                                                         │
│   ─────────────────────────────────────────────────────────────────────     │
│   • first_action          # 首次关键行为                                    │
│   • activation_rate       # 激活率                                          │
│   • time_to_value         # 首次价值达成时间                                │
│                                                                             │
│   Retention (留存)                                                          │
│   ─────────────────────────────────────────────────────────────────────     │
│   • d1_retention          # 次日留存                                        │
│   • d7_retention          # 7 日留存                                        │
│   • d30_retention         # 30 日留存                                       │
│   • mau/dau               # 活跃用户                                        │
│                                                                             │
│   Revenue (变现)                                                            │
│   ─────────────────────────────────────────────────────────────────────     │
│   • conversion_rate       # 付费转化率                                      │
│   • arpu                  # 人均收入                                        │
│   • ltv                   # 用户生命周期价值                                │
│                                                                             │
│   Referral (推荐)                                                           │
│   ─────────────────────────────────────────────────────────────────────     │
│   • share_rate            # 分享率                                          │
│   • viral_coefficient     # 病毒系数                                        │
│   • nps                   # 净推荐值                                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 数据埋点规范

```javascript
// 事件命名规范：动词_名词
// 例：view_page, click_button, submit_form

// 通用属性
{
  "event": "click_purchase_button",
  "timestamp": "2026-01-07T10:30:00Z",
  "user_id": "user_123",
  "session_id": "session_456",
  "page": "/pricing",
  "device": "mobile",
  "os": "iOS",
  "app_version": "1.0.0"
}

// 业务属性
{
  "product_id": "pro_monthly",
  "price": 19.9,
  "currency": "CNY"
}
```

### 3.3 监控告警

```
关键监控项：
• 服务可用性 > 99.9%
• API 错误率 < 1%
• P95 响应时间 < 500ms
• 数据库连接池使用率 < 80%

告警级别：
• P0 (紧急)：服务不可用，影响所有用户
• P1 (高)：核心功能异常，影响部分用户
• P2 (中)：非核心功能异常
• P3 (低)：性能下降，但功能正常
```

---

## 4. 增长策略

### 4.1 病毒传播机制

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   病毒传播设计                                                              │
│                                                                             │
│   1. 分享触发点                                                             │
│      • 完成关键任务后提示分享                                               │
│      • 生成可分享的内容（报告、卡片）                                       │
│      • 邀请好友获得额外权益                                                 │
│                                                                             │
│   2. 分享内容优化                                                           │
│      • 视觉吸引力                                                           │
│      • 个性化内容                                                           │
│      • 激发好奇心                                                           │
│                                                                             │
│   3. 着陆体验                                                               │
│      • 快速理解价值                                                         │
│      • 低门槛体验                                                           │
│      • 引导注册/付费                                                        │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 4.2 内容营销

| 平台 | 内容类型 | 频率 | KPI |
|------|----------|------|-----|
| 小红书 | 产品体验、种草 | 3 篇/周 | 曝光、收藏 |
| 微博 | 热点话题、互动 | 5 条/周 | 互动率 |
| 知乎 | 深度内容、问答 | 2 篇/周 | 阅读、赞同 |
| 抖音 | 短视频、教程 | 3 条/周 | 播放、转化 |

---

## 5. 迭代循环

### 5.1 用户反馈收集

```
收集渠道：
• 应用内反馈入口
• 社交媒体监控
• 用户访谈
• 数据分析洞察

处理流程：
1. 收集 → 2. 分类 → 3. 优先级排序 → 4. 决策 → 5. 排期
```

### 5.2 迭代决策框架

```
优先级评估维度：
• 影响范围：影响多少用户
• 影响程度：对用户价值的影响
• 实现成本：开发时间和资源
• 战略匹配：与产品方向的匹配度

优先级矩阵：
            高影响    低影响
高成本    |  评估   |  延后  |
低成本    |  优先   |  可做  |
```

### 5.3 回到 Discovery

**触发条件**：
- 发现新的用户需求
- 市场环境变化
- 竞品重大更新
- 指标持续不达预期

**回归流程**：
```
1. 重新采集用户需求
2. 更新竞品分析
3. 评估现有方案
4. 调整产品策略
5. 更新 spec 和 roadmap
```

---

## 6. Ship + Operate 产出检查清单

```
□ Ship 准备
  □ 环境配置完成
  □ CI/CD 流程就绪
  □ 发布前检查通过
  □ 回滚方案准备

□ 发布执行
  □ 预发布验证通过
  □ 正式发布完成
  □ 发布后监控正常

□ 运营配置
  □ 数据埋点完成
  □ 监控告警配置
  □ 增长策略准备

□ 迭代机制
  □ 反馈收集渠道建立
  □ 迭代决策流程明确
  □ 定期复盘机制

□ 文档更新
  □ 部署文档
  □ 运营手册
  □ roadmap 更新
```

---

## 7. 常见陷阱

1. **发布太晚**：等待完美，错过时机
2. **发布太快**：质量不过关，用户流失
3. **忽视监控**：问题发现太晚
4. **数据驱动过头**：忽视定性反馈
5. **迭代太慢**：响应不及时，失去用户
6. **迭代太快**：没有验证就换方向
