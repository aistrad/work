<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fortune AI - Main</title>
  <link rel="stylesheet" href="/static/ui.css?v={{ asset_version }}" />
</head>
<body>
  <div class="ui-page">
    <header class="ui-header">
      <div class="ui-brand">Fortune AI</div>
      <div class="ui-topbar">
        <button class="ui-btn ui-btn-ghost" id="session-drawer-open">会话 ▼</button>
        <label class="ui-topbar__label">风格</label>
        <select id="persona-style" class="ui-select">
          <option value="standard">standard</option>
          <option value="warm" selected>warm</option>
          <option value="roast">roast</option>
        </select>
        <button class="ui-btn ui-btn-ghost" id="open-settings">设置</button>
        <button class="ui-btn ui-btn-ghost" id="logout">退出</button>
      </div>
    </header>

    <main class="ui-layout">
      <!-- 左：对话区（SSOT） -->
      <section class="ui-col ui-chat" aria-label="Chat">
        <div class="ui-thread" id="thread" aria-live="polite">
          <!-- 消息会追加到这里 -->
        </div>
        <div class="ui-context-pill" id="context-pill" title="当前上下文">
          <span id="pill-name">—</span>
          <span id="pill-birth">—</span>
          <span id="pill-loc">—</span>
          <span id="pill-dirty" class="ui-pill-dirty" style="display:none">待应用</span>
        </div>
        <form class="ui-input" id="ask-form">
          <button type="button" class="ui-icon-btn" id="open-bento" aria-label="打开功能区">＋</button>
          <textarea id="ask-text" rows="1" placeholder="提出你的问题，例如：今年事业如何提升？" autofocus></textarea>
          <button type="submit" class="ui-send-btn" aria-label="发送">发送</button>
        </form>
      </section>

      <!-- 右：功能区（Bento/工具/设置） -->
      <section class="ui-col ui-workbench" aria-label="Bento">
        <!-- 顶部常驻：Gadgets 结果区（所有工具输出优先展示在这里） -->
        <div class="ui-viewer" aria-label="结果 Viewer">
          <div class="ui-viewer__bar">
            <div class="ui-viewer__title" id="viewer-title">结果区</div>
            <div class="ui-viewer__actions">
              <button class="ui-btn ui-btn-ghost" id="viewer-copy">复制</button>
              <button class="ui-btn ui-btn-ghost" id="viewer-clear">清空</button>
            </div>
          </div>
          <article class="ui-viewer__content" id="viewer-content">
            <div class="ui-task__meta">工具/模板/校准/报告的进度与结果会显示在这里。</div>
          </article>
        </div>

        <nav class="ui-tabs">
          <button class="ui-tab ui-tab--active" data-panel="panel-bento">Bento</button>
          <button class="ui-tab" data-panel="panel-tools">工具</button>
          <button class="ui-tab" data-panel="panel-settings">设置</button>
        </nav>
        <div class="ui-panels">
          <div class="ui-panel" id="panel-bento" style="display:block">
            <div class="ui-bento">
              <!-- 每日必用 -->
              <section class="ui-bento-group" data-priority="high">
                <div class="ui-bento-group__title">每日必用</div>
                <div class="ui-bento-group__cards">
                  <section class="ui-card" id="card-today">
                    <div class="ui-card__hd">
                      <div class="ui-card__hd-left">
                        <div class="ui-card__title">今日指引</div>
                      </div>
                      <div class="ui-card__hd-right">
                        <button class="ui-btn ui-btn-ghost ui-card__btn" id="reload-today">刷新</button>
                        <button class="ui-card__toggle" aria-label="折叠"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 7.5L10 12.5L15 7.5"/></svg></button>
                      </div>
                    </div>
                    <div class="ui-card__bd" id="today-content">加载中…</div>
                  </section>

                  <section class="ui-card" id="card-checkin">
                    <div class="ui-card__hd">
                      <div class="ui-card__hd-left">
                        <div class="ui-card__title">情绪打卡</div>
                      </div>
                      <div class="ui-card__hd-right">
                        <button class="ui-card__toggle" aria-label="折叠"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 7.5L10 12.5L15 7.5"/></svg></button>
                      </div>
                    </div>
                    <div class="ui-card__bd">
                      <form id="checkin-form" class="ui-form">
                        <div class="ui-grid-2">
                          <label>情绪
                            <select name="mood">
                              <option>焦虑</option>
                              <option>低落</option>
                              <option>愤怒</option>
                              <option>平静</option>
                              <option>兴奋</option>
                            </select>
                          </label>
                          <label>强度（0-10）<input name="intensity" type="number" min="0" max="10" step="1" value="6" /></label>
                        </div>
                        <label>备注（可选）<textarea name="note" rows="2" placeholder="一句话描述触发点"></textarea></label>
                        <div class="ui-actions-row">
                          <button type="submit" class="ui-btn ui-btn-primary">提交</button>
                        </div>
                      </form>
                    </div>
                  </section>
                </div>
              </section>

              <!-- 任务与决策 -->
              <section class="ui-bento-group" data-priority="medium">
                <div class="ui-bento-group__title">任务与决策</div>
                <div class="ui-bento-group__cards">
                  <section class="ui-card" id="card-actions">
                    <div class="ui-card__hd">
                      <div class="ui-card__hd-left">
                        <div class="ui-card__title">行动处方</div>
                      </div>
                      <div class="ui-card__hd-right">
                        <button class="ui-btn ui-btn-ghost ui-card__btn" id="reload-actions">刷新</button>
                        <button class="ui-card__toggle" aria-label="折叠"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 7.5L10 12.5L15 7.5"/></svg></button>
                      </div>
                    </div>
                    <div class="ui-card__bd" id="actions-content">—</div>
                  </section>

                  <section class="ui-card collapsed" id="card-decision">
                    <div class="ui-card__hd">
                      <div class="ui-card__hd-left">
                        <div class="ui-card__title">决策模板</div>
                      </div>
                      <div class="ui-card__hd-right">
                        <button class="ui-card__toggle" aria-label="展开"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 7.5L10 12.5L15 7.5"/></svg></button>
                      </div>
                    </div>
                    <div class="ui-card__bd">
                      <form id="decision-form" class="ui-form">
                        <label>我在纠结的问题<textarea name="question" rows="2" placeholder="例如：要不要换工作？"></textarea></label>
                        <label>选项（每行一个）<textarea name="options" rows="3" placeholder="A...\nB..."></textarea></label>
                        <div class="ui-actions-row">
                          <button type="submit" class="ui-btn">发送给教练</button>
                        </div>
                        <div class="ui-hint">会把你填写的内容整理成 Decision Brief 并发到左侧对话。</div>
                      </form>
                    </div>
                  </section>

                  <section class="ui-card collapsed" id="card-script">
                    <div class="ui-card__hd">
                      <div class="ui-card__hd-left">
                        <div class="ui-card__title">话术生成</div>
                      </div>
                      <div class="ui-card__hd-right">
                        <button class="ui-card__toggle" aria-label="展开"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 7.5L10 12.5L15 7.5"/></svg></button>
                      </div>
                    </div>
                    <div class="ui-card__bd">
                      <form id="script-form" class="ui-form">
                        <div class="ui-grid-2">
                          <label>场景
                            <select name="scene">
                              <option value="沟通">沟通</option>
                              <option value="边界">边界</option>
                              <option value="拒绝">拒绝</option>
                              <option value="谈判">谈判</option>
                            </select>
                          </label>
                          <label>对象（可选）<input name="target" placeholder="同事/伴侣/领导…" /></label>
                        </div>
                        <label>你希望达成什么<textarea name="goal" rows="2" placeholder="例如：委婉拒绝加班"></textarea></label>
                        <div class="ui-actions-row">
                          <button type="submit" class="ui-btn">生成并发到对话</button>
                        </div>
                      </form>
                    </div>
                  </section>
                </div>
              </section>

              <!-- 成长追踪 -->
              <section class="ui-bento-group" data-priority="low">
                <div class="ui-bento-group__title">成长追踪</div>
                <div class="ui-bento-group__cards">
                  <section class="ui-card" id="card-plan">
                    <div class="ui-card__hd">
                      <div class="ui-card__hd-left">
                        <div class="ui-card__title">成长计划</div>
                      </div>
                      <div class="ui-card__hd-right">
                        <button class="ui-btn ui-btn-ghost ui-card__btn" id="reload-plan">刷新</button>
                        <button class="ui-card__toggle" aria-label="折叠"><svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 7.5L10 12.5L15 7.5"/></svg></button>
                      </div>
                    </div>
                    <div class="ui-card__bd" id="plan-content">—</div>
                  </section>
                </div>
              </section>
            </div>
          </div>

          <div class="ui-panel" id="panel-tools">
            <div class="ui-card ui-card--flat">
              <div class="ui-card__hd"><div class="ui-card__title">八字深度报告</div></div>
              <div class="ui-card__bd">
                <form id="report-form" class="ui-form">
                  <div class="ui-grid-2">
                    <label>后端
                      <select name="backend">
                        <option value="cli" selected>cli（默认）</option>
                        <option value="gemini">gemini</option>
                      </select>
                    </label>
                    <label>模型
                      <select name="model">
                        <option value="standard">standard</option>
                        <option value="deep_research">deep_research</option>
                      </select>
                    </label>
                  </div>
                  <label>系统提示（可选）<textarea name="system_prompt" rows="3" placeholder="用于报告生成的系统提示"></textarea></label>
                  <div class="ui-actions-row">
                    <button type="submit" class="ui-btn ui-btn-primary">生成报告</button>
                  </div>
                  <div class="ui-hint">提交后，进度与结果会显示在右侧“结果区”。</div>
                </form>
              </div>
            </div>

            <div class="ui-card ui-card--flat">
              <div class="ui-card__hd"><div class="ui-card__title">出生校准（SSE）</div></div>
              <div class="ui-card__bd">
                <form id="rectify-form" class="ui-form">
                  <label>事件列表<textarea name="events" rows="5" placeholder="marriage,2018-05-12,strong\nchild_birth,2020-11-03,strong"></textarea></label>
                  <div class="ui-grid-2">
                    <label>窗口开始<input name="window_start" placeholder="09:00:00" value="00:00:00" /></label>
                    <label>窗口结束<input name="window_end" placeholder="11:00:00" value="23:59:59" /></label>
                  </div>
                  <div class="ui-actions-row">
                    <button type="submit" class="ui-btn">开始校准</button>
                  </div>
                  <div class="ui-hint">会使用你的 Profile 作为出生信息；进度与结果会显示在右侧“结果区”。</div>
                </form>
              </div>
            </div>

            <div class="ui-card ui-card--flat">
              <div class="ui-card__hd"><div class="ui-card__title">铁板神算</div></div>
              <div class="ui-card__bd">
                <form id="tieban-form" class="ui-form">
                  <div class="ui-grid-2">
                    <label>父生肖
                      <select name="father_zodiac">
                        <option value="">（可选）</option>
                        <option>鼠</option><option>牛</option><option>虎</option><option>兔</option>
                        <option>龙</option><option>蛇</option><option>马</option><option>羊</option>
                        <option>猴</option><option>鸡</option><option>狗</option><option>猪</option>
                      </select>
                    </label>
                    <label>母生肖
                      <select name="mother_zodiac">
                        <option value="">（可选）</option>
                        <option>鼠</option><option>牛</option><option>虎</option><option>兔</option>
                        <option>龙</option><option>蛇</option><option>马</option><option>羊</option>
                        <option>猴</option><option>鸡</option><option>狗</option><option>猪</option>
                      </select>
                    </label>
                    <label>兄弟姐妹数<input name="siblings_count" type="number" min="0" step="1" placeholder="可选" /></label>
                  </div>
                  <div class="ui-actions-row">
                    <button type="submit" class="ui-btn">生成命书候选</button>
                  </div>
                  <div class="ui-hint">会使用你的 Profile 作为出生信息；进度与结果会显示在右侧“结果区”。</div>
                </form>
              </div>
            </div>
          </div>

          <div class="ui-panel" id="panel-settings">
            <div class="ui-card ui-card--flat">
              <div class="ui-card__hd"><div class="ui-card__title">偏好</div></div>
              <div class="ui-card__bd">
                <form id="prefs-form" class="ui-form">
                  <div class="ui-grid-2">
                    <label>风格
                      <select name="persona_style">
                        <option value="standard">standard</option>
                        <option value="warm">warm</option>
                        <option value="roast">roast</option>
                      </select>
                    </label>
                    <label>每日推送
                      <select name="push_enabled">
                        <option value="true">开启</option>
                        <option value="false">关闭</option>
                      </select>
                    </label>
                    <label>推送时间<input name="push_time" placeholder="08:00:00" /></label>
                    <label>静默开始<input name="quiet_hours_start" placeholder="22:00:00" /></label>
                    <label>静默结束<input name="quiet_hours_end" placeholder="07:00:00" /></label>
                  </div>
                  <div class="ui-actions-row">
                    <button type="submit" class="ui-btn ui-btn-primary">保存</button>
                  </div>
                </form>
              </div>
            </div>

            <div class="ui-card ui-card--flat">
              <div class="ui-card__hd"><div class="ui-card__title">账号</div></div>
              <div class="ui-card__bd">
                <form id="password-form" class="ui-form">
                  <div class="ui-grid-2">
                    <label>旧密码<input name="old_password" type="password" /></label>
                    <label>新密码<input name="new_password" type="password" /></label>
                  </div>
                  <div class="ui-actions-row">
                    <button type="submit" class="ui-btn">修改密码</button>
                  </div>
                </form>
                <div class="ui-actions-row" style="margin-top:10px">
                  <button class="ui-btn ui-btn-ghost" id="logout-all">退出所有设备</button>
                  <button class="ui-btn" id="delete-account">注销账户</button>
                </div>
                <div class="ui-hint">注销为软删除；会清空登录态。</div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- 会话抽屉 -->
  <div class="ui-drawer" id="session-drawer" aria-hidden="true">
    <div class="ui-drawer__overlay" id="session-drawer-overlay"></div>
    <div class="ui-drawer__panel">
      <div class="ui-drawer__hd">
        <div class="ui-drawer__title">会话</div>
        <button class="ui-btn ui-btn-primary" id="session-new">新对话</button>
        <button class="ui-btn ui-btn-ghost" id="session-drawer-close">关闭</button>
      </div>
      <div class="ui-drawer__search">
        <input id="session-search" placeholder="搜索会话（标题/预览）" />
      </div>
      <div class="ui-drawer__list" id="session-list"></div>
    </div>
  </div>

  <script src="/static/ui.js?v={{ asset_version }}"></script>
</body>
</html>
