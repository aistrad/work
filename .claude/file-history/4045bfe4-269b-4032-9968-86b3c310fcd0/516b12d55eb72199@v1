# Mentis OS v3.0 - 资源配置

## 1. 数据库

**PostgreSQL (aiscend 服务器)**
- 主机: `106.37.170.238`
- 端口: `8224`
- 用户: `postgres`
- 密码: `Ak4_9lScd-69WX`
- 数据库: `mentis_v3`
- 连接字符串: `postgresql://postgres:Ak4_9lScd-69WX@106.37.170.238:8224/mentis_v3`

## 2. 智谱 GLM

**API 控制台**: https://bigmodel.cn/usercenter/equity-mgmt/user-rights

**API Key**: `42b82ed9a13e4e8890ef3854bb840ef8.TcWZ4DIq0NF2xElF`

**可用模型**:
| 模型 | 用途 | 说明 |
|------|------|------|
| `glm-4-flash` | 对话 | 快速响应 |
| `glm-4v-flash` | 图片理解 | Vision 模型 |
| `embedding-3` | 向量嵌入 | 1024 维 |

**API 文档**: https://bigmodel.cn/dev/api

## 3. Pinecone

**控制台**: https://app.pinecone.io/

**API Key**: `pcsk_tVETE_HsAhSvJG9yN2nSdGfkMz2aTefYa72inmvnp97musqf3twzRgDiLEtHDdYAsBmiQ`

**获取 AGENTS 文档**:
```bash
curl -o CLAUDE.md https://docs.pinecone.io/AGENTS-PYTHON.md
```

**索引配置建议**:
- 名称: `mentis-streams`
- 维度: `1024` (与 GLM embedding-3 匹配)
- Metric: `cosine`

## 4. Google Gemini API (备选)

- 环境变量：`GEMINI_API_KEY`
- 用途：供 Google Gemini（genai SDK）使用，包括 `text-embedding-004` 等 Embedding/文本模型。

设置方式：
```bash
export GEMINI_API_KEY="<your-gemini-api-key>"
```

## 5. 语音识别

**注意**: GLM 暂不支持语音识别。可选方案:

1. **OpenAI Whisper** (推荐)
   - 需要 OpenAI API Key
   - 支持中英文

2. **百度 ASR**
   - 免费额度较多
   - 需要申请

## 6. 环境变量汇总

```bash
# 数据库
MENTIS_DB_URL=postgresql://postgres:Ak4_9lScd-69WX@106.37.170.238:8224/mentis_v3

# JWT
MENTIS_JWT_SECRET=mentis-v3-jwt-secret-key-2026-aiscend

# GLM
GLM_API_KEY=42b82ed9a13e4e8890ef3854bb840ef8.TcWZ4DIq0NF2xElF
GLM_CHAT_MODEL=glm-4-flash
GLM_VISION_MODEL=glm-4v-flash
GLM_EMBEDDING_MODEL=embedding-3

# Pinecone
PINECONE_API_KEY=pcsk_tVETE_HsAhSvJG9yN2nSdGfkMz2aTefYa72inmvnp97musqf3twzRgDiLEtHDdYAsBmiQ
# PINECONE_HOST=待创建索引后填写

# 服务提供商
MENTIS_VISION_PROVIDER=glm
MENTIS_EMBEDDING_PROVIDER=glm
```

## 7. 启动命令

```bash
# 后端
cd /home/aiscend/work/mentis
pip install -r requirements.txt
python -m uvicorn api.main:app --port 8100 --reload

# 前端
cd /home/aiscend/work/mentis/apps/web
pnpm install
pnpm dev
```

## 8. 功能状态

| 功能 | 状态 | 说明 |
|------|------|------|
| Stream 处理 | ✅ | 本地情绪/行为检测 |
| 八字/运势 | ✅ | 本地计算 |
| 图片分析 | ✅ | GLM-4V |
| 向量嵌入 | ✅ | GLM embedding-3 |
| 语义搜索 | ⚠️ | 需创建 Pinecone 索引 |
| 语音识别 | ❌ | GLM 不支持，需 OpenAI/百度 |

## 9. 待办事项

- [ ] 在 Pinecone 创建 `mentis-streams` 索引
- [ ] 运行数据库迁移脚本初始化表
- [ ] 配置语音识别服务 (可选)
