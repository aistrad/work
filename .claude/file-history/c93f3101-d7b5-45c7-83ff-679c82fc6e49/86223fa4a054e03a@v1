# VibeLife Cron Jobs
# ===================
# 将此文件添加到系统 crontab: crontab crontab.example

# 环境变量
VIBELIFE_DB_URL=postgresql://postgres:password@localhost:8224/vibelife
PYTHONPATH=/path/to/vibelife/apps/api

# ───────────────────────────────────────────────────────────────
# Profile 抽取 - 每天凌晨3点
# 从用户交互中抽取信息，更新 unified_profiles.profile.extracted
# ───────────────────────────────────────────────────────────────
0 3 * * * cd /path/to/vibelife/apps/api && python3 -m workers.profile_extractor 7 >> /var/log/vibelife/profile_extractor.log 2>&1

# ───────────────────────────────────────────────────────────────
# Proactive 推送调度器 - 每天凌晨4点运行（生成当日数据）
# 生成内容：今日运势、签到提醒、行星行运等
# ───────────────────────────────────────────────────────────────
0 4 * * * cd /path/to/vibelife/apps/api && python3 workers/proactive_worker.py --once >> /var/log/vibelife/proactive.log 2>&1

# ───────────────────────────────────────────────────────────────
# 周运提醒 - 每周日晚上8点
# ───────────────────────────────────────────────────────────────
0 20 * * 0 cd /path/to/vibelife/apps/api && python3 scripts/send_weekly_fortune.py >> /var/log/vibelife/weekly.log 2>&1

# ───────────────────────────────────────────────────────────────
# 数据库清理 - 每天凌晨4点
# ───────────────────────────────────────────────────────────────
0 4 * * * cd /path/to/vibelife/apps/api && python3 scripts/cleanup.py >> /var/log/vibelife/cleanup.log 2>&1

# ───────────────────────────────────────────────────────────────
# 知识库向量更新 - 每天凌晨5点
# ───────────────────────────────────────────────────────────────
0 5 * * * cd /path/to/vibelife/apps/api && python3 scripts/update_embeddings.py >> /var/log/vibelife/embeddings.log 2>&1
