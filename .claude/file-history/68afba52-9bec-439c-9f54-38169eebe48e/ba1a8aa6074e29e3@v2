# Everything Claude Code 安装目录分析与优化

## 当前问题

### 安装状态
- **仓库位置**: `/home/aiscend/work/everything-claude-code/`
- **Claude 配置**: `~/.claude/` (commands, skills, agents, rules)
- **安装方式**: 手动复制 (`cp` 命令)

### 核心问题
文件被**复制**而非**符号链接**，导致：
1. 修改仓库文件 → `~/.claude/` 不会同步更新
2. 刚才添加的 frontmatter 修改只在仓库中，未生效
3. 维护困难：需要重复复制

### 文件差异证据
```
~/.claude/commands/learn.md       - 10:51 (旧版，无 frontmatter)
work/.../commands/learn.md        - 11:47 (新版，有 frontmatter)
```

---

## 解决方案

### 方案 A：符号链接（推荐）

将 `~/.claude/` 中的目录替换为符号链接：

```bash
# 备份现有配置
mv ~/.claude/commands ~/.claude/commands.bak
mv ~/.claude/skills ~/.claude/skills.bak
mv ~/.claude/agents ~/.claude/agents.bak
mv ~/.claude/rules ~/.claude/rules.bak

# 创建符号链接
ln -s /home/aiscend/work/everything-claude-code/commands ~/.claude/commands
ln -s /home/aiscend/work/everything-claude-code/skills ~/.claude/skills
ln -s /home/aiscend/work/everything-claude-code/agents ~/.claude/agents
ln -s /home/aiscend/work/everything-claude-code/rules ~/.claude/rules
```

**优点**：
- 修改仓库即时生效
- 单一数据源，无需同步
- 可通过 git 管理版本

**缺点**：
- 其他自定义 skill 需要放在仓库中或另外处理

### 方案 B：Plugin 安装

使用官方推荐的 Plugin 机制：

```bash
# 添加 marketplace
/plugin marketplace add affaan-m/everything-claude-code

# 安装 plugin
/plugin install everything-claude-code@everything-claude-code
```

或手动配置 `~/.claude/settings.json`:
```json
{
  "enabledPlugins": {
    "everything-claude-code@everything-claude-code": true
  }
}
```

**优点**：
- 官方支持的方式
- Plugin 自动管理更新

**缺点**：
- 需要使用 GitHub 上的仓库而非本地仓库
- 本地修改需要提交并推送

### 方案 C：重新复制（临时方案）

如果只需要同步刚才的修改：

```bash
cp /home/aiscend/work/everything-claude-code/commands/*.md ~/.claude/commands/
cp /home/aiscend/work/everything-claude-code/skills/*/SKILL.md ~/.claude/skills/*/
```

---

## 额外发现：混合配置

`~/.claude/skills/` 中有些 skill 不在仓库中：
- `better-auth-best-practices` - 用户自定义
- `notebooklm` - 用户自定义
- `skills-discovery` - 用户自定义
- `ultra` - 用户自定义
- `vibe*` 系列 - 用户自定义
- `web-design-guidelines` - 用户自定义

**如果使用符号链接**，需要：
1. 将自定义 skill 移入仓库，或
2. 创建 `~/.claude/skills-custom/` 放置自定义内容

---

## 最终方案

**用户选择**：符号链接 + 将自定义内容移入仓库

### 实施步骤

#### 步骤 1：将自定义 skill 移入仓库

```bash
# 移动自定义 skill 到仓库
cp -r ~/.claude/skills/better-auth-best-practices /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/notebooklm /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/skills-discovery /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/ultra /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/vibe /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/vibe-agent /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/vibe-app /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/vibe-native /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/vibe-review /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/vibe-skill /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/web-design-guidelines /home/aiscend/work/everything-claude-code/skills/
cp -r ~/.claude/skills/sync-work /home/aiscend/work/everything-claude-code/skills/
```

#### 步骤 2：备份现有配置

```bash
mv ~/.claude/commands ~/.claude/commands.bak
mv ~/.claude/skills ~/.claude/skills.bak
mv ~/.claude/agents ~/.claude/agents.bak
mv ~/.claude/rules ~/.claude/rules.bak
```

#### 步骤 3：创建符号链接

```bash
ln -s /home/aiscend/work/everything-claude-code/commands ~/.claude/commands
ln -s /home/aiscend/work/everything-claude-code/skills ~/.claude/skills
ln -s /home/aiscend/work/everything-claude-code/agents ~/.claude/agents
ln -s /home/aiscend/work/everything-claude-code/rules ~/.claude/rules
```

#### 步骤 4：清理备份（可选）

确认一切正常后：
```bash
rm -rf ~/.claude/commands.bak
rm -rf ~/.claude/skills.bak
rm -rf ~/.claude/agents.bak
rm -rf ~/.claude/rules.bak
```

---

## 验证步骤

完成后验证：
```bash
# 检查符号链接
ls -la ~/.claude/commands ~/.claude/skills ~/.claude/agents ~/.claude/rules

# 验证文件一致（应显示 "identical"）
diff ~/.claude/commands/learn.md /home/aiscend/work/everything-claude-code/commands/learn.md && echo "Files are identical"

# 验证 frontmatter 已生效
head -5 ~/.claude/commands/learn.md
# 应显示 ---\ndescription: ...\n---
```

在 Claude Code 中测试：
- `What skills are available?` - 验证所有 skill 加载
- `/verify` - 测试命令可用
- `/tdd` - 测试 TDD 命令

---

## 需要移动的自定义 Skill（完整列表）

```
better-auth-best-practices
notebooklm
skills-discovery
sync-work
ultra
vibe
vibe-agent
vibe-app
vibe-native
vibe-review
vibe-skill
web-design-guidelines
```

共 12 个自定义 skill 需要移入仓库。
