# Fortune AI 前端设计方案 - 最终优化版 v2

> 作为 Notion UI/UX 设计总监视角，基于 `frontend_claude_v1` + `frontend_codex_v1` + `idea v1.md` 全部增量，形成完整可落地方案

---

## 〇、质感升级增量（本次新增）

> frontend_claude_v1 已采纳 80% 关键结构，以下是"从结构正确到 Notion 质感"的最后一公里

| 增量 idea | 之前状态 | 为什么值得采纳 | 落地规范 |
|----------|---------|--------------|---------|
| **HSL/OKLCH 色彩变量** | 仅 Hex 表 | 主题切换更平滑、token 可维护 | 所有 token 改为 `hsl(var(--...))` 映射 |
| **Zone B 无框设计** | 写的是 `1px border` | Notion 的"轻"来自去边框、靠材质分层 | Zone B 卡片默认**无 border**，只用 `bg-sidebar/bg-app` 差异 + 极淡 hover shadow |
| **Markdown 渲染细节** | 只写"完整支持" | 决定"像 Notion 还是像聊天气泡" | 列表缩进 `24px`、代码块底色 `#F7F6F3`、右上角「复制」按钮 |
| **DnD 投放态 + 反馈** | P2 后置无细节 | 一旦做就要做对 | 拖拽时 Zone B drop zone 出现 `border-dashed`；投放成功弹底部黑色胶囊 Toast；移动端可加轻触觉 |
| **Resizer 微交互** | 仅"可拖拽" | 可发现性影响使用频率 | 分割线默认 `1px`，hover 变粗 `4px` 并显 `cursor: col-resize` |
| **Tailwind token 系统能力** | 仅列技术栈 | 让 token 真正落地到工程 | 增补完整 `tailwind.config.ts` 变量映射 + plugins |
| **Update Diff 可回溯记录** | 仅写"应用后产生锚点" | 与"版本化"原则一致 | 每次应用都落一条 `event-page`，可在趋势/搜索中查到 |

---

## 一、Codex v1 遗漏的关键 idea 分析

### 1.1 技术实现层（Codex 未覆盖）

| 遗漏点 | idea v1.md 原文要点 | 重要性 | 建议 |
|-------|-------------------|-------|------|
| **技术栈规范** | Next.js App Router + Tailwind + Radix/shadcn + Recharts/Visx + Zustand + Framer Motion | ⭐⭐⭐ | 必须采纳：这是落地的技术基座 |
| **Tailwind 配置示例** | 提供了完整的 `tailwind.config.ts` 色彩/字体/阴影变量定义 | ⭐⭐⭐ | 必须采纳：直接可用于开发 |
| **布局组件结构** | 提供了 `DashboardLayout.tsx` 伪代码骨架 | ⭐⭐ | 采纳：指导前端实现 |
| **长列表虚拟滚动** | 消息流必须用虚拟滚动优化性能 | ⭐⭐⭐ | 必须采纳：Chat 性能关键 |
| **RSC 边界** | RSC 注意 Chat 实时流式更新与 hydration 边界 | ⭐⭐ | 采纳：技术架构约束 |

### 1.2 无障碍与可用性（Codex 未覆盖）

| 遗漏点 | idea v1.md 原文要点 | 重要性 | 建议 |
|-------|-------------------|-------|------|
| **无障碍验收清单** | 全键盘可操作、焦点可见、对比度达标、Reduce Motion、字号可放大不崩 | ⭐⭐⭐ | 必须采纳：Notion 级体验的底线 |
| **Radix 无障碍支持** | 使用 Radix UI 开箱即用的无障碍能力 | ⭐⭐⭐ | 必须采纳 |

### 1.3 交互细节（Codex 部分覆盖但不完整）

| 遗漏点 | idea v1.md 原文要点 | 重要性 | 建议 |
|-------|-------------------|-------|------|
| **骨架屏 + Shimmer** | 加载时显示灰色轮廓 + 微光扫过 | ⭐⭐⭐ | 必须采纳：感知速度关键 |
| **乐观 UI** | 点击后立即反馈，失败再回滚 | ⭐⭐⭐ | 必须采纳：Notion 快感的核心 |
| **Tooltip 分离式** | 右上角固定显示，不遮挡视线 | ⭐⭐ | 已部分覆盖，需强调键盘/hover 可发现性 |
| **拖拽桥（DnD）** | Chat 项拖到 Zone B | ⭐ | P2 后置（Codex 未提，建议保持后置） |

### 1.4 视觉细节（Codex 部分覆盖）

| 遗漏点 | idea v1.md 原文要点 | 重要性 | 建议 |
|-------|-------------------|-------|------|
| **Pulse 颜色避免混淆** | Pulse 用同色系淡高光（+20%），避免黄色与"警示"混淆 | ⭐⭐ | 采纳：视觉语义一致性 |
| **"无框设计"原则** | 卡片去除边框，仅靠背景色差或极淡阴影区分层次 | ⭐⭐⭐ | 必须采纳：Notion 极简的核心 |
| **字号阶梯比率** | Major Third (1.250) 比率构建字号层级 | ⭐⭐ | 采纳：排版韵律感 |

### 1.5 Mystic 模块细节（Codex 部分覆盖）

| 遗漏点 | idea v1.md 原文要点 | 重要性 | 建议 |
|-------|-------------------|-------|------|
| **星盘渐进披露** | 仅悬停时高亮相位连线，平时隐藏复杂网 | ⭐⭐⭐ | 必须采纳：核心交互差异化 |
| **塔罗插画风格** | 单色线稿或蚀刻版画风格，保持黑白灰调性 | ⭐⭐ | 采纳：避免破坏极简感 |
| **3D 翻牌降级** | 移动端低性能/Reduce Motion 必须降级 | ⭐⭐ | 已部分覆盖，需明确降级方案 |

### 1.6 课程模块（Codex 未展开）

| 遗漏点 | idea v1.md 原文要点 | 重要性 | 建议 |
|-------|-------------------|-------|------|
| **课程列表视图** | 缩略图 4:3 + 标题 + 进度条（极细 4px） | ⭐⭐ | 采纳 |
| **播放器模式** | Zone B 内部路由跳转/滑块动画，顶部播放器 + 下方大纲笔记 | ⭐⭐ | 采纳 |
| **双屏笔记同步** | Chat 笔记实时同步到 Zone B "我的笔记"区域 | ⭐⭐⭐ | 必须采纳：核心差异化体验 |

### 1.7 设计哲学层（Codex 未强调）

| 遗漏点 | idea v1.md 原文要点 | 重要性 | 建议 |
|-------|-------------------|-------|------|
| **"纸张"隐喻** | 屏幕不是发光玻璃，而是有纹理感的高级纸张 | ⭐⭐ | 采纳：指导视觉决策的心智模型 |
| **"思考的容器"** | UI 应当是透明的，视觉重心服务于用户数据 | ⭐⭐⭐ | 必须采纳：设计原则 |
| **流 vs 态的辩证** | Zone A 是易逝/高频/探索性；Zone B 是持久/结构化/回顾性 | ⭐⭐ | 已隐含覆盖，但值得明确写入 |

---

## 二、最终优化方案

基于 Codex v1 + 上述遗漏点补充，形成完整方案。

---

### 0. 设计哲学（新增）

#### 核心隐喻

| 隐喻 | 说明 |
|-----|------|
| **纸张** | 屏幕是有纹理感的高级纸张，不是发光玻璃 |
| **思考的容器** | UI 透明，视觉重心服务于用户数据与 AI 意图 |
| **流与态** | Zone A = 时间线性（易逝/高频）；Zone B = 空间结构（持久/回顾） |

#### 三条总原则（验收标准）

1. **用户永远掌控**：自动联动必须可逆、可关闭、可撤销
2. **输出必须可操作**：任何 AI 结论都能一键变成任务/页面/标记
3. **资产必须可管理**：有库、能搜索、能归档、能版本化

---

### 1. 信息架构（确认）

#### 三层架构

| 层级 | 名称 | 说明 |
|-----|------|------|
| Zone A | Flow（对话流） | 时间线性：对话、生成、纠错、产物入口 |
| Zone B | State（面板态） | 空间结构：状态/趋势/任务/关系等稳定视图 |
| Asset Layer | Library（资产库） | 隐形层：Page 资产库（可搜索/归档/回溯） |

#### 桌面端布局

- Zone A 左侧，默认 50%，支持拖拽调整
- Zone B 右侧，默认 450px，可收起
- 联动策略：默认"高亮提示"不强制跳转

#### 移动端布局

- 底部双 Tab：Chat / Dashboard
- 轻跃迁：Artifact → Bottom Sheet 半屏 → 可选"在功能区打开"

---

### 2. 页面模型（Notion 化：Page + Blocks）

#### Page 类型

| 类型 | 说明 |
|-----|------|
| `twin-page` | 精神数字孪生（核心资产页） |
| `artifact-page` | 对话生成的分析/建议沉淀页 |
| `quest-page` | 任务与副本页 |
| `relation-page` | 关系页（含双人副本） |
| `event-page` | 关键事件页（趋势锚点） |
| `mystic-page` | 玄学产物页（含行动建议） |
| `course-page` | 课程与笔记页 |

#### Blocks 类型

| Block | 说明 |
|-------|------|
| `callout` | 一句话结论 |
| `toggle` | 原因与证据（默认折叠） |
| `task` | 下一步行动（最多 3 个） |
| `chart` | 趋势图（去轴/去网格） |
| `diff` | 回写 Diff |
| `card` | Artifact Card |

---

### 3. Zone A：Chat 交互区

#### Omnibar（悬浮胶囊）

- 位置：距底部 24px 悬浮
- 外观：`rounded-xl`、`bg-app`、`shadow-float`
- 高度：自适应，最大 40vh
- **交互**：输入区永远不遮挡最后一条消息
- 功能：`+` 多模态 / `/` Slash Command / Context Pills（可锁定/清除）

#### 消息流

- 用户消息：右对齐、去气泡化
- AI 回复：左对齐、无背景、流式打字机 `▍`
- **三段式强制结构**：callout → toggle → task

#### Artifact Card 三键

| 按钮 | 功能 |
|-----|------|
| Pin | 钉到 Tab 顶部 |
| Save as Page | 保存为资产页 |
| To Quest | 转为任务 |

#### Update Diff Bar

```
将更新：能量 +2（因睡眠改善）｜连接 -1（因冲突事件）
[✅ 应用更新] [✎ 纠正] [⏸ 暂不更新]
```

**可回溯机制（关键）**：
- 每次「应用」都落一条 `event-page`，记录：变更内容 + 原因 + 时间戳 + 源对话链接
- 该 event-page 可在「趋势」Tab 作为事件标记显示
- 可在 `⌘K` 全局搜索中查到
- 暂停不丢失，进入待处理列表（在任务/通知中心可处理）

---

### 4. Zone B：Dashboard = 6 Tabs

| Tab | 名称 | 核心内容 |
|-----|------|---------|
| 1 | 概览 | 一句话洞察 + 今日三任务 + 五维状态条 + 风险提示 + 最近钉住 |
| 2 | 状态 | L1 元数据 + L2 动态状态（可回溯到 diff/event） |
| 3 | 趋势 | 解释型图表 + Timeline 事件标记 |
| 4 | 任务 | 1-3 最小行动 + 2/5/15 分钟 + 降级任务 |
| 5 | 关系 | 关系页 + 双人副本 + 社交玩法入口 |
| 6 | 探索 | Mystic + 课程 + 工件库入口 |

#### 趋势图规范（补充）

- 去网格/去轴线
- monotone 曲线，线宽 2px，主色 #37352F
- **Tooltip 分离式**：右上角固定显示，不遮挡
- **可发现性**：键盘左右切点 + hover 轻描边提示
- 事件标记 → 可回到对话/工件页

#### Mystic 模块规范（补充）

- 主题层：2% 紫调 / Mesh；Serif 仅用于标题
- **星盘渐进披露**：仅悬停时高亮相位连线
- **塔罗插画**：单色线稿或蚀刻版画风格
- **降级方案**：移动端低性能 → 无 3D → 静态翻转；Reduce Motion → 即时切换
- 输出必须包含 task 块

#### 课程模块规范（补充）

- 列表视图：缩略图 4:3 + 标题 + 进度条（4px 高）
- 播放器模式：Zone B 内路由跳转，顶部播放器 + 下方笔记
- **双屏笔记同步**：Chat 笔记实时同步到 Zone B "我的笔记"

---

### 5. 视觉 Token

#### Neutral Tokens（HSL 映射，支持主题切换）

> **重要**：所有色彩使用 `hsl(var(--...))` 格式，便于主题切换与动态调整

| Token | Light (HSL) | Dark (HSL) | 用途 |
|-------|-------------|------------|------|
| `--background` | `0 0% 100%` | `0 0% 10%` | 主背景 #FFFFFF / #191919 |
| `--sidebar` | `40 9% 98%` | `0 0% 13%` | 侧栏背景 #FBFBFA / #202020 |
| `--hover` | `40 6% 94%` | `0 0% 17%` | Hover/Active #F1F1EF / #2C2C2C |
| `--border` | `40 5% 91%` | `0 0% 22%` | 细分割线 #E9E9E7 / #373737 |
| `--foreground` | `42 8% 20%` | `0 0% 83%` | 正文/标题 #37352F / #D4D4D4 |
| `--muted-foreground` | `40 3% 47%` | `0 0% 61%` | 辅助信息 #787774 / #9B9B9B |
| `--muted` | `40 2% 67%` | `0 0% 38%` | 次要/禁用 #ACABA9 / #606060 |

#### Functional Tokens（粉笔色，HSL 映射）

| Token | Light (HSL) | Dark (HSL) | 用途 |
|-------|-------------|------------|------|
| `--mystic` | `292 47% 95%` | `280 18% 17%` | Mystic 氛围 #F3E5F5 / #2A2430 |
| `--advice` | `207 89% 94%` | `203 25% 15%` | 建议卡 #E3F2FD / #1F282D |
| `--status` | `122 39% 94%` | `135 12% 16%` | 状态良好 #E8F5E9 / #242B26 |
| `--alert` | `36 100% 94%` | `27 29% 17%` | 风险提示 #FFF3E0 / #36291F |

#### Typography（Major Third 1.250）

| 级别 | 字号 | 行高 | 字重 | 用途 |
|-----|-----|-----|-----|------|
| H1 | 30px | 1.2 | 600 | 模块名称 |
| H2 | 24px | 1.3 | 600 | 卡片标题 |
| H3 | 20px | 1.4 | 500 | 图表标题 |
| Body | 16px | 1.6 | 400 | 正文 |
| Caption | 14px | 1.5 | 400 | 元数据 |
| Tiny | 12px | 1.0 | 500 | 标签 |

#### 间距（8px 网格）

`4 / 8 / 12 / 16 / 24 / 32`

#### 阴影

| 层级 | 阴影 | 用途 |
|-----|------|------|
| Flat | **无阴影、无 border** | Zone B 常规卡片（靠 bg 差异分层） |
| Hover | `0 2px 4px rgba(0,0,0,0.02)` | 悬停态（极淡） |
| Float | `0 8px 16px rgba(0,0,0,0.08)` | 悬浮元素（Omnibar/Popover） |

#### 无框设计原则（关键）

> Notion 的"轻"来自去边框、靠材质分层

- Zone B 卡片**默认无 border**，仅用 `bg-sidebar` vs `bg-background` 差异
- Hover 时加极淡 shadow（`shadow-hover`），不加 border
- 仅 Zone A/B 分割线、输入框等保留 `1px border-subtle`

#### Markdown 渲染规范（新增）

| 元素 | 规范 |
|-----|------|
| 列表缩进 | `24px`（1.5rem） |
| 代码块背景 | `#F7F6F3`（暖灰） |
| 代码块交互 | 右上角「复制」按钮，hover 显示 |
| 代码字体 | `font-mono`，14px |
| 引用块 | 左侧 `3px` 竖线 `--muted-foreground` |

#### Resizer 分割线规范（新增）

| 状态 | 样式 |
|-----|------|
| 默认 | `width: 1px`，`bg-border` |
| Hover | `width: 4px`，`bg-hover`，`cursor: col-resize` |
| 拖拽中 | `width: 4px`，`bg-foreground/20%` |

---

### 6. 动效规范

| 场景 | 规范 |
|-----|------|
| Duration | < 200ms（极快无感知） |
| Tab 切换 | 底部横线滑动（Layout ID Animation） |
| 数据更新 | Pulse = 同色系淡高光（+20%），500ms 渐回透明；**避免黄色** |
| 流式输出 | 打字机 + 闪烁 ▍ |
| 卡片保存 | "Pin" 后飞入 Zone B |
| **加载态** | 骨架屏 + Shimmer 微光扫过 |
| **乐观 UI** | 立即反馈，失败回滚 |
| DnD 拖拽 | P2 后置，但规范如下 ↓ |

#### DnD 拖拽规范（P2，一旦做就按此标准）

| 阶段 | 规范 |
|-----|------|
| 拖拽开始 | 源元素 `opacity: 0.5`，显示拖拽预览 |
| 进入 Zone B | drop zone 出现 `border: 2px dashed --foreground/30%` |
| 投放成功 | 底部弹出黑色胶囊 Toast（`bg-foreground text-background`），内容如"已保存至课程表" |
| 移动端 | 可选轻触觉反馈（Haptic Feedback） |

---

### 7. 游戏化

#### 默认（隐性反馈）

- 完成任务：Pulse + 数值变化（+1/+2）
- 成就：几何徽章收纳在 Profile
- 数据更新：背景 Flash 高光

#### 可选（显性 RPG）

- 开关：显示角色等级与经验条
- 开启后 Overview 顶部出现极简经验线

---

### 8. 分享与增长

#### Share Card Generator

- 一键生成分享图卡
- 默认脱敏
- 模板 3-5 套（极简 Notion 风）
- 比例适配：小红书竖图 / TikTok 竖屏

#### 社交机制入口

- 能量打赏（虚拟积分/道具）
- 好运接龙
- 吐槽接龙

---

### 9. 合规与安全

- 玄学模块：禁止"绝对命运预测"措辞
- 危机词：强制触发危机干预入口
- 打赏：早期仅虚拟积分

---

### 10. 技术栈（新增）

| 层级 | 选型 |
|-----|------|
| 框架 | Next.js (App Router) + RSC |
| 样式 | Tailwind CSS |
| 组件 | shadcn/ui / Radix UI（无障碍） |
| 图标 | Lucide React |
| 图表 | Visx / Recharts |
| 状态 | Zustand |
| 动效 | Framer Motion |
| **消息流** | 虚拟滚动（性能关键） |

#### Tailwind 配置（完整 HSL 映射）

```typescript
// tailwind.config.ts
import type { Config } from "tailwindcss";

const config: Config = {
  darkMode: ["class"],
  content: ["./src/**/*.{ts,tsx}"],
  theme: {
    extend: {
      colors: {
        // 语义化变量（HSL 映射，支持主题切换）
        background: "hsl(var(--background))",
        sidebar: "hsl(var(--sidebar))",
        hover: "hsl(var(--hover))",
        border: "hsl(var(--border))",
        foreground: "hsl(var(--foreground))",
        "muted-foreground": "hsl(var(--muted-foreground))",
        muted: "hsl(var(--muted))",
        // 功能色（HSL 映射）
        mystic: "hsl(var(--mystic))",
        advice: "hsl(var(--advice))",
        status: "hsl(var(--status))",
        alert: "hsl(var(--alert))",
      },
      fontFamily: {
        sans: ["var(--font-sans)", "ui-sans-serif", "system-ui", "sans-serif"],
        serif: ["var(--font-serif)", "ui-serif", "Georgia", "serif"],
        mono: ["var(--font-mono)", "ui-monospace", "monospace"],
      },
      boxShadow: {
        hover: "0 2px 4px rgba(0,0,0,0.02)",
        float: "0 8px 16px rgba(0,0,0,0.08)",
      },
      spacing: {
        "4.5": "1.125rem", // 18px
      },
      borderRadius: {
        xl: "0.75rem", // 12px for Omnibar
      },
    },
  },
  plugins: [
    require("tailwindcss-animate"),
    require("@tailwindcss/typography"),
  ],
};
export default config;
```

#### CSS 变量定义（globals.css）

```css
/* globals.css */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Neutral - Light */
    --background: 0 0% 100%;
    --sidebar: 40 9% 98%;
    --hover: 40 6% 94%;
    --border: 40 5% 91%;
    --foreground: 42 8% 20%;
    --muted-foreground: 40 3% 47%;
    --muted: 40 2% 67%;
    /* Functional - Light */
    --mystic: 292 47% 95%;
    --advice: 207 89% 94%;
    --status: 122 39% 94%;
    --alert: 36 100% 94%;
  }

  .dark {
    /* Neutral - Dark */
    --background: 0 0% 10%;
    --sidebar: 0 0% 13%;
    --hover: 0 0% 17%;
    --border: 0 0% 22%;
    --foreground: 0 0% 83%;
    --muted-foreground: 0 0% 61%;
    --muted: 0 0% 38%;
    /* Functional - Dark */
    --mystic: 280 18% 17%;
    --advice: 203 25% 15%;
    --status: 135 12% 16%;
    --alert: 27 29% 17%;
  }
}
```

---

### 11. 无障碍验收清单（新增）

- [ ] 全键盘可操作
- [ ] 焦点可见
- [ ] 对比度达标（WCAG AA）
- [ ] 动效可关（Reduce Motion）
- [ ] 字号可放大不崩
- [ ] 使用 Radix UI 无障碍原语

---

### 12. 里程碑

#### Milestone 1：双核骨架 + Block Chat

- 双核布局（桌面）+ 双 Tab（移动）
- Omnibar + /commands
- AI 输出三段式 Blocks
- Pin / Save as Page / To Quest 三键
- 骨架屏 + 乐观 UI

#### Milestone 2：回写 Diff + 趋势事件

- Update Diff Bar
- 趋势图 + Timeline 事件标记
- ⌘K 全局搜索
- 虚拟滚动优化

#### Milestone 3：关系副本 + 分享系统

- 关系页 + 双人副本
- Share Card Generator
- 社交玩法入口

#### Milestone 4：Mystic + 课程

- Mystic 氛围切换与降级
- 星盘渐进披露
- 课程播放 + 双屏笔记同步

---

## 三、总结

| 维度 | Codex v1 状态 | 最终方案补充 |
|-----|--------------|-------------|
| 设计哲学 | 隐含 | **明确写入**：纸张隐喻、思考的容器、流与态 |
| 技术栈 | 未覆盖 | **完整补充**：Next.js + Tailwind + Radix + Visx + Zustand |
| 无障碍 | 未覆盖 | **完整补充**：验收清单 + Radix |
| 性能 | 未覆盖 | **完整补充**：虚拟滚动、骨架屏、乐观 UI |
| 无框设计 | 未强调 | **明确强调**：卡片去边框 |
| Pulse 颜色 | 未明确 | **明确**：同色系淡高光，避免黄色 |
| 星盘交互 | 部分覆盖 | **明确**：渐进披露 |
| 塔罗风格 | 未明确 | **明确**：单色线稿/蚀刻版画 |
| 课程双屏 | 未展开 | **完整补充**：笔记同步 |
| Tooltip | 部分覆盖 | **补充**：可发现性（键盘+hover） |

---

## 四、本次质感升级总结

| 维度 | 之前状态 | 本次升级 |
|-----|---------|---------|
| 色彩系统 | Hex 表 | HSL 变量映射，支持主题切换 |
| 卡片边框 | `1px border` | **无框设计**，靠 bg 差异分层 |
| Markdown | "完整支持" | 列表缩进 24px + 代码块复制 + 引用块样式 |
| Resizer | "可拖拽" | hover 变粗 + cursor 提示 |
| DnD | P2 无细节 | 完整规范（投放态 + Toast + 触觉） |
| Tailwind | 仅列技术栈 | 完整 config + globals.css |
| Diff 回溯 | "产生锚点" | 每次落 event-page，可搜索可查看 |

---

**一句话总结**：最终方案 = 80% 结构骨架 + 20% Notion 质感细节 + 100% 工程可落地。

**最终形态**：一个看起来像**艺术品**，用起来像**瑞士军刀**，技术上**不跑偏**的智能工作空间。
