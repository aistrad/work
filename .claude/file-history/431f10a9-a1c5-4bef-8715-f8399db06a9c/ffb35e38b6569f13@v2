# VibeLife - 资源配置

> 最后更新: 2026-01-05 | Phase 0 完成

## 1. 数据库

**PostgreSQL (aiscend 服务器)** ✅ 已验证

| 配置项 | 值 |
|--------|-----|
| 主机 | `106.37.170.238` |
| 端口 | `8224` |
| 用户 | `postgres` |
| 密码 | `Ak4_9lScd-69WX` |
| 数据库 | `vibelife` |
| 连接字符串 | `postgresql://postgres:Ak4_9lScd-69WX@106.37.170.238:8224/vibelife` |

**已创建表 (14个)**:
- `vibe_users` - 用户核心表
- `vibe_user_auth` - 认证方式表
- `vibe_data_consents` - 数据共享授权表
- `skill_profiles` - Skill Profile
- `skill_conversations` - 对话记录
- `skill_messages` - 消息记录
- `skill_insights` - 洞察记录
- `subscription_plans` - 订阅计划
- `user_subscriptions` - 用户订阅状态
- `knowledge_chunks` - 知识块 (含 pgvector 3072维)
- `knowledge_qa_pairs` - QA 对
- `fortune_events` - 运势事件日历
- `reminder_settings` - 提醒设置
- `user_notifications` - 用户通知记录

## 2. 智谱 GLM (对话/图片)

**API 控制台**: https://bigmodel.cn/usercenter/equity-mgmt/user-rights

| 配置项 | 值 |
|--------|-----|
| API Key | `42b82ed9a13e4e8890ef3854bb840ef8.TcWZ4DIq0NF2xElF` |
| 对话模型 | `glm-4-flash` ✅ |
| 图片理解 | `glm-4v-flash` ✅ |
| Base URL | `https://open.bigmodel.cn/api/paas/v4` |

**API 文档**: https://docs.bigmodel.cn/cn/guide/models/text/glm-4.7

## 3. Claude (备选)

| 配置项 | 值 |
|--------|-----|
| API Key | 需配置 `CLAUDE_API_KEY` |
| 模型 | `claude-3-5-sonnet-20241022` |

## 4. Google Gemini (Embedding)

**申请地址**: https://aistudio.google.com/app/apikey

| 配置项 | 值 |
|--------|-----|
| API Key | `AIzaSyCRxKvvtDeb1_-yBUVGafNkTuO2QLME9HE` |
| 模型 | `gemini-embedding-001` |
| **维度** | **3072** |

## 5. Pinecone (向量存储)

**控制台**: https://app.pinecone.io/

| 配置项 | 值 |
|--------|-----|
| API Key | `pcsk_tVETE_HsAhSvJG9yN2nSdGfkMz2aTefYa72inmvnp97musqf3twzRgDiLEtHDdYAsBmiQ` |
| 索引 | `mentis-streams` (可复用) / `vibelife-knowledge` (新建) |
| Host | `mentis-streams-nkchadl.svc.aped-4627-b74a.pinecone.io` |
| **维度** | **3072** (与 Gemini 匹配) |
| Metric | `cosine` |

## 6. 服务分工总览

| 服务 | 提供商 | 模型 | 状态 |
|------|--------|------|------|
| 对话生成 | GLM | glm-4-flash | ✅ 已验证 |
| 图片理解 | GLM | glm-4v-flash | ✅ 已配置 |
| 向量嵌入 | Gemini | gemini-embedding-001 (3072维) | ✅ 已验证 |
| 向量存储 | Pinecone | mentis-streams (3072维) | ✅ 已验证 |
| 星盘计算 | swisseph | Swiss Ephemeris | 待安装 |

## 7. 环境变量

完整环境变量已配置在 `/home/aiscend/work/vibelife/.env`

```bash
# ─────────────────────────────────────────────────────────────────
# VIBELIFE 环境变量
# ─────────────────────────────────────────────────────────────────

# 数据库
VIBELIFE_DB_URL=postgresql://postgres:Ak4_9lScd-69WX@106.37.170.238:8224/vibelife

# JWT
VIBELIFE_JWT_SECRET=vibelife-jwt-secret-key-2026-aiscend

# 智谱 GLM (对话/图片)
GLM_API_KEY=42b82ed9a13e4e8890ef3854bb840ef8.TcWZ4DIq0NF2xElF
GLM_CHAT_MODEL=glm-4-flash
GLM_VISION_MODEL=glm-4v-flash

# Claude (备选)
CLAUDE_API_KEY=your-claude-api-key

# Google Gemini (Embedding)
GEMINI_API_KEY=AIzaSyCRxKvvtDeb1_-yBUVGafNkTuO2QLME9HE
GEMINI_EMBEDDING_MODEL=gemini-embedding-001

# Pinecone
PINECONE_API_KEY=pcsk_tVETE_HsAhSvJG9yN2nSdGfkMz2aTefYa72inmvnp97musqf3twzRgDiLEtHDdYAsBmiQ
PINECONE_HOST=mentis-streams-nkchadl.svc.aped-4627-b74a.pinecone.io

# 默认 LLM 提供商
DEFAULT_LLM_PROVIDER=glm
```

## 8. 启动命令

**后端启动**:
```bash
cd /home/aiscend/work/vibelife/apps/api
source .env  # 或手动 export
uvicorn main:app --port 8000 --host 0.0.0.0 --reload
```

**前端启动**:
```bash
cd /home/aiscend/work/vibelife/apps/web
pnpm install
pnpm dev
```

**健康检查**:
```bash
curl http://127.0.0.1:8000/health
# {"status":"ok","service":"vibelife-api","version":"1.0.0"}
```

## 9. 项目结构

```
/home/aiscend/work/vibelife/
├── apps/
│   ├── api/                     # FastAPI 后端
│   │   ├── main.py              # 应用入口
│   │   ├── requirements.txt     # Python 依赖
│   │   ├── Dockerfile
│   │   ├── routes/
│   │   │   ├── auth.py          # 认证路由
│   │   │   └── health.py        # 健康检查
│   │   └── stores/
│   │       └── db.py            # 数据库连接
│   │
│   └── web/                     # Next.js 14 前端
│       ├── package.json
│       ├── tailwind.config.ts
│       ├── Dockerfile
│       └── src/app/
│           ├── layout.tsx
│           ├── globals.css
│           └── page.tsx         # 首页
│
├── migrations/
│   └── 001_init.sql             # 数据库初始化 (已执行)
│
├── packages/                    # 共享包 (待实现)
├── package.json                 # Monorepo 配置
├── pnpm-workspace.yaml
├── turbo.json
├── docker-compose.yml
├── .env.example
├── .env                         # 已配置实际密钥
└── .gitignore
```

## 10. 域名规划

| 域名 | 用途 |
|------|------|
| `vibelife.app` | 主站 |
| `bazi.vibelife.app` | 八字站点 |
| `zodiac.vibelife.app` | 星座站点 |
| `mbti.vibelife.app` | MBTI 站点 |
| `id.vibelife.app` | Vibe ID 认证中心 |

## 11. 进度状态

- [x] Phase 0: 项目初始化 ✅ 2026-01-05
  - [x] 创建项目目录结构
  - [x] 后端基础设施初始化 (FastAPI)
  - [x] 前端基础设施初始化 (Next.js 14)
  - [x] 数据库迁移 (14个表)
  - [x] 环境变量配置
- [ ] Phase 1: 数据层完善 (进行中)
- [ ] Phase 2-14: 待开始
