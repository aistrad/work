version: "1.0"
skill_id: jungastro

# ═══════════════════════════════════════════════════════════════════════════════
# 收集型工具
# ═══════════════════════════════════════════════════════════════════════════════
collect:
  - name: collect_birth_info
    description: |
      收集用户的出生信息以进行荣格心理占星分析。
      当用户想要进行心理占星分析但尚未提供出生信息时调用。
    card_type: collect_form
    fallback_type: form  # V7.1: 无专用卡片时降级到表单视图
    card_props:
      title: "心理占星分析"
      subtitle: "请提供您的出生信息"
      form_fields:
        - name: birth_date
          type: date
          required: true
          label: 出生日期
        - name: birth_time
          type: time
          required: true
          label: 出生时间
          hint: 出生时间影响上升星座和宫位，建议查询出生证明
        - name: birth_location
          type: location
          required: true
          label: 出生地点
    parameters:
      - name: question
        type: string
        required: false
        description: 用户的问题或困惑
    when_to_call: 用户想进行心理占星分析但没有提供出生信息时

# ═══════════════════════════════════════════════════════════════════════════════
# 展示型工具
# ═══════════════════════════════════════════════════════════════════════════════
display:
  - name: show_psychological_portrait
    description: |
      展示用户的心理画像分析，包括：
      - 核心自我 (太阳): Ego 意识中心
      - 情感需求 (月亮): Personal Unconscious
      - 人格面具 (上升): Persona
      - 心理功能分布: 元素/模式分析
    card_type: jungastro_portrait
    fallback_type: list  # V7.1: 无专用卡片时降级到列表视图
    when_to_call: |
      - 用户说"分析我的心理"
      - 用户说"我的深层性格"
      - 用户想了解心理结构
      - 用户说"心理画像"
    parameters:
      - name: focus
        type: string
        required: false
        description: |
          分析焦点:
          - ego: 核心自我 (太阳)
          - emotions: 情感需求 (月亮)
          - persona: 人格面具 (上升)
          - functions: 心理功能分布
          - full: 完整分析 (默认)
        default: full

  - name: show_shadow_analysis
    description: |
      展示阴影分析，包括：
      - 困难相位识别 (刑相、对冲)
      - 冥王星配置分析
      - 12宫内容分析
      - 内在冲突动力学
      - 整合建议
    card_type: jungastro_shadow
    fallback_type: list  # V7.1: 无专用卡片时降级到列表视图
    when_to_call: |
      - 用户问"我的阴影是什么"
      - 用户问"内在冲突"
      - 用户问困难相位的意义
      - 用户提到冥王星
      - 用户问"为什么我总是..."
    parameters:
      - name: aspect
        type: string
        required: false
        description: 特定相位 (如 "sun_square_saturn")
      - name: planet
        type: string
        required: false
        description: 特定行星 (如 "pluto")

  - name: show_individuation_path
    description: |
      展示个体化路径分析，包括：
      - 当前人生阶段
      - 土星周期分析
      - 外行星行运
      - 成长方向建议
    card_type: jungastro_individuation
    fallback_type: timeline  # V7.1: 无专用卡片时降级到时间线视图
    when_to_call: |
      - 用户问"我的成长方向"
      - 用户问"土星回归"
      - 用户问"人生阶段"
      - 用户问"中年危机"
      - 用户问"我现在应该做什么"
    parameters:
      - name: cycle
        type: string
        required: false
        description: |
          特定周期:
          - saturn_return: 土星回归 (约29岁、58岁)
          - uranus_opposition: 天王星对冲 (约42岁)
          - chiron_return: 凯龙回归 (约50岁)
          - jupiter_return: 木星回归 (约12年周期)
          - current: 当前阶段 (默认)
        default: current

  - name: show_psychological_functions
    description: |
      展示心理功能分布图，包括：
      - 元素分布 (火/土/风/水)
      - 模式分布 (开创/固定/变动)
      - 行星能量分析
      - 主导功能与劣势功能
    card_type: jungastro_functions
    fallback_type: chart  # V7.1: 无专用卡片时降级到图表视图
    when_to_call: |
      - 用户问"我的心理功能"
      - 用户问"元素分布"
      - 用户想了解能量类型
      - 用户问"我是什么类型"
    parameters:
      - name: view
        type: string
        required: false
        description: |
          视图类型:
          - elements: 元素分布
          - modalities: 模式分布
          - planets: 行星能量
          - full: 完整分析 (默认)
        default: full

  - name: show_relationship_dynamics
    description: |
      展示关系动力学分析，包括：
      - 7宫分析 (关系模式)
      - 金星/火星配置
      - 投射模式识别
      - 合盘心理分析 (如有对方信息)
    card_type: jungastro_relationship
    fallback_type: list  # V7.1: 无专用卡片时降级到列表视图
    when_to_call: |
      - 用户问"我的关系模式"
      - 用户问"为什么我总是吸引..."
      - 用户问"我和TA的心理动力"
      - 用户问"投射"
    parameters:
      - name: partner_birth_date
        type: string
        required: false
        description: 对方出生日期 (用于合盘)
      - name: partner_birth_time
        type: string
        required: false
        description: 对方出生时间
      - name: partner_birth_location
        type: string
        required: false
        description: 对方出生地点
