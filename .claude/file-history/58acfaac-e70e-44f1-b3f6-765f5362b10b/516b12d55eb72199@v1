# Mentis OS v3.0 - 资源配置

## 1. 数据库

**PostgreSQL (aiscend 服务器)** ✅ 已配置
- 主机: `106.37.170.238`
- 端口: `8224`
- 用户: `postgres`
- 密码: `Ak4_9lScd-69WX`
- 数据库: `mentis_v3`
- 连接字符串: `postgresql://postgres:Ak4_9lScd-69WX@106.37.170.238:8224/mentis_v3`

## 2. 智谱 GLM (对话/图片)

**API 控制台**: https://bigmodel.cn/usercenter/equity-mgmt/user-rights

**API Key**: `42b82ed9a13e4e8890ef3854bb840ef8.TcWZ4DIq0NF2xElF`

**使用模型**:
| 模型 | 用途 | 说明 |
|------|------|------|
| `glm-4-flash` | 对话 | 快速响应 |
| `glm-4v-flash` | 图片理解 | Vision 模型 |

**API 文档**: https://bigmodel.cn/dev/api

## 3. Google Gemini (Embedding)

**申请地址**: https://aistudio.google.com/app/apikey

**使用模型**: `text-embedding-004`
- 维度: 768
- 用途: 向量嵌入/语义搜索

**设置方式**:
```bash
export GEMINI_API_KEY="AIzaSyCRxKvvtDeb1_-yBUVGafNkTuO2QLME9HE"
```

**快速验证**:
```python
import os
from google import genai

api_key = os.environ["GEMINI_API_KEY"]
client = genai.Client(api_key=api_key)

resp = client.models.embed_content(
    model="text-embedding-004",
    contents="hello, world",
)
print(len(resp.embeddings[0].values))  # 768
```

## 4. Pinecone

**控制台**: https://app.pinecone.io/

**API Key**: `pcsk_tVETE_HsAhSvJG9yN2nSdGfkMz2aTefYa72inmvnp97musqf3twzRgDiLEtHDdYAsBmiQ`

**索引配置**:
- 名称: `mentis-streams`
- **维度: `768`** (与 Gemini text-embedding-004 匹配)
- Metric: `cosine`

**获取 AGENTS 文档**:
```bash
curl -o CLAUDE.md https://docs.pinecone.io/AGENTS-PYTHON.md
```

## 5. 语音识别

**注意**: GLM 暂不支持语音识别。可选方案:

1. **OpenAI Whisper** (推荐)
   - 需要 OpenAI API Key
   - 支持中英文

2. **百度 ASR**
   - 免费额度较多
   - 需要申请

## 6. 环境变量汇总

```bash
# 数据库
MENTIS_DB_URL=postgresql://postgres:Ak4_9lScd-69WX@106.37.170.238:8224/mentis_v3

# JWT
MENTIS_JWT_SECRET=mentis-v3-jwt-secret-key-2026-aiscend

# 智谱 GLM (对话/图片)
GLM_API_KEY=42b82ed9a13e4e8890ef3854bb840ef8.TcWZ4DIq0NF2xElF
GLM_CHAT_MODEL=glm-4-flash
GLM_VISION_MODEL=glm-4v-flash

# Google Gemini (Embedding)
GEMINI_API_KEY=AIzaSyCRxKvvtDeb1_-yBUVGafNkTuO2QLME9HE
GEMINI_EMBEDDING_MODEL=text-embedding-004

# Pinecone
PINECONE_API_KEY=pcsk_tVETE_HsAhSvJG9yN2nSdGfkMz2aTefYa72inmvnp97musqf3twzRgDiLEtHDdYAsBmiQ
# PINECONE_HOST=待创建索引后填写

# 服务提供商
MENTIS_VISION_PROVIDER=glm
MENTIS_EMBEDDING_PROVIDER=gemini
```

## 7. 启动命令

```bash
# 后端
cd /home/aiscend/work/mentis
pip install -r requirements.txt
python -m uvicorn api.main:app --port 8100 --reload

# 前端
cd /home/aiscend/work/mentis/apps/web
pnpm install
pnpm dev
```

## 8. 服务分工

| 服务 | 提供商 | 模型 | 状态 |
|------|--------|------|------|
| 对话生成 | GLM | glm-4-flash | ✅ |
| 图片理解 | GLM | glm-4v-flash | ✅ |
| 向量嵌入 | Gemini | text-embedding-004 | ⚠️ 需 API Key |
| 语义搜索 | Pinecone | - | ⚠️ 需创建索引 |
| 语音识别 | - | - | ❌ 待配置 |

## 9. 待办事项

- [ ] 配置 `GEMINI_API_KEY` (https://aistudio.google.com/app/apikey)
- [ ] 在 Pinecone 创建 `mentis-streams` 索引 (维度: 768)
- [ ] 配置语音识别服务 (可选)
