"use client"

import { cn } from "@/lib/utils"
import { useAppStore } from "@/stores/app-store"
import * as Tabs from "@radix-ui/react-tabs"
import { motion } from "framer-motion"
import { OverviewTab } from "./tabs/overview-tab"
import { StatusTab } from "./tabs/status-tab"
import { TrendsTab } from "./tabs/trends-tab"
import { QuestsTab } from "./tabs/quests-tab"
import { RelationsTab } from "./tabs/relations-tab"
import { ExploreTab } from "./tabs/explore-tab"

const TABS = [
  { id: "overview", label: "概览" },
  { id: "status", label: "状态" },
  { id: "trends", label: "趋势" },
  { id: "quests", label: "任务" },
  { id: "relations", label: "关系" },
  { id: "explore", label: "探索" },
] as const

export function DashboardZone() {
  const { activeTab, setActiveTab } = useAppStore()

  return (
    <div className="flex flex-col h-full">
      <Tabs.Root
        value={activeTab}
        onValueChange={(value) => setActiveTab(value as typeof activeTab)}
        className="flex flex-col h-full"
      >
        {/* Tab 导航 */}
        <Tabs.List
          className={cn(
            "flex items-center gap-1 px-4",
            "h-12 border-b border-border",
            "bg-sidebar overflow-x-auto",
            "scrollbar-none" // 隐藏滚动条
          )}
        >
          {TABS.map((tab) => (
            <Tabs.Trigger
              key={tab.id}
              value={tab.id}
              className={cn(
                "relative px-3 py-2 text-sm font-medium",
                "text-muted-foreground hover:text-foreground",
                "transition-colors whitespace-nowrap",
                "data-[state=active]:text-foreground"
              )}
            >
              {tab.label}
              {/* 底部指示器 */}
              {activeTab === tab.id && (
                <motion.div
                  layoutId="tab-indicator"
                  className="absolute bottom-0 left-0 right-0 h-0.5 bg-foreground"
                  transition={{ type: "spring", stiffness: 500, damping: 30 }}
                />
              )}
            </Tabs.Trigger>
          ))}
        </Tabs.List>

        {/* Tab 内容 */}
        <div className="flex-1 overflow-y-auto">
          <Tabs.Content value="overview" className="h-full">
            <OverviewTab />
          </Tabs.Content>
          <Tabs.Content value="status" className="h-full">
            <StatusTab />
          </Tabs.Content>
          <Tabs.Content value="trends" className="h-full">
            <TrendsTab />
          </Tabs.Content>
          <Tabs.Content value="quests" className="h-full">
            <QuestsTab />
          </Tabs.Content>
          <Tabs.Content value="relations" className="h-full">
            <RelationsTab />
          </Tabs.Content>
          <Tabs.Content value="explore" className="h-full">
            <ExploreTab />
          </Tabs.Content>
        </div>
      </Tabs.Root>
    </div>
  )
}
