# Design 阶段最佳实践

## 概述

Design 阶段目标是完成产品体验、技术架构、数据模型的完整设计。

**核心原则**：三者密切相关，都服务于用户真实需求和尚未被满足的体验。

---

## 1. 产品体验设计

### 1.1 用户旅程设计

**用户旅程地图模板**：

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   用户旅程：{{旅程名称}}                                                    │
│                                                                             │
│   阶段 1        阶段 2        阶段 3        阶段 4        阶段 5            │
│   ─────────     ─────────     ─────────     ─────────     ─────────         │
│   {{阶段1}}     {{阶段2}}     {{阶段3}}     {{阶段4}}     {{阶段5}}         │
│                                                                             │
│   用户行为                                                                  │
│   ─────────────────────────────────────────────────────────────────────     │
│   {{行为1}}     {{行为2}}     {{行为3}}     {{行为4}}     {{行为5}}         │
│                                                                             │
│   用户情绪                                                                  │
│   ─────────────────────────────────────────────────────────────────────     │
│   😐 → 🤔 → 😊 → 🎉 → 💝                                                     │
│                                                                             │
│   触点/界面                                                                 │
│   ─────────────────────────────────────────────────────────────────────     │
│   {{触点1}}     {{触点2}}     {{触点3}}     {{触点4}}     {{触点5}}         │
│                                                                             │
│   关键指标                                                                  │
│   ─────────────────────────────────────────────────────────────────────     │
│   {{指标1}}     {{指标2}}     {{指标3}}     {{指标4}}     {{指标5}}         │
│                                                                             │
│   痛点/机会                                                                 │
│   ─────────────────────────────────────────────────────────────────────     │
│   {{痛点1}}     {{痛点2}}     {{痛点3}}     {{痛点4}}     {{痛点5}}         │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 交互模式设计

**核心交互模式清单**：

| 模式 | 适用场景 | 设计要点 |
|------|----------|----------|
| 表单输入 | 信息采集 | 分步骤、实时验证、智能填充 |
| 对话式 | 复杂任务 | 自然语言、上下文保持、引导式 |
| 卡片流 | 信息浏览 | 可扫描、可交互、可分享 |
| 仪表板 | 数据展示 | 层次分明、可定制、响应式 |
| 向导式 | 首次使用 | 步骤清晰、可跳过、进度可见 |

### 1.3 情感化设计

**情感设计三层次**：

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   1. 本能层（Visceral）                                                     │
│      第一印象、视觉吸引                                                     │
│      ├── 色彩：传达品牌调性                                                 │
│      ├── 排版：建立视觉层次                                                 │
│      └── 动效：增加生命感                                                   │
│                                                                             │
│   2. 行为层（Behavioral）                                                   │
│      使用体验、功能满足                                                     │
│      ├── 流畅：减少等待和摩擦                                               │
│      ├── 可控：用户掌控感                                                   │
│      └── 反馈：每个操作有响应                                               │
│                                                                             │
│   3. 反思层（Reflective）                                                   │
│      深层意义、自我认同                                                     │
│      ├── 价值：用户觉得值得                                                 │
│      ├── 认同：与用户价值观共鸣                                             │
│      └── 分享：愿意向他人推荐                                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.4 访谈问题清单

1. 用户的核心旅程是什么？从进入到完成目标的路径？
2. 关键的交互模式是什么？有什么情感设计要求？
3. UI/UX 的设计原则是什么？参考基准？
4. 信息架构如何组织？导航结构？
5. 用户在哪些点可能流失？如何挽留？

---

## 2. 技术架构设计

### 2.1 分层架构模板

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   L1: PRESENTATION LAYER                                                    │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 前端框架选择                                                            │
│   • 状态管理方案                                                            │
│   • 样式方案                                                                │
│                                                                             │
│   L2: API LAYER                                                             │
│   ─────────────────────────────────────────────────────────────────────     │
│   • API 框架选择                                                            │
│   • 认证方案                                                                │
│   • API 版本策略                                                            │
│                                                                             │
│   L3: BUSINESS LOGIC LAYER                                                  │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 核心业务逻辑                                                            │
│   • 领域模型                                                                │
│   • 服务划分                                                                │
│                                                                             │
│   L4: DATA LAYER                                                            │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 数据库选择                                                              │
│   • 缓存策略                                                                │
│   • 数据访问模式                                                            │
│                                                                             │
│   L5: INFRASTRUCTURE LAYER                                                  │
│   ─────────────────────────────────────────────────────────────────────     │
│   • 部署架构                                                                │
│   • 监控告警                                                                │
│   • CI/CD                                                                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.2 技术选型决策框架

| 维度 | 权重 | 考虑因素 |
|------|------|----------|
| 团队熟悉度 | 高 | 学习曲线、现有经验 |
| 生态成熟度 | 高 | 社区活跃度、文档质量、第三方支持 |
| 性能 | 中 | 是否满足需求、可扩展性 |
| 成本 | 中 | 开发成本、运维成本、许可成本 |
| 长期维护 | 中 | 更新频率、向后兼容性 |

### 2.3 访谈问题清单

1. 系统的分层架构是什么？每层的职责？
2. 技术选型的考虑因素？（团队熟悉度/生态/性能/成本）
3. 核心 API 有哪些？接口设计原则？
4. 部署架构如何规划？单机/集群/云原生？
5. 有哪些技术风险？如何应对？

---

## 3. 数据模型设计

### 3.1 实体关系设计

**ER 设计检查清单**：

```
□ 核心实体识别
  □ 每个实体有明确的业务含义
  □ 实体边界清晰，不重叠
  □ 主键设计合理

□ 关系定义
  □ 一对一/一对多/多对多关系明确
  □ 外键约束定义
  □ 级联操作规则

□ 属性设计
  □ 字段类型合适
  □ 非空/默认值/唯一约束
  □ 索引策略
```

### 3.2 数据存储策略

| 数据类型 | 推荐存储 | 原因 |
|----------|----------|------|
| 结构化业务数据 | PostgreSQL | ACID、关系查询 |
| 非结构化文档 | MongoDB / JSONB | 灵活 schema |
| 向量数据 | pgvector / Pinecone | 相似度搜索 |
| 缓存数据 | Redis | 高性能、多数据结构 |
| 文件资源 | S3 / R2 | 低成本、高可用 |

### 3.3 访谈问题清单

1. 核心实体有哪些？它们之间的关系？
2. 数据存储策略？（关系型/文档/向量/缓存）
3. 数据流如何设计？从输入到存储到输出？
4. 关键算法有哪些？复杂度如何？
5. 数据量预估？增长趋势？

---

## 4. API 设计

### 4.1 RESTful API 设计原则

```
资源命名：
• 使用名词，不用动词
• 使用复数形式
• 层级关系用 / 分隔

HTTP 方法：
• GET - 查询
• POST - 创建
• PUT - 全量更新
• PATCH - 部分更新
• DELETE - 删除

响应格式：
{
  "code": 0,           // 业务状态码
  "message": "success", // 消息
  "data": {...}        // 数据
}

错误处理：
{
  "code": 1001,
  "message": "Invalid parameter",
  "errors": [
    {"field": "email", "message": "Invalid email format"}
  ]
}
```

### 4.2 API 文档规范

每个 API 需要包含：
- 端点（Endpoint）
- HTTP 方法
- 请求参数（Query/Body）
- 响应结构
- 错误码说明
- 示例请求和响应

---

## 5. Design 产出检查清单

完成 Design 后，确保以下内容已明确：

```
□ 产品体验设计
  □ 核心用户旅程已绘制
  □ 关键交互模式已定义
  □ 情感设计原则已明确
  □ 信息架构已设计

□ 技术架构设计
  □ 分层架构已定义
  □ 技术选型已决策
  □ 部署架构已规划
  □ 风险已识别

□ 数据模型设计
  □ 核心实体已定义
  □ 关系已明确
  □ 存储策略已选择
  □ 数据流已设计

□ API 设计
  □ 核心 API 已定义
  □ 接口规范已明确
  □ 错误处理已设计

□ spec.md 更新
  □ Part 3: 产品体验设计
  □ Part 4: 用户数据系统
  □ Part 5: 技术架构
  □ API 设计规范
  □ 数据库 Schema
```

---

## 6. 常见陷阱

1. **过度设计**：考虑太多未来可能，增加不必要的复杂度
2. **忽视用户体验**：只关注技术实现，忽略用户感受
3. **设计与需求脱节**：设计炫酷但不解决用户问题
4. **低估数据复杂度**：数据关系比预想复杂
5. **技术选型随意**：没有充分评估就做决定
