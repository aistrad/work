/**
 * ZodiacLunarPhaseCard - æœˆç›¸å¡ç‰‡
 *
 * ä» show-lunar-phase.tsx æå–çš„çº¯æ¸²æŸ“ç»„ä»¶
 * é€šè¿‡ CardRegistry æ³¨å†Œï¼Œç”± card_type: "zodiac_lunar_phase" è§¦å‘
 */

"use client";

import { registerCard } from "@/skills/CardRegistry";

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Types
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

type LunarPhaseType =
  | "new_moon"
  | "waxing_crescent"
  | "first_quarter"
  | "waxing_gibbous"
  | "full_moon"
  | "waning_gibbous"
  | "last_quarter"
  | "waning_crescent";

interface LunarPhaseInfluence {
  emotional: string;
  energy: string;
  best_for: string[];
  avoid: string[];
}

interface ZodiacLunarPhaseData {
  date?: string;
  phase?: LunarPhaseType;
  sign?: string;
  degree?: number;
  illumination?: number;
  influence?: LunarPhaseInfluence;
  rituals?: string[];
  summary?: string;
}

interface ZodiacLunarPhaseCardProps {
  data: ZodiacLunarPhaseData;
  cardProps?: Record<string, unknown>;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Constants
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const PHASE_INFO: Record<string, { name: string; emoji: string; meaning: string }> = {
  new_moon: { name: "æ–°æœˆ", emoji: "ğŸŒ‘", meaning: "æ–°çš„å¼€å§‹" },
  waxing_crescent: { name: "çœ‰æœˆ", emoji: "ğŸŒ’", meaning: "è®¾å®šæ„å›¾" },
  first_quarter: { name: "ä¸Šå¼¦æœˆ", emoji: "ğŸŒ“", meaning: "é‡‡å–è¡ŒåŠ¨" },
  waxing_gibbous: { name: "ç›ˆå‡¸æœˆ", emoji: "ğŸŒ”", meaning: "è°ƒæ•´å®Œå–„" },
  full_moon: { name: "æ»¡æœˆ", emoji: "ğŸŒ•", meaning: "æ”¶è·ä¸é‡Šæ”¾" },
  waning_gibbous: { name: "äºå‡¸æœˆ", emoji: "ğŸŒ–", meaning: "æ„Ÿæ©åˆ†äº«" },
  last_quarter: { name: "ä¸‹å¼¦æœˆ", emoji: "ğŸŒ—", meaning: "æ”¾ä¸‹æ‰§å¿µ" },
  waning_crescent: { name: "æ®‹æœˆ", emoji: "ğŸŒ˜", meaning: "ä¼‘æ¯åæ€" },
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Component
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function ZodiacLunarPhaseCard({ data }: ZodiacLunarPhaseCardProps) {
  const {
    phase = "new_moon",
    sign = "",
    degree = 0,
    illumination = 0,
    influence,
    rituals = [],
    summary = "",
  } = data;

  const info = PHASE_INFO[phase] || { name: phase, emoji: "ğŸŒ™", meaning: "" };

  return (
    <div className="lunar-phase-card bg-indigo-950/50 rounded-xl border border-indigo-500/30 p-4 my-2 animate-fade-in">
      {/* Header */}
      <div className="text-center mb-4">
        <div className="text-5xl mb-2">{info.emoji}</div>
        <div className="text-xl font-bold text-indigo-200">{info.name}</div>
        <div className="text-indigo-400 text-sm">{info.meaning}</div>
        <div className="text-indigo-300 text-sm mt-1">
          {sign} {degree.toFixed(1)}Â°
        </div>
      </div>

      {/* Illumination Bar */}
      <div className="mb-4">
        <div className="flex justify-between text-xs text-indigo-400 mb-1">
          <span>ç…§æ˜åº¦</span>
          <span>{illumination}%</span>
        </div>
        <div className="h-2 bg-indigo-900 rounded-full overflow-hidden">
          <div
            className="h-full bg-gradient-to-r from-indigo-500 to-yellow-300 transition-all duration-500"
            style={{ width: `${illumination}%` }}
          />
        </div>
      </div>

      {/* Influence */}
      {influence && (
        <div className="grid grid-cols-2 gap-3 mb-4">
          <div className="p-2 bg-indigo-900/50 rounded">
            <div className="text-xs text-indigo-400 mb-1">æƒ…ç»ªå½±å“</div>
            <div className="text-sm text-indigo-200">{influence.emotional}</div>
          </div>
          <div className="p-2 bg-indigo-900/50 rounded">
            <div className="text-xs text-indigo-400 mb-1">èƒ½é‡çŠ¶æ€</div>
            <div className="text-sm text-indigo-200">{influence.energy}</div>
          </div>
        </div>
      )}

      {/* Best For / Avoid */}
      {influence && (
        <div className="grid grid-cols-2 gap-3 mb-4">
          <div>
            <div className="text-xs text-green-400 mb-1">é€‚åˆ</div>
            <ul className="text-sm space-y-1">
              {influence.best_for.map((item, i) => (
                <li key={i} className="text-indigo-200">âœ“ {item}</li>
              ))}
            </ul>
          </div>
          <div>
            <div className="text-xs text-orange-400 mb-1">é¿å…</div>
            <ul className="text-sm space-y-1">
              {influence.avoid.map((item, i) => (
                <li key={i} className="text-indigo-200">âœ— {item}</li>
              ))}
            </ul>
          </div>
        </div>
      )}

      {/* Rituals */}
      {rituals.length > 0 && (
        <div className="mb-4">
          <div className="text-xs text-indigo-400 mb-1">å»ºè®®ä»ªå¼</div>
          <div className="flex flex-wrap gap-2">
            {rituals.map((ritual, i) => (
              <span key={i} className="px-2 py-1 bg-indigo-800/50 rounded text-xs text-indigo-200">
                {ritual}
              </span>
            ))}
          </div>
        </div>
      )}

      {/* Summary */}
      {summary && (
        <div className="text-sm text-indigo-300 border-t border-indigo-500/30 pt-3">
          {summary}
        </div>
      )}
    </div>
  );
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Register to CardRegistry
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

registerCard("zodiac_lunar_phase", ZodiacLunarPhaseCard);

export default ZodiacLunarPhaseCard;
