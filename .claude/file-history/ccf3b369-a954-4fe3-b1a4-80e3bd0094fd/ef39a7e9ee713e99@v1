/**
 * VibeLife Components - Lazy Loading Export
 *
 * 懒加载版本，适用于大型组件
 * 使用 React.lazy() + Suspense 实现代码分割
 */

import dynamic from "next/dynamic";
import { ComponentType } from "react";

// ═══════════════════════════════════════════════════════════════════════════
// Loading Skeleton (加载骨架)
// ═══════════════════════════════════════════════════════════════════════════

const LoadingSkeleton = () => (
  <div className="animate-pulse bg-white/5 rounded-xl h-48 w-full" />
);

const ChartLoadingSkeleton = () => (
  <div className="animate-pulse bg-white/5 rounded-xl h-80 w-full" />
);

// ═══════════════════════════════════════════════════════════════════════════
// Lazy Components (懒加载组件)
// ═══════════════════════════════════════════════════════════════════════════

/**
 * 人生K线图 - 使用 ECharts，较大的依赖
 */
export const LazyLifeKLine = dynamic(
  () => import("@/components/trend/LifeKLine").then((mod) => mod.LifeKLine as ComponentType<any>),
  {
    loading: () => <ChartLoadingSkeleton />,
    ssr: false, // ECharts 不支持 SSR
  }
);

/**
 * 八字命盘 - SVG 图表
 */
export const LazyBaziChart = dynamic(
  () => import("@/components/chart/BaziChart").then((mod) => mod.BaziChart as ComponentType<any>),
  {
    loading: () => <ChartLoadingSkeleton />,
  }
);

/**
 * 星盘图 - SVG 图表
 */
export const LazyZodiacChart = dynamic(
  () => import("@/components/chart/ZodiacChart").then((mod) => mod.ZodiacChart as ComponentType<any>),
  {
    loading: () => <ChartLoadingSkeleton />,
  }
);

/**
 * 身份棱镜 - 3D 效果组件
 */
export const LazyIdentityPrism = dynamic(
  () => import("@/components/identity/IdentityPrism").then((mod) => mod.IdentityPrism as ComponentType<any>),
  {
    loading: () => <LoadingSkeleton />,
  }
);

/**
 * 关系分析卡片
 */
export const LazyRelationshipCard = dynamic(
  () => import("@/components/relationship/RelationshipCard").then((mod) => mod.RelationshipCard as ComponentType<any>),
  {
    loading: () => <LoadingSkeleton />,
  }
);

/**
 * 话术模板卡片
 */
export const LazyScriptCard = dynamic(
  () => import("@/components/script/ScriptCard").then((mod) => mod.ScriptCard as ComponentType<any>),
  {
    loading: () => <LoadingSkeleton />,
  }
);

/**
 * 趋势卡片
 */
export const LazyNowNextCard = dynamic(
  () => import("@/components/trend/NowNextCard").then((mod) => mod.NowNextCard as ComponentType<any>),
  {
    loading: () => <LoadingSkeleton />,
  }
);

/**
 * 推演过场
 */
export const LazyTransitionOverlay = dynamic(
  () => import("@/components/core/TransitionOverlay").then((mod) => mod.TransitionOverlay as ComponentType<any>),
  {
    loading: () => null, // 过场组件不需要骨架
  }
);

// ═══════════════════════════════════════════════════════════════════════════
// Re-export Types
// ═══════════════════════════════════════════════════════════════════════════

export type { LifeKLineProps, FortuneDataPoint } from "@/components/trend/LifeKLine";
export type { BaziChartProps, BaziData, Pillar } from "@/components/chart/BaziChart";
export type { ZodiacChartProps, ZodiacData, Planet } from "@/components/chart/ZodiacChart";
export type { IdentityPrismProps, IdentityDimension } from "@/components/identity/IdentityPrism";
export type { RelationshipCardProps, PersonProfile, DimensionScore } from "@/components/relationship/RelationshipCard";
export type { ScriptCardProps, ScriptData, ScriptStep } from "@/components/script/ScriptCard";
export type { NowNextCardProps, NowPhase, NextPhase } from "@/components/trend/NowNextCard";
export type { TransitionOverlayProps } from "@/components/core/TransitionOverlay";
