# VibeLife Skill Builder - 工具定义 (v10.3)
# 文件位置: .claude/skills/vibelife-skill/tools/tools.yaml
#
# 本文件定义 vibelife-skill 的工具集，用于构建 VibeLife 平台上的领域专家 Skill

version: "1.0"
skill_id: vibelife-skill

# ═══════════════════════════════════════════════════════════════════════════════
# 收集工具 (Collect Tools)
# ═══════════════════════════════════════════════════════════════════════════════

collect:
  - name: request_skill_info
    description: |
      收集构建 Skill 所需的基本信息。
      当用户未提供 skill_id、源文件路径或领域描述时调用此工具。
    card_type: collect_form
    when_to_call: |
      - 用户想要构建 Skill 但未提供必要信息时
      - 需要明确 Skill 的领域、名称或数据源时
    parameters:
      - name: missing_fields
        type: array
        required: false
        description: |
          缺失的字段列表，可选值：
          - skill_id: Skill 标识符
          - domain: 领域描述
          - source_path: 源文件路径
          - knowledge_type: 知识类型（案例/规则/百科）

# ═══════════════════════════════════════════════════════════════════════════════
# 计算工具 (Compute Tools)
# ═══════════════════════════════════════════════════════════════════════════════

compute:
  - name: run_pipeline
    description: |
      执行知识入库流水线。
      支持以下阶段：
      - Stage 0: 格式检查与预处理
      - Stage 1: 文本切块
      - Stage 2: 向量化
      - Stage 3: 索引构建
      - Stage 6: 质量检查
    card_type: vibelife_skill_progress
    when_to_call: |
      - 用户提供源文件后执行入库
      - 需要重新处理知识库时
    parameters:
      - name: skill_id
        type: string
        required: true
        description: 目标 Skill 的标识符
      - name: source_path
        type: string
        required: true
        description: 源文件或目录路径
      - name: stages
        type: array
        required: false
        description: |
          要执行的阶段列表，默认执行全部。
          可选值：[0, 1, 2, 3, 6]
      - name: options
        type: object
        required: false
        description: |
          流水线选项：
          - chunk_size: 切块大小（默认 1000）
          - overlap: 重叠大小（默认 200）
          - model: 向量化模型

  - name: run_extractor
    description: |
      执行 Case/Rule 抽取。
      从原始文本中提取结构化的案例或规则。
    card_type: vibelife_skill_progress
    when_to_call: |
      - 知识入库完成后执行抽取
      - 需要更新案例/规则库时
    parameters:
      - name: skill_id
        type: string
        required: true
        description: 目标 Skill 的标识符
      - name: extract_type
        type: string
        required: true
        description: |
          抽取类型：
          - case: 案例抽取
          - rule: 规则抽取
          - both: 同时抽取
      - name: source_ids
        type: array
        required: false
        description: 指定要处理的源文档 ID 列表，不指定则处理全部

# ═══════════════════════════════════════════════════════════════════════════════
# 展示工具 (Display Tools)
# ═══════════════════════════════════════════════════════════════════════════════

display:
  - name: show_build_progress
    description: |
      展示 Skill 构建进度卡片。
      显示当前阶段、完成百分比和详细日志。
    card_type: vibelife_skill_progress
    when_to_call: |
      - 流水线执行过程中实时展示进度
      - 用户询问构建状态时
    parameters:
      - name: skill_id
        type: string
        required: true
        description: 目标 Skill 的标识符
      - name: stage
        type: string
        required: true
        description: |
          当前阶段：
          - preprocessing: 预处理
          - chunking: 切块
          - vectorizing: 向量化
          - indexing: 索引构建
          - extracting: 抽取
          - quality_check: 质量检查
      - name: progress
        type: number
        required: true
        description: 进度百分比 (0-100)
      - name: message
        type: string
        required: false
        description: 状态消息
      - name: details
        type: object
        required: false
        description: |
          详细信息：
          - processed: 已处理数量
          - total: 总数量
          - errors: 错误数量

  - name: show_quality_report
    description: |
      展示 Skill 知识库质量报告。
      包含覆盖率、准确率、知识分布等指标。
    card_type: vibelife_skill_quality
    when_to_call: |
      - 构建完成后展示质量报告
      - 用户询问知识库质量时
    parameters:
      - name: skill_id
        type: string
        required: true
        description: 目标 Skill 的标识符
      - name: metrics
        type: object
        required: true
        description: |
          质量指标：
          - coverage: 覆盖率 (0-1)
          - accuracy: 准确率 (0-1)
          - completeness: 完整度 (0-1)
      - name: distribution
        type: object
        required: false
        description: |
          知识分布：
          - by_type: 按类型分布
          - by_topic: 按主题分布
      - name: issues
        type: array
        required: false
        description: |
          发现的问题列表：
          - type: 问题类型
          - description: 问题描述
          - suggestion: 修复建议
      - name: recommendations
        type: array
        required: false
        description: 改进建议列表
