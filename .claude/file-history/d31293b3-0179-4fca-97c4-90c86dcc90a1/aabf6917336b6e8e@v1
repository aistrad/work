/**
 * CoreTraits - ä¸‰ä¸ªæ ¸å¿ƒç‰¹è´¨å±•ç¤ºç»„ä»¶
 *
 * v7.0 æ–°å¢: ç”¨äºæ­æ™“ä»ªå¼çš„ä¸‰ä¸ªæ‰“å‡»ç‚¹
 * [ä¼˜ç‚¹1, ä¼˜ç‚¹2, éšç§˜ææƒ§/éœ€æ±‚]
 */

'use client'

import { useState, useEffect } from 'react'
import { cn } from '@/lib/utils'

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Types
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

interface CoreTraitsProps {
  /** ä¸‰ä¸ªç‰¹è´¨: [ä¼˜ç‚¹1, ä¼˜ç‚¹2, éšç§˜ææƒ§] */
  traits: [string, string, string]
  /** æ˜¯å¦æ’­æ”¾åŠ¨ç”» */
  animated?: boolean
  /** åŠ¨ç”»å»¶è¿Ÿ (ms) */
  animationDelay?: number
  /** å®Œæˆå›è°ƒ */
  onComplete?: () => void
  /** è‡ªå®šä¹‰ç±»å */
  className?: string
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Constants
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const TRAIT_CONFIGS = [
  {
    label: 'è¶…èƒ½åŠ›ä¹‹ä¸€',
    icon: 'âœ¨',
    color: 'from-amber-400 to-orange-500',
    bgColor: 'bg-amber-50 dark:bg-amber-950/20',
    borderColor: 'border-amber-200 dark:border-amber-800/50',
  },
  {
    label: 'è¶…èƒ½åŠ›ä¹‹äºŒ',
    icon: 'ğŸ’«',
    color: 'from-purple-400 to-pink-500',
    bgColor: 'bg-purple-50 dark:bg-purple-950/20',
    borderColor: 'border-purple-200 dark:border-purple-800/50',
  },
  {
    label: 'éšç§˜çš„ä½ ',
    icon: 'ğŸŒ™',
    color: 'from-slate-400 to-slate-600',
    bgColor: 'bg-slate-50 dark:bg-slate-950/20',
    borderColor: 'border-slate-200 dark:border-slate-700/50',
  },
]

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Main Component
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

export function CoreTraits({
  traits,
  animated = true,
  animationDelay = 600,
  onComplete,
  className,
}: CoreTraitsProps) {
  const [visibleCount, setVisibleCount] = useState(animated ? 0 : 3)

  useEffect(() => {
    if (!animated) {
      setVisibleCount(3)
      return
    }

    // ä¾æ¬¡æ˜¾ç¤ºä¸‰ä¸ªç‰¹è´¨
    const timers: NodeJS.Timeout[] = []

    for (let i = 0; i < 3; i++) {
      const timer = setTimeout(() => {
        setVisibleCount(i + 1)
        if (i === 2 && onComplete) {
          // æœ€åä¸€ä¸ªæ˜¾ç¤ºåå›è°ƒ
          setTimeout(onComplete, animationDelay)
        }
      }, animationDelay * (i + 1))
      timers.push(timer)
    }

    return () => {
      timers.forEach(clearTimeout)
    }
  }, [animated, animationDelay, onComplete])

  return (
    <div className={cn('space-y-4', className)}>
      {traits.map((trait, index) => {
        const config = TRAIT_CONFIGS[index]
        const isVisible = index < visibleCount
        const isLast = index === 2

        return (
          <div
            key={index}
            className={cn(
              'transform transition-all duration-500',
              isVisible
                ? 'opacity-100 translate-y-0'
                : 'opacity-0 translate-y-4'
            )}
            style={{
              transitionDelay: animated ? `${index * 100}ms` : '0ms',
            }}
          >
            <div
              className={cn(
                'p-4 rounded-2xl border',
                config.bgColor,
                config.borderColor,
                isLast && 'border-dashed'
              )}
            >
              {/* Label */}
              <div className="flex items-center gap-2 mb-2">
                <span className="text-lg">{config.icon}</span>
                <span className="text-xs text-ink-500 font-medium">{config.label}</span>
              </div>

              {/* Trait */}
              <p
                className={cn(
                  'text-lg font-medium',
                  isLast ? 'text-ink-600' : 'text-ink-800'
                )}
              >
                {trait}
              </p>

              {/* Decorative gradient line */}
              <div
                className={cn(
                  'mt-3 h-0.5 rounded-full opacity-30',
                  `bg-gradient-to-r ${config.color}`
                )}
                style={{
                  width: isVisible ? '100%' : '0%',
                  transition: 'width 0.8s ease-out',
                  transitionDelay: animated ? `${(index + 1) * animationDelay + 200}ms` : '0ms',
                }}
              />
            </div>
          </div>
        )
      })}
    </div>
  )
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Compact Variant
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

interface CoreTraitsCompactProps {
  traits: [string, string, string]
  className?: string
}

export function CoreTraitsCompact({ traits, className }: CoreTraitsCompactProps) {
  return (
    <div className={cn('flex flex-wrap gap-2', className)}>
      {traits.map((trait, index) => {
        const isLast = index === 2
        return (
          <span
            key={index}
            className={cn(
              'px-3 py-1.5 rounded-full text-sm',
              isLast
                ? 'bg-slate-100 text-slate-600 dark:bg-slate-800 dark:text-slate-300 border border-dashed border-slate-300 dark:border-slate-600'
                : 'bg-amber-50 text-amber-700 dark:bg-amber-900/30 dark:text-amber-300'
            )}
          >
            {TRAIT_CONFIGS[index].icon} {trait}
          </span>
        )
      })}
    </div>
  )
}

export default CoreTraits
