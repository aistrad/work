"""
Model Router - Dynamic Model Selection System

This module provides intelligent model routing based on:
- User tier (free, pro, vip)
- Task type (chat, image_gen, analysis, etc.)
- Skill context (bazi, zodiac, mbti)
- Quota management
- A/B testing

Usage:
    from services.model_router import get_model_router, ModelContext

    router = get_model_router()

    context = ModelContext(
        user_id="user-123",
        user_tier="pro",
        skill="bazi",
        task="chat"
    )

    selection = await router.resolve(context)
    # selection.provider = "glm"
    # selection.model = "glm-4-plus"
    # selection.was_downgraded = False
"""

from .models import (
    # Context
    ModelContext,

    # Results
    ModelSelection,
    QuotaCheckResult,

    # Enums
    UserTier,
    TaskType,
    Capability,
    ExceedAction,
    QuotaScope,
    Period,

    # Database Models
    ModelProvider,
    Model,
    ModelRoute,
    QuotaRule,
    QuotaUsage,
    ModelCallLog,
)

from .router import (
    ModelRouter,
    get_model_router,
)

from .quota import (
    QuotaManager,
    get_quota_manager,
)

from .cache import (
    RouteCache,
    get_cache,
)

from .repository import (
    ModelRouterRepository,
    get_repository,
)

__all__ = [
    # Context
    "ModelContext",

    # Results
    "ModelSelection",
    "QuotaCheckResult",

    # Enums
    "UserTier",
    "TaskType",
    "Capability",
    "ExceedAction",
    "QuotaScope",
    "Period",

    # Database Models
    "ModelProvider",
    "Model",
    "ModelRoute",
    "QuotaRule",
    "QuotaUsage",
    "ModelCallLog",

    # Router
    "ModelRouter",
    "get_model_router",

    # Quota
    "QuotaManager",
    "get_quota_manager",

    # Cache
    "RouteCache",
    "get_cache",

    # Repository
    "ModelRouterRepository",
    "get_repository",
]
