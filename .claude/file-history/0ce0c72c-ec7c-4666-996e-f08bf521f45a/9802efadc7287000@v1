"""
Proactive System Data Models

Data classes for the proactive notification system.
Extracted from engine.py for modularity.
"""

from dataclasses import dataclass, field
from datetime import date
from enum import Enum
from typing import Dict, Any, Optional, List
from uuid import UUID


class ReminderPriority(str, Enum):
    """Reminder priority levels"""
    LOW = "low"
    MEDIUM = "medium"
    HIGH = "high"
    URGENT = "urgent"


@dataclass
class ReminderTask:
    """A reminder task to be processed"""
    user_id: UUID
    skill_id: str
    reminder_type: str
    priority: ReminderPriority = ReminderPriority.MEDIUM
    trigger_event: Optional[str] = None
    trigger_date: Optional[date] = None
    metadata: Dict[str, Any] = field(default_factory=dict)


@dataclass
class ReminderContent:
    """Generated reminder content for notification"""
    title: str
    body: str = ""
    data: Dict[str, Any] = field(default_factory=dict)
    card_type: Optional[str] = None
    # Optional fields from Agent generation
    fortune_hint: Optional[str] = None
    action_tip: Optional[str] = None
    # Conversation guidance fields
    suggested_prompt: Optional[str] = None
    quick_actions: List[Dict[str, str]] = field(default_factory=list)

    def to_dict(self) -> Dict[str, Any]:
        """Convert to dictionary for notification storage"""
        result = {
            "title": self.title,
            "body": self.body,
            **self.data,
        }
        if self.card_type:
            result["card_type"] = self.card_type
        if self.fortune_hint:
            result["fortune_hint"] = self.fortune_hint
        if self.action_tip:
            result["action_tip"] = self.action_tip
        if self.suggested_prompt:
            result["suggested_prompt"] = self.suggested_prompt
        if self.quick_actions:
            result["quick_actions"] = self.quick_actions
        return result
