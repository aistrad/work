# Lifecoach Reminders Configuration v3.0
# LLM-First 架构：声明式 conditions + Agent 内容生成
# 定义主动推送的触发条件和内容

version: "3.0"
skill_id: lifecoach
enabled: true

# ═══════════════════════════════════════════════════════════════════════════
# 提醒定义
# ═══════════════════════════════════════════════════════════════════════════

reminders:
  # ─────────────────────────────────────────────────────────────────────────
  # 每日签到
  # ─────────────────────────────────────────────────────────────────────────
  - id: daily_checkin
    name: 每日签到
    description: 每天早晨提醒用户签到，开始新的一天
    enabled: true
    priority: high

    trigger:
      type: time_based
      schedule: "0 8 * * *"  # 每天早上8点
      cooldown_hours: 24

    # 声明式条件 - 静态优先求值
    conditions:
      - description: "用户已设定愿景"
        data_path: "skills.lifecoach.north_star"
        operator: "exists"
      - description: "今天还未签到"
        data_path: "skills.lifecoach.progress.last_checkin_date"
        operator: "!="
        value: "{today}"

    content:
      rule: rules/proactive/daily-checkin-push.md
      card_type: daily_levers
      suggested_prompt: "准备好开始今天了吗？"
      quick_actions:
        - label: "开始"
          prompt: "我准备好了，开始今天的杠杆行动"
        - label: "低能量"
          prompt: "今天能量比较低，帮我调整一下计划"

  # ─────────────────────────────────────────────────────────────────────────
  # 周复盘
  # ─────────────────────────────────────────────────────────────────────────
  - id: weekly_review
    name: 周复盘
    description: 周日晚上提醒用户进行周复盘
    enabled: true
    priority: medium

    trigger:
      type: time_based
      schedule: "0 20 * * 0"  # 周日晚上8点
      cooldown_hours: 168  # 7天

    conditions:
      - description: "用户已设定愿景"
        data_path: "skills.lifecoach.north_star"
        operator: "exists"
      - description: "本周有签到记录"
        data_path: "skills.lifecoach.progress.weekly_checkins"
        operator: ">"
        value: 0

    content:
      rule: rules/proactive/weekly-review-push.md
      card_type: role_balance
      suggested_prompt: "这周结束了，来做个复盘吧"
      quick_actions:
        - label: "开始复盘"
          prompt: "好的，我们来复盘这周"
        - label: "快速版"
          prompt: "用5分钟快速复盘这周"

  # ─────────────────────────────────────────────────────────────────────────
  # 周规划
  # ─────────────────────────────────────────────────────────────────────────
  - id: weekly_planning
    name: 周规划
    description: 周一早上提醒用户进行周规划
    enabled: true
    priority: high

    trigger:
      type: time_based
      schedule: "0 8 * * 1"  # 周一早上8点
      cooldown_hours: 168  # 7天

    conditions:
      - description: "用户已设定愿景"
        data_path: "skills.lifecoach.north_star"
        operator: "exists"

    content:
      rule: rules/proactive/weekly-planning-push.md
      card_type: weekly_rocks
      suggested_prompt: "帮我规划这周的大石头"
      quick_actions:
        - label: "开始规划"
          prompt: "好的，帮我规划这周的大石头"
        - label: "延续上周"
          prompt: "这周继续上周未完成的大石头"

  # ─────────────────────────────────────────────────────────────────────────
  # 杠杆提醒
  # ─────────────────────────────────────────────────────────────────────────
  - id: lever_reminder
    name: 杠杆提醒
    description: 提醒用户完成今日杠杆行动
    enabled: true
    priority: low

    trigger:
      type: time_based
      schedule: "0 14 * * *"  # 下午2点
      cooldown_hours: 24

    conditions:
      - description: "今天已签到"
        data_path: "skills.lifecoach.progress.last_checkin_date"
        operator: "=="
        value: "{today}"
      - description: "有未完成的杠杆"
        data_path: "skills.lifecoach.daily.pending_levers_count"
        operator: ">"
        value: 0

    content:
      rule: rules/proactive/lever-reminder-push.md
      card_type: daily_levers
      suggested_prompt: "查看今天的杠杆进度"
      quick_actions:
        - label: "查看"
          prompt: "查看今天的杠杆完成情况"
        - label: "完成了"
          prompt: "我完成了今天的杠杆行动"

  # ─────────────────────────────────────────────────────────────────────────
  # 断签提醒
  # ─────────────────────────────────────────────────────────────────────────
  - id: streak_recovery
    name: 断签提醒
    description: 用户断签后的温和提醒
    enabled: true
    priority: medium

    trigger:
      type: event_based
      event: streak_broken
      delay_hours: 24  # 断签后24小时发送

    conditions:
      - description: "之前有连续签到记录（至少3天）"
        data_path: "skills.lifecoach.progress.previous_streak"
        operator: ">="
        value: 3

    content:
      rule: rules/proactive/streak-recovery-push.md
      card_type: motivation
      suggested_prompt: "我想重新开始"
      quick_actions:
        - label: "重新开始"
          prompt: "我准备好重新开始了"
        - label: "聊聊"
          prompt: "最近有些事情让我没能坚持"

# ═══════════════════════════════════════════════════════════════════════════
# 全局配置
# ═══════════════════════════════════════════════════════════════════════════

global_config:
  default_push_hour: 8
  cooldown_hours: 24
  max_daily_pushes: 3
  quiet_hours:
    start: 22
    end: 7
  channels:
    - in_app
    - push_notification
  respect_user_preferences: true
