---
id: skill-publish
name: Skill 发布
impact: LOW
impactDescription: 打包发布 Skill，使其可被使用
tags: 发布, 打包, 部署
---

# Skill 发布规则

## 适用场景

将完成的 Skill 打包发布，使其可被系统使用。

典型请求：
- "发布 bazi skill"
- "打包 zodiac skill"
- "部署新 skill"

## 分析要点

| 步骤 | 执行要点 | 命令/操作 | 优先级 |
|-----|---------|----------|-------|
| 1 | 确认 skill_id | 询问用户 | 必须 |
| 2 | 检查质量报告 | 确认所有指标达标 | 必须 |
| 3 | 验证目录结构 | 检查 SKILL.md, rules/, tools/ | 必须 |
| 4 | 验证 SKILL.md | 行数 < 200，结构完整 | 必须 |
| 5 | 验证 rules/ | 所有能力都有对应文件 | 必须 |
| 6 | 验证 tools/ | tools.yaml 和 handlers.py 存在 | 必须 |
| 7 | 执行发布 | 更新配置，重启服务 | 必须 |

## 目录结构检查

```
apps/api/skills/{skill_id}/
├── SKILL.md                 # 必须，< 200 行
├── rules/
│   ├── _index.md            # 必须
│   └── {capability}.md      # 每个能力一个
├── tools/
│   ├── tools.yaml           # 必须
│   └── handlers.py          # 必须
└── services/                # 可选
```

## 输出要求

1. **必须执行**：
   - 目录结构验证
   - SKILL.md 格式验证
   - 工具定义验证

2. **验证清单**：
   ```markdown
   ## 发布检查清单

   ### SKILL.md
   - [ ] 行数 < 200
   - [ ] Frontmatter 完整 (name, description)
   - [ ] 核心能力索引表格完整
   - [ ] 工具快速参考表格完整

   ### rules/
   - [ ] _index.md 存在
   - [ ] 所有能力都有对应 .md 文件
   - [ ] 每个 rule 有 frontmatter
   - [ ] 每个 rule 有分析要点表格

   ### tools/
   - [ ] tools.yaml 存在且有效
   - [ ] handlers.py 存在且无语法错误
   ```

3. **引导方向**：
   - 发布成功后告知用户如何使用
   - 提供测试命令

## 发布命令

```bash
# 验证 Skill 结构
python scripts/validate_skill.py {skill_id}

# 重启 API 服务加载新 Skill
sudo systemctl restart vibelife-api

# 或开发环境
cd /home/aiscend/work/vibelife/apps/api
./start_api.sh
```

## 常见问题

### SKILL.md 超过 200 行
将详细内容移到 rules/ 目录，只保留索引。

### 工具定义缺失
参考 templates/TOOLS_TEMPLATE.yaml 创建工具定义。
