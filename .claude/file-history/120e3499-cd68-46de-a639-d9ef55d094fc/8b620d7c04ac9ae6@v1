---
id: quality-check
name: 质量检查
impact: MEDIUM
impactDescription: 确保知识库质量，影响最终服务效果
tags: 质量, 检查, 覆盖率, 准确率
---

# 质量检查规则

## 适用场景

对已入库的知识进行质量评估和检查。

典型请求：
- "检查知识库质量"
- "生成质量报告"
- "评估覆盖率"

## 分析要点

| 步骤 | 执行要点 | 命令/操作 | 优先级 |
|-----|---------|----------|-------|
| 1 | 确认 skill_id | 询问用户 | 必须 |
| 2 | 检查 chunks 覆盖率 | 查询 knowledge_chunks 表 | 必须 |
| 3 | 检查 cases 分布 | 查询 cases 表的 tags 分布 | 必须 |
| 4 | 检查 rules 完整性 | 遍历 rules/*.md 文件 | 必须 |
| 5 | 执行检索测试 | 测试 top-5 检索准确率 | 推荐 |
| 6 | 生成质量报告 | 输出综合评估 | 必须 |

## 质量指标

| 指标 | 目标 | 计算方式 |
|-----|------|---------|
| 知识覆盖率 | ≥300 chunks | COUNT(*) FROM knowledge_chunks WHERE skill_id = ? |
| 案例数量 | ≥50 cases | COUNT(*) FROM cases WHERE skill_id = ? |
| 案例分布 | 覆盖所有核心能力 | 检查 tags 是否覆盖能力索引 |
| 规则完整性 | 100% | 检查每个能力是否有对应 rule 文件 |
| 检索准确率 | ≥70% | Top-5 结果与预期匹配比例 |

## 输出要求

1. **必须执行**：
   - 统计各项指标
   - 生成质量报告
   - 标记不达标项

2. **报告格式**：
   ```markdown
   # {skill_id} 质量报告

   ## 概览
   | 指标 | 当前值 | 目标 | 状态 |
   |-----|-------|------|------|
   | 知识覆盖率 | {n} chunks | ≥300 | ✅/❌ |
   | ... | ... | ... | ... |

   ## 问题清单
   - [ ] {问题1}
   - [ ] {问题2}

   ## 建议
   1. {建议1}
   2. {建议2}
   ```

3. **引导方向**：
   - 如有不达标项，询问是否补充
   - 全部达标后询问是否发布

## 检索测试用例

为每个核心能力准备 3 个测试 query：

```yaml
test_queries:
  - query: "{测试 query 1}"
    expected_topics: ["{主题1}", "{主题2}"]
  - query: "{测试 query 2}"
    expected_topics: ["{主题1}"]
```

## 常见问题

### 覆盖率不足
增加知识源文档，重新执行入库流程。

### 检索准确率低
优化 embedding 模型，或调整切块参数。
