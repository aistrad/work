# VibeLife é¡¹ç›®æ¶æ„åˆ†æï¼šè®¾è®¡ vs å®ç°å·®è·æŠ¥å‘Š

## æ¦‚è¿°

VibeLife æ˜¯ä¸€ä¸ªé‡‡ç”¨ **pnpm monorepo + Turbo** æ„å»ºçš„å¤š Skill å¹³å°ï¼Œé€šè¿‡ "Skill éš”ç¦»" æ¨¡å¼å®ç°å¤šç«™ç‚¹è®¾è®¡ã€‚

---

# ç¬¬ä¸€éƒ¨åˆ†ï¼šè®¾è®¡è§„èŒƒ vs å®ç°çŠ¶æ€æ·±åº¦å¯¹æ¯”

## å…­å±‚æ¶æ„å®ç°çŠ¶æ€æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å±‚çº§                        â”‚ è®¾è®¡å®Œæˆåº¦ â”‚ å®ç°å®Œæˆåº¦ â”‚ å·®è·è¯„ä¼°        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L1: SKILL CONSTELLATION     â”‚   100%    â”‚    30%    â”‚ ğŸ”´ ä¸¥é‡å·®è·     â”‚
â”‚     (ç‹¬ç«‹ç«™ç‚¹å±‚)            â”‚           â”‚           â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L2: EXPERIENCE LAYER        â”‚   100%    â”‚    25%    â”‚ ğŸ”´ ä¸¥é‡å·®è·     â”‚
â”‚     (ä½“éªŒæ ‡å‡†å±‚)            â”‚           â”‚           â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L3: SKILL AGENT LAYER       â”‚   100%    â”‚    50%    â”‚ ğŸŸ¡ ä¸­ç­‰å·®è·     â”‚
â”‚     (æ™ºèƒ½ä»£ç†å±‚)            â”‚           â”‚           â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L4: KNOWLEDGE LAYER         â”‚    90%    â”‚    15%    â”‚ ğŸ”´ ä¸¥é‡å·®è·     â”‚
â”‚     (çŸ¥è¯†å¼•æ“å±‚)            â”‚           â”‚           â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L5: VIBE ENGINE             â”‚   100%    â”‚    60%    â”‚ ğŸŸ¡ ä¸­ç­‰å·®è·     â”‚
â”‚     (æ ¸å¿ƒæ™ºèƒ½å¼•æ“)          â”‚           â”‚           â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ L6: IDENTITY & DATA         â”‚    90%    â”‚    70%    â”‚ ğŸŸ¢ åŸºæœ¬å®Œæˆ     â”‚
â”‚     (èº«ä»½æ•°æ®å±‚)            â”‚           â”‚           â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## L1: SKILL CONSTELLATION (ç‹¬ç«‹ç«™ç‚¹å±‚) - ğŸ”´ 30%

### è®¾è®¡è§„èŒƒè¦æ±‚
| ç«™ç‚¹ | åŸŸå | çŠ¶æ€ |
|------|------|------|
| ä¸»ç«™ Hub | vibelife.app | âš ï¸ æ¡†æ¶å­˜åœ¨ |
| å…«å­— | bazi.vibelife.app | âš ï¸ é¡µé¢éª¨æ¶ |
| æ˜Ÿåº§ | astra.vibelife.app | âš ï¸ é¡µé¢éª¨æ¶ |
| MBTI | mbti.vibelife.app | âš ï¸ é¡µé¢éª¨æ¶ |
| ä¾æ‹ | attach.vibelife.app | âŒ æœªå®ç° |
| èŒä¸š | career.vibelife.app | âŒ æœªå®ç° |
| Vibe ID | id.vibelife.app | âŒ æœªå®ç° |

### å·²å®ç°
- âœ… å¤šç«™ç‚¹è·¯ç”±æ¶æ„ (`/bazi`, `/zodiac`, `/mbti`)
- âœ… SSO è·¨ç«™ç‚¹è®¤è¯è®¾è®¡ (`sso.py`)
- âœ… site_config æ¦‚å¿µè®¾è®¡

### æœªå®ç°
- âŒ ç‹¬ç«‹å­åŸŸåéƒ¨ç½²
- âŒ Skill Landing é¡µé¢å®Œæ•´å®ç°ï¼ˆä»… bazi æœ‰ 288 è¡Œï¼Œå…¶ä»–ä»… 88 è¡Œéª¨æ¶ï¼‰
- âŒ site_config.yaml é…ç½®ç³»ç»Ÿ
- âŒ Attachã€Career ç­‰ Phase 2 Skills

---

## L2: EXPERIENCE LAYER (ä½“éªŒæ ‡å‡†å±‚) - ğŸ”´ 25%

### è®¾è®¡è§„èŒƒè¦æ±‚çš„å››å¤§ç»„ä»¶

| ç»„ä»¶ | è®¾è®¡è§„èŒƒ | å®ç°çŠ¶æ€ | å·®è· |
|------|---------|---------|------|
| **The Landing** | é›¶æ‘©æ“¦å…¥å£ã€æ¸è¿›æ³¨å†Œã€ä»·å€¼å‰ç½® | âš ï¸ 20% | HeroåŒºåŸŸæœ‰ï¼Œä½†æ— æ¨æ¼”è¿‡åœºã€æ— å³æ—¶æ´å¯Ÿ |
| **Stream** | æ²‰æµ¸å¯¹è¯ã€ä¸»åŠ¨å…³æ€€ã€æƒ…ç»ªæ„ŸçŸ¥ | âœ… 60% | ChatContainer å·²å®ç°ï¼Œä½†æ—  Quick Replies |
| **Insight Cards** | 4ç§å¡ç‰‡ã€Bottom Sheetã€åˆ†äº« | âš ï¸ 30% | InsightCard ç»„ä»¶å­˜åœ¨ï¼Œä½†æ— å®Œæ•´äº¤äº’ |
| **Journey** | é•¿æœŸè¿½è¸ªã€æ¼”åŒ–è®°å½•ã€æˆé•¿è½¨è¿¹ | âŒ 0% | å®Œå…¨æœªå®ç° |

### æ ¸å¿ƒè§†è§‰ç»„ä»¶å®ç°çŠ¶æ€

| ç»„ä»¶ | è®¾è®¡è§„èŒƒ | ä»£ç å­˜åœ¨ | åŠŸèƒ½å®Œæ•´ |
|------|---------|---------|---------|
| VibeGlyph | Skill ç¬¦å· | âœ… 159è¡Œ | âš ï¸ åŸºç¡€åŠŸèƒ½ |
| BreathAura | å‘¼å¸å…‰æ™• | âœ… 111è¡Œ | âš ï¸ åŸºç¡€åŠŸèƒ½ |
| InsightSeal | ä¸ªäººåŒ–å°ç«  | âœ… 175è¡Œ | âš ï¸ åŸºç¡€åŠŸèƒ½ |
| LuminousPaper | å…‰çº¸èƒŒæ™¯ | âœ… 95è¡Œ | âš ï¸ åŸºç¡€åŠŸèƒ½ |
| **Birth Input Capsule** | ä»ªå¼æ„Ÿè¾“å…¥ | âŒ | âŒ æœªå®ç° |
| **Deduction Bridge** | æ¨æ¼”è¿‡åœºåŠ¨ç”» | âŒ | âŒ æœªå®ç° |
| **Identity Prism** | ä¸‰å…ƒè§†è§’ | âŒ | âŒ æœªå®ç° |
| **BottomNav** | å››Tabå¯¼èˆª | âŒ | âŒ æœªå®ç° |

### å…³é”®ç¼ºå¤±
- âŒ **æ¨æ¼”è¿‡åœº (Deduction Bridge)** - 1.5-2ç§’ä»ªå¼æ„ŸåŠ¨ç”»
- âŒ **Identity Prism** - èº«ä»½ä¸‰å…ƒè§†è§’ï¼ˆOuter/Core/Innerï¼‰
- âŒ **å®Œæ•´çš„ Insight Card ç³»ç»Ÿ** - 4ç§ç±»å‹å¡ç‰‡ + Bottom Sheet + åˆ†äº«
- âŒ **BottomNav** - Chat/Chart/Journey/Me å››Tab

---

## L3: SKILL AGENT LAYER (æ™ºèƒ½ä»£ç†å±‚) - ğŸŸ¡ 50%

### å·²å®ç°
- âœ… Agent Runtime æ¡†æ¶ (`runtime.py`)
- âœ… Persona Engine (`persona.py` - 159è¡Œï¼Œå« SKILL_PERSONAS)
- âœ… Skill Router (`router.py` - Intent åˆ†ç±»)
- âœ… Context Managerï¼ˆåŸºç¡€å®ç°ï¼‰

### éƒ¨åˆ†å®ç°
- âš ï¸ Tool Executor - å…«å­—/æ˜Ÿåº§å·¥å…·æœ‰ä»£ç ï¼ˆ541+420è¡Œï¼‰ï¼Œä½†æœªå®Œæ•´é›†æˆ
- âš ï¸ 6æ­¥æ ‡å‡†å¤„ç†æµç¨‹ - æ¡†æ¶å­˜åœ¨ï¼Œä½† Insight Generation æœªå®Œæ•´

### æœªå®ç°
- âŒ å®Œæ•´çš„ Workflow ç¼–æ’
- âŒ Tool ç»“æœåˆ° Response çš„æ— ç¼æ•´åˆ
- âŒ å¤šè½®å¯¹è¯çŠ¶æ€ç®¡ç†

---

## L4: KNOWLEDGE LAYER (çŸ¥è¯†å¼•æ“å±‚) - ğŸ”´ 15%

### æ¶æ„å®ç°çŠ¶æ€

| ç»„ä»¶ | è®¾è®¡è§„èŒƒ | å®ç°çŠ¶æ€ |
|------|---------|---------|
| Knowledge Pipeline | é‡‡é›†â†’ç»“æ„åŒ–â†’åµŒå…¥ç´¢å¼• | âš ï¸ ä»£ç å­˜åœ¨ï¼Œæ— å®é™…è¿è¡Œ |
| Hybrid Retrieval | Vector + FTS + Graph | âœ… SQLå‡½æ•°å·²å®ç° |
| Knowledge Grader | LLM ç›¸å…³æ€§è¯„ä¼° | âŒ æœªå®ç° |
| Skill KB Stores | æŒ‰ Skill åˆ†åº“ | ğŸ”´ ä»…1ä¸ªæµ‹è¯•æ–‡ä»¶ |

### çŸ¥è¯†åº“å†…å®¹çŠ¶æ€ - ğŸ”´ ä¸¥é‡ç¼ºå¤±

```
knowledge/
â”œâ”€â”€ bazi/
â”‚   â””â”€â”€ åç¥åŸºç¡€.md (2.0 KB) â† å”¯ä¸€çš„çŸ¥è¯†æ–‡ä»¶ï¼
â”œâ”€â”€ zodiac/
â”‚   â””â”€â”€ (ç©º)
â””â”€â”€ mbti/
    â””â”€â”€ (ç©º)

packages/knowledge/  â† å…¨éƒ¨ä¸ºç©ºç›®å½•
â”œâ”€â”€ bazi/
â”œâ”€â”€ zodiac/
â”œâ”€â”€ mbti/
â””â”€â”€ shared/
```

**è®¾è®¡è§„èŒƒè¦æ±‚çš„çŸ¥è¯†ç»“æ„**ï¼š
```
å…«å­—çŸ¥è¯†åº“åº”åŒ…å«ï¼š
â”œâ”€â”€ theory/           # ç†è®ºåŸºç¡€ï¼ˆå¤©å¹²åœ°æ”¯ã€åç¥ã€äº”è¡Œï¼‰
â”œâ”€â”€ patterns/         # æ ¼å±€æ¨¡å¼ï¼ˆæ­£å®˜æ ¼ã€åè´¢æ ¼ç­‰ï¼‰
â”œâ”€â”€ transit/          # å¤§è¿æµå¹´
â”œâ”€â”€ cases/            # æ¡ˆä¾‹åº“
â””â”€â”€ qa/               # é—®ç­”å¯¹
```

**å½“å‰åªæœ‰**: 1ä¸ªæ–‡ä»¶ï¼Œçº¦2KB

---

## L5: VIBE ENGINE (æ ¸å¿ƒæ™ºèƒ½å¼•æ“) - ğŸŸ¡ 60%

### å…­å¤§æœåŠ¡å®ç°çŠ¶æ€

| æœåŠ¡ | ä»£ç è¡Œæ•° | åŠŸèƒ½å®Œæ•´åº¦ | å¤‡æ³¨ |
|------|---------|-----------|------|
| LLM Orchestrator | 374è¡Œ | âœ… 80% | å¤šæ¨¡å‹ç¼–æ’ã€æµå¼å“åº” |
| Memory System | 288è¡Œ | âš ï¸ 50% | çŸ­æœŸè®°å¿†æœ‰ï¼Œé•¿æœŸå‘é‡åŒ–å¾…å®Œå–„ |
| Emotion Engine | 314è¡Œ | âš ï¸ 40% | ä»£ç å­˜åœ¨ï¼Œè§„åˆ™åº“ä¸å®Œæ•´ |
| Portrait Service | 353è¡Œ | âš ï¸ 50% | æ¡†æ¶æœ‰ï¼Œå®é™…ç”Ÿæˆé€»è¾‘å¾…å®Œå–„ |
| Insight Generator | 390è¡Œ | âš ï¸ 40% | 4ç§å¡ç‰‡ç±»å‹å®šä¹‰ï¼Œè§¦å‘è§„åˆ™ä¸å®Œæ•´ |
| Vibe Score | - | âŒ 0% | å®Œå…¨æœªå®ç° |

### å…³é”®ç¼ºå¤±
- âŒ **Vibe Score** - èƒ½é‡åˆ†æ•°(0-100)ã€è¶‹åŠ¿è¿½è¸ª
- âŒ **Proactive Agent** - ä¸»åŠ¨å…³å¿ƒã€æé†’æ¨é€
- âš ï¸ **Insight è§¦å‘è§„åˆ™** - ç½®ä¿¡åº¦é˜ˆå€¼ã€å†·å´æœŸç®¡ç†

---

## L6: IDENTITY & DATA (èº«ä»½æ•°æ®å±‚) - ğŸŸ¢ 70%

### æ•°æ®åº“å®ç°çŠ¶æ€ - âœ… å®Œæ•´

| è¡¨ç±»åˆ« | è¡¨æ•°é‡ | çŠ¶æ€ |
|-------|-------|------|
| ç”¨æˆ·èº«ä»½ | 3è¡¨ | âœ… vibe_users, vibe_user_auth, vibe_data_consents |
| Skill æ•°æ® | 4è¡¨ | âœ… skill_profiles, conversations, messages, insights |
| çŸ¥è¯†åº“ | 3è¡¨ | âœ… knowledge_documents, chunks, qa_pairs |
| è®¢é˜…ç³»ç»Ÿ | 2è¡¨ | âœ… subscription_plans, user_subscriptions |
| æé†’ç³»ç»Ÿ | 3è¡¨ | âœ… fortune_events, reminder_settings, notifications |
| ç”¨æˆ·ç”»åƒ | 2è¡¨ | âœ… user_portraits, portrait_history |

### Repository å®ç° - âœ… å®Œæ•´
- âœ… user_repo.py (273è¡Œ) - å®Œæ•´ CRUD + è®¤è¯
- âœ… knowledge_repo.py (273è¡Œ) - æ··åˆæœç´¢ + åµŒå…¥
- âœ… skill_repo.py (467è¡Œ) - æ¡£æ¡ˆ/å¯¹è¯/æ¶ˆæ¯/æ´å¯Ÿ
- âœ… subscription_repo.py (260è¡Œ) - è®¢é˜…ç®¡ç†

### å¤–éƒ¨æœåŠ¡é›†æˆ

| æœåŠ¡ | é…ç½®çŠ¶æ€ | ä»£ç é›†æˆ |
|------|---------|---------|
| PostgreSQL + pgvector | âœ… | âœ… å®Œæ•´ |
| Gemini Embedding | âœ… | âœ… 148è¡Œ |
| Pinecone | âœ… é…ç½® | âŒ æ— ä»£ç  |
| Redis | âŒ | âŒ |
| Neo4j | âŒ | âŒ |

---

## ä»£ç é‡ç»Ÿè®¡

| æ¨¡å— | ä»£ç è¡Œæ•° | è¯„ä¼° |
|------|---------|------|
| åç«¯ Services | 6,755è¡Œ | âœ… å®è´¨æ€§å®ç° |
| åç«¯ Routes | 1,941è¡Œ | âœ… å®Œæ•´ |
| åç«¯ Models | 504è¡Œ | âœ… å®Œæ•´ |
| åç«¯ Stores | 1,273è¡Œ | âœ… å®Œæ•´ |
| åç«¯ Tools | 1,691è¡Œ | âœ… å…«å­—/æ˜Ÿåº§å·¥å…· |
| å‰ç«¯ Components | 2,421è¡Œ | âš ï¸ åŸºç¡€ç»„ä»¶ |
| å‰ç«¯ Pages | 1,269è¡Œ | âš ï¸ é¡µé¢éª¨æ¶ |
| **æ€»è®¡** | ~15,854è¡Œ | æ¶æ„å®Œæ•´ï¼Œä½“éªŒå±‚ç¼ºå¤± |

---

# ç¬¬äºŒéƒ¨åˆ†ï¼šå…³é”®å·®è·ä¼˜å…ˆçº§æ’åº

## ğŸ”´ P0 - å¿…é¡»ç«‹å³å®Œæˆï¼ˆé˜»å¡ä¸Šçº¿ï¼‰

| å·®è·é¡¹ | å½±å“ | å·¥ä½œé‡ä¼°ç®— |
|-------|------|-----------|
| çŸ¥è¯†åº“å†…å®¹ | æ— çŸ¥è¯†=æ— æ™ºèƒ½ | 2-3å‘¨ |
| Insight Card å®Œæ•´é—­ç¯ | æ ¸å¿ƒä»·å€¼ä¸»å¼  | 1å‘¨ |
| Identity Prism | å·®å¼‚åŒ–ä½“éªŒ | 1å‘¨ |
| æ¨æ¼”è¿‡åœºåŠ¨ç”» | ä»ªå¼æ„Ÿç¼ºå¤± | 3å¤© |
| BottomNav å››Tab | ç§»åŠ¨ç«¯å¯¼èˆª | 2å¤© |

## ğŸŸ¡ P1 - ä¸Šçº¿å 4 å‘¨å†…å®Œæˆ

| å·®è·é¡¹ | å½±å“ | å·¥ä½œé‡ä¼°ç®— |
|-------|------|-----------|
| Journey é¡µé¢ | é•¿æœŸç•™å­˜ | 1å‘¨ |
| Vibe Score | é‡åŒ–æˆé•¿ | 1å‘¨ |
| å…³ç³»æ¨¡æ‹Ÿå™¨ | ç—…æ¯’è£‚å˜ | 1å‘¨ |
| Skill Mirror | å‘¨æœŸå›é¡¾åˆ†äº« | 1å‘¨ |
| Proactive Agent | ä¸»åŠ¨å…³å¿ƒ | 2å‘¨ |

## ğŸŸ¢ P2 - å¯è¿­ä»£å®Œæˆ

| å·®è·é¡¹ | å½±å“ | å·¥ä½œé‡ä¼°ç®— |
|-------|------|-----------|
| Attach/Career Skills | ç”Ÿæ€æ‰©å±• | å„2å‘¨ |
| Neo4j å›¾æ•°æ®åº“ | å…³ç³»å»ºæ¨¡ | 1å‘¨ |
| Redis ç¼“å­˜ | æ€§èƒ½ä¼˜åŒ– | 3å¤© |
| å›½é™…åŒ– | æµ·å¤–å¸‚åœº | 2å‘¨ |

---

# ç¬¬ä¸‰éƒ¨åˆ†ï¼šè®¿è°ˆç»“è®ºä¸å®æ–½è®¡åˆ’

## ç”¨æˆ·éœ€æ±‚ç¡®è®¤

| ç»´åº¦ | ç”¨æˆ·é€‰æ‹© |
|------|---------|
| **MVP èŒƒå›´** | å…«å­— + æ˜Ÿåº§ï¼ˆä¸¤ä¸ª Skillï¼‰ |
| **çŸ¥è¯†åº“ç­–ç•¥** | è‡ªå»ºçŸ¥è¯†åº“ |
| **æ ¸å¿ƒå·®å¼‚åŒ–** | Insight Cardsï¼ˆ4ç§å…¨éƒ¨ä¸Šçº¿ï¼‰ |
| **çŸ¥è¯†æ·±åº¦** | ä¸­ç­‰ä¸“ä¸šçº§ |
| **èµ„æºé…ç½®** | å…¨æ ˆ1äºº |
| **æ—¶é—´çº¦æŸ** | æ— ç¡¬æ€§æˆªæ­¢ï¼Œè´¨é‡ä¼˜å…ˆ |
| **å·¥ä½œé‡å¿ƒ** | å¹³è¡¡æ¨è¿›ï¼ˆå‰ç«¯+çŸ¥è¯†åº“+è”è°ƒï¼‰ |
| **å·¥ä½œæ–¹å¼** | è¯¦ç»†è®¡åˆ’å…ˆ |
| **å½“å‰çŠ¶æ€** | åç«¯éƒ¨åˆ†å¯ç”¨ï¼Œå‰ç«¯èƒ½è·‘é€š |

---

# ç¬¬å››éƒ¨åˆ†ï¼šæ¨èå®æ–½è®¡åˆ’

## æ€»ä½“ç­–ç•¥ï¼šä¸‰è½¨å¹¶è¡Œ + æ¨¡å—åŒ–äº¤ä»˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MVP å®æ–½ä¸‰è½¨å¹¶è¡Œ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  è½¨é“ A: çŸ¥è¯†åº“å»ºè®¾          è½¨é“ B: å‰ç«¯ä½“éªŒå±‚     è½¨é“ C: è”è°ƒä¼˜åŒ–  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                 â”‚
â”‚  A1: å…«å­—çŸ¥è¯†åº“              B1: Insight Cards      C1: ç«¯åˆ°ç«¯æµ‹è¯• â”‚
â”‚      - åç¥ä½“ç³»                  - 4ç§å¡ç‰‡ç»„ä»¶          - API è”è°ƒ  â”‚
â”‚      - äº”è¡ŒåŸºç¡€                  - Bottom Sheet         - æµå¼å“åº”  â”‚
â”‚      - æ ¼å±€åˆ†æ                  - åˆ†äº«åŠŸèƒ½              â”‚
â”‚      - å¤§è¿æµå¹´                                                  â”‚
â”‚                              B2: æ ¸å¿ƒç»„ä»¶                        â”‚
â”‚  A2: æ˜Ÿåº§çŸ¥è¯†åº“                  - æ¨æ¼”è¿‡åœºåŠ¨ç”»          C2: æ•°æ®æµ  â”‚
â”‚      - 12æ˜Ÿåº§                    - BottomNav             - çŸ¥è¯†æ£€ç´¢  â”‚
â”‚      - è¡Œæ˜Ÿå®«ä½                  - Birth Capsule         - Insightè§¦å‘â”‚
â”‚      - ç›¸ä½è§£è¯»                                                  â”‚
â”‚                              B3: é¡µé¢å®Œå–„                        â”‚
â”‚  A3: çŸ¥è¯†å…¥åº“                    - Bazi Landing                  â”‚
â”‚      - åˆ†å—å¤„ç†                  - Zodiac Landing                â”‚
â”‚      - å‘é‡åµŒå…¥                  - Chat ä¼˜åŒ–                     â”‚
â”‚      - è´¨é‡éªŒè¯                                                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 1: åŸºç¡€å¤¯å®ï¼ˆ1-2å‘¨ï¼‰

### ç›®æ ‡ï¼šç¡®ä¿ç«¯åˆ°ç«¯æµç¨‹å¯è¿è¡Œ

#### 1.1 åç«¯è”è°ƒéªŒè¯
- [ ] éªŒè¯ chat API ç«¯åˆ°ç«¯æµç¨‹
- [ ] éªŒè¯çŸ¥è¯†æ£€ç´¢ hybrid_search_v2 å‡½æ•°
- [ ] éªŒè¯ Insight ç”Ÿæˆå’Œå­˜å‚¨
- [ ] ä¿®å¤å‘ç°çš„é˜»å¡æ€§é—®é¢˜

#### 1.2 çŸ¥è¯†åº“ - å…«å­—åŸºç¡€
```
knowledge/bazi/
â”œâ”€â”€ theory/
â”‚   â”œâ”€â”€ å¤©å¹²è¯¦è§£.md          # 10å¤©å¹²æ€§è´¨ã€é˜´é˜³äº”è¡Œ
â”‚   â”œâ”€â”€ åœ°æ”¯è¯¦è§£.md          # 12åœ°æ”¯æ€§è´¨ã€è—å¹²
â”‚   â”œâ”€â”€ åç¥åŸºç¡€.md          # âœ… å·²æœ‰ï¼Œéœ€æ‰©å……
â”‚   â”œâ”€â”€ åç¥è¯¦è§£-æ¯”åŠ«.md     # æ¯”è‚©ã€åŠ«è´¢æ·±åº¦è§£è¯»
â”‚   â”œâ”€â”€ åç¥è¯¦è§£-é£Ÿä¼¤.md     # é£Ÿç¥ã€ä¼¤å®˜æ·±åº¦è§£è¯»
â”‚   â”œâ”€â”€ åç¥è¯¦è§£-è´¢æ˜Ÿ.md     # æ­£è´¢ã€åè´¢æ·±åº¦è§£è¯»
â”‚   â”œâ”€â”€ åç¥è¯¦è§£-å®˜æ€.md     # æ­£å®˜ã€ä¸ƒæ€æ·±åº¦è§£è¯»
â”‚   â”œâ”€â”€ åç¥è¯¦è§£-å°æ˜Ÿ.md     # æ­£å°ã€åå°æ·±åº¦è§£è¯»
â”‚   â””â”€â”€ äº”è¡Œç”Ÿå…‹.md          # ç›¸ç”Ÿç›¸å…‹å…³ç³»
â”œâ”€â”€ patterns/
â”‚   â”œâ”€â”€ å…«æ ¼æ¦‚è¿°.md          # æ­£å®˜æ ¼ã€åè´¢æ ¼ç­‰å…«ç§æ ¼å±€
â”‚   â””â”€â”€ ç‰¹æ®Šæ ¼å±€.md          # ä»æ ¼ã€åŒ–æ ¼ç­‰
â””â”€â”€ transit/
    â”œâ”€â”€ å¤§è¿è§£è¯».md          # 10å¹´å¤§è¿è®¡ç®—ä¸è§£è¯»
    â””â”€â”€ æµå¹´åˆ†æ.md          # å¹´åº¦è¿åŠ¿æ¡†æ¶
```

#### 1.3 å‰ç«¯ - Insight Cards æ ¸å¿ƒ
- [ ] InsightCard ç»„ä»¶é‡æ„ï¼ˆ4ç§ç±»å‹ï¼‰
- [ ] Bottom Sheet å±•å¼€äº¤äº’
- [ ] å¡ç‰‡åˆ†äº«åŠŸèƒ½ï¼ˆå¤åˆ¶/æµ·æŠ¥ï¼‰

**å…³é”®æ–‡ä»¶**ï¼š
- `apps/web/src/components/insight/InsightCard.tsx`
- `apps/web/src/components/insight/InsightPanel.tsx`
- æ–°å¢ï¼š`apps/web/src/components/insight/InsightBottomSheet.tsx`
- æ–°å¢ï¼š`apps/web/src/components/insight/InsightShare.tsx`

---

## Phase 2: ä½“éªŒæå‡ï¼ˆ2-3å‘¨ï¼‰

### ç›®æ ‡ï¼šæ ¸å¿ƒå·®å¼‚åŒ–ä½“éªŒå®Œæ•´

#### 2.1 çŸ¥è¯†åº“ - å…«å­—è¿›é˜¶ + æ˜Ÿåº§åŸºç¡€
```
knowledge/bazi/
â”œâ”€â”€ analysis/
â”‚   â”œâ”€â”€ æ€§æ ¼åˆ†ææ¡†æ¶.md      # åŸºäºåç¥çš„æ€§æ ¼è§£è¯»
â”‚   â”œâ”€â”€ äº‹ä¸šè´¢è¿.md          # äº‹ä¸šã€è´¢è¿åˆ†ææ–¹æ³•
â”‚   â”œâ”€â”€ æ„Ÿæƒ…å©šå§».md          # æ„Ÿæƒ…ã€å©šå§»åˆ†ææ–¹æ³•
â”‚   â””â”€â”€ å¥åº·æç¤º.md          # äº”è¡Œä¸å¥åº·
â””â”€â”€ qa/
    â””â”€â”€ å¸¸è§é—®é¢˜.md          # FAQ é—®ç­”å¯¹

knowledge/zodiac/
â”œâ”€â”€ signs/
â”‚   â”œâ”€â”€ ç™½ç¾Šåº§.md â†’ åŒé±¼åº§.md  # 12æ˜Ÿåº§å®Œæ•´æ¡£æ¡ˆ
â”œâ”€â”€ houses/
â”‚   â””â”€â”€ 12å®«ä½è§£è¯».md        # 12å®«ä½å«ä¹‰
â”œâ”€â”€ planets/
â”‚   â””â”€â”€ 10è¡Œæ˜Ÿè§£è¯».md        # å¤ªé˜³â†’å†¥ç‹æ˜Ÿ
â””â”€â”€ aspects/
    â””â”€â”€ ä¸»è¦ç›¸ä½.md          # åˆã€å†²ã€åˆ‘ã€ä¸‰åˆã€å…­åˆ
```

#### 2.2 å‰ç«¯ - æ ¸å¿ƒäº¤äº’ç»„ä»¶
- [ ] **æ¨æ¼”è¿‡åœºåŠ¨ç”»** (Deduction Bridge)
  - å…«å­—ç‰ˆï¼šåŒå¿ƒç¯æ—‹è½¬
  - æ˜Ÿåº§ç‰ˆï¼šæ˜Ÿè¿åŠ¨ç”»
- [ ] **BottomNav** å››Tabå¯¼èˆª
- [ ] **Birth Input Capsule** ä»ªå¼æ„Ÿè¾“å…¥

**å…³é”®æ–‡ä»¶**ï¼š
- æ–°å¢ï¼š`apps/web/src/components/core/DeductionBridge.tsx`
- æ–°å¢ï¼š`apps/web/src/components/ui/BottomNav.tsx`
- æ–°å¢ï¼š`apps/web/src/components/core/BirthInputCapsule.tsx`

#### 2.3 é¡µé¢å®Œå–„
- [ ] Bazi Landing é¡µé¢å®Œæ•´å®ç°
- [ ] Zodiac Landing é¡µé¢å®Œæ•´å®ç°
- [ ] Chat é¡µé¢ä¼˜åŒ–ï¼ˆQuick Repliesã€æƒ…ç»ªæ„ŸçŸ¥æç¤ºï¼‰

---

## Phase 3: åŠŸèƒ½é—­ç¯ï¼ˆ2-3å‘¨ï¼‰

### ç›®æ ‡ï¼šMVP åŠŸèƒ½å®Œæ•´å¯ç”¨

#### 3.1 çŸ¥è¯†åº“ - çŸ¥è¯†å…¥åº“ä¸éªŒè¯
- [ ] è¿è¡Œ ingestion pipeline
- [ ] éªŒè¯ hybrid_search å¬å›è´¨é‡
- [ ] è¿­ä»£ä¼˜åŒ–åˆ†å—ç­–ç•¥

#### 3.2 Insight ç³»ç»Ÿå®Œæ•´å®ç°
- [ ] 4ç§ Insight è§¦å‘è§„åˆ™
- [ ] ç½®ä¿¡åº¦é˜ˆå€¼è°ƒä¼˜
- [ ] å†·å´æœŸç®¡ç†
- [ ] Insight åµŒå…¥å‘é‡æœç´¢

**å…³é”®æ–‡ä»¶**ï¼š
- `apps/api/services/vibe_engine/insight_generator.py`
- `apps/api/stores/skill_repo.py` (search_insights_by_embedding)

#### 3.3 Identity Prismï¼ˆå¦‚æ—¶é—´å…è®¸ï¼‰
- [ ] ä¸‰å…ƒè§†è§’ç»„ä»¶ï¼ˆOuter/Core/Innerï¼‰
- [ ] PC å³æ åŠå¸¸é©»å¸ƒå±€
- [ ] Mobile Me Tab é›†æˆ

---

## å…³é”®æ–‡ä»¶æ¸…å•

### çŸ¥è¯†åº“ç›¸å…³
| è·¯å¾„ | è¯´æ˜ |
|------|------|
| `knowledge/bazi/` | å…«å­—çŸ¥è¯†æ–‡æ¡£ï¼ˆå¾…åˆ›å»ºï¼‰ |
| `knowledge/zodiac/` | æ˜Ÿåº§çŸ¥è¯†æ–‡æ¡£ï¼ˆå¾…åˆ›å»ºï¼‰ |
| `apps/api/workers/ingestion.py` | çŸ¥è¯†å…¥åº“ worker |
| `apps/api/workers/chunker.py` | æ–‡æœ¬åˆ†å—å¤„ç† |
| `apps/api/services/knowledge/embedding.py` | Gemini åµŒå…¥æœåŠ¡ |
| `apps/api/services/knowledge/retrieval.py` | æ··åˆæ£€ç´¢æœåŠ¡ |

### å‰ç«¯ç»„ä»¶ç›¸å…³
| è·¯å¾„ | è¯´æ˜ |
|------|------|
| `apps/web/src/components/insight/` | Insight å¡ç‰‡ç³»ç»Ÿ |
| `apps/web/src/components/core/` | æ ¸å¿ƒè§†è§‰ç»„ä»¶ |
| `apps/web/src/components/ui/` | åŸºç¡€ UI ç»„ä»¶ |
| `apps/web/src/app/bazi/` | å…«å­—é¡µé¢ |
| `apps/web/src/app/zodiac/` | æ˜Ÿåº§é¡µé¢ |

### åç«¯æœåŠ¡ç›¸å…³
| è·¯å¾„ | è¯´æ˜ |
|------|------|
| `apps/api/services/vibe_engine/insight_generator.py` | Insight ç”Ÿæˆ |
| `apps/api/services/agent/runtime.py` | Agent è¿è¡Œæ—¶ |
| `apps/api/routes/chat.py` | èŠå¤© API |

---

## äº¤ä»˜é‡Œç¨‹ç¢‘

| é‡Œç¨‹ç¢‘ | å†…å®¹ | éªŒæ”¶æ ‡å‡† |
|--------|------|---------|
| **M1** | ç«¯åˆ°ç«¯æµç¨‹å¯è¿è¡Œ | ç”¨æˆ·è¾“å…¥â†’AIå›å¤â†’æ˜¾ç¤ºæ­£å¸¸ |
| **M2** | Insight Cards å®Œæ•´ | 4ç§å¡ç‰‡å±•ç¤º+åˆ†äº«åŠŸèƒ½ |
| **M3** | å…«å­—çŸ¥è¯†åº“ä¸Šçº¿ | ä¸“ä¸šé—®é¢˜æœ‰çŸ¥è¯†æ”¯æ’‘çš„å›ç­” |
| **M4** | æ ¸å¿ƒä½“éªŒç»„ä»¶ | æ¨æ¼”è¿‡åœº+BottomNav+Birth Capsule |
| **M5** | æ˜Ÿåº§çŸ¥è¯†åº“ä¸Šçº¿ | Zodiac Skill å¯ç”¨ |
| **M6** | MVP å®Œæ•´å‘å¸ƒ | ä¸¤ä¸ª Skill å®Œæ•´ä½“éªŒé—­ç¯ |

---

## ä¸‹ä¸€æ­¥è¡ŒåŠ¨

ç¡®è®¤æ­¤è®¡åˆ’åï¼Œæˆ‘å°†æŒ‰ä»¥ä¸‹é¡ºåºæ‰§è¡Œï¼š

1. **éªŒè¯å½“å‰ç³»ç»ŸçŠ¶æ€** - è¿è¡Œåç«¯å’Œå‰ç«¯ï¼Œç¡®è®¤å¯è¿è¡Œæ€§
2. **å¼€å§‹ Phase 1.1** - åç«¯è”è°ƒéªŒè¯
3. **å¹¶è¡Œå¯åŠ¨ Phase 1.2** - å¼€å§‹ç”Ÿæˆå…«å­—çŸ¥è¯†åº“å†…å®¹
4. **å¹¶è¡Œå¯åŠ¨ Phase 1.3** - Insight Cards ç»„ä»¶å¼€å‘

---

## æ¶æ„æ€»è§ˆ

```
vibelife/
â”œâ”€â”€ apps/                    # åº”ç”¨å±‚
â”‚   â”œâ”€â”€ api/                 # FastAPI åç«¯ (Python)
â”‚   â”œâ”€â”€ web/                 # Next.js å‰ç«¯ (v14)
â”‚   â””â”€â”€ id/                  # è®¤è¯ä¸­å¿ƒ (å¾…å¼€å‘)
â”œâ”€â”€ packages/                # å…±äº«åŒ…
â”‚   â”œâ”€â”€ shared/              # ç±»å‹+å·¥å…·
â”‚   â”œâ”€â”€ knowledge/           # çŸ¥è¯†åº“æ•°æ®
â”‚   â”œâ”€â”€ skills/              # Skill å¼•æ“ (å¾…å®ç°)
â”‚   â””â”€â”€ ui/                  # UI ç»„ä»¶åº“ (å¾…å®ç°)
â”œâ”€â”€ knowledge/               # RAG çŸ¥è¯†æ–‡ä»¶
â”œâ”€â”€ migrations/              # æ•°æ®åº“è¿ç§»
â””â”€â”€ deploy/                  # éƒ¨ç½²é…ç½®
```

---

## ç«™ç‚¹/åŸŸåè®¾è®¡

| ç«™ç‚¹ | åŸŸå | è¯´æ˜ |
|------|------|------|
| ä¸»ç«™ | `vibelife.app` | Landing + Hub |
| å…«å­— | `bazi.vibelife.app` | å…«å­—å‘½ç† Skill |
| æ˜Ÿåº§ | `zodiac.vibelife.app` | æ˜Ÿåº§å æ˜Ÿ Skill |
| MBTI | `mbti.vibelife.app` | æ€§æ ¼åˆ†æ Skill |
| ID | `id.vibelife.app` | SSO è®¤è¯ä¸­å¿ƒ |
| API | `api.vibelife.app` | åç«¯ API |

---

## å…±äº«ç»„ä»¶ vs Skill ç‹¬æœ‰ç»„ä»¶

### ğŸ”· å…±äº«ç»„ä»¶ï¼ˆæ‰€æœ‰ç«™ç‚¹é€šç”¨ï¼‰

#### åç«¯å…±äº« (`apps/api/`)

| ç»„ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| Agent å¼•æ“ | `services/agent/` | æ¶ˆæ¯å¤„ç†ã€æ„å›¾è·¯ç”±ã€äººæ ¼ç®¡ç† |
| Vibe Engine | `services/vibe_engine/` | ç”¨æˆ·ç”»åƒã€æƒ…ç»ªåˆ†æã€æ´å¯Ÿç”Ÿæˆ |
| çŸ¥è¯†æ£€ç´¢ | `services/knowledge/` | Gemini åµŒå…¥ + Pinecone RAG |
| è®¤è¯ç³»ç»Ÿ | `services/identity/` | SSO å•ç‚¹ç™»å½•ã€JWT ä»¤ç‰Œ |
| æ”¯ä»˜ç³»ç»Ÿ | `services/billing/` | Stripe è®¢é˜…ç®¡ç† |
| æé†’ç³»ç»Ÿ | `services/reminder/` | æé†’ç”Ÿæˆå’Œæ¨é€ |
| Mirror å›é¡¾ | `services/mirror/` | å‘¨/æœˆå›é¡¾å¡ç‰‡ |
| æ•°æ®æ¨¡å‹ | `models/` | Userã€Skillã€Knowledgeã€Subscription |
| æ•°æ®è®¿é—® | `stores/` | PostgreSQL Repository æ¨¡å¼ |
| å…±äº«å·¥å…· | `tools/shared/` | æ—¥æœŸã€å†œå†è½¬æ¢ |

#### å‰ç«¯å…±äº« (`apps/web/src/`)

| ç»„ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| æ ¸å¿ƒè§†è§‰ç»„ä»¶ | `components/core/` | VibeGlyphã€BreathAuraã€InsightSealã€LuminousPaper |
| UI ç»„ä»¶åº“ | `components/ui/` | Buttonã€Inputã€Cardã€Dialog ç­‰ |
| èŠå¤©ç»„ä»¶ | `components/chat/` | ChatContainerã€ChatMessage |
| æ´å¯Ÿç»„ä»¶ | `components/insight/` | æ´å¯Ÿå¡ç‰‡å±•ç¤º |
| API å®¢æˆ·ç«¯ | `lib/api.ts` | ç»Ÿä¸€ API è°ƒç”¨ |
| æ ¹å¸ƒå±€ | `app/layout.tsx` | å…¨å±€æ ·å¼å’Œé…ç½® |

#### å…±äº«åŒ… (`packages/`)

| åŒ… | è·¯å¾„ | è¯´æ˜ |
|---|------|------|
| @vibelife/shared | `packages/shared/` | ç±»å‹å®šä¹‰ã€å·¥å…·å‡½æ•° |
| å…±äº«çŸ¥è¯† | `packages/knowledge/shared/` | é€šç”¨çŸ¥è¯†æ•°æ® |

---

### ğŸ”¶ Skill ç‹¬æœ‰ç»„ä»¶

#### åç«¯ Skill å·¥å…· (`apps/api/tools/`)

| Skill | è·¯å¾„ | å†…å®¹ |
|-------|------|------|
| å…«å­— | `tools/bazi/` | `calculator.py` å¤©å¹²åœ°æ”¯è®¡ç®—ã€`transit.py` å¤§è¿æµå¹´ã€`analysis.py` æ ¼å±€åˆ†æ |
| æ˜Ÿåº§ | `tools/zodiac/` | `chart.py` æ˜Ÿç›˜ç”Ÿæˆã€`transit.py` è¡Œæ˜Ÿè¡Œè¿ã€`events.py` å¤©æ–‡äº‹ä»¶ |
| MBTI | `tools/mbti/` | (å¾…å®ç°) |

#### åç«¯ Skill é…ç½®

| é…ç½®é¡¹ | æ–‡ä»¶ | è¯´æ˜ |
|--------|------|------|
| Skill äººæ ¼ | `services/agent/persona.py` | `SKILL_PERSONAS = {"bazi": "...", "zodiac": "..."}` |
| æ„å›¾åˆ†ç±» | `services/agent/router.py` | `Intent.BAZI_CHART`ã€`Intent.ZODIAC_NATAL` ç­‰ |
| SSO ç«™ç‚¹ | `services/identity/sso.py` | `VALID_SITES = {"bazi", "zodiac", "mbti"}` |

#### å‰ç«¯ Skill é¡µé¢ (`apps/web/src/app/`)

| Skill | è·¯å¾„ | å†…å®¹ |
|-------|------|------|
| å…«å­— | `app/bazi/` | `page.tsx` Landingã€`chat/page.tsx` èŠå¤© |
| æ˜Ÿåº§ | `app/zodiac/` | `page.tsx` Landingã€`chat/page.tsx` èŠå¤© |
| MBTI | `app/mbti/` | `page.tsx` Landingã€`chat/page.tsx` èŠå¤© |
| é€šç”¨èŠå¤© | `app/chat/[skillId]/` | åŠ¨æ€è·¯ç”±æ”¯æŒæ‰€æœ‰ Skill |

#### çŸ¥è¯†åº“æ•°æ® (`packages/knowledge/`)

| Skill | è·¯å¾„ | å†…å®¹ |
|-------|------|------|
| å…«å­— | `knowledge/bazi/` | å…«å­—æ–‡çŒ®ã€å‘½ç†å­¦èµ„æ–™ |
| æ˜Ÿåº§ | `knowledge/zodiac/` | å æ˜Ÿå­¦ã€æ˜Ÿåº§èµ„æ–™ |
| MBTI | `knowledge/mbti/` | MBTI ç†è®ºã€ç±»å‹èµ„æ–™ |

---

## æ•°æ®éš”ç¦»ç­–ç•¥

### æ•°æ®åº“è¡¨è®¾è®¡

æ‰€æœ‰ä¸ Skill ç›¸å…³çš„è¡¨éƒ½ä½¿ç”¨ `skill_id` å­—æ®µéš”ç¦»ï¼š

```sql
-- conversations è¡¨
skill_id VARCHAR  -- "bazi" | "zodiac" | "mbti"

-- user_portraits è¡¨ (æŒ‰ Skill å­˜å‚¨ç”»åƒ)
skill_id VARCHAR

-- insights è¡¨ (æŒ‰ Skill å­˜å‚¨æ´å¯Ÿ)
skill_id VARCHAR
```

### è®¢é˜…æ¨¡å‹

```python
class SubscriptionTier:
    FREE = "free"
    SKILL_SINGLE = "skill_single"    # å• Skill è®¢é˜…
    SKILL_BUNDLE = "skill_bundle"    # å¤š Skill æ†ç»‘
    VIBELIFE_ALL = "vibelife_all"    # å…¨ç«™è®¢é˜…
```

---

## å…³é”®è®¾è®¡æ¨¡å¼

### 1. Skill å‚æ•°åŒ–

æ‰€æœ‰ä¸»è¦ç»„ä»¶æ¥å— `skill` å‚æ•°ï¼š

```typescript
// å‰ç«¯ç»„ä»¶
interface WithSkill {
  skill?: "bazi" | "zodiac" | "mbti";
}

// Skill é…ç½®å­—å…¸
const SKILL_COLORS = { bazi: {...}, zodiac: {...}, mbti: {...} };
const SKILL_EMPTY_STATE = { ... };
const SKILL_QUICK_PROMPTS = { ... };
```

```python
# åç«¯é…ç½®
SKILL_PERSONAS = {"bazi": "...", "zodiac": "...", "mbti": "..."}
SKILL_INTENTS = {"bazi": [...], "zodiac": [...], ...}
```

### 2. SSO è·¨ç«™è®¤è¯

```
1. ä¸»ç«™ç™»å½• â†’ ç”Ÿæˆ access_token + refresh_token
2. å¯¼èˆªåˆ° Skill ç«™ç‚¹ â†’ éªŒè¯ token
3. å¯é€‰ SSO token (5åˆ†é’Ÿæœ‰æ•ˆ) â†’ è·¨åŸŸèº«ä»½éªŒè¯
4. /auth/sso-callback â†’ æ¢å– Skill ä¸“ç”¨ token
```

---

## å…³é”®æ–‡ä»¶è·¯å¾„é€ŸæŸ¥

| åŠŸèƒ½ | è·¯å¾„ |
|------|------|
| SSO é…ç½® | `apps/api/services/identity/sso.py` |
| Agent å¼•æ“ | `apps/api/services/agent/runtime.py` |
| Skill äººæ ¼ | `apps/api/services/agent/persona.py` |
| æ„å›¾è·¯ç”± | `apps/api/services/agent/router.py` |
| è®¢é˜…ç®¡ç† | `apps/api/services/billing/subscription.py` |
| æ•°æ®æ¨¡å‹ | `apps/api/models/` |
| å…«å­—å·¥å…· | `apps/api/tools/bazi/` |
| æ˜Ÿåº§å·¥å…· | `apps/api/tools/zodiac/` |
| æ ¸å¿ƒç»„ä»¶ | `apps/web/src/components/core/` |
| Skill é¡µé¢ | `apps/web/src/app/{bazi,zodiac,mbti}/` |
| çŸ¥è¯†åº“ | `packages/knowledge/{bazi,zodiac,mbti}/` |

---

## å¾…å®Œæˆçš„å…±äº«å±‚

- ğŸ”² `packages/skills/` - Skill å¼•æ“åŒ…
- ğŸ”² `packages/ui/` - UI ç»„ä»¶åº“åŒ…
- ğŸ”² `apps/id/` - ä¸“ç”¨è®¤è¯ä¸­å¿ƒåº”ç”¨
- ğŸ”² Phase 1.5: Insight è·¨ Skill æ£€ç´¢
- ğŸ”² Phase 2: Global Portrait å…¨å±€ç”»åƒ
