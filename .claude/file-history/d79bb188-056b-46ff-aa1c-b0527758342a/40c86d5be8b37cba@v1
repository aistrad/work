version: "2.0"
skill_id: mindfulness
description: 正念导师工具 - 引导练习、记录统计

# ═══════════════════════════════════════════════════════════════════════════
# 动作型工具
# ═══════════════════════════════════════════════════════════════════════════
action:
  - name: start_mindfulness_session
    description: |
      开始正念练习会话。
      何时调用：
      - 用户请求做正念/冥想/呼吸练习时
      - 系统检测到情绪波动建议练习时
      - 其他 Skill 结束后触发收尾练习时
    parameters:
      - name: practice_type
        type: string
        required: true
        description: 练习类型
        enum:
          - breathing        # 呼吸锚定 (1-3分钟)
          - breathing_478    # 478呼吸 (2分钟)
          - stop             # STOP急救 (1分钟)
          - body_scan        # 身体扫描 (3分钟)
          - morning          # 晨间意图 (3分钟)
          - focus            # 专注启动 (2分钟)
          - sleep            # 睡前放松 (5-10分钟)
          - rain             # RAIN情绪处理 (5-10分钟)
          - integration      # 专家收尾 (2分钟)
      - name: duration_minutes
        type: integer
        required: false
        description: 练习时长（分钟），不指定则使用默认值
        default: 3
      - name: context
        type: object
        required: false
        description: |
          上下文信息，用于个性化引导：
          - trigger: 触发来源 (user/schedule/emotion_detect/expert_handoff)
          - preceding_skill: 前置 Skill (bazi/zodiac/tarot)
          - emotion_detected: 检测到的情绪 (anxiety/anger/sadness)
          - user_question: 用户原始问题
      - name: mood_before
        type: integer
        required: false
        description: 练习前情绪评分 (1-5)

  - name: complete_mindfulness_session
    description: |
      完成正念练习并记录。
      何时调用：
      - 用户完成练习后
      - 用户中途退出时（标记未完成）
    parameters:
      - name: session_id
        type: string
        required: true
        description: 练习会话 ID
      - name: completed
        type: boolean
        required: true
        description: 是否完成
      - name: mood_after
        type: integer
        required: false
        description: 练习后情绪评分 (1-5)
      - name: notes
        type: string
        required: false
        description: 用户反馈笔记

# ═══════════════════════════════════════════════════════════════════════════
# 展示型工具
# ═══════════════════════════════════════════════════════════════════════════
display:
  - name: show_practice_guide
    description: |
      展示正念练习的分步引导。
      使用极简文字 + 留白（...）表示停顿。
    card_type: practice_guide
    parameters:
      - name: practice_type
        type: string
        required: true
        description: 练习类型
        enum:
          - breathing
          - breathing_478
          - stop
          - body_scan
          - morning
          - focus
          - sleep
          - rain
          - integration
      - name: step
        type: integer
        required: false
        description: 当前步骤（用于分步展示）
        default: 0
      - name: total_steps
        type: integer
        required: false
        description: 总步骤数

  - name: show_mindfulness_stats
    description: |
      展示用户的正念练习统计。
      何时调用：
      - 用户询问练习记录时
      - 用户完成里程碑时
    card_type: mindfulness_stats
    parameters:
      - name: period
        type: string
        required: false
        description: 统计周期
        default: all
        enum:
          - today
          - week
          - month
          - all

  - name: show_streak_celebration
    description: |
      展示连续打卡庆祝卡片。
      何时调用：
      - 用户达到 3/7/14/21/30 天里程碑时
    card_type: streak_celebration
    parameters:
      - name: streak_days
        type: integer
        required: true
        description: 连续天数
      - name: total_minutes
        type: integer
        required: false
        description: 总练习分钟数

  - name: show_emotion_check
    description: |
      展示情绪检测卡片，询问用户当前状态。
      何时调用：
      - 检测到可能的负面情绪时
      - 建议练习前了解用户状态时
    card_type: emotion_check
    parameters:
      - name: detected_emotion
        type: string
        required: false
        description: 检测到的情绪
        enum:
          - anxiety
          - anger
          - sadness
          - stress
          - overwhelm
          - none
      - name: suggestion
        type: string
        required: false
        description: 建议的练习类型

# ═══════════════════════════════════════════════════════════════════════════
# 练习引导内容（内置数据）
# ═══════════════════════════════════════════════════════════════════════════
# 以下是各练习类型的引导脚本，由 show_practice_guide 使用

practice_scripts:
  breathing:
    name: 呼吸锚定
    duration: 1-3分钟
    steps:
      - "找到一个舒服的姿势..."
      - ""
      - "闭上眼睛..."
      - ""
      - "把注意力放在呼吸上..."
      - ""
      - "吸气..."
      - "..."
      - "呼气..."
      - "..."
      - "就这样。"
      - ""
      - "没什么要改变的。"
      - ""
      - "如果走神了..."
      - "没关系..."
      - "轻轻回来。"
      - ""
      - "吸气..."
      - "..."
      - "呼气..."
      - "..."
      - "很好。"
      - ""
      - "慢慢睁开眼睛..."
      - "带着这份平静继续。"

  breathing_478:
    name: 478呼吸
    duration: 2分钟
    effect: 激活副交感神经，快速平静
    steps:
      - "这个呼吸法可以快速平静..."
      - ""
      - "找到舒服的姿势..."
      - ""
      - "我们开始..."
      - ""
      - "吸气，数 4 秒..."
      - "1... 2... 3... 4..."
      - ""
      - "屏住呼吸，数 7 秒..."
      - "1... 2... 3... 4... 5... 6... 7..."
      - ""
      - "慢慢呼气，数 8 秒..."
      - "1... 2... 3... 4... 5... 6... 7... 8..."
      - ""
      - "很好，再来一次..."
      - ""
      - "吸气 4 秒..."
      - "..."
      - "屏住 7 秒..."
      - "..."
      - "呼气 8 秒..."
      - "..."
      - ""
      - "最后一次..."
      - ""
      - "感受身体的变化..."
      - "平静正在到来。"

  stop:
    name: STOP急救
    duration: 1分钟
    steps:
      - "**S - Stop**"
      - "停下来。"
      - "不说话，不行动。"
      - "就在这里。"
      - ""
      - "**T - Take a breath**"
      - "深呼吸..."
      - "..."
      - "再一次..."
      - "..."
      - "第三次..."
      - "..."
      - ""
      - "**O - Observe**"
      - "我现在感觉怎样？"
      - "身体哪里紧？"
      - "..."
      - ""
      - "**P - Proceed**"
      - "我真正想要的是什么？"
      - "..."
      - ""
      - "好了，你可以继续了。"
      - "带着觉察。"

  body_scan:
    name: 身体扫描
    duration: 3分钟
    steps:
      - "找到舒服的姿势..."
      - "可以坐着或躺着..."
      - ""
      - "注意你的头顶..."
      - "放松..."
      - "..."
      - ""
      - "注意你的面部..."
      - "眼睛、下巴..."
      - "放松..."
      - "..."
      - ""
      - "注意你的肩膀..."
      - "让它们往下沉..."
      - "..."
      - ""
      - "注意你的双手..."
      - "手指、手掌..."
      - "放松..."
      - "..."
      - ""
      - "注意你的腹部..."
      - "感受呼吸的起伏..."
      - "..."
      - ""
      - "注意你的双腿..."
      - "大腿、小腿..."
      - "放松..."
      - "..."
      - ""
      - "注意你的双脚..."
      - "脚趾、脚掌..."
      - "放松..."
      - "..."
      - ""
      - "现在感受整个身体..."
      - "从头到脚..."
      - "完整、放松。"

  morning:
    name: 晨间意图
    duration: 3分钟
    steps:
      - "早安..."
      - ""
      - "三次深呼吸..."
      - "感受自己醒来..."
      - "..."
      - ""
      - "**感恩**"
      - "今天，我感谢____"
      - "（可以是任何小事）"
      - "..."
      - ""
      - "**意图**"
      - "今天，我想____"
      - "（只需要一个小目标）"
      - "..."
      - ""
      - "**放下**"
      - "今天，我放下____"
      - "（一个不需要的念头）"
      - "..."
      - ""
      - "深呼吸..."
      - "开始这一天。"

  focus:
    name: 专注启动
    duration: 2分钟
    steps:
      - "准备开始工作了..."
      - ""
      - "先清空桌面..."
      - "关闭无关页面..."
      - "..."
      - ""
      - "三次深呼吸..."
      - "吸气... 呼气..."
      - "..."
      - ""
      - "明确一下："
      - "接下来这段时间..."
      - "我只做____"
      - "..."
      - ""
      - "其他的，可以等一等。"
      - ""
      - "好，开始吧。"

  sleep:
    name: 睡前放松
    duration: 5-10分钟
    steps:
      - "躺下来..."
      - "找到最舒服的姿势..."
      - "闭上眼睛..."
      - ""
      - "今天发生了很多事..."
      - "不需要分析..."
      - "只是观察..."
      - "像看电影一样..."
      - "..."
      - ""
      - "有什么还在心里？"
      - "..."
      - "把它放进一个盒子..."
      - "明天再处理..."
      - "..."
      - ""
      - "现在开始放松身体..."
      - ""
      - "头顶... 放松..."
      - "..."
      - "面部... 放松..."
      - "..."
      - "肩膀... 往下沉..."
      - "..."
      - "双手... 放松..."
      - "..."
      - "腹部... 放松..."
      - "..."
      - "双腿... 放松..."
      - "..."
      - "双脚... 放松..."
      - "..."
      - ""
      - "整个身体..."
      - "越来越沉..."
      - "越来越轻..."
      - "..."
      - ""
      - "呼吸渐慢..."
      - "..."
      - "渐慢..."
      - "..."
      - ""
      - "晚安。"

  rain:
    name: RAIN情绪处理
    duration: 5-10分钟
    steps:
      - "我知道你现在不太好受..."
      - "让我们一起面对它..."
      - ""
      - "**R - Recognize（认出）**"
      - ""
      - "我现在感受到的是____"
      - "是愤怒？悲伤？恐惧？"
      - "还是其他什么？"
      - "..."
      - "给它一个名字..."
      - "..."
      - ""
      - "**A - Allow（允许）**"
      - ""
      - "这个感受可以在这里。"
      - "不需要推开它..."
      - "也不需要抓紧它..."
      - "它只是在这里..."
      - "..."
      - ""
      - "**I - Investigate（探索）**"
      - ""
      - "它在身体哪里？"
      - "胸口？喉咙？肚子？"
      - "..."
      - "什么形状？"
      - "什么颜色？"
      - "..."
      - "如果它能说话..."
      - "它想说什么？"
      - "..."
      - ""
      - "**N - Non-identification（不等同）**"
      - ""
      - "我有这个情绪..."
      - "但我不是这个情绪。"
      - ""
      - "它会来..."
      - "也会走..."
      - "我还是我。"
      - "..."
      - ""
      - "深呼吸..."
      - "..."
      - "感谢自己愿意面对..."
      - "这本身就是勇气。"

  integration:
    name: 整合练习
    duration: 2分钟
    context: 专家收尾
    steps:
      - "刚才聊了很多..."
      - "让这些内容沉淀一下..."
      - ""
      - "深呼吸..."
      - "..."
      - ""
      - "不需要马上理解所有..."
      - "有些洞察需要时间..."
      - "..."
      - ""
      - "再深呼吸..."
      - "..."
      - ""
      - "把最重要的一点..."
      - "放在心里..."
      - "..."
      - ""
      - "好了..."
      - "带着这份觉察继续。"
