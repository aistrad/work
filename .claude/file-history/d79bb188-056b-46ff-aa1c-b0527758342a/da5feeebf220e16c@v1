# 正念提醒配置
# 定义主动推送的时间和内容

version: "1.0"
skill_id: mindfulness

# ═══════════════════════════════════════════════════════════════════════════
# 定时提醒
# ═══════════════════════════════════════════════════════════════════════════
scheduled_reminders:

  morning_mindfulness:
    name: 晨间正念
    trigger_type: time
    schedule: "07:30"
    schedule_type: daily
    time_window: "07:00-09:00"

    content:
      title: "晨间正念"
      body: "早安，用 3 分钟正念开始这一天？"

    options:
      - label: "开始练习"
        action:
          type: start_session
          practice_type: morning
      - label: "稍后提醒"
        action:
          type: snooze
          minutes: 30
      - label: "今天跳过"
        action:
          type: skip_today

    conditions:
      - user_has_enabled_morning_reminder: true
      - not_already_practiced_today: morning

  evening_relaxation:
    name: 睡前放松
    trigger_type: time
    schedule: "22:00"
    schedule_type: daily
    time_window: "21:00-23:00"

    content:
      title: "睡前放松"
      body: "睡前放松一下？帮你更好入睡"

    options:
      - label: "5分钟放松"
        action:
          type: start_session
          practice_type: sleep
          duration: 5
      - label: "10分钟深度"
        action:
          type: start_session
          practice_type: sleep
          duration: 10
      - label: "今天跳过"
        action:
          type: skip_today

    conditions:
      - user_has_enabled_evening_reminder: true
      - not_already_practiced_today: sleep

# ═══════════════════════════════════════════════════════════════════════════
# 情绪触发提醒
# ═══════════════════════════════════════════════════════════════════════════
emotion_triggers:

  anxiety_detected:
    name: 焦虑检测
    trigger_type: emotion
    emotion: anxiety
    keywords:
      - 焦虑
      - 着急
      - 担心
      - 紧张
      - 不安
      - 慌

    content:
      body: |
        感觉你有点焦虑，要不要先做个 1 分钟呼吸？
        有时候，停下来比冲过去更快。

    options:
      - label: "好的"
        action:
          type: start_session
          practice_type: stop
      - label: "继续聊"
        action:
          type: dismiss

  anger_detected:
    name: 愤怒检测
    trigger_type: emotion
    emotion: anger
    keywords:
      - 生气
      - 愤怒
      - 火大
      - 气死
      - 烦
      - 讨厌

    content:
      body: |
        我理解你很生气。
        在继续之前，要不要先用 STOP 让自己平静一下？
        这样你的决定会更清醒。

    options:
      - label: "试试 STOP"
        action:
          type: start_session
          practice_type: stop
      - label: "继续聊"
        action:
          type: dismiss

  sadness_detected:
    name: 悲伤检测
    trigger_type: emotion
    emotion: sadness
    keywords:
      - 难过
      - 悲伤
      - 想哭
      - 心痛
      - 失落
      - 委屈

    content:
      body: |
        我感受到你现在不太好受...
        要不要用 RAIN 练习来处理这个情绪？

    options:
      - label: "好的"
        action:
          type: start_session
          practice_type: rain
      - label: "现在不想"
        action:
          type: dismiss

  overwhelm_detected:
    name: 压力过载检测
    trigger_type: emotion
    emotion: overwhelm
    keywords:
      - 崩溃
      - 受不了
      - 太多了
      - 压力大
      - 喘不过气

    content:
      body: |
        一次处理这么多确实很难...
        先做个 1 分钟 STOP，让自己喘口气？

    options:
      - label: "好的"
        action:
          type: start_session
          practice_type: stop
      - label: "继续聊"
        action:
          type: dismiss

# ═══════════════════════════════════════════════════════════════════════════
# 专家联动触发
# ═══════════════════════════════════════════════════════════════════════════
expert_handoff:

  bazi_completion:
    name: 八字对话收尾
    trigger_type: skill_completion
    preceding_skill: bazi

    conditions:
      - session_depth: ">= 3"  # 对话超过3轮
      - topic_depth: deep      # 话题深度较深

    content:
      body: |
        刚才聊了很多关于命理的内容，
        要不要用 2 分钟正念，让这些洞察沉淀一下？

    options:
      - label: "好的"
        action:
          type: start_session
          practice_type: integration
          context:
            preceding_skill: bazi
      - label: "不用了"
        action:
          type: dismiss

  zodiac_completion:
    name: 星座对话收尾
    trigger_type: skill_completion
    preceding_skill: zodiac

    conditions:
      - session_depth: ">= 3"

    content:
      body: |
        刚才聊了很多关于星象的内容，
        要不要用 2 分钟正念，让这些洞察沉淀一下？

    options:
      - label: "好的"
        action:
          type: start_session
          practice_type: integration
          context:
            preceding_skill: zodiac
      - label: "不用了"
        action:
          type: dismiss

  tarot_completion:
    name: 塔罗对话收尾
    trigger_type: skill_completion
    preceding_skill: tarot

    conditions:
      - cards_drawn: ">= 1"  # 抽了牌

    content:
      body: |
        让这张牌的信息沉淀一下，
        做 2 分钟冥想？

    options:
      - label: "好的"
        action:
          type: start_session
          practice_type: integration
          context:
            preceding_skill: tarot
      - label: "不用了"
        action:
          type: dismiss

  career_completion:
    name: 职业对话收尾
    trigger_type: skill_completion
    preceding_skill: career

    conditions:
      - session_depth: ">= 3"

    content:
      body: |
        规划了这么多，
        用 1 分钟呼吸，给自己一点空间消化？

    options:
      - label: "好的"
        action:
          type: start_session
          practice_type: breathing
          duration: 1
          context:
            preceding_skill: career
      - label: "不用了"
        action:
          type: dismiss

# ═══════════════════════════════════════════════════════════════════════════
# 里程碑庆祝
# ═══════════════════════════════════════════════════════════════════════════
milestone_celebrations:

  streak_3:
    trigger: streak_days == 3
    content:
      title: "连续 3 天"
      body: "连续 3 天打卡，习惯正在形成！"

  streak_7:
    trigger: streak_days == 7
    content:
      title: "一周坚持"
      body: "一周坚持！你已经超越了 80% 的人。"

  streak_14:
    trigger: streak_days == 14
    content:
      title: "两周了"
      body: "两周了！这个习惯已经生根发芽。"

  streak_21:
    trigger: streak_days == 21
    content:
      title: "21天里程碑"
      body: "21 天，心理学上的习惯养成点！"

  streak_30:
    trigger: streak_days == 30
    content:
      title: "一个月"
      body: "一个月！你已经是正念达人了！"

  total_100_minutes:
    trigger: total_minutes >= 100
    content:
      title: "100 分钟"
      body: "累计练习 100 分钟！感受到变化了吗？"

  total_30_sessions:
    trigger: total_sessions >= 30
    content:
      title: "30 次练习"
      body: "完成 30 次练习！正念已经成为你生活的一部分。"

# ═══════════════════════════════════════════════════════════════════════════
# 默认用户偏好
# ═══════════════════════════════════════════════════════════════════════════
default_preferences:
  morning_reminder_enabled: true
  morning_reminder_time: "07:30"
  evening_reminder_enabled: true
  evening_reminder_time: "22:00"
  emotion_detect_enabled: true
  expert_handoff_enabled: true
  preferred_duration: 3  # 默认练习时长（分钟）
