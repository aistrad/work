# Vibe Profile Schema v2.0
# Agent-Native, LLM readable schema definition
# All data is written by LLM through save tool

version: "2.0"
description: "User profile data structure, written by LLM via save tool"

schema:
  vibe:
    # ═══════════════════════════════════════════════════════════════════════════
    # Layer 1: profile - Stable identity (changes slowly)
    # ═══════════════════════════════════════════════════════════════════════════
    profile:
      description: "Stable user profile (changes slowly)"
      fields:
        identity:
          archetypes:
            type: array
            items: string
            max_items: 3
            description: "Personality archetypes, max 3"
            example: ["Explorer", "Creator", "Sage"]
          traits:
            type: array
            items: string
            max_items: 5
            description: "Core traits, max 5"
            example: ["analytical", "empathetic", "curious"]
          style:
            type: string
            description: "Communication style"
            enum: ["direct", "warm", "rational", "emotional"]
        context:
          occupation:
            type: string
            description: "Current occupation"
            example: "Product Designer"
          life_stage:
            type: string
            enum:
              - student
              - early_career
              - growth
              - peak
              - transition
            description: "Life stage"
          interests:
            type: array
            items: string
            max_items: 10
            description: "Areas of interest"
            example: ["AI", "travel", "reading"]

    # ═══════════════════════════════════════════════════════════════════════════
    # Layer 2: state - Current state (changes frequently)
    # ═══════════════════════════════════════════════════════════════════════════
    state:
      description: "Current state (real-time changes)"
      fields:
        emotion:
          type: string
          enum:
            - anxious
            - sad
            - neutral
            - content
            - excited
            - focused
          description: "Current emotional state"
        energy:
          type: string
          enum:
            - low
            - medium
            - high
          description: "Energy level"
        focus:
          type: array
          items: string
          max_items: 3
          description: "Currently focused topics"
          example: ["career transition", "relationship"]

    # ═══════════════════════════════════════════════════════════════════════════
    # Layer 3: goals - User goals
    # ═══════════════════════════════════════════════════════════════════════════
    goals:
      description: "User goals list"
      type: array
      max_items: 10
      item_schema:
        title:
          type: string
          required: true
          description: "Goal title"
        category:
          type: string
          enum:
            - career
            - health
            - relationship
            - wealth
            - growth
          description: "Goal category"
        status:
          type: string
          enum:
            - active
            - paused
            - completed
          default: active
          description: "Goal status"

    # ═══════════════════════════════════════════════════════════════════════════
    # Layer 4: timeline - Important events (append-only storage)
    # ═══════════════════════════════════════════════════════════════════════════
    timeline:
      description: "Important events (append-only)"
      type: array
      max_items: 100
      item_schema:
        date:
          type: date
          format: "YYYY-MM-DD"
          description: "Event date"
        type:
          type: string
          enum:
            - goal
            - decision
            - milestone
            - life_event
          description: "Event type"
        event:
          type: string
          required: true
          description: "Event description"

# ═══════════════════════════════════════════════════════════════════════════
# Save Path Rules
# ═══════════════════════════════════════════════════════════════════════════
save_paths:
  allowed:
    # Profile paths (stable identity)
    - "vibe.profile.identity.archetypes"
    - "vibe.profile.identity.traits"
    - "vibe.profile.identity.style"
    - "vibe.profile.context.occupation"
    - "vibe.profile.context.life_stage"
    - "vibe.profile.context.interests"
    # State paths (current state)
    - "vibe.state.emotion"
    - "vibe.state.energy"
    - "vibe.state.focus"
    # Goals path
    - "vibe.goals"
    # Timeline path (append-only)
    - "vibe.timeline"

  strategies:
    "vibe.profile.*": "merge"      # Merge updates
    "vibe.state.*": "overwrite"    # Overwrite current state
    "vibe.goals": "merge_by_title" # Merge by title field
    "vibe.timeline": "append"      # Append only, never overwrite
