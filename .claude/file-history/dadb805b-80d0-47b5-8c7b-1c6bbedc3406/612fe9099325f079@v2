"use client";

import { useParams, useRouter } from "next/navigation";
import { ChatLayout } from "@/components/chat/ChatLayout";
import { ChatContainer } from "@/components/chat/ChatContainer";
import { type SkillType } from "@/components/core";

const SKILL_CONFIG: Record<string, { name: string; backHref: string; profileHref: string }> = {
  bazi: { name: "八字命理", backHref: "/bazi", profileHref: "/bazi/profile" },
  zodiac: { name: "星座占星", backHref: "/zodiac", profileHref: "/zodiac/profile" },
  mbti: { name: "MBTI 性格", backHref: "/mbti", profileHref: "/mbti/profile" },
  attach: { name: "依恋模式", backHref: "/attach", profileHref: "/attach/profile" },
  career: { name: "职业规划", backHref: "/career", profileHref: "/career/profile" },
};

export default function ChatPage() {
  const params = useParams();
  const router = useRouter();
  const skillId = params.skillId as string;

  // Determine skill type with fallback
  const isValidSkill = skillId in SKILL_CONFIG;
  const skill: SkillType = isValidSkill ? (skillId as SkillType) : "bazi";

  const config = SKILL_CONFIG[skillId] || {
    name: skillId,
    backHref: "/",
    profileHref: "/",
  };

  return (
    <ChatLayout
      skill={skill}
      title={config.name}
      backHref={config.backHref}
      onViewProfile={() => router.push(config.profileHref)}
    >
      <ChatContainer skillId={skillId} skill={skill} />
    </ChatLayout>
  );
}
