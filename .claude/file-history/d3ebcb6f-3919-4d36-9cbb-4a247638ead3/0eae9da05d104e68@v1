/**
 * ArchetypeBadge - 原型徽章组件
 *
 * 基于前端规范 v7.1 - Linear 风格
 * v5.3: 使用 CSS 动画替代 Framer Motion (Vercel rule: rerender-animation-library)
 */

'use client'

import { memo } from 'react'
import { cn } from '@/lib/utils'
import type { ArchetypeType, DimensionId } from '@/types/vibe-id'
import { getArchetypeMeta, getArchetypeColor, DIMENSION_META } from '@/types/vibe-id'

interface ArchetypeBadgeProps {
  archetypeId: ArchetypeType
  dimension?: DimensionId
  size?: 'sm' | 'md' | 'lg'
  showLabel?: boolean
  showDimension?: boolean
  interactive?: boolean
  className?: string
  onClick?: () => void
}

const SIZE_CLASSES = {
  sm: 'w-10 h-10 text-lg',
  md: 'w-14 h-14 text-2xl',
  lg: 'w-20 h-20 text-4xl',
}

/**
 * 原型徽章组件
 * 显示原型的 emoji 和可选的标签
 */
export const ArchetypeBadge = memo(function ArchetypeBadge({
  archetypeId,
  dimension,
  size = 'md',
  showLabel = false,
  showDimension = false,
  interactive = false,
  className,
  onClick,
}: ArchetypeBadgeProps) {
  const meta = getArchetypeMeta(archetypeId)
  const color = getArchetypeColor(archetypeId)

  return (
    <div
      className={cn(
        'flex flex-col items-center gap-1',
        interactive && 'cursor-pointer transition-transform hover:scale-105 active:scale-95',
        className
      )}
      onClick={onClick}
    >
      {/* Badge circle */}
      <div
        className={cn(
          'rounded-full flex items-center justify-center',
          'shadow-sm transition-shadow hover:shadow-md',
          SIZE_CLASSES[size]
        )}
        style={{
          background: `linear-gradient(135deg, ${color}20 0%, ${color}10 100%)`,
          border: `2px solid ${color}30`,
        }}
      >
        <span role="img" aria-label={meta.name}>
          {meta.emoji}
        </span>
      </div>

      {/* Dimension label */}
      {showDimension && dimension && (
        <span className="text-xs text-ink-400 font-medium">
          {DIMENSION_LABELS[dimension].label}
        </span>
      )}

      {/* Archetype name */}
      {showLabel && (
        <span className="text-sm text-ink-700 font-medium">
          {meta.name}
        </span>
      )}
    </div>
  )
})

export default ArchetypeBadge
