# Skill Schema 定义

> 定义案例的数据结构，包括通用字段和 Skill 特定字段。

---

## 通用字段 (所有 Skill 共享)

以下字段是所有 Skill 案例都必须包含的通用结构：

### thinking_frameworks_used

标注该案例使用了哪些思维架构，用于 Scenario-Case 匹配。

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| thinking_frameworks_used | array[string] | 使用的思维架构列表 | ["客体思维架构", "时运思维架构"] |

### reasoning_chain

专家的推理链条，记录从观察到结论的完整思维过程。

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| step | int | 步骤序号 | 1, 2, 3... |
| framework | string | 使用的思维架构 | "客体思维架构" |
| observation | string | 观察到的特征/现象 | "劫财辛金透出于年柱" |
| analysis | string | 分析推理过程 | "劫财被正官丁火克制" |
| conclusion | string | 该步骤的结论 | "劫财弱势，反衬比肩强势" |

**示例**:
```json
{
  "reasoning_chain": [
    {
      "step": 1,
      "framework": "客体思维架构",
      "observation": "劫财辛金透出于年柱",
      "analysis": "劫财被正官丁火克制，力量被削弱",
      "conclusion": "劫财弱势，反衬比肩特质强势"
    },
    {
      "step": 2,
      "framework": "柱位思维架构",
      "observation": "劫财位于年柱",
      "analysis": "年柱代表童年时期和祖辈宫位",
      "conclusion": "童年期会有贵人相助的机遇"
    }
  ]
}
```

### guidance_patterns

可复用的指导模式，这是专家系统的核心价值。

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| pattern_name | string | 模式名称 | "劫弱反补法" |
| condition | string | 适用条件 | "劫财被克弱时" |
| advice | string | 具体建议 | "不宜合伙，适合独立发展" |
| source | string | 来源依据 | "正偏转换理论" |

**示例**:
```json
{
  "guidance_patterns": [
    {
      "pattern_name": "劫弱反补法",
      "condition": "劫财被克弱时",
      "advice": "不宜合伙创业，适合独立发展或寻求贵人扶持",
      "source": "正偏转换理论"
    },
    {
      "pattern_name": "官杀混杂调和法",
      "condition": "正官与七杀同时出现时",
      "advice": "宜从事需要两面手段的工作，如管理+技术复合岗",
      "source": "十神调和理论"
    }
  ]
}
```

### 完整案例结构

```json
{
  "id": "CASE_bazi_001",
  "skill_id": "bazi",
  "name": "乾隆皇帝八字分析",

  "core_data": { "...Skill特定..." },
  "features": { "...Skill特定..." },

  "thinking_frameworks_used": ["客体思维架构", "柱位思维架构", "正偏思维架构"],

  "reasoning_chain": [
    { "step": 1, "framework": "...", "observation": "...", "analysis": "...", "conclusion": "..." }
  ],

  "guidance_patterns": [
    { "pattern_name": "...", "condition": "...", "advice": "...", "source": "..." }
  ],

  "tags": ["事业", "贵人"],
  "scenario_ids": ["basic_reading", "career"]
}
```

---

## Skill 特定字段

以下是各 Skill 特有的 core_data 和 features 结构。

---

## Bazi (八字命理)

### core_data

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| year | string | 年柱 | "甲子" |
| month | string | 月柱 | "乙丑" |
| day | string | 日柱 | "丙寅" |
| hour | string | 时柱 | "丁卯" |
| gender | string | 性别 | "男" / "女" |

### features

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| daymaster | string | 日主 | "甲木", "丙火" |
| strength | string | 身强/身弱 | "身强", "身弱", "中和" |
| pattern | string | 格局 | "正官格", "食神格" |
| key_gods | array | 关键十神 | ["正官", "正印", "食神"] |

### 常用标签

```
事业, 财运, 婚姻, 感情, 健康, 学业, 子女, 父母, 兄弟, 朋友,
官运, 创业, 投资, 合作, 变动, 桃花, 贵人, 小人, 意外, 疾病
```

---

## Zodiac (西方占星)

### core_data

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| sun_sign | string | 太阳星座 | "白羊座" |
| moon_sign | string | 月亮星座 | "巨蟹座" |
| rising_sign | string | 上升星座 | "天蝎座" |
| birth_chart | string | 星盘配置摘要 | "火象主导，T三角格局" |

### features

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| dominant_element | string | 主导元素 | "火", "土", "风", "水" |
| dominant_modality | string | 主导模式 | "基本", "固定", "变动" |
| key_aspects | array | 关键相位 | ["日月合相", "金火刑"] |
| stellium | string | 星群 | "第十宫星群" |

### 常用标签

```
事业, 感情, 财运, 健康, 人际, 家庭, 学业, 旅行, 创意, 灵性,
太阳回归, 行运, 推运, 合盘, 本命, 流年, 流月
```

---

## Tarot (塔罗占卜)

### core_data

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| spread_type | string | 牌阵类型 | "凯尔特十字", "三牌阵" |
| cards | array | 抽到的牌 | ["愚者正位", "女祭司逆位"] |
| question | string | 问题类型 | "感情", "事业", "决策" |

### features

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| major_count | integer | 大牌数量 | 3 |
| dominant_suit | string | 主导花色 | "圣杯", "权杖" |
| reversed_count | integer | 逆位数量 | 2 |
| key_cards | array | 关键牌 | ["塔", "命运之轮"] |

### 常用标签

```
感情, 事业, 财运, 决策, 时机, 人际, 健康, 灵性, 过去, 现在, 未来,
大阿卡纳, 小阿卡纳, 宫廷牌, 正位, 逆位
```

---

## Career (职业规划)

### core_data

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| background | string | 职业背景 | "5年互联网产品经理" |
| current_role | string | 当前职位 | "高级产品经理" |
| challenge | string | 面临挑战 | "职业瓶颈，考虑转型" |

### features

| 字段 | 类型 | 说明 | 示例 |
|------|------|------|------|
| industry | string | 行业 | "互联网", "金融", "教育" |
| career_stage | string | 职业阶段 | "探索期", "建立期", "维持期" |
| key_skills | array | 核心技能 | ["产品设计", "数据分析"] |
| goals | string | 职业目标 | "3年内成为产品总监" |

### 常用标签

```
转型, 晋升, 跳槽, 创业, 副业, 技能提升, 人际关系, 工作压力,
职业规划, 面试, 薪资谈判, 团队管理, 领导力, 职业倦怠
```

---

## Python Schema 定义

```python
# 通用案例字段 (所有 Skill 共享)
COMMON_CASE_FIELDS = {
    "thinking_frameworks_used": {
        "type": "array",
        "items": "string",
        "description": "使用的思维架构列表，用于 Scenario-Case 匹配"
    },
    "reasoning_chain": {
        "type": "array",
        "description": "专家推理链条",
        "items": {
            "step": "int",
            "framework": "string",
            "observation": "string",
            "analysis": "string",
            "conclusion": "string"
        }
    },
    "guidance_patterns": {
        "type": "array",
        "description": "可复用的指导模式",
        "items": {
            "pattern_name": "string",
            "condition": "string",
            "advice": "string",
            "source": "string"
        }
    }
}

# Skill 特定字段
SKILL_SCHEMAS = {
    "bazi": {
        "core_data": {
            "year": "年柱 (如: 甲子)",
            "month": "月柱",
            "day": "日柱",
            "hour": "时柱",
            "gender": "性别 (男/女)",
        },
        "features": {
            "daymaster": "日主 (如: 甲木)",
            "strength": "身强/身弱",
            "pattern": "格局 (如: 正官格)",
            "key_gods": "关键十神 (数组)",
        },
    },
    "zodiac": {
        "core_data": {
            "sun_sign": "太阳星座",
            "moon_sign": "月亮星座",
            "rising_sign": "上升星座",
            "birth_chart": "星盘配置摘要",
        },
        "features": {
            "dominant_element": "主导元素",
            "dominant_modality": "主导模式",
            "key_aspects": "关键相位",
            "stellium": "星群 (如有)",
        },
    },
    "tarot": {
        "core_data": {
            "spread_type": "牌阵类型",
            "cards": "抽到的牌 (数组)",
            "question": "问题类型",
        },
        "features": {
            "major_count": "大牌数量",
            "dominant_suit": "主导花色",
            "reversed_count": "逆位数量",
            "key_cards": "关键牌",
        },
    },
    "career": {
        "core_data": {
            "background": "职业背景",
            "current_role": "当前职位",
            "challenge": "面临挑战",
        },
        "features": {
            "industry": "行业",
            "career_stage": "职业阶段",
            "key_skills": "核心技能",
            "goals": "职业目标",
        },
    },
}
```
