# Dashboard æ•°æ®æµè®¾è®¡

> **Version**: 2.0 | 2026-01-19
> **å…³è”æ–‡æ¡£**: DESIGN.md, COMPONENTS.md

---

## æ•°æ®æºæ˜ å°„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Dashboard æ•°æ®æºå…¨æ™¯ v2.0                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   Dashboard                    æ•°æ®æº                       å­˜å‚¨ä½ç½®             â”‚
â”‚   â•â•â•â•â•â•â•â•â•                    â•â•â•â•â•                        â•â•â•â•â•               â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚   â”‚ Ambient     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ ç³»ç»Ÿæ—¶é—´ + èŠ‚æ°” API â”€â”€â”€â”€â”€â”€â”€â”€â–¶ å®žæ—¶è®¡ç®—           â”‚
â”‚   â”‚ Header      â”‚              Quote Library â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ static/quotes.ts   â”‚
â”‚   â”‚             â”‚              ç”¨æˆ·åå¥½ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ preferences       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              Check-in çŠ¶æ€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ life_context       â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚   â”‚ Lifecoach   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ North Star â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ life_context       â”‚
â”‚   â”‚ Card        â”‚              (vision, yearGoal)            ._paths.lifecoach  â”‚
â”‚   â”‚ (Unified)   â”‚                                            .north_star        â”‚
â”‚   â”‚             â”‚              Monthly Project â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ .current.month    â”‚
â”‚   â”‚             â”‚              (name, progress, days)        .roadmap           â”‚
â”‚   â”‚             â”‚                                                               â”‚
â”‚   â”‚             â”‚              Today Levers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ .current.daily    â”‚
â”‚   â”‚             â”‚              (3 levers, streak)            .progress          â”‚
â”‚   â”‚             â”‚                                                               â”‚
â”‚   â”‚             â”‚              Week Rocks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ .current.week     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              (rocks, roles)                .goals             â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚   â”‚ My Skills   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ Subscribed Skills â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ user_skills       â”‚
â”‚   â”‚ Carousel    â”‚              (skill_id list)               table              â”‚
â”‚   â”‚             â”‚                                                               â”‚
â”‚   â”‚             â”‚              Proactive Engine â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ skill_cards        â”‚
â”‚   â”‚             â”‚              (computed content)            cache / realtime   â”‚
â”‚   â”‚             â”‚                                                               â”‚
â”‚   â”‚             â”‚              Skill Card Registry â”€â”€â”€â”€â”€â”€â”€â”€â–¶ skill_registry     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              (metadata, endpoints)         table              â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚   â”‚ Discover    â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ All Skills - Subscribed â”€â”€â”€â”€â–¶ skill_registry    â”‚
â”‚   â”‚ Carousel    â”‚              (unsubscribed list)           table              â”‚
â”‚   â”‚             â”‚                                                               â”‚
â”‚   â”‚             â”‚              Recommendation Engine â”€â”€â”€â”€â”€â”€â–¶ ML / Rules         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              (personalized ranking)                           â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Skill æ•°æ®æµæ ¸å¿ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Skill Card æ•°æ®æµ                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   1. Skill æ³¨å†Œ (ç³»ç»Ÿå¯åŠ¨æ—¶)                                                     â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                      â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   skills/                                                               â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ bazi/                                                            â”‚   â”‚
â”‚   â”‚   â”‚   â”œâ”€â”€ SKILL.md                                                     â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ cards/                                                       â”‚   â”‚
â”‚   â”‚   â”‚       â””â”€â”€ daily_fortune.yaml   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ zodiac/                                       â”‚                  â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€â”€ cards/                                    â”‚                  â”‚   â”‚
â”‚   â”‚   â”‚       â””â”€â”€ weekly_horoscope.yaml â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚   â”‚
â”‚   â”‚   â””â”€â”€ jungian/                                      â”‚                  â”‚   â”‚
â”‚   â”‚       â””â”€â”€ cards/                                    â–¼                  â”‚   â”‚
â”‚   â”‚           â””â”€â”€ archetype_insight.yaml â”€â”€â”€â”€â”€â”€â–¶ skill_registry           â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                                  â”‚
â”‚   2. ç”¨æˆ·è®¢é˜…                                                                    â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•                                                                    â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   POST /api/skills/subscribe                                            â”‚   â”‚
â”‚   â”‚   { "skill_id": "jungian" }                                            â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚        â”‚                                                                â”‚   â”‚
â”‚   â”‚        â–¼                                                                â”‚   â”‚
â”‚   â”‚   user_skills table                                                     â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚   â”‚ user_id      â”‚ skill_id    â”‚ subscribed_at     â”‚ config       â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚   â”‚   â”‚ user_123     â”‚ bazi        â”‚ 2026-01-01        â”‚ {}           â”‚   â”‚   â”‚
â”‚   â”‚   â”‚ user_123     â”‚ jungian     â”‚ 2026-01-19        â”‚ {}           â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                                  â”‚
â”‚   3. Proactive Engine è®¡ç®—                                                       â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                       â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   è§¦å‘å™¨:                                                                â”‚   â”‚
â”‚   â”‚   - å®šæ—¶ä»»åŠ¡ (daily/weekly)                                             â”‚   â”‚
â”‚   â”‚   - ç”¨æˆ·è¯·æ±‚ Dashboard                                                  â”‚   â”‚
â”‚   â”‚   - å¤–éƒ¨äº‹ä»¶ (èŠ‚æ°”å˜åŒ–ç­‰)                                               â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚        â”‚                                                                â”‚   â”‚
â”‚   â”‚        â–¼                                                                â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚   â”‚   â”‚                     Proactive Engine                             â”‚ â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚ â”‚   â”‚
â”‚   â”‚   â”‚   for skill in user.subscribed_skills:                          â”‚ â”‚   â”‚
â”‚   â”‚   â”‚       card_def = skill_registry.get_card(skill.card_id)         â”‚ â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚ â”‚   â”‚
â”‚   â”‚   â”‚       if should_refresh(card_def.refresh):                      â”‚ â”‚   â”‚
â”‚   â”‚   â”‚           content = await compute_card_content(                 â”‚ â”‚   â”‚
â”‚   â”‚   â”‚               skill_id=skill.id,                                â”‚ â”‚   â”‚
â”‚   â”‚   â”‚               user_profile=user.profile,                        â”‚ â”‚   â”‚
â”‚   â”‚   â”‚               context=current_context                           â”‚ â”‚   â”‚
â”‚   â”‚   â”‚           )                                                     â”‚ â”‚   â”‚
â”‚   â”‚   â”‚           cache.set(f"card:{user.id}:{skill.card_id}", content) â”‚ â”‚   â”‚
â”‚   â”‚   â”‚                                                                  â”‚ â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚   â”‚        â”‚                                                                â”‚   â”‚
â”‚   â”‚        â–¼                                                                â”‚   â”‚
â”‚   â”‚   skill_cards cache                                                     â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚   â”‚ key                              â”‚ content          â”‚ ttl      â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚   â”‚   â”‚ card:user_123:bazi_daily         â”‚ { ... }          â”‚ 24h      â”‚   â”‚   â”‚
â”‚   â”‚   â”‚ card:user_123:jungian_insight    â”‚ { ... }          â”‚ 7d       â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## èšåˆ API è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Dashboard èšåˆ API v2.0                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   GET /api/dashboard                                                             â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                            â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   async def get_dashboard(user_id: str) -> DashboardDTO:                â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚       # 1. å¹¶è¡ŒèŽ·å–åŸºç¡€æ•°æ®                                              â”‚   â”‚
â”‚   â”‚       profile, lifecoach, subscriptions = await asyncio.gather(         â”‚   â”‚
â”‚   â”‚           vibe_profile_repo.get_profile(user_id),                       â”‚   â”‚
â”‚   â”‚           lifecoach_service.get_state(user_id),                         â”‚   â”‚
â”‚   â”‚           skill_service.get_subscriptions(user_id)                      â”‚   â”‚
â”‚   â”‚       )                                                                 â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚       # 2. èŽ·å– Skill Cards (å·²è®¡ç®—çš„å†…å®¹)                               â”‚   â”‚
â”‚   â”‚       my_skills = await proactive_engine.get_skill_cards(               â”‚   â”‚
â”‚   â”‚           user_id=user_id,                                              â”‚   â”‚
â”‚   â”‚           skill_ids=subscriptions.skill_ids                             â”‚   â”‚
â”‚   â”‚       )                                                                 â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚       # 3. èŽ·å– Discover æŽ¨è                                            â”‚   â”‚
â”‚   â”‚       discover = await recommendation_service.get_skills(               â”‚   â”‚
â”‚   â”‚           user_id=user_id,                                              â”‚   â”‚
â”‚   â”‚           exclude=subscriptions.skill_ids,                              â”‚   â”‚
â”‚   â”‚           limit=10                                                      â”‚   â”‚
â”‚   â”‚       )                                                                 â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚       # 4. ç»„è£… DTO                                                      â”‚   â”‚
â”‚   â”‚       return DashboardDTO(                                              â”‚   â”‚
â”‚   â”‚           ambient=build_ambient(profile),                               â”‚   â”‚
â”‚   â”‚           status=build_status(lifecoach),                               â”‚   â”‚
â”‚   â”‚           lifecoach=build_lifecoach(lifecoach),                         â”‚   â”‚
â”‚   â”‚           mySkills=my_skills,                                           â”‚   â”‚
â”‚   â”‚           discover=discover                                             â”‚   â”‚
â”‚   â”‚       )                                                                 â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API è§„æ ¼è¯¦ç»†

### GET /api/dashboard

```typescript
// è¯·æ±‚
GET /api/dashboard
Headers:
  Authorization: Bearer {token}

// å“åº”
{
  "success": true,
  "data": {
    "userId": "user_123",
    "generatedAt": "2026-01-19T08:00:00Z",

    "ambient": {
      "greeting": "æ—©å®‰ï¼Œå°è–‡",
      "quote": {
        "text": "æ¯ä¸€ä¸ªä¸æ›¾èµ·èˆžçš„æ—¥å­ï¼Œéƒ½æ˜¯å¯¹ç”Ÿå‘½çš„è¾œè´Ÿã€‚",
        "author": "å°¼é‡‡",
        "category": "growth"
      },
      "date": "2026å¹´1æœˆ19æ—¥ å‘¨æ—¥",
      "solarTerm": "å°å¯’ç¬¬ä¸‰å€™"
    },

    "status": {
      "streak": 7,
      "checkedIn": false,
      "energy": "high"
    },

    "lifecoach": {
      "northStar": {
        "vision": "ç”¨æ–‡å­—å¸®åŠ©ä»–äººæ‰¾åˆ°æ–¹å‘",
        "yearGoal": "å‡ºç‰ˆç¬¬ä¸€æœ¬ä¹¦"
      },
      "monthlyProject": {
        "name": "å®Œæˆä¹¦ç±ç¬¬3ç« ",
        "progress": 40,
        "daysRemaining": 12
      },
      "todayLevers": [
        { "id": "lever_1", "text": "å®Œæˆ3.2èŠ‚åˆç¨¿", "completed": false },
        { "id": "lever_2", "text": "å›žå¤å°æ˜Žçš„é‚®ä»¶", "completed": false },
        { "id": "lever_3", "text": "30åˆ†é’Ÿé˜…è¯»", "completed": false }
      ],
      "weekRocks": [
        { "id": "rock_1", "text": "å®Œæˆ3.2èŠ‚åˆç¨¿", "role": "åˆ›ä½œè€…", "completed": true },
        { "id": "rock_2", "text": "å‘¨ä¸‰å¸¦å­©å­åŽ»å…¬å›­", "role": "çˆ¶äº²", "completed": false },
        { "id": "rock_3", "text": "å‘¨å…­çº¦ä¼š", "role": "ä¸ˆå¤«", "completed": false }
      ]
    },

    "mySkills": [
      {
        "skillId": "bazi",
        "cardId": "daily_fortune",
        "title": "ä»Šæ—¥è¿åŠ¿",
        "icon": "â˜¯ï¸",
        "content": {
          "summary": "ä»Šæ—¥å®œé™ä¸å®œåŠ¨",
          "detail": "ç”²å­æ—¥ï¼Œæ°´æœ¨ç›¸ç”Ÿ...",
          "advice": "é€‚åˆè¯»ä¹¦ã€å†™ä½œï¼Œä¸å®œé‡å¤§å†³ç­–"
        },
        "actionLabel": "æŸ¥çœ‹è¯¦æƒ…",
        "actionRoute": "/skills/bazi/daily",
        "lastUpdated": "2026-01-19T00:00:00Z"
      },
      {
        "skillId": "jungian",
        "cardId": "archetype_insight",
        "title": "åŽŸåž‹æ´žå¯Ÿ",
        "icon": "ðŸŽ­",
        "content": {
          "archetype": "åˆ›é€ è€…",
          "insight": "æœ¬å‘¨ä½ çš„åˆ›é€ è€…åŽŸåž‹æ´»è·ƒåº¦å¾ˆé«˜",
          "shadow": "æ³¨æ„ä¸è¦é™·å…¥å®Œç¾Žä¸»ä¹‰çš„é™·é˜±"
        },
        "actionLabel": "æ·±å…¥æŽ¢ç´¢",
        "actionRoute": "/skills/jungian/insight",
        "lastUpdated": "2026-01-13T00:00:00Z"
      }
    ],

    "discover": [
      {
        "skillId": "zodiac",
        "title": "æ˜Ÿåº§è¿åŠ¿",
        "icon": "â­",
        "tagline": "æŽ¢ç´¢æ˜Ÿè±¡æ™ºæ…§",
        "description": "æ¯å‘¨æ˜Ÿåº§è¿åŠ¿åˆ†æžï¼Œäº†è§£è¡Œæ˜Ÿå¯¹ä½ çš„å½±å“",
        "subscriberCount": 1234
      },
      {
        "skillId": "mbti",
        "title": "MBTI æ•™ç»ƒ",
        "icon": "ðŸ§ ",
        "tagline": "ç†è§£ä½ çš„è®¤çŸ¥åŠŸèƒ½",
        "description": "åŸºäºŽ MBTI çš„ä¸ªæ€§åŒ–å‘å±•å»ºè®®",
        "subscriberCount": 890
      }
    ]
  },
  "meta": {
    "cached": false,
    "cacheKey": "dashboard:user_123:20260119"
  }
}
```

### POST /api/skills/subscribe

```typescript
// è¯·æ±‚
POST /api/skills/subscribe
Headers:
  Authorization: Bearer {token}
Body:
  {
    "skillId": "zodiac"
  }

// å“åº”
{
  "success": true,
  "data": {
    "subscription": {
      "skillId": "zodiac",
      "subscribedAt": "2026-01-19T10:00:00Z"
    },
    "card": {
      "skillId": "zodiac",
      "cardId": "weekly_horoscope",
      "title": "æœ¬å‘¨è¿åŠ¿",
      "icon": "â­",
      "content": {
        "sign": "æ°´ç“¶åº§",
        "summary": "æœ¬å‘¨äº‹ä¸šè¿æ—ºç››...",
        "luckyDay": "å‘¨ä¸‰"
      },
      "actionLabel": "æŸ¥çœ‹å®Œæ•´è¿åŠ¿",
      "actionRoute": "/skills/zodiac/weekly"
    }
  }
}
```

### DELETE /api/skills/subscribe/{skillId}

```typescript
// è¯·æ±‚
DELETE /api/skills/subscribe/zodiac
Headers:
  Authorization: Bearer {token}

// å“åº”
{
  "success": true,
  "data": {
    "unsubscribed": "zodiac",
    "unsubscribedAt": "2026-01-19T11:00:00Z"
  }
}
```

### POST /api/dashboard/checkin

```typescript
// è¯·æ±‚
POST /api/dashboard/checkin
Headers:
  Authorization: Bearer {token}
Body:
  {
    "timestamp": "2026-01-19T08:30:00Z"
  }

// å“åº”
{
  "success": true,
  "data": {
    "streak": 8,
    "message": "å¤ªæ£’äº†ï¼è¿žç»­ç¬¬8å¤©ç­¾åˆ°ï¼",
    "animation": "fire",
    "status": {
      "checkedIn": true,
      "checkinTime": "2026-01-19T08:30:00Z",
      "streak": 8
    }
  }
}
```

### PATCH /api/dashboard/lever/{lever_id}

```typescript
// è¯·æ±‚
PATCH /api/dashboard/lever/lever_1
Headers:
  Authorization: Bearer {token}
Body:
  {
    "completed": true
  }

// å“åº”
{
  "success": true,
  "data": {
    "lever": {
      "id": "lever_1",
      "text": "å®Œæˆ3.2èŠ‚åˆç¨¿",
      "completed": true,
      "completedAt": "2026-01-19T10:30:00Z"
    },
    "progress": {
      "completed": 1,
      "total": 3,
      "percentage": 33
    },
    "allCompleted": false
  }
}
```

---

## ç¼“å­˜ç­–ç•¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç¼“å­˜å±‚çº§ v2.0                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   Layer 1: æµè§ˆå™¨ç¼“å­˜ (SWR)                                                      â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                    â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   // Dashboard ä¸»æ•°æ®                                                    â”‚   â”‚
â”‚   â”‚   useSWR('/api/dashboard', fetcher, {                                   â”‚   â”‚
â”‚   â”‚     revalidateOnFocus: false,                                           â”‚   â”‚
â”‚   â”‚     revalidateOnReconnect: true,                                        â”‚   â”‚
â”‚   â”‚     dedupingInterval: 60000,       // 1åˆ†é’Ÿå†…åŽ»é‡                        â”‚   â”‚
â”‚   â”‚     errorRetryCount: 3,                                                 â”‚   â”‚
â”‚   â”‚   });                                                                   â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   // Skill Cards ç‹¬ç«‹ç¼“å­˜ (æ”¯æŒç‹¬ç«‹åˆ·æ–°)                                 â”‚   â”‚
â”‚   â”‚   useSWR(`/api/skills/${skillId}/card`, fetcher, {                      â”‚   â”‚
â”‚   â”‚     dedupingInterval: 300000,      // 5åˆ†é’Ÿå†…åŽ»é‡                        â”‚   â”‚
â”‚   â”‚   });                                                                   â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                                  â”‚
â”‚   Layer 2: Skill Card ç¼“å­˜ (Redis)                                              â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                             â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   # æŒ‰ Skill åˆ·æ–°å‘¨æœŸè®¾ç½® TTL                                            â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   card_key = f"card:{user_id}:{skill_id}:{card_id}"                     â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   TTL ç­–ç•¥:                                                              â”‚   â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚   â”‚   â”‚ refresh ç±»åž‹      â”‚ TTL        â”‚ ç¤ºä¾‹                          â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚   â”‚
â”‚   â”‚   â”‚ daily             â”‚ 24 hours   â”‚ å…«å­—æ¯æ—¥è¿åŠ¿                   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚ weekly            â”‚ 7 days     â”‚ è£æ ¼å‘¨æ´žå¯Ÿ                     â”‚   â”‚   â”‚
â”‚   â”‚   â”‚ realtime          â”‚ 5 minutes  â”‚ çŠ¶æ€è¿½è¸ªç±»                     â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   # ç¼“å­˜å¤±æ•ˆè§¦å‘                                                         â”‚   â”‚
â”‚   â”‚   - ç”¨æˆ·æ‰‹åŠ¨åˆ·æ–° Skill Card                                              â”‚   â”‚
â”‚   â”‚   - å®šæ—¶ä»»åŠ¡ (æŒ‰ refresh å‘¨æœŸ)                                           â”‚   â”‚
â”‚   â”‚   - å¤–éƒ¨äº‹ä»¶ (èŠ‚æ°”å˜åŒ–ã€ç”¨æˆ·æ•°æ®æ›´æ–°)                                    â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                                  â”‚
â”‚   Layer 3: Dashboard èšåˆç¼“å­˜                                                    â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                                                   â”‚
â”‚                                                                                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   cache_key = f"dashboard:{user_id}:{date}"                             â”‚   â”‚
â”‚   â”‚   ttl = 300  # 5 åˆ†é’Ÿ                                                   â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â”‚   # å¤±æ•ˆæ¡ä»¶                                                             â”‚   â”‚
â”‚   â”‚   - ç”¨æˆ·ç­¾åˆ° â†’ å¤±æ•ˆ status                                               â”‚   â”‚
â”‚   â”‚   - ç”¨æˆ·æ›´æ–° lever/rock â†’ å¤±æ•ˆ lifecoach                                 â”‚   â”‚
â”‚   â”‚   - ç”¨æˆ·è®¢é˜…/å–æ¶ˆ Skill â†’ å¤±æ•ˆ mySkills + discover                       â”‚   â”‚
â”‚   â”‚   - æ¯æ—¥ 00:00 â†’ å…¨éƒ¨å¤±æ•ˆ                                                â”‚   â”‚
â”‚   â”‚                                                                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å‰ç«¯çŠ¶æ€ç®¡ç†

```typescript
// src/stores/dashboardStore.ts

import { create } from 'zustand';
import { persist } from 'zustand/middleware';
import type { DashboardDTO, SkillCard, DiscoverSkill } from '@/types/dashboard';

interface DashboardState {
  // æ•°æ®
  dashboard: DashboardDTO | null;
  isLoading: boolean;
  error: Error | null;

  // æ“ä½œ
  setDashboard: (data: DashboardDTO) => void;

  // Status
  setCheckedIn: (streak: number) => void;

  // Lifecoach
  toggleLever: (leverId: string) => void;
  toggleRock: (rockId: string) => void;

  // Skills
  addSkillCard: (card: SkillCard) => void;
  removeSkillCard: (skillId: string) => void;
  updateSkillCard: (skillId: string, content: SkillCard['content']) => void;

  // Discover
  removeFromDiscover: (skillId: string) => void;
}

export const useDashboardStore = create<DashboardState>()(
  persist(
    (set) => ({
      dashboard: null,
      isLoading: false,
      error: null,

      setDashboard: (data) => set({ dashboard: data }),

      setCheckedIn: (streak) => set((state) => ({
        dashboard: state.dashboard ? {
          ...state.dashboard,
          status: { ...state.dashboard.status, checkedIn: true, streak }
        } : null
      })),

      toggleLever: (leverId) => set((state) => {
        if (!state.dashboard) return state;

        const levers = state.dashboard.lifecoach.todayLevers.map(lever =>
          lever.id === leverId
            ? { ...lever, completed: !lever.completed }
            : lever
        );

        return {
          dashboard: {
            ...state.dashboard,
            lifecoach: { ...state.dashboard.lifecoach, todayLevers: levers }
          }
        };
      }),

      toggleRock: (rockId) => set((state) => {
        if (!state.dashboard) return state;

        const rocks = state.dashboard.lifecoach.weekRocks.map(rock =>
          rock.id === rockId
            ? { ...rock, completed: !rock.completed }
            : rock
        );

        return {
          dashboard: {
            ...state.dashboard,
            lifecoach: { ...state.dashboard.lifecoach, weekRocks: rocks }
          }
        };
      }),

      addSkillCard: (card) => set((state) => {
        if (!state.dashboard) return state;
        return {
          dashboard: {
            ...state.dashboard,
            mySkills: [...state.dashboard.mySkills, card]
          }
        };
      }),

      removeSkillCard: (skillId) => set((state) => {
        if (!state.dashboard) return state;
        return {
          dashboard: {
            ...state.dashboard,
            mySkills: state.dashboard.mySkills.filter(s => s.skillId !== skillId)
          }
        };
      }),

      updateSkillCard: (skillId, content) => set((state) => {
        if (!state.dashboard) return state;
        return {
          dashboard: {
            ...state.dashboard,
            mySkills: state.dashboard.mySkills.map(card =>
              card.skillId === skillId
                ? { ...card, content, lastUpdated: new Date().toISOString() }
                : card
            )
          }
        };
      }),

      removeFromDiscover: (skillId) => set((state) => {
        if (!state.dashboard) return state;
        return {
          dashboard: {
            ...state.dashboard,
            discover: state.dashboard.discover.filter(s => s.skillId !== skillId)
          }
        };
      }),
    }),
    {
      name: 'vibelife-dashboard-v2',
      partialize: (state) => ({
        dashboard: state.dashboard
      })
    }
  )
);
```

---

## Skill è®¢é˜…æ•°æ®æµæ—¶åºå›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Skill è®¢é˜…æµç¨‹                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                  â”‚
â”‚   User     Dashboard      Store        API       Proactive     DB               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚          Engine       â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚  ç‚¹å‡»è®¢é˜… â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚ ä¹è§‚æ›´æ–°    â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚ ä»Ž discoverâ”‚           â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚ ç§»åˆ° mySkills          â”‚          â”‚               â”‚
â”‚     â”‚          â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ (placeholder)         â”‚          â”‚               â”‚
â”‚     â”‚  çœ‹åˆ°ç§»åŠ¨ â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚   POST    â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚ subscribe  â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚ INSERT   â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚ compute_card          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚ ç”Ÿæˆå†…å®¹ â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ { card }   â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ æ›´æ–°çœŸå®žå†…å®¹            â”‚          â”‚               â”‚
â”‚     â”‚  å®Œæ•´å¡ç‰‡ â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â”‚     â”‚          â”‚            â”‚           â”‚            â”‚          â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é”™è¯¯å¤„ç†

```typescript
// src/hooks/useDashboard.ts

import useSWR from 'swr';
import { useDashboardStore } from '@/stores/dashboardStore';

export function useDashboard() {
  const store = useDashboardStore();

  const { data, error, isLoading, mutate } = useSWR(
    '/api/dashboard',
    fetcher,
    {
      onSuccess: (data) => store.setDashboard(data),
      fallbackData: store.dashboard, // ç¦»çº¿æ—¶ä½¿ç”¨ç¼“å­˜
    }
  );

  // è®¢é˜… Skill
  const subscribeSkill = async (skillId: string) => {
    // 1. ä¹è§‚æ›´æ–°: ç§»åŠ¨åˆ° mySkills
    const targetSkill = data?.discover.find(s => s.skillId === skillId);
    if (targetSkill) {
      store.removeFromDiscover(skillId);
      store.addSkillCard({
        skillId,
        cardId: 'loading',
        title: targetSkill.title,
        icon: targetSkill.icon,
        content: null, // placeholder
        actionLabel: 'åŠ è½½ä¸­...',
        actionRoute: '',
      });
    }

    try {
      // 2. å‘é€è¯·æ±‚
      const result = await api.post('/api/skills/subscribe', { skillId });

      // 3. æ›´æ–°çœŸå®žå†…å®¹
      store.updateSkillCard(skillId, result.card);
    } catch (error) {
      // 4. å›žæ»š
      if (targetSkill) {
        store.removeSkillCard(skillId);
        // æ¢å¤ discover éœ€è¦é‡æ–°èŽ·å–
        mutate();
      }
      throw error;
    }
  };

  // ç­¾åˆ°
  const checkIn = async () => {
    const currentStreak = data?.status.streak || 0;

    // 1. ä¹è§‚æ›´æ–°
    store.setCheckedIn(currentStreak + 1);

    try {
      // 2. å‘é€è¯·æ±‚
      const result = await api.post('/api/dashboard/checkin');

      // 3. ç”¨æœåŠ¡ç«¯æ•°æ®éªŒè¯
      store.setCheckedIn(result.streak);

      return result;
    } catch (error) {
      // 4. å›žæ»š
      store.setCheckedIn(currentStreak);
      throw error;
    }
  };

  return {
    dashboard: data,
    isLoading,
    error,
    refresh: mutate,
    subscribeSkill,
    checkIn,
  };
}
```

---

> **Version**: 2.0 | 2026-01-19
