# Dashboard 组件实现指南

> **Version**: 1.0 | 2026-01-19
> **关联文档**: DESIGN.md (视觉规格)

---

## 核心组件 ASCII 详图

### 1. AmbientHeader

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              AmbientHeader                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │                                                                          │  │
│   │  早安，{用户名}                                    2026年1月19日 周日    │  │
│   │  ───────────────────────────────────────────────────────────────────     │  │
│   │  "{个性化消息，基于时间/状态/节气}"                                      │  │
│   │                                                                          │  │
│   │  📍 {节气} · {建议}                                                      │  │
│   │                                                                          │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│   数据来源:                                                                      │
│   ├── greeting: 基于时间 (早安/午安/晚安) + 用户名                              │
│   ├── message: 个性化消息生成器 (见下方算法)                                    │
│   ├── date: 格式化当前日期                                                      │
│   └── solarTerm: 节气数据 (可选，中国用户)                                      │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

**智能名言系统:**

```typescript
// src/lib/dashboard/quotes.ts

/**
 * 名言库 - 按主题分类
 * 设计原则：触动人心、简洁有力、与用户状态共鸣
 */

// ═══════════════════════════════════════════════════════════════
// 1. 愿景与目标
// ═══════════════════════════════════════════════════════════════
const VISION_QUOTES = [
  { text: "你的愿景正在等待你的行动。", author: null },
  { text: "种一棵树最好的时间是十年前，其次是现在。", author: "中国谚语" },
  { text: "不是因为看见了才相信，而是因为相信了才看见。", author: null },
  { text: "你不必看清整个楼梯，只需迈出第一步。", author: "马丁·路德·金" },
  { text: "今天做的每一件小事，都是明天大事的预演。", author: null },
  { text: "目标不是用来达成的，而是用来指引方向的。", author: "布鲁斯·李" },
  { text: "梦想不会逃跑，逃跑的永远是自己。", author: "村上春树" },
  { text: "最慢的步伐不是跬步，而是徘徊。", author: null },
];

// ═══════════════════════════════════════════════════════════════
// 2. 坚持与毅力
// ═══════════════════════════════════════════════════════════════
const PERSISTENCE_QUOTES = [
  { text: "滴水穿石，不是力量大，而是功夫深。", author: null },
  { text: "每一次你想放弃的时候，想想为什么开始。", author: null },
  { text: "成功的秘诀在于坚持。坚持的秘诀在于热爱。", author: null },
  { text: "复利效应：今天的1%进步，一年后是37倍。", author: null },
  { text: "不是强者才能坚持，而是坚持了才会变强。", author: null },
  { text: "你已经走了这么远，不要忘记为什么出发。", author: null },
  { text: "伟大的事业不是靠力气完成的，而是靠坚持完成的。", author: "塞缪尔·约翰逊" },
  { text: "日拱一卒，功不唐捐。", author: "曾国藩" },
];

// ═══════════════════════════════════════════════════════════════
// 3. 自我认知
// ═══════════════════════════════════════════════════════════════
const SELF_AWARENESS_QUOTES = [
  { text: "认识你自己。", author: "苏格拉底" },
  { text: "你是谁，比你做什么更重要。", author: null },
  { text: "真正的自由是成为你自己。", author: null },
  { text: "接纳自己，是改变的起点。", author: null },
  { text: "每个人都是自己生命的作者。", author: null },
  { text: "最深的井，往往有最甜的水。", author: "尼采" },
  { text: "你内心的答案，比任何外在的声音都重要。", author: null },
  { text: "向内求，是所有外在成就的起点。", author: null },
];

// ═══════════════════════════════════════════════════════════════
// 4. 行动与当下
// ═══════════════════════════════════════════════════════════════
const ACTION_QUOTES = [
  { text: "千里之行，始于足下。", author: "老子" },
  { text: "想都是问题，做才是答案。", author: null },
  { text: "最好的准备就是立刻开始。", author: null },
  { text: "完成比完美更重要。", author: null },
  { text: "今天是余生中最年轻的一天。", author: null },
  { text: "你不需要很厉害才能开始，但需要开始才能很厉害。", author: null },
  { text: "行动是治愈恐惧的良药。", author: null },
  { text: "知道不等于做到，做到不等于做好。", author: null },
  { text: "先完成，再完美。", author: null },
];

// ═══════════════════════════════════════════════════════════════
// 5. 成长与变化
// ═══════════════════════════════════════════════════════════════
const GROWTH_QUOTES = [
  { text: "舒适区的边缘，是成长发生的地方。", author: null },
  { text: "蜕变总是伴随着不舒服。", author: null },
  { text: "你不是在变老，而是在变好。", author: null },
  { text: "今天的你比昨天的你更接近目标。", author: null },
  { text: "每一次跌倒，都是在学习如何站得更稳。", author: null },
  { text: "不是环境造就人，而是人选择如何回应环境。", author: "维克多·弗兰克尔" },
  { text: "唯一不变的，就是变化本身。", author: "赫拉克利特" },
  { text: "成长是一个过程，不是一个事件。", author: null },
];

// ═══════════════════════════════════════════════════════════════
// 6. 休息与平衡
// ═══════════════════════════════════════════════════════════════
const REST_QUOTES = [
  { text: "休息不是放弃，而是为了走更远的路。", author: null },
  { text: "张弛有度，方能长久。", author: null },
  { text: "有时候，慢下来才能看清方向。", author: null },
  { text: "照顾好自己，才能照顾好世界。", author: null },
  { text: "留白是为了让重要的事物更突出。", author: null },
  { text: "最有效率的人，知道什么时候该停下来。", author: null },
  { text: "能量管理比时间管理更重要。", author: null },
];

// ═══════════════════════════════════════════════════════════════
// 7. 困境与突破
// ═══════════════════════════════════════════════════════════════
const BREAKTHROUGH_QUOTES = [
  { text: "山重水复疑无路，柳暗花明又一村。", author: "陆游" },
  { text: "在你准备放弃的那一刻，往往离成功最近。", author: null },
  { text: "困难是化了妆的礼物。", author: null },
  { text: "没有到不了的明天。", author: null },
  { text: "冬天来了，春天还会远吗？", author: "雪莱" },
  { text: "风雨之后才能见彩虹。", author: null },
  { text: "你现在经历的，都会成为你未来的力量。", author: null },
];

// ═══════════════════════════════════════════════════════════════
// 8. 周期性名言（特殊时间点）
// ═══════════════════════════════════════════════════════════════
const PERIODIC_QUOTES = {
  monday: [
    { text: "新的一周，新的可能。", author: null },
    { text: "周一是重新开始的好时机。", author: null },
    { text: "这周，你想成为什么样的人？", author: null },
    { text: "每个周一都是52次重新开始的机会。", author: null },
  ],
  friday: [
    { text: "回顾这周，你离目标更近了一步。", author: null },
    { text: "周五不是结束，是下周的准备。", author: null },
    { text: "这周的你，比上周的你更强了。", author: null },
  ],
  weekend: [
    { text: "周末是给灵魂充电的时间。", author: null },
    { text: "休息好，才能走得更远。", author: null },
    { text: "用周末的时间，做那些平时来不及做的事。", author: null },
    { text: "好好休息，也是一种自律。", author: null },
  ],
  month_start: [
    { text: "新的一月，新的篇章。", author: null },
    { text: "这个月，你想完成什么？", author: null },
    { text: "每个月都是一个小的人生周期。", author: null },
  ],
  month_end: [
    { text: "月底了，回顾一下这个月的收获。", author: null },
    { text: "即使没有完成所有目标，你也在前进。", author: null },
    { text: "无论结果如何，感谢这个月努力的自己。", author: null },
  ],
  year_start: [
    { text: "新的一年，让我们重新定义可能。", author: null },
    { text: "今年，你想成为什么样的人？", author: null },
    { text: "365天，足够改变一切。", author: null },
  ],
};

// ═══════════════════════════════════════════════════════════════
// 智能选择算法
// ═══════════════════════════════════════════════════════════════

interface QuoteContext {
  hour: number;
  dayOfWeek: number;        // 0=周日, 1=周一, ...
  dayOfMonth: number;
  month: number;
  streak: number;
  checkedIn: boolean;
  weekProgress: number;     // 0-1
  monthProgress: number;    // 0-1
  userMood?: 'low' | 'normal' | 'high';  // 用户情绪状态
  recentQuotes?: string[];  // 最近展示过的名言（避免重复）
}

function selectQuote(context: QuoteContext): { text: string; author: string | null } {
  const {
    hour, dayOfWeek, dayOfMonth, month,
    streak, checkedIn, weekProgress,
    userMood, recentQuotes
  } = context;

  let candidatePool: Array<{ text: string; author: string | null; weight: number }> = [];

  // ─────────────────────────────────────────────────────────────
  // 1. 周期性名言优先（特殊时间点）
  // ─────────────────────────────────────────────────────────────
  if (dayOfWeek === 1) {
    candidatePool.push(...PERIODIC_QUOTES.monday.map(q => ({ ...q, weight: 10 })));
  } else if (dayOfWeek === 5) {
    candidatePool.push(...PERIODIC_QUOTES.friday.map(q => ({ ...q, weight: 10 })));
  } else if (dayOfWeek === 0 || dayOfWeek === 6) {
    candidatePool.push(...PERIODIC_QUOTES.weekend.map(q => ({ ...q, weight: 10 })));
  }

  if (dayOfMonth <= 3) {
    candidatePool.push(...PERIODIC_QUOTES.month_start.map(q => ({ ...q, weight: 12 })));
  } else if (dayOfMonth >= 28) {
    candidatePool.push(...PERIODIC_QUOTES.month_end.map(q => ({ ...q, weight: 12 })));
  }

  if (month === 1 && dayOfMonth <= 7) {
    candidatePool.push(...PERIODIC_QUOTES.year_start.map(q => ({ ...q, weight: 15 })));
  }

  // ─────────────────────────────────────────────────────────────
  // 2. 基于用户状态选择
  // ─────────────────────────────────────────────────────────────

  // 连续签到 → 强调坚持
  if (streak >= 7) {
    candidatePool.push(...PERSISTENCE_QUOTES.map(q => ({ ...q, weight: 8 })));
  }

  // 早晨未签到 → 强调行动
  if (!checkedIn && hour >= 6 && hour < 12) {
    candidatePool.push(...ACTION_QUOTES.map(q => ({ ...q, weight: 8 })));
  }

  // 本周完成度高 → 强调成长
  if (weekProgress >= 0.7) {
    candidatePool.push(...GROWTH_QUOTES.map(q => ({ ...q, weight: 6 })));
  }

  // 本周完成度低 → 强调突破
  if (weekProgress < 0.3 && dayOfWeek >= 4) {
    candidatePool.push(...BREAKTHROUGH_QUOTES.map(q => ({ ...q, weight: 8 })));
  }

  // 用户情绪低落 → 强调突破与支持
  if (userMood === 'low') {
    candidatePool.push(...BREAKTHROUGH_QUOTES.map(q => ({ ...q, weight: 10 })));
  }

  // 晚上或周末 → 加入休息相关
  if (hour >= 20 || dayOfWeek === 0 || dayOfWeek === 6) {
    candidatePool.push(...REST_QUOTES.map(q => ({ ...q, weight: 5 })));
  }

  // ─────────────────────────────────────────────────────────────
  // 3. 默认池补充
  // ─────────────────────────────────────────────────────────────
  candidatePool.push(...VISION_QUOTES.map(q => ({ ...q, weight: 3 })));
  candidatePool.push(...SELF_AWARENESS_QUOTES.map(q => ({ ...q, weight: 3 })));

  // ─────────────────────────────────────────────────────────────
  // 4. 去重（排除最近展示过的）
  // ─────────────────────────────────────────────────────────────
  if (recentQuotes?.length) {
    candidatePool = candidatePool.filter(
      q => !recentQuotes.includes(q.text)
    );
  }

  // ─────────────────────────────────────────────────────────────
  // 5. 加权随机选择（使用日期作为种子，同一天返回相同名言）
  // ─────────────────────────────────────────────────────────────
  const seed = new Date().toDateString();
  const totalWeight = candidatePool.reduce((sum, q) => sum + q.weight, 0);
  const targetWeight = (hashCode(seed) % totalWeight + totalWeight) % totalWeight;

  let cumulative = 0;
  for (const quote of candidatePool) {
    cumulative += quote.weight;
    if (cumulative >= targetWeight) {
      return { text: quote.text, author: quote.author };
    }
  }

  return VISION_QUOTES[0];
}

function hashCode(str: string): number {
  let hash = 0;
  for (let i = 0; i < str.length; i++) {
    hash = ((hash << 5) - hash) + str.charCodeAt(i);
    hash |= 0;
  }
  return hash;
}
```

**名言展示效果:**

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                     │
│  早安，小薇                                    2026年1月19日 周日    │
│  ───────────────────────────────────────────────────────────────    │
│                                                                     │
│  "你不必看清整个楼梯，只需迈出第一步。"                             │
│                                      —— 马丁·路德·金               │
│                                                                     │
│  📍 小寒第三候 · 宜静心规划                                         │
│                                                                     │
└─────────────────────────────────────────────────────────────────────┘
```

**设计原则:**

1. **触动人心** - 每句名言都要能引发思考或共鸣
2. **简洁有力** - 不超过 30 字，一眼能读完
3. **状态共鸣** - 根据用户当前状态选择最合适的名言
4. **避免重复** - 同一天显示相同名言，但每天更换
5. **中西融合** - 既有东方智慧，也有西方哲理
6. **加权选择** - 周期性/状态相关名言权重更高

---

### 2. IdentityCard (WHO I AM)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              IdentityCard                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │                                                                          │  │
│   │  WHO I AM                                                                │  │
│   │  ─────────                                                               │  │
│   │                                                                          │  │
│   │  ┌────────────────────────────────────────────────────────────────────┐ │  │
│   │  │                                                                    │ │  │
│   │  │   ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐                  │ │  │
│   │  │   │        │  │        │  │        │  │        │                  │ │  │
│   │  │   │   🎨   │  │   💕   │  │   🧭   │  │   ⚔️   │                  │ │  │
│   │  │   │        │  │        │  │        │  │        │                  │ │  │
│   │  │   │  核心  │  │  内在  │  │  外在  │  │  阴影  │                  │ │  │
│   │  │   │ 创造者 │  │  情人  │  │ 探索者 │  │  英雄  │                  │ │  │
│   │  │   │        │  │        │  │        │  │        │                  │ │  │
│   │  │   └────────┘  └────────┘  └────────┘  └────────┘                  │ │  │
│   │  │                                                                    │ │  │
│   │  └────────────────────────────────────────────────────────────────────┘ │  │
│   │                                                                          │  │
│   │  身份宣言：                                                              │  │
│   │  ┌────────────────────────────────────────────────────────────────────┐ │  │
│   │  │ "我是一个每天都在创造的人"                                         │ │  │
│   │  └────────────────────────────────────────────────────────────────────┘ │  │
│   │                                                                          │  │
│   │  当前状态: ┌──────────┐                                                 │  │
│   │           │ 专注创作 │                                                  │  │
│   │           └──────────┘                                                  │  │
│   │                                                                          │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│   子组件:                                                                        │
│   ├── ArchetypeQuad: 四维原型展示                                               │
│   │   └── ArchetypeBadge × 4: 单个原型徽章                                      │
│   ├── IdentityStatement: 身份宣言引用框                                         │
│   └── CurrentStateTag: 状态标签                                                 │
│                                                                                  │
│   交互:                                                                          │
│   ├── 点击原型 → 展开原型详情 Modal                                             │
│   ├── 点击身份宣言 → 进入编辑模式                                               │
│   └── Hover → 显示"查看详情"链接                                                │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

**ArchetypeBadge 变体:**

```
Size Variants:
┌────────┐  ┌──────────┐  ┌────────────────┐
│   🎨   │  │          │  │                │
│        │  │    🎨    │  │      🎨        │
│ sm     │  │          │  │                │
└────────┘  │    md    │  │      lg        │
   32px     └──────────┘  │                │
               48px       │    创造者      │
                          │                │
                          └────────────────┘
                               72px

State Variants:
┌──────────┐  ┌──────────┐  ┌──────────┐
│    🎨    │  │    🎨    │  │ ✨ 🎨 ✨  │
│          │  │ ──────── │  │          │
│ default  │  │ selected │  │ animated │
└──────────┘  └──────────┘  └──────────┘
```

---

### 3. TodayCard (TODAY'S FOCUS)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              TodayCard                                           │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   状态机:                                                                        │
│   ═══════                                                                        │
│                                                                                  │
│   ┌─────────────┐     签到      ┌─────────────┐    勾选完成    ┌─────────────┐  │
│   │  NOT_READY  │ ───────────▶ │   ACTIVE    │ ─────────────▶ │  COMPLETED  │  │
│   │  (未签到)   │              │  (进行中)   │               │  (全部完成) │  │
│   └─────────────┘              └─────────────┘               └─────────────┘  │
│                                                                                  │
│   ─────────────────────────────────────────────────────────────────────────────  │
│                                                                                  │
│   状态 1: NOT_READY (未签到)                                                     │
│   ┌──────────────────────────────────────────┐                                  │
│   │                                          │                                  │
│   │  ☀️ 今日杠杆行动                          │                                  │
│   │                                          │                                  │
│   │  ┌──────────────────────────────────┐   │                                  │
│   │  │ □ 完成3.2节初稿                  │   │  ← 灰色，不可交互                │
│   │  │ □ 回复小明的邮件                 │   │                                  │
│   │  │ □ 30分钟阅读                     │   │                                  │
│   │  └──────────────────────────────────┘   │                                  │
│   │                                          │                                  │
│   │  🔥 7天                                  │                                  │
│   │                                          │                                  │
│   │  ┌──────────────────────────────────┐   │                                  │
│   │  │         [ 开始今天 ]             │   │  ← 主要 CTA                      │
│   │  └──────────────────────────────────┘   │                                  │
│   │                                          │                                  │
│   └──────────────────────────────────────────┘                                  │
│                                                                                  │
│   ─────────────────────────────────────────────────────────────────────────────  │
│                                                                                  │
│   状态 2: ACTIVE (进行中)                                                        │
│   ┌──────────────────────────────────────────┐                                  │
│   │                                          │                                  │
│   │  ✓ 今日杠杆行动                          │  ← 绿色对勾                      │
│   │                                          │                                  │
│   │  ┌──────────────────────────────────┐   │                                  │
│   │  │ ☑ 完成3.2节初稿     ✓ 已完成    │   │  ← 可交互勾选                    │
│   │  │ □ 回复小明的邮件                 │   │                                  │
│   │  │ □ 30分钟阅读                     │   │                                  │
│   │  └──────────────────────────────────┘   │                                  │
│   │                                          │                                  │
│   │  🔥 8天        进度 1/3                  │  ← 显示进度                      │
│   │                                          │                                  │
│   │  ████░░░░░░░░░░░░░░░░░░ 33%             │  ← 进度条                        │
│   │                                          │                                  │
│   └──────────────────────────────────────────┘                                  │
│                                                                                  │
│   ─────────────────────────────────────────────────────────────────────────────  │
│                                                                                  │
│   状态 3: COMPLETED (全部完成)                                                   │
│   ┌──────────────────────────────────────────┐                                  │
│   │  ┌────────────────────────────────────┐ │                                  │
│   │  │     ✨ 今日目标全部完成！✨        │ │  ← 庆祝动画                      │
│   │  └────────────────────────────────────┘ │                                  │
│   │                                          │                                  │
│   │  ☑ 完成3.2节初稿                        │                                  │
│   │  ☑ 回复小明的邮件                       │                                  │
│   │  ☑ 30分钟阅读                           │                                  │
│   │                                          │                                  │
│   │  🔥 8天        ████████████████████ 100%│                                  │
│   │                                          │                                  │
│   │  "明天继续加油！"                        │                                  │
│   │                                          │                                  │
│   └──────────────────────────────────────────┘                                  │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

**签到按钮动画序列:**

```
点击 "开始今天" 按钮:

Frame 0 (0ms):        Frame 1 (100ms):      Frame 2 (300ms):      Frame 3 (500ms):
┌─────────────┐       ┌─────────────┐       ┌─────────────┐       ┌─────────────┐
│  开始今天   │  ──▶  │  ●          │  ──▶  │     ✨      │  ──▶  │   🔥 8天    │
└─────────────┘       └─────────────┘       │   🔥 8天    │       │             │
                      loading 动画           │     ✨      │       │   太棒了！  │
                                            └─────────────┘       └─────────────┘
                                            数字跳动 7→8          完成状态
```

---

### 4. NorthStarCard (NORTH STAR)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              NorthStarCard                                       │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │                                                                          │  │
│   │  NORTH STAR                                                              │  │
│   │  ──────────                                                              │  │
│   │                                                                          │  │
│   │  ┌────────────────────────────────────────────────────────────────────┐ │  │
│   │  │                                                                    │ │  │
│   │  │  ★ "我想成为一个用文字帮助他人找到方向的创作者"                    │ │  │
│   │  │                                                                    │ │  │
│   │  └────────────────────────────────────────────────────────────────────┘ │  │
│   │                                                                          │  │
│   │  ┌────────────────────────────────────────────────────────────────────┐ │  │
│   │  │  月度项目                                                          │ │  │
│   │  │  ──────────                                                        │ │  │
│   │  │                                                                    │ │  │
│   │  │  完成书籍第3章                                                     │ │  │
│   │  │                                                                    │ │  │
│   │  │  ████████░░░░░░░░░░░░ 40%                                         │ │  │
│   │  │                                                                    │ │  │
│   │  │  ┌────────────────────────────────────────────────────────────┐   │ │  │
│   │  │  │  📅 距离月底还有 12 天                                      │   │ │  │
│   │  │  └────────────────────────────────────────────────────────────┘   │ │  │
│   │  │                                                                    │ │  │
│   │  └────────────────────────────────────────────────────────────────────┘ │  │
│   │                                                                          │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│   进度条颜色逻辑:                                                                │
│   ├── 0-25%:  红色 (落后)                                                       │
│   ├── 26-50%: 橙色 (需加速)                                                     │
│   ├── 51-75%: 蓝色 (正常)                                                       │
│   └── 76-100%: 绿色 (领先)                                                      │
│                                                                                  │
│   时间紧迫性提示:                                                                │
│   ├── 剩余天数 <= 3: 红色高亮 + 脉冲动画                                        │
│   ├── 剩余天数 <= 7: 橙色警告                                                   │
│   └── 其他: 正常显示                                                            │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

### 5. WeekCard (THIS WEEK)

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              WeekCard                                            │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │                                                                          │  │
│   │  THIS WEEK                                      2/4 完成                 │  │
│   │  ─────────                                                               │  │
│   │                                                                          │  │
│   │  本周大石头                                                              │  │
│   │  ┌────────────────────────────────────────────────────────────────────┐ │  │
│   │  │                                                                    │ │  │
│   │  │  ┌────┐                                                            │ │  │
│   │  │  │ ✓  │  完成3.2节初稿                         创作者             │ │  │
│   │  │  └────┘                                                            │ │  │
│   │  │                                                                    │ │  │
│   │  │  ┌────┐                                                            │ │  │
│   │  │  │ ○  │  周三带孩子去公园                      父亲               │ │  │
│   │  │  └────┘                                                            │ │  │
│   │  │                                                                    │ │  │
│   │  │  ┌────┐                                                            │ │  │
│   │  │  │ ○  │  周六约会                              丈夫               │ │  │
│   │  │  └────┘                                                            │ │  │
│   │  │                                                                    │ │  │
│   │  │  ┌────┐                                                            │ │  │
│   │  │  │ ○  │  跑步3次                               个人               │ │  │
│   │  │  └────┘                                                            │ │  │
│   │  │                                                                    │ │  │
│   │  └────────────────────────────────────────────────────────────────────┘ │  │
│   │                                                                          │  │
│   │  角色平衡                                                                │  │
│   │  ┌────────────────────────────────────────────────────────────────────┐ │  │
│   │  │                                                                    │ │  │
│   │  │  创作者  ████████░░ 80%                                           │ │  │
│   │  │  父亲    ██████░░░░ 60%                                           │ │  │
│   │  │  丈夫    ████░░░░░░ 40%                                           │ │  │
│   │  │  个人    ██░░░░░░░░ 20%                                           │ │  │
│   │  │                                                                    │ │  │
│   │  └────────────────────────────────────────────────────────────────────┘ │  │
│   │                                                                          │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│   角色颜色映射:                                                                  │
│   ├── 创作者: #3498DB (蓝)                                                      │
│   ├── 父亲:   #27AE60 (绿)                                                      │
│   ├── 丈夫:   #E91E63 (粉)                                                      │
│   └── 个人:   #9B59B6 (紫)                                                      │
│                                                                                  │
│   平衡警告:                                                                      │
│   ├── 某角色 < 30%: 橙色警告                                                    │
│   └── 某角色 = 0%:  红色警告 + 提示                                             │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

### 6. GrowthTimeline

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              GrowthTimeline                                      │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   ┌──────────────────────────────────────────────────────────────────────────┐  │
│   │                                                                          │  │
│   │  GROWTH TIMELINE                                                         │  │
│   │  ───────────────                                                         │  │
│   │                                                                          │  │
│   │       │                                                                  │  │
│   │       │                                                                  │  │
│   │  2026.01.01 ──●── 设定年度愿景                                          │  │
│   │       │           ↑ 过去节点: 实心圆 ● + 淡色                            │  │
│   │       │                                                                  │  │
│   │  2026.01.07 ──●── 完成第一周签到                                        │  │
│   │       │                                                                  │  │
│   │       │                                                                  │  │
│   │  2026.01.15 ──●── 第2章定稿                                             │  │
│   │       │                                                                  │  │
│   │       │                                                                  │  │
│   │  2026.01.19 ──◉── 今天                                                  │  │
│   │       │           ↑ 今日节点: 高亮圆 ◉ + 脉冲动画                        │  │
│   │       │                                                                  │  │
│   │  2026.01.31 ──◇── 月度目标: 第3章完成                                   │  │
│   │               ↑ 未来节点: 空心菱形 ◇ + 虚线连接                          │  │
│   │                                                                          │  │
│   └──────────────────────────────────────────────────────────────────────────┘  │
│                                                                                  │
│   节点类型:                                                                      │
│   ├── past:   ● 实心圆, 灰色, 实线                                              │
│   ├── today:  ◉ 高亮圆, 主色, 脉冲动画                                          │
│   └── future: ◇ 空心菱形, 淡色, 虚线                                            │
│                                                                                  │
│   交互:                                                                          │
│   ├── 点击过去节点 → 查看详情/回顾                                              │
│   ├── 点击今日节点 → 滚动到今日卡片                                             │
│   └── 点击未来节点 → 显示进度预估                                               │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 响应式布局矩阵

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              响应式断点                                          │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   Mobile (<640px)                                                                │
│   ═══════════════                                                                │
│                                                                                  │
│   ┌─────────────────────────┐                                                   │
│   │      AmbientHeader      │                                                   │
│   ├─────────────────────────┤                                                   │
│   │       TodayCard         │  ← 优先显示                                       │
│   ├─────────────────────────┤                                                   │
│   │      IdentityCard       │                                                   │
│   ├─────────────────────────┤                                                   │
│   │        WeekCard         │                                                   │
│   ├─────────────────────────┤                                                   │
│   │      NorthStarCard      │                                                   │
│   ├─────────────────────────┤                                                   │
│   │     GrowthTimeline      │  ← 可折叠                                         │
│   ├─────────────────────────┤                                                   │
│   │     MobileBottomNav     │                                                   │
│   └─────────────────────────┘                                                   │
│                                                                                  │
│   Tablet (640px - 1024px)                                                        │
│   ═══════════════════════════                                                    │
│                                                                                  │
│   ┌─────────────────────────────────────────────┐                               │
│   │              AmbientHeader                  │                               │
│   ├──────────────────────┬──────────────────────┤                               │
│   │      TodayCard       │    IdentityCard      │                               │
│   ├──────────────────────┼──────────────────────┤                               │
│   │     NorthStarCard    │      WeekCard        │                               │
│   ├──────────────────────┴──────────────────────┤                               │
│   │              GrowthTimeline                 │                               │
│   └─────────────────────────────────────────────┘                               │
│                                                                                  │
│   Desktop (>1024px)                                                              │
│   ═════════════════════                                                          │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │                           AmbientHeader                                  │   │
│   ├──────────────────────────────┬───────────────────────────────────────────┤   │
│   │         IdentityCard         │              TodayCard                    │   │
│   ├──────────────────────────────┼───────────────────────────────────────────┤   │
│   │        NorthStarCard         │               WeekCard                    │   │
│   ├──────────────────────────────┴───────────────────────────────────────────┤   │
│   │                           GrowthTimeline                                  │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

**Tailwind Grid 配置:**

```tsx
<div className="grid gap-4
  grid-cols-1
  sm:grid-cols-2
  lg:grid-cols-2
  xl:grid-cols-2
">
  {/* Card ordering via order-* classes */}
  <IdentityCard className="sm:order-1 lg:order-1" />
  <TodayCard className="order-first sm:order-2 lg:order-2" /> {/* Mobile first */}
  <NorthStarCard className="sm:order-3 lg:order-3" />
  <WeekCard className="sm:order-4 lg:order-4" />
</div>

<GrowthTimeline className="col-span-full" />
```

---

## 动画规格

```typescript
// src/lib/dashboard/animations.ts

export const animations = {
  // 卡片入场
  cardEnter: {
    initial: { opacity: 0, y: 20 },
    animate: { opacity: 1, y: 0 },
    transition: { duration: 0.3, ease: [0.4, 0, 0.2, 1] }
  },

  // 卡片悬停
  cardHover: {
    scale: 1.02,
    y: -2,
    transition: { duration: 0.2, ease: "easeOut" }
  },

  // 签到动画
  checkIn: {
    scale: [1, 1.2, 1],
    transition: { duration: 0.5, ease: "easeInOut" }
  },

  // 数字跳动
  numberBounce: {
    scale: [1, 1.3, 1],
    transition: { duration: 0.3, ease: "easeOut" }
  },

  // 进度条填充
  progressFill: {
    initial: { scaleX: 0 },
    animate: { scaleX: 1 },
    transition: { duration: 0.8, ease: [0.4, 0, 0.2, 1] }
  },

  // 时间线节点脉冲
  todayPulse: {
    scale: [1, 1.1, 1],
    opacity: [1, 0.8, 1],
    transition: { duration: 2, repeat: Infinity, ease: "easeInOut" }
  },

  // 庆祝撒花
  confetti: {
    // 使用 canvas-confetti 库
    particleCount: 50,
    spread: 60,
    origin: { y: 0.6 }
  }
};
```

---

## 错误边界与降级

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              错误处理策略                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│   场景 1: 数据加载失败                                                           │
│   ────────────────────                                                           │
│                                                                                  │
│   ┌──────────────────────────────────────────┐                                  │
│   │                                          │                                  │
│   │         ⚠️ 加载数据时出错                │                                  │
│   │                                          │                                  │
│   │         请稍后再试                        │                                  │
│   │                                          │                                  │
│   │         [ 重试 ]                         │                                  │
│   │                                          │                                  │
│   └──────────────────────────────────────────┘                                  │
│                                                                                  │
│   场景 2: 部分数据缺失                                                           │
│   ────────────────────                                                           │
│                                                                                  │
│   ┌──────────────────────┐  ┌──────────────────────┐                           │
│   │                      │  │                      │                           │
│   │  WHO I AM    ✓      │  │  TODAY'S FOCUS       │                           │
│   │  ─────────          │  │  ─────────────       │                           │
│   │                      │  │                      │                           │
│   │  🎨 💕 🧭 ⚔️         │  │  ┌────────────────┐ │                           │
│   │                      │  │  │ 数据同步中...  │ │ ← 优雅降级                │
│   │                      │  │  │ [ 手动设置 ]   │ │                           │
│   │                      │  │  └────────────────┘ │                           │
│   │                      │  │                      │                           │
│   └──────────────────────┘  └──────────────────────┘                           │
│                                                                                  │
│   场景 3: 网络离线                                                               │
│   ────────────────────                                                           │
│                                                                                  │
│   ┌─────────────────────────────────────────────────────────────────────────┐   │
│   │  📶 当前离线 - 显示缓存数据                                              │   │
│   └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                  │
│   使用 SWR 的 fallbackData 显示上次成功获取的数据                                │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## 可访问性规范

```typescript
// a11y 检查清单

const a11yRequirements = {
  // 1. 键盘导航
  keyboard: {
    tabOrder: "逻辑顺序: Header → Today → Identity → NorthStar → Week → Timeline",
    focusVisible: "所有可交互元素必须有可见焦点状态",
    enterActivate: "Enter 键激活按钮和链接"
  },

  // 2. 屏幕阅读器
  screenReader: {
    headings: "使用语义化标题 (h2 for cards, h3 for sections)",
    landmarks: "使用 role='main', role='region'",
    liveRegions: "动态内容使用 aria-live='polite'"
  },

  // 3. 颜色对比
  contrast: {
    text: "正文文字对比度 >= 4.5:1",
    largeText: "大文字对比度 >= 3:1",
    interactive: "可交互元素对比度 >= 3:1"
  },

  // 4. 动效
  motion: {
    reduceMotion: "尊重 prefers-reduced-motion 设置",
    noCriticalAnimation: "关键信息不依赖动画传达"
  }
};
```

**示例组件:**

```tsx
// 可访问的签到按钮
<button
  onClick={handleCheckIn}
  disabled={isLoading}
  aria-label={checkedIn ? "今日已签到" : "开始今天的签到"}
  aria-pressed={checkedIn}
  className="..."
>
  {isLoading ? (
    <span aria-live="polite">签到中...</span>
  ) : checkedIn ? (
    "已签到"
  ) : (
    "开始今天"
  )}
</button>

// 进度条
<div
  role="progressbar"
  aria-valuenow={progress}
  aria-valuemin={0}
  aria-valuemax={100}
  aria-label={`月度项目进度 ${progress}%`}
>
  <div style={{ width: `${progress}%` }} />
</div>
```

---

> **Version**: 1.0 | 2026-01-19
