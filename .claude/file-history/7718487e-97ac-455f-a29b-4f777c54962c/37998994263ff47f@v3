# VibeLife Dashboard 设计规格

> **Version**: 1.0 | 2026-01-19
> **定位**: 用户人生仪表盘 - 一眼看见"我是谁、我在哪、我要去哪"
> **设计理念**: Linear 精致度 + 温暖东方美学 + 主动关怀体验

---

## 核心设计哲学

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   传统 Dashboard: 展示数据                                                  │
│   ─────────────────────────────                                             │
│   用户来看数据，然后离开                                                     │
│                                                                             │
│   VibeLife Dashboard: 镜像与陪伴                                            │
│   ─────────────────────────────                                             │
│   "每次打开，都感觉被理解、被记住、被关心"                                   │
│                                                                             │
│   不是看数据的地方，是每天遇见更好自己的地方                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 设计三问

1. **用户为什么要来 Dashboard？**
   - 不是为了看数据，是为了"被提醒我是谁"
   - 早晨：确认今天的方向
   - 晚上：看看自己走了多远

2. **Dashboard 如何让用户感到被理解？**
   - 个性化问候（基于时间 + 状态 + 历史）
   - 智能卡片排序（基于当前最需要关注的）
   - 主动推送融入界面（不打扰，但在那里）

3. **用户离开时应该带走什么？**
   - 清晰：今天最重要的一件事
   - 力量：被认可的感觉
   - 期待：想明天再来

---

## 信息架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Dashboard 信息层次                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   Layer 0: 情境感知 (Ambient)                                               │
│   ═══════════════════════════                                               │
│   • 时间问候 + 天气/节气                                                    │
│   • 用户状态感知（连续登录、今日已签到等）                                   │
│   • 主动推送预览                                                            │
│                                                                             │
│   Layer 1: 身份镜像 (WHO I AM)                                              │
│   ═══════════════════════════                                               │
│   • VibeProfile 卡片（四维原型）                                            │
│   • 身份宣言（Lifecoach）                                                   │
│   • 当前状态标签                                                            │
│                                                                             │
│   Layer 2: 人生地图 (WHERE I'M GOING)                                       │
│   ═══════════════════════════                                               │
│   • 北极星愿景                                                              │
│   • 月度项目进度                                                            │
│   • 本周大石头                                                              │
│                                                                             │
│   Layer 3: 今日行动 (WHAT TO DO TODAY)                                      │
│   ═══════════════════════════                                               │
│   • 今日杠杆行动                                                            │
│   • 签到状态                                                                │
│   • 主动推送提醒                                                            │
│                                                                             │
│   Layer 4: 成长轨迹 (HOW FAR I'VE COME)                                     │
│   ═══════════════════════════                                               │
│   • 连续签到天数                                                            │
│   • 目标完成率                                                              │
│   • 里程碑时间线                                                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 页面布局 (Desktop)

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│  VibeLife                                         🔔  ⚙️   头像                         │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                                   │   │
│  │   早安，小薇                                              2026年1月19日 周日      │   │
│  │   ─────────────────────────────────────────────────────────────────────────────   │   │
│  │   "新的一周开始了，你的愿景正在等待你的行动。"                                    │   │
│  │                                                                                   │   │
│  │   📍 小寒第三候 · 宜静心规划                                                      │   │
│  │                                                                                   │   │
│  └─────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                          │
│  ┌──────────────────────────────────┐  ┌──────────────────────────────────────────┐   │
│  │                                  │  │                                          │   │
│  │   TODAY'S VIBE                   │  │   TODAY'S FOCUS                          │   │
│  │   ════════════                   │  │   ═════════════                          │   │
│  │                                  │  │                                          │   │
│  │   今日能量 78/100                │  │   ☀️ 今日杠杆行动                         │   │
│  │   ████████████████░░░░ 🔥       │  │                                          │   │
│  │                                  │  │   □ 完成3.2节初稿                         │   │
│  │   ┌────┬────┬────┬────┐        │  │   □ 回复小明的邮件                        │   │
│  │   │事业│感情│健康│财运│        │  │   □ 30分钟阅读                            │   │
│  │   │ 85 │ 62 │ 70 │ 75 │        │  │                                          │   │
│  │   └────┴────┴────┴────┘        │  │   ─────────────────────────────────────  │   │
│  │                                  │  │                                          │   │
│  │   ☀️ 宜: 创意工作、头脑风暴     │  │   🔥 连续签到: 7天                        │   │
│  │   ⚠️ 慎: 重大财务决定           │  │                                          │   │
│  │                                  │  │   [ 开始今天 ]                            │   │
│  │   💡 "甲木得火生发，想法易落地"  │  │                                          │   │
│  │                                  │  │                                          │   │
│  └──────────────────────────────────┘  └──────────────────────────────────────────┘   │
│                                                                                          │
│  ┌──────────────────────────────────┐  ┌──────────────────────────────────────────┐   │
│  │                                  │  │                                          │   │
│  │   NORTH STAR                     │  │   THIS WEEK                              │   │
│  │   ──────────                     │  │   ─────────                              │   │
│  │                                  │  │                                          │   │
│  │   "我想成为一个用文字帮助         │  │   本周大石头                             │   │
│  │    他人找到方向的创作者"          │  │                                          │   │
│  │                                  │  │   ✓ 完成3.2节初稿 (创作者)               │   │
│  │   ─────────────────────────────  │  │   ○ 周三带孩子去公园 (父亲)              │   │
│  │                                  │  │   ○ 周六约会 (丈夫)                      │   │
│  │   月度项目: 完成书籍第3章         │  │   ○ 跑步3次 (个人)                       │   │
│  │                                  │  │                                          │   │
│  │   ████████░░░░░░░░░░ 40%         │  │   角色平衡:                              │   │
│  │                                  │  │   创作 ████████░░ 80%                    │   │
│  │   距离月底还有 12 天              │  │   父亲 ██████░░░░ 60%                    │   │
│  │                                  │  │   丈夫 ████░░░░░░ 40%                    │   │
│  │                                  │  │   个人 ██░░░░░░░░ 20%                    │   │
│  │                                  │  │                                          │   │
│  └──────────────────────────────────┘  └──────────────────────────────────────────┘   │
│                                                                                          │
│  ┌─────────────────────────────────────────────────────────────────────────────────┐   │
│  │                                                                                   │   │
│  │   GROWTH TIMELINE                                                                 │   │
│  │   ───────────────                                                                 │   │
│  │                                                                                   │   │
│  │   2026.01.01 ──●── 设定年度愿景                                                  │   │
│  │               │                                                                   │   │
│  │   2026.01.07 ──●── 完成第一周签到                                                │   │
│  │               │                                                                   │   │
│  │   2026.01.15 ──●── 第2章定稿                                                     │   │
│  │               │                                                                   │   │
│  │   2026.01.19 ──○── 今天                                                          │   │
│  │               │                                                                   │   │
│  │   2026.01.31 ──◇── 月度目标: 第3章完成                                           │   │
│  │                                                                                   │   │
│  └─────────────────────────────────────────────────────────────────────────────────┘   │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 页面布局 (Mobile)

```
┌─────────────────────────────────┐
│  VibeLife          🔔    👤     │
├─────────────────────────────────┤
│                                 │
│  早安，小薇                     │
│  "新的一周，新的可能"           │
│                                 │
│  ┌─────────────────────────┐   │
│  │                         │   │
│  │  ☀️ 今日杠杆行动         │   │
│  │                         │   │
│  │  □ 完成3.2节初稿        │   │
│  │  □ 回复小明的邮件       │   │
│  │  □ 30分钟阅读           │   │
│  │                         │   │
│  │  🔥 7天   [ 开始今天 ]  │   │
│  │                         │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │                         │   │
│  │  WHO I AM               │   │
│  │                         │   │
│  │  ┌──┐ ┌──┐ ┌──┐ ┌──┐   │   │
│  │  │🎨│ │💕│ │🧭│ │⚔️│   │   │
│  │  └──┘ └──┘ └──┘ └──┘   │   │
│  │                         │   │
│  │  "我是一个每天都在      │   │
│  │   创造的人"             │   │
│  │                         │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │                         │   │
│  │  本周大石头  2/4        │   │
│  │                         │   │
│  │  ✓ 完成3.2节初稿        │   │
│  │  ○ 周三带孩子去公园     │   │
│  │  ○ 周六约会             │   │
│  │  ○ 跑步3次              │   │
│  │                         │   │
│  └─────────────────────────┘   │
│                                 │
│  ┌─────────────────────────┐   │
│  │                         │   │
│  │  月度进度               │   │
│  │  ████████░░░░ 40%       │   │
│  │  第3章 · 还剩12天       │   │
│  │                         │   │
│  └─────────────────────────┘   │
│                                 │
├─────────────────────────────────┤
│  🏠    💬    📊    👤           │
│ Home  Chat  Stats Profile       │
└─────────────────────────────────┘
```

---

## 数据流架构

```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                              Dashboard 数据流                                            │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                          │
│   ┌───────────────────────────────────────────────────────────────────────────────────┐ │
│   │                              Frontend (Next.js)                                    │ │
│   │                                                                                    │ │
│   │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                  │ │
│   │   │  DashboardPage  │  │  useDashboard   │  │   Zustand       │                  │ │
│   │   │    (RSC)        │──│     Hook        │──│    Store        │                  │ │
│   │   └─────────────────┘  └─────────────────┘  └─────────────────┘                  │ │
│   │          │                     │                    │                              │ │
│   │          │              ┌──────┴──────┐            │                              │ │
│   │          │              │             │            │                              │ │
│   │          ▼              ▼             ▼            ▼                              │ │
│   │   ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐                │ │
│   │   │  SWR Cache  │ │  SWR Cache  │ │  SWR Cache  │ │  SWR Cache  │                │ │
│   │   │ VibeProfile │ │ Lifecoach   │ │ Proactive   │ │   Stats     │                │ │
│   │   └──────┬──────┘ └──────┬──────┘ └──────┬──────┘ └──────┬──────┘                │ │
│   │          │               │               │               │                        │ │
│   └──────────┼───────────────┼───────────────┼───────────────┼────────────────────────┘ │
│              │               │               │               │                          │
│              └───────────────┴───────────────┴───────────────┘                          │
│                                      │                                                   │
│                                      ▼                                                   │
│   ┌───────────────────────────────────────────────────────────────────────────────────┐ │
│   │                              API Layer                                             │ │
│   │                                                                                    │ │
│   │   GET /api/dashboard                                                               │ │
│   │   ├── 聚合多个数据源                                                               │ │
│   │   ├── 计算派生数据 (进度、状态)                                                    │ │
│   │   └── 返回 DashboardDTO                                                            │ │
│   │                                                                                    │ │
│   │   或分离调用:                                                                       │ │
│   │   ├── GET /api/vibe-profile/{user_id}                                              │ │
│   │   ├── GET /api/lifecoach/state/{user_id}                                           │ │
│   │   ├── GET /api/proactive/today/{user_id}                                           │ │
│   │   └── GET /api/stats/overview/{user_id}                                            │ │
│   │                                                                                    │ │
│   └───────────────────────────────────────────────────────────────────────────────────┘ │
│                                      │                                                   │
│                                      ▼                                                   │
│   ┌───────────────────────────────────────────────────────────────────────────────────┐ │
│   │                              Backend Services                                      │ │
│   │                                                                                    │ │
│   │   ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                  │ │
│   │   │ VibeProfile     │  │   Lifecoach     │  │   Proactive     │                  │ │
│   │   │ Repository      │  │   Service       │  │   Engine        │                  │ │
│   │   └────────┬────────┘  └────────┬────────┘  └────────┬────────┘                  │ │
│   │            │                    │                    │                            │ │
│   │            └────────────────────┴────────────────────┘                            │ │
│   │                                 │                                                  │ │
│   │                                 ▼                                                  │ │
│   │                        ┌─────────────────┐                                        │ │
│   │                        │   PostgreSQL    │                                        │ │
│   │                        │ unified_profiles│                                        │ │
│   │                        │   + 相关表      │                                        │ │
│   │                        └─────────────────┘                                        │ │
│   │                                                                                    │ │
│   └───────────────────────────────────────────────────────────────────────────────────┘ │
│                                                                                          │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

---

## 数据模型

### DashboardDTO

```typescript
// src/types/dashboard.ts

interface DashboardDTO {
  // Meta
  userId: string;
  generatedAt: string;

  // Layer 0: Ambient
  ambient: {
    greeting: string;           // "早安，小薇"
    message: string;            // 个性化消息
    date: string;               // "2026年1月19日 周日"
    solarTerm?: string;         // "小寒第三候"
    suggestion?: string;        // "宜静心规划"
  };

  // Layer 1: WHO I AM
  identity: {
    archetypes: {
      core: ArchetypeId;
      inner: ArchetypeId;
      outer: ArchetypeId;
      shadow: ArchetypeId;
    };
    statement?: string;         // 身份宣言
    currentState?: string;      // 当前状态
    tags?: string[];            // 状态标签
  };

  // Layer 2: WHERE I'M GOING
  northStar: {
    vision?: string;            // 北极星愿景
    monthlyProject?: {
      name: string;
      progress: number;         // 0-100
      daysRemaining: number;
    };
    yearGoal?: string;
  };

  // Layer 3: TODAY'S FOCUS
  today: {
    levers: Array<{
      id: string;
      text: string;
      completed: boolean;
    }>;
    streak: number;             // 连续签到天数
    checkedIn: boolean;         // 今日是否已签到
    proactiveMessage?: string;  // 今日主动推送
  };

  // Layer 4: THIS WEEK
  week: {
    rocks: Array<{
      id: string;
      text: string;
      role: string;             // 角色
      completed: boolean;
    }>;
    roleBalance: Record<string, number>;  // 角色 → 完成度
  };

  // Layer 5: GROWTH
  growth: {
    milestones: Array<{
      date: string;
      title: string;
      type: 'past' | 'today' | 'future';
    }>;
    stats: {
      totalDays: number;        // 使用总天数
      goalsCompleted: number;   // 完成目标数
      insightsGained: number;   // 获得洞察数
    };
  };
}
```

---

## 组件架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         Dashboard 组件树                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   DashboardPage (RSC)                                                       │
│   │                                                                         │
│   ├── DashboardProvider (Client - Context + State)                          │
│   │   │                                                                     │
│   │   ├── AmbientHeader                                                     │
│   │   │   ├── Greeting                                                      │
│   │   │   ├── DateDisplay                                                   │
│   │   │   └── SolarTermBadge                                                │
│   │   │                                                                     │
│   │   ├── DashboardGrid                                                     │
│   │   │   │                                                                 │
│   │   │   ├── IdentityCard (WHO I AM)                                       │
│   │   │   │   ├── ArchetypeQuad                                             │
│   │   │   │   │   └── ArchetypeBadge × 4                                    │
│   │   │   │   ├── IdentityStatement                                         │
│   │   │   │   └── CurrentStateTag                                           │
│   │   │   │                                                                 │
│   │   │   ├── TodayCard (TODAY'S FOCUS)                                     │
│   │   │   │   ├── LeverList                                                 │
│   │   │   │   │   └── LeverItem × n                                         │
│   │   │   │   ├── StreakBadge                                               │
│   │   │   │   └── CheckInButton                                             │
│   │   │   │                                                                 │
│   │   │   ├── NorthStarCard (NORTH STAR)                                    │
│   │   │   │   ├── VisionQuote                                               │
│   │   │   │   ├── MonthlyProgress                                           │
│   │   │   │   │   └── ProgressBar                                           │
│   │   │   │   └── Countdown                                                 │
│   │   │   │                                                                 │
│   │   │   └── WeekCard (THIS WEEK)                                          │
│   │   │       ├── RockList                                                  │
│   │   │       │   └── RockItem × n                                          │
│   │   │       └── RoleBalance                                               │
│   │   │           └── RoleBar × n                                           │
│   │   │                                                                     │
│   │   └── GrowthTimeline                                                    │
│   │       └── MilestoneNode × n                                             │
│   │                                                                         │
│   └── MobileBottomNav (Client - Mobile Only)                                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 卡片设计规范

### 卡片视觉语言

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                         卡片设计系统                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   基础卡片                                                                   │
│   ──────────                                                                │
│                                                                             │
│   ┌─────────────────────────────────────┐                                  │
│   │                                     │                                  │
│   │  ░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░░  │  ← 顶部微妙渐变 (4px)             │
│   │                                     │                                  │
│   │   CARD TITLE                        │  ← 标题: 12px, 字重 500, 灰色    │
│   │   ───────────                       │                                  │
│   │                                     │                                  │
│   │   主要内容区域                       │  ← 内容: 14-16px, 正常字重       │
│   │                                     │                                  │
│   │                                     │                                  │
│   │   [ Action Button ]                 │  ← 操作按钮: 底部对齐            │
│   │                                     │                                  │
│   └─────────────────────────────────────┘                                  │
│                                                                             │
│   样式规范:                                                                  │
│   • 圆角: 16px (大卡片) / 12px (小卡片)                                     │
│   • 阴影: 多层柔和阴影 (Linear 风格)                                        │
│   • 背景: rgba(255, 255, 255, 0.8) + backdrop-blur                          │
│   • 边框: 无边框，用阴影分隔                                                 │
│   • 内边距: 20px (大) / 16px (中) / 12px (小)                               │
│   • hover: translateY(-2px) + 阴影加深                                      │
│                                                                             │
│   ─────────────────────────────────────────────────────────────────────     │
│                                                                             │
│   状态变体                                                                   │
│   ──────────                                                                │
│                                                                             │
│   Default    完成       高亮        需关注                                  │
│   ┌─────┐   ┌─────┐   ┌─────┐    ┌─────┐                                   │
│   │     │   │ ✓   │   │ ★   │    │ !   │                                   │
│   │     │   │     │   │     │    │     │                                   │
│   └─────┘   └─────┘   └─────┘    └─────┘                                   │
│   白底      浅绿边     金色光晕    橙色脉冲                                  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Tailwind 实现

```css
/* 基础卡片样式 */
.dashboard-card {
  @apply relative rounded-2xl p-5
         bg-white/80 backdrop-blur-sm
         shadow-[0_1px_2px_rgba(0,0,0,0.04),0_4px_8px_rgba(0,0,0,0.04),0_8px_16px_rgba(0,0,0,0.02)]
         transition-all duration-200 ease-out
         hover:translate-y-[-2px]
         hover:shadow-[0_2px_4px_rgba(0,0,0,0.06),0_8px_16px_rgba(0,0,0,0.06),0_16px_32px_rgba(0,0,0,0.04)];
}

/* 顶部渐变装饰 */
.dashboard-card::before {
  @apply absolute top-0 left-0 right-0 h-1 rounded-t-2xl
         bg-gradient-to-r from-primary-400 to-primary-600
         opacity-60;
  content: '';
}

/* 完成状态 */
.dashboard-card--completed {
  @apply border-2 border-green-200;
}

/* 高亮状态 */
.dashboard-card--highlight {
  @apply ring-2 ring-amber-300 ring-offset-2;
}

/* 需关注状态 */
.dashboard-card--attention {
  @apply animate-pulse border-2 border-orange-300;
}
```

---

## 交互设计

### 签到流程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           签到交互流程                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   状态 1: 未签到                                                            │
│   ────────────────                                                          │
│                                                                             │
│   ┌───────────────────────────────────┐                                    │
│   │                                   │                                    │
│   │  ☀️ 今日杠杆行动                   │                                    │
│   │                                   │                                    │
│   │  □ 完成3.2节初稿                  │                                    │
│   │  □ 回复小明的邮件                 │                                    │
│   │  □ 30分钟阅读                     │                                    │
│   │                                   │                                    │
│   │  🔥 7天   [ 开始今天 ]  ← 主按钮  │                                    │
│   │                                   │                                    │
│   └───────────────────────────────────┘                                    │
│                                                                             │
│           │ 点击 "开始今天"                                                 │
│           ▼                                                                 │
│                                                                             │
│   状态 2: 签到动画                                                          │
│   ────────────────                                                          │
│                                                                             │
│   ┌───────────────────────────────────┐                                    │
│   │                                   │                                    │
│   │              ✨                    │                                    │
│   │           🔥 8天                   │ ← 数字跳动 + 火焰放大              │
│   │              ✨                    │                                    │
│   │                                   │                                    │
│   │  "新的一天，新的开始！"           │ ← 鼓励语                           │
│   │                                   │                                    │
│   └───────────────────────────────────┘                                    │
│                                                                             │
│           │ 1.5s 后自动过渡                                                 │
│           ▼                                                                 │
│                                                                             │
│   状态 3: 已签到                                                            │
│   ────────────────                                                          │
│                                                                             │
│   ┌───────────────────────────────────┐                                    │
│   │                                   │                                    │
│   │  ✓ 今日杠杆行动                   │ ← 标题变绿                         │
│   │                                   │                                    │
│   │  ☑ 完成3.2节初稿      ← 可勾选   │                                    │
│   │  □ 回复小明的邮件                 │                                    │
│   │  □ 30分钟阅读                     │                                    │
│   │                                   │                                    │
│   │  🔥 8天   进度 1/3                │ ← 显示完成进度                     │
│   │                                   │                                    │
│   └───────────────────────────────────┘                                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 卡片交互

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           卡片交互模式                                       │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   悬停展开 (Desktop)                                                        │
│   ──────────────────                                                        │
│                                                                             │
│   Normal:                          Hover:                                   │
│   ┌──────────────────┐             ┌──────────────────┐                    │
│   │                  │             │                  │ ↑ translate(-2px)  │
│   │  WHO I AM        │   ────▶    │  WHO I AM        │                    │
│   │  🎨 💕 🧭 ⚔️      │             │  🎨 💕 🧭 ⚔️      │                    │
│   │                  │             │                  │                    │
│   └──────────────────┘             │  ──────────────  │                    │
│                                    │  查看详情 →      │ ← 显示操作         │
│                                    │                  │                    │
│                                    └──────────────────┘                    │
│                                                                             │
│   点击展开详情 (Modal)                                                       │
│   ────────────────────                                                      │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                                                                     │  │
│   │   WHO I AM                                                    ✕     │  │
│   │   ═══════════                                                       │  │
│   │                                                                     │  │
│   │   ┌────────────────────────────────────────────────────────────┐   │  │
│   │   │                                                            │   │  │
│   │   │        🎨                    💕                            │   │  │
│   │   │      创造者                  情人                          │   │  │
│   │   │       核心                   内在                          │   │  │
│   │   │                                                            │   │  │
│   │   │        🧭                    ⚔️                            │   │  │
│   │   │      探索者                  英雄                          │   │  │
│   │   │       外在                   阴影                          │   │  │
│   │   │                                                            │   │  │
│   │   └────────────────────────────────────────────────────────────┘   │  │
│   │                                                                     │  │
│   │   身份宣言                                                          │  │
│   │   ──────────                                                        │  │
│   │   "我是一个每天都在创造、用作品连接世界的人"                        │  │
│   │                                                                     │  │
│   │   核心优势                                                          │  │
│   │   ──────────                                                        │  │
│   │   • 将想象变为现实的能力                                            │  │
│   │   • 深度连接与感受美的能力                                          │  │
│   │                                                                     │  │
│   │   成长方向                                                          │  │
│   │   ──────────                                                        │  │
│   │   • 完成而非只是开始                                                │  │
│   │   • 保持独立自我                                                    │  │
│   │                                                                     │  │
│   │                               [ 与 AI 深入探索 ]                    │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 智能排序算法

```typescript
// src/lib/dashboard/card-priority.ts

interface CardPriority {
  cardId: string;
  score: number;
  reason: string;
}

/**
 * 计算卡片优先级
 * 原则：最需要关注的在前面
 */
function calculateCardPriorities(data: DashboardDTO): CardPriority[] {
  const priorities: CardPriority[] = [];
  const now = new Date();
  const hour = now.getHours();

  // 1. 今日卡片 - 早晨优先
  if (!data.today.checkedIn) {
    priorities.push({
      cardId: 'today',
      score: hour < 12 ? 100 : 80,  // 中午前更高优先级
      reason: '未签到'
    });
  } else {
    const completedCount = data.today.levers.filter(l => l.completed).length;
    const totalCount = data.today.levers.length;
    priorities.push({
      cardId: 'today',
      score: 50 + (1 - completedCount / totalCount) * 30,
      reason: `${completedCount}/${totalCount} 完成`
    });
  }

  // 2. 身份卡片 - 稳定显示
  priorities.push({
    cardId: 'identity',
    score: 70,
    reason: '核心身份'
  });

  // 3. 本周卡片 - 周末提升优先级
  const dayOfWeek = now.getDay();
  const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
  const weekProgress = data.week.rocks.filter(r => r.completed).length / data.week.rocks.length;

  priorities.push({
    cardId: 'week',
    score: isWeekend ? 90 : (60 + (1 - weekProgress) * 20),
    reason: isWeekend ? '周末复盘' : `${Math.round(weekProgress * 100)}% 完成`
  });

  // 4. 北极星卡片 - 月末提升优先级
  const dayOfMonth = now.getDate();
  const isEndOfMonth = dayOfMonth > 25;

  priorities.push({
    cardId: 'northStar',
    score: isEndOfMonth ? 85 : 55,
    reason: isEndOfMonth ? '月末冲刺' : '长期愿景'
  });

  // 5. 成长时间线 - 有里程碑临近时提升
  const upcomingMilestone = data.growth.milestones.find(
    m => m.type === 'future' && new Date(m.date).getTime() - now.getTime() < 7 * 24 * 60 * 60 * 1000
  );

  priorities.push({
    cardId: 'growth',
    score: upcomingMilestone ? 75 : 40,
    reason: upcomingMilestone ? '里程碑临近' : '成长记录'
  });

  return priorities.sort((a, b) => b.score - a.score);
}
```

---

## 主动推送集成

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                      Dashboard 主动推送集成                                  │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   触发场景                                                                   │
│   ──────────                                                                │
│                                                                             │
│   1. 每日签到提醒 (08:00)                                                   │
│      └─ 嵌入 Today 卡片顶部                                                 │
│                                                                             │
│   2. 周复盘引导 (周日 20:00)                                                │
│      └─ 浮动卡片 + Week 卡片高亮                                            │
│                                                                             │
│   3. 月度检查 (月初)                                                        │
│      └─ NorthStar 卡片高亮 + Modal 引导                                     │
│                                                                             │
│   4. 关怀询问 (连续3天未登录)                                               │
│      └─ 全屏温暖问候                                                        │
│                                                                             │
│   ─────────────────────────────────────────────────────────────────────     │
│                                                                             │
│   视觉呈现                                                                   │
│   ──────────                                                                │
│                                                                             │
│   嵌入式:                                                                   │
│   ┌───────────────────────────────────┐                                    │
│   │  ┌─────────────────────────────┐  │                                    │
│   │  │ 💬 "早安！今天的杠杆行动..." │  │ ← 卡片内嵌消息                    │
│   │  └─────────────────────────────┘  │                                    │
│   │                                   │                                    │
│   │  □ 完成3.2节初稿                  │                                    │
│   │  □ 回复小明的邮件                 │                                    │
│   │                                   │                                    │
│   └───────────────────────────────────┘                                    │
│                                                                             │
│   浮动式:                                                                   │
│   ┌───────────────────────────────────────────────────────────────────┐    │
│   │                                                                   │    │
│   │  ┌─────────────────────────────────────────────────────────────┐ │    │
│   │  │                                                             │ │    │
│   │  │  这周结束了                                                  │ │    │
│   │  │  ──────────                                                 │ │    │
│   │  │                                                             │ │    │
│   │  │  "回顾过去7天，你完成了3/4个大石头。                        │ │    │
│   │  │   想聊聊这周的收获吗？"                                     │ │    │
│   │  │                                                             │ │    │
│   │  │              [ 开始周复盘 ]  [ 稍后再说 ]                   │ │    │
│   │  │                                                             │ │    │
│   │  └─────────────────────────────────────────────────────────────┘ │    │
│   │                                                                   │    │
│   └───────────────────────────────────────────────────────────────────┘    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 空状态设计

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           空状态处理                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   新用户 (无任何数据)                                                        │
│   ────────────────────                                                      │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐  │
│   │                                                                     │  │
│   │                          🌱                                         │  │
│   │                                                                     │  │
│   │                    欢迎来到 VibeLife                                │  │
│   │                                                                     │  │
│   │         让我们一起开始这段理解自己的旅程                            │  │
│   │                                                                     │  │
│   │                                                                     │  │
│   │         ┌─────────────────────────────────────────┐                │  │
│   │         │                                         │                │  │
│   │         │  第一步：和我聊聊你是谁                 │                │  │
│   │         │                                         │                │  │
│   │         │  我会通过对话了解你，帮你发现            │                │  │
│   │         │  属于你的人格原型和人生方向              │                │  │
│   │         │                                         │                │  │
│   │         │         [ 开始对话 ]                    │                │  │
│   │         │                                         │                │  │
│   │         └─────────────────────────────────────────┘                │  │
│   │                                                                     │  │
│   └─────────────────────────────────────────────────────────────────────┘  │
│                                                                             │
│   ─────────────────────────────────────────────────────────────────────     │
│                                                                             │
│   部分数据缺失                                                               │
│   ──────────────                                                            │
│                                                                             │
│   有 VibeProfile，无 Lifecoach:                                             │
│                                                                             │
│   ┌──────────────────────────────────┐  ┌──────────────────────────────┐   │
│   │  WHO I AM           ✓           │  │  TODAY'S FOCUS               │   │
│   │  ─────────                      │  │  ─────────────               │   │
│   │                                 │  │                              │   │
│   │  🎨 💕 🧭 ⚔️                     │  │  ┌──────────────────────┐   │   │
│   │                                 │  │  │                      │   │   │
│   │  "我是一个创造者"               │  │  │  还没有设定目标       │   │   │
│   │                                 │  │  │                      │   │   │
│   └──────────────────────────────────┘  │  │  [ 设定今日计划 ]    │   │   │
│                                         │  │                      │   │   │
│                                         │  └──────────────────────┘   │   │
│                                         │                              │   │
│                                         └──────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 性能优化策略

```typescript
// 性能优化清单

/**
 * 1. 数据获取优化
 */
// 使用 SWR 进行数据缓存和去重
const { data } = useSWR('/api/dashboard', fetcher, {
  revalidateOnFocus: false,
  dedupingInterval: 60000,  // 1分钟内不重复请求
});

// 并行获取独立数据
const [profile, lifecoach, proactive] = await Promise.all([
  fetchProfile(userId),
  fetchLifecoach(userId),
  fetchProactive(userId),
]);

/**
 * 2. 渲染优化
 */
// 使用 memo 防止不必要的重渲染
const IdentityCard = memo(function IdentityCard({ archetypes }) {
  // ...
});

// 虚拟化长列表 (如 milestones)
<VirtualizedList
  items={milestones}
  itemHeight={60}
  renderItem={(item) => <MilestoneNode {...item} />}
/>

/**
 * 3. 代码分割
 */
// 动态导入模态框组件
const IdentityModal = dynamic(() => import('./IdentityModal'), {
  loading: () => <ModalSkeleton />,
});

/**
 * 4. 骨架屏
 */
// 加载时显示骨架屏
{isLoading ? (
  <DashboardSkeleton />
) : (
  <DashboardContent data={data} />
)}
```

---

## 文件结构

```
apps/web/src/
├── app/
│   └── dashboard/
│       ├── page.tsx                    # Dashboard 页面入口 (RSC)
│       ├── loading.tsx                 # 加载状态
│       └── error.tsx                   # 错误处理
│
├── components/
│   └── dashboard/
│       ├── DashboardProvider.tsx       # 状态管理 Provider
│       ├── DashboardGrid.tsx           # 网格布局
│       ├── AmbientHeader.tsx           # 问候区域
│       │
│       ├── cards/
│       │   ├── IdentityCard.tsx        # WHO I AM 卡片
│       │   ├── TodayCard.tsx           # 今日焦点卡片
│       │   ├── NorthStarCard.tsx       # 北极星卡片
│       │   ├── WeekCard.tsx            # 本周卡片
│       │   └── GrowthTimeline.tsx      # 成长时间线
│       │
│       ├── shared/
│       │   ├── DashboardCard.tsx       # 基础卡片组件
│       │   ├── ProgressBar.tsx         # 进度条
│       │   ├── StreakBadge.tsx         # 连续签到徽章
│       │   └── CheckInButton.tsx       # 签到按钮
│       │
│       └── modals/
│           ├── IdentityModal.tsx       # 身份详情弹窗
│           ├── WeekReviewModal.tsx     # 周复盘弹窗
│           └── ProactiveModal.tsx      # 主动推送弹窗
│
├── hooks/
│   └── useDashboard.ts                 # Dashboard 数据 Hook
│
├── lib/
│   └── dashboard/
│       ├── card-priority.ts            # 卡片优先级算法
│       └── greeting.ts                 # 问候语生成
│
├── stores/
│   └── dashboardStore.ts               # Dashboard 状态存储
│
└── types/
    └── dashboard.ts                    # TypeScript 类型定义
```

---

## 实施优先级

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           实施路线图                                         │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   Phase 1: MVP (P0) - 核心体验                                              │
│   ════════════════════════════════                                          │
│                                                                             │
│   ✓ AmbientHeader (问候 + 日期)                                             │
│   ✓ TodayCard (今日杠杆 + 签到)                                             │
│   ✓ IdentityCard (四维原型 + 身份宣言)                                      │
│   ✓ 基础响应式布局                                                          │
│   ✓ useDashboard Hook                                                       │
│                                                                             │
│   ─────────────────────────────────────────────────────────────────────     │
│                                                                             │
│   Phase 2: 完整功能 (P1)                                                    │
│   ════════════════════════                                                  │
│                                                                             │
│   □ NorthStarCard (愿景 + 月度进度)                                         │
│   □ WeekCard (大石头 + 角色平衡)                                            │
│   □ GrowthTimeline (里程碑)                                                 │
│   □ 签到动画                                                                │
│   □ 智能卡片排序                                                            │
│                                                                             │
│   ─────────────────────────────────────────────────────────────────────     │
│                                                                             │
│   Phase 3: 进阶体验 (P2)                                                    │
│   ════════════════════════                                                  │
│                                                                             │
│   □ 主动推送集成                                                            │
│   □ 详情弹窗                                                                │
│   □ 数据可视化增强                                                          │
│   □ 空状态引导                                                              │
│   □ 性能优化                                                                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 附录: API 接口规格

### GET /api/dashboard

```typescript
// Request
GET /api/dashboard?user_id={user_id}

// Response
{
  "success": true,
  "data": DashboardDTO,
  "meta": {
    "cached": boolean,
    "generatedAt": string
  }
}
```

### POST /api/dashboard/checkin

```typescript
// Request
POST /api/dashboard/checkin
{
  "user_id": string
}

// Response
{
  "success": true,
  "data": {
    "streak": number,
    "message": string,
    "animation": "fire" | "confetti" | "sparkle"
  }
}
```

### PATCH /api/dashboard/lever/:id

```typescript
// Request
PATCH /api/dashboard/lever/{lever_id}
{
  "completed": boolean
}

// Response
{
  "success": true,
  "data": {
    "lever": Lever,
    "todayProgress": {
      "completed": number,
      "total": number
    }
  }
}
```

---

> **Version**: 1.0 | 2026-01-19
> 设计师: Claude (World-class UI/UX)
> 愿景对齐: VibeLife-northstar-v8.md
