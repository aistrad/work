/**
 * Dashboard Types - V2.0 Skill-driven Dashboard
 *
 * Based on /docs/components/dashboard/DESIGN.md
 */

// ═══════════════════════════════════════════════════════════════════════════
// Dashboard DTO
// ═══════════════════════════════════════════════════════════════════════════

export interface DashboardDTO {
  // Meta
  userId: string;
  generatedAt: string;

  // Layer 0: Ambient
  ambient: AmbientData;

  // Layer 0: Status
  status: StatusData;

  // Layer 1: Lifecoach (merged card)
  lifecoach: LifecoachData;

  // Layer 2: My Skills (subscribed)
  mySkills: SkillCardData[];

  // Layer 3: Discover (unsubscribed recommendations)
  discover: DiscoverSkillData[];
}

// ═══════════════════════════════════════════════════════════════════════════
// Ambient Layer
// ═══════════════════════════════════════════════════════════════════════════

export interface AmbientData {
  greeting: string;
  quote: {
    text: string;
    author: string | null;
  };
  date: string;
  solarTerm?: string;
}

export interface StatusData {
  streak: number;
  checkedIn: boolean;
  energy?: number;
}

// ═══════════════════════════════════════════════════════════════════════════
// Lifecoach Layer (Merged Card)
// ═══════════════════════════════════════════════════════════════════════════

export interface LifecoachData {
  northStar?: string;

  monthlyProject?: {
    name: string;
    progress: number; // 0-100
    daysRemaining: number;
  };

  todayLevers: LeverItem[];

  weekRocks: RockItem[];
}

export interface LeverItem {
  id: string;
  text: string;
  completed: boolean;
}

export interface RockItem {
  id: string;
  text: string;
  role: string;
  completed: boolean;
}

// ═══════════════════════════════════════════════════════════════════════════
// Skill Card Layer
// ═══════════════════════════════════════════════════════════════════════════

export interface SkillCardData {
  skillId: string;
  cardId: string;
  title: string;
  icon: string;
  content: SkillCardContent;
  computedAt: string;
  actionLabel: string;
  actionRoute: string;
}

export interface SkillCardContent {
  headline: string;
  insights: string[];
  rating?: {
    overall: number;
    label: string;
    details?: Record<string, number>;
  };
  suggestions?: {
    do: string[];
    avoid: string[];
  };
}

// ═══════════════════════════════════════════════════════════════════════════
// Discover Layer
// ═══════════════════════════════════════════════════════════════════════════

export interface DiscoverSkillData {
  skillId: string;
  title: string;
  icon: string;
  tagline: string;
  description: string;
}

// ═══════════════════════════════════════════════════════════════════════════
// API Request/Response Types
// ═══════════════════════════════════════════════════════════════════════════

export interface DashboardResponse {
  success: boolean;
  data: DashboardDTO;
  meta?: {
    cached: boolean;
    generatedAt: string;
  };
}

export interface CheckinResponse {
  success: boolean;
  data: {
    streak: number;
    message: string;
    animation?: string;
    status: StatusData;
  };
}

export interface LeverToggleResponse {
  success: boolean;
  data: {
    lever: LeverItem;
    progress: {
      completed: number;
      total: number;
      percentage: number;
    };
    allCompleted: boolean;
  };
}

export interface SkillSubscribeResponse {
  success: boolean;
  data: {
    subscription: {
      skillId: string;
      subscribedAt: string;
    };
    card: SkillCardData;
  };
}

// ═══════════════════════════════════════════════════════════════════════════
// Quote System Types
// ═══════════════════════════════════════════════════════════════════════════

export interface Quote {
  text: string;
  author: string | null;
}

export interface QuoteContext {
  hour: number;
  dayOfWeek: number;
  dayOfMonth: number;
  month: number;
  streak: number;
  checkedIn: boolean;
  weekProgress: number;
  subscribedSkills: string[];
}

// ═══════════════════════════════════════════════════════════════════════════
// Component Props Types
// ═══════════════════════════════════════════════════════════════════════════

export interface CarouselTrackProps {
  children: React.ReactNode;
  gap?: number;
  padding?: number;
  className?: string;
}

export interface SkillCardProps {
  skillId: string;
  icon: string;
  title: string;
  content: SkillCardContent;
  actionLabel: string;
  actionRoute: string;
  onClick?: () => void;
}

export interface DiscoverCardProps {
  skillId: string;
  icon: string;
  title: string;
  tagline: string;
  description: string;
  onSubscribe: (skillId: string) => Promise<void>;
}
