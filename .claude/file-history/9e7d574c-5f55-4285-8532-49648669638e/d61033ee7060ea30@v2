# VibeLife Frontend v7.0 Specification

> **Version**: 7.0 | 2026-01-16
> **Target**: AI Agent Optimized
> **Backend**: V7 API Architecture
> **Design System**: ã€Œæš–é˜³ç¥ç§˜ã€+ åŸå‹è§†è§‰ç³»ç»Ÿ
> **Priority Source**: VibeIDè®¾è®¡-v5.md > SPEC-v7.md > Frontend-v6.md

---

## Table of Contents

1. [System Architecture](#1-system-architecture)
2. [VibeID Core Module](#2-vibeid-core-module)
3. [Design System](#3-design-system)
4. [Performance Optimization](#4-performance-optimization)
5. [Component Library & Card System](#5-component-library--card-system)
6. [API Integration & Data Flow](#6-api-integration--data-flow)
7. [Implementation Plan & Verification](#7-implementation-plan--verification)

---

## 1. System Architecture

### 1.1 Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           VibeLife Frontend v7.0                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         App Shell (Next.js 14)                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚   Layout    â”‚  â”‚   Router    â”‚  â”‚   Auth      â”‚  â”‚   Theme    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  Provider   â”‚  â”‚  (App Dir)  â”‚  â”‚  Provider   â”‚  â”‚  Provider  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Feature Modules                               â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚   VibeID    â”‚  â”‚    Chat     â”‚  â”‚   Skills    â”‚  â”‚  Commerce  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚   Module    â”‚  â”‚   Module    â”‚  â”‚   Module    â”‚  â”‚   Module   â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ (Archetype) â”‚  â”‚ (Agentic)   â”‚  â”‚ (Bazi/Zodiacâ”‚  â”‚ (Payment)  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Core Services Layer                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚    API      â”‚  â”‚   State     â”‚  â”‚   Stream    â”‚  â”‚   Card     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚   Client    â”‚  â”‚   Store     â”‚  â”‚   Handler   â”‚  â”‚  Registry  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  (SWR 2.x)  â”‚  â”‚(Zustand 4.x)â”‚  â”‚ (AI SDK 6)  â”‚  â”‚ (Dynamic)  â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Design System Layer                           â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  UI Core    â”‚  â”‚  Archetype  â”‚  â”‚  Animation  â”‚  â”‚   Theme    â”‚  â”‚   â”‚
â”‚  â”‚  â”‚ Components  â”‚  â”‚   Visuals   â”‚  â”‚   System    â”‚  â”‚   Tokens   â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Backend API (V7)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  CoreAgent  â”‚  â”‚   Skill     â”‚  â”‚    Tool     â”‚  â”‚      Knowledge      â”‚â”‚
â”‚  â”‚  (Agentic   â”‚  â”‚  Service    â”‚  â”‚  Registry   â”‚  â”‚       Store         â”‚â”‚
â”‚  â”‚   Loop)     â”‚  â”‚  Registry   â”‚  â”‚  (Schema)   â”‚  â”‚     (Qdrant)        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Technology Stack

| Category | Technology | Version | Purpose |
|----------|------------|---------|---------|
| Framework | Next.js | 14.x | App Router, RSC, Streaming |
| Language | TypeScript | 5.3+ | Type Safety |
| Styling | Tailwind CSS | 3.4 | Utility-first CSS |
| State | Zustand | 4.x | Client State Management |
| Data Fetching | SWR | 2.x | Server State + Caching |
| AI | AI SDK | 6.x | Streaming + Tool Calls |
| Charts | ECharts | 5.x | Data Visualization |
| Animation | Framer Motion | 10.x | UI Animations |
| Form | React Hook Form | 7.x | Form Handling |
| Validation | Zod | 3.x | Schema Validation |

### 1.3 Directory Structure

```
apps/web/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                          # Next.js App Router
â”‚   â”‚   â”œâ”€â”€ (auth)/                   # Auth routes group
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â””â”€â”€ register/
â”‚   â”‚   â”œâ”€â”€ (main)/                   # Main app routes
â”‚   â”‚   â”‚   â”œâ”€â”€ chat/
â”‚   â”‚   â”‚   â”œâ”€â”€ profile/
â”‚   â”‚   â”‚   â”œâ”€â”€ vibe-id/              # VibeID feature
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ page.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ archetype/[id]/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ journey/
â”‚   â”‚   â”‚   â””â”€â”€ skills/
â”‚   â”‚   â”‚       â”œâ”€â”€ bazi/
â”‚   â”‚   â”‚       â”œâ”€â”€ zodiac/
â”‚   â”‚   â”‚       â”œâ”€â”€ tarot/
â”‚   â”‚   â”‚       â””â”€â”€ career/
â”‚   â”‚   â”œâ”€â”€ api/                      # API routes (if needed)
â”‚   â”‚   â”œâ”€â”€ layout.tsx
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ components/                   # Shared components
â”‚   â”‚   â”œâ”€â”€ ui/                       # Design system primitives
â”‚   â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Input.tsx
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ layout/                   # Layout components
â”‚   â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â”‚   â””â”€â”€ BottomNav.tsx
â”‚   â”‚   â”œâ”€â”€ chat/                     # Chat components
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatContainer.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatMessage.tsx
â”‚   â”‚   â”‚   â””â”€â”€ MessageInput.tsx
â”‚   â”‚   â””â”€â”€ shared/                   # Cross-feature components
â”‚   â”‚       â”œâ”€â”€ BreathAura.tsx
â”‚   â”‚       â”œâ”€â”€ VibeGlyph.tsx
â”‚   â”‚       â””â”€â”€ InsightSeal.tsx
â”‚   â”‚
â”‚   â”œâ”€â”€ skills/                       # Skill-specific modules
â”‚   â”‚   â”œâ”€â”€ bazi/
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”œâ”€â”€ tools/                # Tool result cards
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts          # Card exports
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ show-bazi-chart.tsx
â”‚   â”‚   â”‚   â””â”€â”€ types/
â”‚   â”‚   â”œâ”€â”€ zodiac/
â”‚   â”‚   â”œâ”€â”€ tarot/
â”‚   â”‚   â”œâ”€â”€ career/
â”‚   â”‚   â”œâ”€â”€ vibe-id/                  # VibeID skill components
â”‚   â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ VibeIDCard.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ArchetypeWheel.tsx
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ArchetypeBadge.tsx
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ DimensionRow.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ tools/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ show-vibe-id.tsx
â”‚   â”‚   â”‚   â””â”€â”€ hooks/
â”‚   â”‚   â”‚       â””â”€â”€ useVibeID.ts
â”‚   â”‚   â”œâ”€â”€ CardRegistry.ts           # Dynamic card registry
â”‚   â”‚   â””â”€â”€ initCards.ts              # Card initialization
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/                        # Shared hooks
â”‚   â”‚   â”œâ”€â”€ useVibeChat.ts            # Chat hook with streaming
â”‚   â”‚   â”œâ”€â”€ useToolSchema.ts          # Tool schema fetching
â”‚   â”‚   â”œâ”€â”€ useAuth.ts
â”‚   â”‚   â””â”€â”€ useTheme.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ stores/                       # Zustand stores
â”‚   â”‚   â”œâ”€â”€ chatStore.ts
â”‚   â”‚   â”œâ”€â”€ userStore.ts
â”‚   â”‚   â””â”€â”€ vibeIdStore.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ services/                     # API services
â”‚   â”‚   â”œâ”€â”€ api.ts                    # Base API client
â”‚   â”‚   â”œâ”€â”€ chat.ts                   # Chat API
â”‚   â”‚   â””â”€â”€ skills.ts                 # Skills API
â”‚   â”‚
â”‚   â”œâ”€â”€ types/                        # TypeScript types
â”‚   â”‚   â”œâ”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ chat.ts
â”‚   â”‚   â”œâ”€â”€ vibe-id.ts
â”‚   â”‚   â””â”€â”€ skills.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ utils/                        # Utility functions
â”‚   â”‚   â”œâ”€â”€ cn.ts                     # Class name merger
â”‚   â”‚   â”œâ”€â”€ format.ts
â”‚   â”‚   â””â”€â”€ validation.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ providers/                    # React providers
â”‚   â”‚   â”œâ”€â”€ AuthProvider.tsx
â”‚   â”‚   â”œâ”€â”€ ThemeProvider.tsx
â”‚   â”‚   â””â”€â”€ Providers.tsx             # Combined provider
â”‚   â”‚
â”‚   â””â”€â”€ styles/                       # Global styles
â”‚       â”œâ”€â”€ globals.css
â”‚       â””â”€â”€ variables.css
â”‚
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ fonts/
â”‚   â”œâ”€â”€ icons/
â”‚   â””â”€â”€ images/
â”‚
â”œâ”€â”€ tailwind.config.ts
â”œâ”€â”€ next.config.js
â””â”€â”€ tsconfig.json
```

### 1.4 Data Flow Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           User Interaction                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Chat Component Layer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ChatContainer.tsx                                               â”‚   â”‚
â”‚  â”‚  - User input handling                                           â”‚   â”‚
â”‚  â”‚  - Message rendering                                             â”‚   â”‚
â”‚  â”‚  - Tool result display via CardRegistry                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      useVibeChat Hook       â”‚   â”‚           CardRegistry               â”‚
â”‚  - Stream handling          â”‚   â”‚  - Dynamic component loading         â”‚
â”‚  - Tool call processing     â”‚   â”‚  - Tool name â†’ Component mapping     â”‚
â”‚  - Message state            â”‚   â”‚  - Lazy loading for performance      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Backend API (V7)                                 â”‚
â”‚  POST /chat/v5/stream                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Request: { user_id, messages, skill_id?, context? }            â”‚   â”‚
â”‚  â”‚  Response: SSE Stream                                            â”‚   â”‚
â”‚  â”‚    - type: "text" | "tool_call" | "tool_result" | "done"        â”‚   â”‚
â”‚  â”‚    - Tool results contain structured data for card rendering     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.5 Stream Event Types

```typescript
// SSE Event Types from Backend
type StreamEventType =
  | 'text'           // Text content chunk
  | 'tool_call'      // Tool being called
  | 'tool_result'    // Tool execution result
  | 'thinking'       // Agent thinking process
  | 'error'          // Error occurred
  | 'done';          // Stream completed

interface StreamEvent {
  type: StreamEventType;
  data: unknown;
  timestamp: number;
}

interface ToolCallEvent {
  type: 'tool_call';
  data: {
    tool_name: string;      // e.g., "show_bazi_chart"
    tool_id: string;        // Unique call ID
    arguments: Record<string, unknown>;
  };
}

interface ToolResultEvent {
  type: 'tool_result';
  data: {
    tool_name: string;
    tool_id: string;
    result: Record<string, unknown>;  // Structured data for card
    skill_id?: string;                // Which skill this belongs to
  };
}
```

---

## 2. VibeID Core Module

> **Source**: VibeIDè®¾è®¡-v5.md (Primary), SPEC-v7.md
> **Priority**: Core Feature - All implementations must align with VibeID-v5.md specifications

### 2.1 Four-Dimensional Archetype System

VibeID uses Carl Jung's 12 archetypes organized across 4 dimensions to create a comprehensive personality profile.

#### 2.1.1 Dimension Definitions

| Dimension | Chinese | Description | Visibility |
|-----------|---------|-------------|------------|
| **Core** | æ ¸å¿ƒåŸå‹ | True self, fundamental nature | Private |
| **Inner** | å†…åœ¨åŸå‹ | Inner world, emotional patterns | Semi-private |
| **Outer** | å¤–åœ¨åŸå‹ | Social presentation, public persona | Public |
| **Shadow** | é˜´å½±åŸå‹ | Hidden aspects, growth areas | Private |

#### 2.1.2 The 12 Archetypes

```typescript
// src/types/vibe-id.ts

/**
 * The 12 Jungian Archetypes
 * Each archetype has associated metadata for visual presentation
 */
export type ArchetypeId =
  | 'innocent'    // å¤©çœŸè€…
  | 'explorer'    // æ¢ç´¢è€…
  | 'sage'        // æ™ºè€…
  | 'hero'        // è‹±é›„
  | 'outlaw'      // å›é€†è€…
  | 'magician'    // é­”æœ¯å¸ˆ
  | 'regular'     // å‡¡äºº
  | 'lover'       // æƒ…äºº
  | 'jester'      // æ„šè€…
  | 'caregiver'   // ç…§é¡¾è€…
  | 'creator'     // åˆ›é€ è€…
  | 'ruler';      // ç»Ÿæ²»è€…

export type DimensionId = 'core' | 'inner' | 'outer' | 'shadow';

/**
 * Archetype metadata for UI rendering
 */
export interface ArchetypeMeta {
  id: ArchetypeId;
  name: string;           // English name
  nameCn: string;         // Chinese name
  emoji: string;          // Visual identifier
  color: string;          // Hex color
  gradient: string;       // CSS gradient
  slogan: string;         // One-line description
  superpower: string;     // Key strength
  growthPoints: string[]; // Areas for development
  element: 'fire' | 'earth' | 'air' | 'water';  // Associated element
}

/**
 * Four-dimensional archetype profile
 */
export interface FourDimensionArchetypes {
  core: ArchetypeId;
  inner: ArchetypeId;
  outer: ArchetypeId;
  shadow: ArchetypeId;
}

/**
 * Complete VibeID profile
 */
export interface VibeIDProfile {
  userId: string;
  archetypes: FourDimensionArchetypes;
  scores: Record<ArchetypeId, number>;  // 0-100 score per archetype
  confidence: number;                    // 0-1 calculation confidence
  calculatedAt: string;                  // ISO timestamp
  source: 'bazi' | 'zodiac' | 'interview' | 'combined';

  // Optional extended data
  dimensionScores?: {
    core: Record<ArchetypeId, number>;
    inner: Record<ArchetypeId, number>;
    outer: Record<ArchetypeId, number>;
    shadow: Record<ArchetypeId, number>;
  };
}
```

### 2.2 Archetype Metadata Constant

```typescript
// src/skills/vibe-id/constants/archetypes.ts

import type { ArchetypeMeta, ArchetypeId } from '@/types/vibe-id';

/**
 * Complete archetype metadata registry
 * Source: VibeIDè®¾è®¡-v5.md Section 3.2
 */
export const ARCHETYPE_META: Record<ArchetypeId, ArchetypeMeta> = {
  innocent: {
    id: 'innocent',
    name: 'Innocent',
    nameCn: 'å¤©çœŸè€…',
    emoji: 'ğŸŒ¸',
    color: '#FFB7C5',
    gradient: 'linear-gradient(135deg, #FFB7C5 0%, #FFF0F3 100%)',
    slogan: 'è¿½æ±‚çº¯ç²¹ä¸ç¾å¥½',
    superpower: 'ä¿æŒä¹è§‚ä¸ä¿¡ä»»çš„èƒ½åŠ›',
    growthPoints: ['é¢å¯¹ç°å®çš„å¤æ‚æ€§', 'å»ºç«‹å¥åº·çš„è¾¹ç•Œ'],
    element: 'air'
  },
  explorer: {
    id: 'explorer',
    name: 'Explorer',
    nameCn: 'æ¢ç´¢è€…',
    emoji: 'ğŸ§­',
    color: '#87CEEB',
    gradient: 'linear-gradient(135deg, #87CEEB 0%, #E0F4FF 100%)',
    slogan: 'è¿½å¯»è‡ªç”±ä¸å‘ç°',
    superpower: 'å‹‡äºæ¢ç´¢æœªçŸ¥çš„å‹‡æ°”',
    growthPoints: ['å­¦ä¼šæ‰¿è¯ºä¸æ‰æ ¹', 'å¹³è¡¡å†’é™©ä¸è´£ä»»'],
    element: 'air'
  },
  sage: {
    id: 'sage',
    name: 'Sage',
    nameCn: 'æ™ºè€…',
    emoji: 'ğŸ“š',
    color: '#9B59B6',
    gradient: 'linear-gradient(135deg, #9B59B6 0%, #E8D5F2 100%)',
    slogan: 'è¿½æ±‚çœŸç†ä¸æ™ºæ…§',
    superpower: 'æ´å¯Ÿæœ¬è´¨çš„åˆ†æèƒ½åŠ›',
    growthPoints: ['å°†çŸ¥è¯†è½¬åŒ–ä¸ºè¡ŒåŠ¨', 'æ¥çº³éç†æ€§çš„æƒ…æ„Ÿ'],
    element: 'air'
  },
  hero: {
    id: 'hero',
    name: 'Hero',
    nameCn: 'è‹±é›„',
    emoji: 'âš”ï¸',
    color: '#E74C3C',
    gradient: 'linear-gradient(135deg, #E74C3C 0%, #FADBD8 100%)',
    slogan: 'å‹‡æ•¢é¢å¯¹æŒ‘æˆ˜',
    superpower: 'å…‹æœå›°éš¾çš„å‹‡æ°”ä¸æ¯…åŠ›',
    growthPoints: ['å­¦ä¼šæ¥å—å¸®åŠ©', 'å¹³è¡¡åˆšå¼ºä¸æŸ”è½¯'],
    element: 'fire'
  },
  outlaw: {
    id: 'outlaw',
    name: 'Outlaw',
    nameCn: 'å›é€†è€…',
    emoji: 'ğŸ”¥',
    color: '#8B0000',
    gradient: 'linear-gradient(135deg, #8B0000 0%, #E6B8AF 100%)',
    slogan: 'æ‰“ç ´å¸¸è§„åˆ›é€ å˜é©',
    superpower: 'æŒ‘æˆ˜æƒå¨çš„å‹‡æ°”',
    growthPoints: ['å»ºè®¾æ€§åœ°ä½¿ç”¨ç ´ååŠ›', 'æ‰¾åˆ°å½’å±æ„Ÿ'],
    element: 'fire'
  },
  magician: {
    id: 'magician',
    name: 'Magician',
    nameCn: 'é­”æœ¯å¸ˆ',
    emoji: 'âœ¨',
    color: '#8E44AD',
    gradient: 'linear-gradient(135deg, #8E44AD 0%, #D7BDE2 100%)',
    slogan: 'åŒ–ä¸å¯èƒ½ä¸ºå¯èƒ½',
    superpower: 'è½¬åŒ–ä¸åˆ›é€ å¥‡è¿¹çš„èƒ½åŠ›',
    growthPoints: ['è„šè¸å®åœ°è½åœ°', 'é¿å…æ“æ§ä»–äºº'],
    element: 'fire'
  },
  regular: {
    id: 'regular',
    name: 'Regular',
    nameCn: 'å‡¡äºº',
    emoji: 'ğŸ¤',
    color: '#27AE60',
    gradient: 'linear-gradient(135deg, #27AE60 0%, #D5F5E3 100%)',
    slogan: 'è„šè¸å®åœ°èå…¥ç¾¤ä½“',
    superpower: 'å»ºç«‹çœŸè¯šè¿æ¥çš„èƒ½åŠ›',
    growthPoints: ['å‘å±•ç‹¬ç‰¹ä¸ªæ€§', 'ä¸æƒ§ä¸ä¼—ä¸åŒ'],
    element: 'earth'
  },
  lover: {
    id: 'lover',
    name: 'Lover',
    nameCn: 'æƒ…äºº',
    emoji: 'ğŸ’•',
    color: '#E91E63',
    gradient: 'linear-gradient(135deg, #E91E63 0%, #F8BBD9 100%)',
    slogan: 'è¿½æ±‚äº²å¯†ä¸çƒ­æƒ…',
    superpower: 'æ·±åº¦è¿æ¥ä¸æ„Ÿå—ç¾çš„èƒ½åŠ›',
    growthPoints: ['ä¿æŒç‹¬ç«‹è‡ªæˆ‘', 'å¹³è¡¡ä»˜å‡ºä¸æ¥å—'],
    element: 'water'
  },
  jester: {
    id: 'jester',
    name: 'Jester',
    nameCn: 'æ„šè€…',
    emoji: 'ğŸ­',
    color: '#F39C12',
    gradient: 'linear-gradient(135deg, #F39C12 0%, #FDEBD0 100%)',
    slogan: 'æ´»åœ¨å½“ä¸‹äº«å—äººç”Ÿ',
    superpower: 'å¸¦æ¥æ¬¢ä¹ä¸è½»æ¾çš„èƒ½åŠ›',
    growthPoints: ['é¢å¯¹ä¸¥è‚ƒè®®é¢˜', 'å‘å±•æ·±åº¦å…³ç³»'],
    element: 'fire'
  },
  caregiver: {
    id: 'caregiver',
    name: 'Caregiver',
    nameCn: 'ç…§é¡¾è€…',
    emoji: 'ğŸŒ¿',
    color: '#2ECC71',
    gradient: 'linear-gradient(135deg, #2ECC71 0%, #E8F8F5 100%)',
    slogan: 'å…³çˆ±ä»–äººæ— ç§å¥‰çŒ®',
    superpower: 'æ»‹å…»ä¸æ”¯æŒä»–äººçš„èƒ½åŠ›',
    growthPoints: ['å­¦ä¼šè‡ªæˆ‘å…³æ€€', 'è®¾ç«‹å¥åº·è¾¹ç•Œ'],
    element: 'earth'
  },
  creator: {
    id: 'creator',
    name: 'Creator',
    nameCn: 'åˆ›é€ è€…',
    emoji: 'ğŸ¨',
    color: '#3498DB',
    gradient: 'linear-gradient(135deg, #3498DB 0%, #D6EAF8 100%)',
    slogan: 'åˆ›é€ ç‹¬ç‰¹ä»·å€¼',
    superpower: 'å°†æƒ³è±¡å˜ä¸ºç°å®çš„èƒ½åŠ›',
    growthPoints: ['å®Œæˆè€Œéåªæ˜¯å¼€å§‹', 'æ¥å—ä¸å®Œç¾'],
    element: 'water'
  },
  ruler: {
    id: 'ruler',
    name: 'Ruler',
    nameCn: 'ç»Ÿæ²»è€…',
    emoji: 'ğŸ‘‘',
    color: '#D4AF37',
    gradient: 'linear-gradient(135deg, #D4AF37 0%, #FEF9E7 100%)',
    slogan: 'æŒæ§å…¨å±€å¼•é¢†æ–¹å‘',
    superpower: 'ç»„ç»‡ä¸é¢†å¯¼çš„èƒ½åŠ›',
    growthPoints: ['å€¾å¬ä»–äººå£°éŸ³', 'æ”¾ä¸‹æ§åˆ¶æ¬²'],
    element: 'earth'
  }
};

/**
 * Get archetype metadata by ID
 */
export function getArchetypeMeta(id: ArchetypeId): ArchetypeMeta {
  return ARCHETYPE_META[id];
}

/**
 * Get all archetypes as array
 */
export function getAllArchetypes(): ArchetypeMeta[] {
  return Object.values(ARCHETYPE_META);
}

/**
 * Group archetypes by element
 */
export function getArchetypesByElement(element: ArchetypeMeta['element']): ArchetypeMeta[] {
  return getAllArchetypes().filter(a => a.element === element);
}
```

### 2.3 VibeID Hook

```typescript
// src/skills/vibe-id/hooks/useVibeID.ts

import { useCallback } from 'react';
import useSWR from 'swr';
import { create } from 'zustand';
import type { VibeIDProfile, ArchetypeId, DimensionId } from '@/types/vibe-id';
import { getArchetypeMeta } from '../constants/archetypes';

// ============================================================================
// Store
// ============================================================================

interface VibeIDState {
  profile: VibeIDProfile | null;
  isLoading: boolean;
  error: Error | null;

  // Actions
  setProfile: (profile: VibeIDProfile) => void;
  clearProfile: () => void;
}

export const useVibeIDStore = create<VibeIDState>((set) => ({
  profile: null,
  isLoading: false,
  error: null,

  setProfile: (profile) => set({ profile, isLoading: false, error: null }),
  clearProfile: () => set({ profile: null }),
}));

// ============================================================================
// API Fetcher
// ============================================================================

const fetcher = async (url: string): Promise<VibeIDProfile> => {
  const res = await fetch(url, {
    credentials: 'include',
    headers: { 'Content-Type': 'application/json' }
  });

  if (!res.ok) {
    const error = new Error('Failed to fetch VibeID profile');
    throw error;
  }

  return res.json();
};

// ============================================================================
// Main Hook
// ============================================================================

interface UseVibeIDOptions {
  userId?: string;
  autoFetch?: boolean;
}

interface UseVibeIDReturn {
  // Data
  profile: VibeIDProfile | null;
  isLoading: boolean;
  error: Error | null;

  // Computed
  coreArchetype: ReturnType<typeof getArchetypeMeta> | null;
  innerArchetype: ReturnType<typeof getArchetypeMeta> | null;
  outerArchetype: ReturnType<typeof getArchetypeMeta> | null;
  shadowArchetype: ReturnType<typeof getArchetypeMeta> | null;

  // Actions
  getArchetype: (dimension: DimensionId) => ReturnType<typeof getArchetypeMeta> | null;
  getTopArchetypes: (count?: number) => Array<{ id: ArchetypeId; score: number }>;
  refresh: () => Promise<void>;
}

export function useVibeID(options: UseVibeIDOptions = {}): UseVibeIDReturn {
  const { userId, autoFetch = true } = options;
  const { profile: storeProfile, setProfile } = useVibeIDStore();

  // SWR for data fetching with automatic deduplication (Vercel rule: client-swr-dedup)
  const { data, error, isLoading, mutate } = useSWR<VibeIDProfile>(
    autoFetch && userId ? `/api/vibe-id/${userId}` : null,
    fetcher,
    {
      revalidateOnFocus: false,
      revalidateOnReconnect: false,
      dedupingInterval: 60000, // 1 minute deduplication
      onSuccess: (data) => setProfile(data),
    }
  );

  const profile = data || storeProfile;

  // Get archetype for a specific dimension
  const getArchetype = useCallback((dimension: DimensionId) => {
    if (!profile) return null;
    const archetypeId = profile.archetypes[dimension];
    return getArchetypeMeta(archetypeId);
  }, [profile]);

  // Get top N archetypes by score
  const getTopArchetypes = useCallback((count = 4) => {
    if (!profile?.scores) return [];

    return Object.entries(profile.scores)
      .map(([id, score]) => ({ id: id as ArchetypeId, score }))
      .sort((a, b) => b.score - a.score)
      .slice(0, count);
  }, [profile]);

  // Refresh profile data
  const refresh = useCallback(async () => {
    await mutate();
  }, [mutate]);

  return {
    profile,
    isLoading,
    error: error || null,

    // Computed archetypes
    coreArchetype: getArchetype('core'),
    innerArchetype: getArchetype('inner'),
    outerArchetype: getArchetype('outer'),
    shadowArchetype: getArchetype('shadow'),

    // Actions
    getArchetype,
    getTopArchetypes,
    refresh,
  };
}
```

### 2.4 VibeID Components

#### 2.4.1 ArchetypeBadge

```tsx
// src/skills/vibe-id/components/ArchetypeBadge.tsx

import { memo } from 'react';
import { motion } from 'framer-motion';
import type { ArchetypeId, DimensionId } from '@/types/vibe-id';
import { getArchetypeMeta } from '../constants/archetypes';
import { cn } from '@/utils/cn';

interface ArchetypeBadgeProps {
  archetypeId: ArchetypeId;
  dimension?: DimensionId;
  size?: 'sm' | 'md' | 'lg';
  showLabel?: boolean;
  showDimension?: boolean;
  interactive?: boolean;
  className?: string;
  onClick?: () => void;
}

const DIMENSION_LABELS: Record<DimensionId, string> = {
  core: 'æ ¸å¿ƒ',
  inner: 'å†…åœ¨',
  outer: 'å¤–åœ¨',
  shadow: 'é˜´å½±',
};

const SIZE_CLASSES = {
  sm: 'w-10 h-10 text-lg',
  md: 'w-14 h-14 text-2xl',
  lg: 'w-20 h-20 text-4xl',
};

// Memoized to prevent unnecessary re-renders (Vercel rule: rerender-memo)
export const ArchetypeBadge = memo(function ArchetypeBadge({
  archetypeId,
  dimension,
  size = 'md',
  showLabel = false,
  showDimension = false,
  interactive = false,
  className,
  onClick,
}: ArchetypeBadgeProps) {
  const meta = getArchetypeMeta(archetypeId);

  return (
    <motion.div
      className={cn(
        'flex flex-col items-center gap-1',
        interactive && 'cursor-pointer',
        className
      )}
      whileHover={interactive ? { scale: 1.05 } : undefined}
      whileTap={interactive ? { scale: 0.95 } : undefined}
      onClick={onClick}
    >
      {/* Badge circle */}
      <div
        className={cn(
          'rounded-full flex items-center justify-center',
          'shadow-md transition-shadow hover:shadow-lg',
          SIZE_CLASSES[size]
        )}
        style={{ background: meta.gradient }}
      >
        <span role="img" aria-label={meta.name}>
          {meta.emoji}
        </span>
      </div>

      {/* Dimension label */}
      {showDimension && dimension && (
        <span className="text-xs text-ink-400 font-medium">
          {DIMENSION_LABELS[dimension]}
        </span>
      )}

      {/* Archetype name */}
      {showLabel && (
        <span className="text-sm text-ink-700 font-medium">
          {meta.nameCn}
        </span>
      )}
    </motion.div>
  );
});
```

#### 2.4.2 DimensionRow

```tsx
// src/skills/vibe-id/components/DimensionRow.tsx

import { memo } from 'react';
import type { ArchetypeId, DimensionId } from '@/types/vibe-id';
import { ArchetypeBadge } from './ArchetypeBadge';
import { getArchetypeMeta } from '../constants/archetypes';
import { cn } from '@/utils/cn';

interface DimensionRowProps {
  dimension: DimensionId;
  archetypeId: ArchetypeId;
  score?: number;
  expanded?: boolean;
  className?: string;
  onToggle?: () => void;
}

const DIMENSION_INFO: Record<DimensionId, { label: string; description: string; icon: string }> = {
  core: {
    label: 'æ ¸å¿ƒåŸå‹',
    description: 'ä½ æœ€çœŸå®çš„è‡ªæˆ‘ï¼Œå†…å¿ƒæ·±å¤„çš„æœ¬è´¨',
    icon: 'ğŸ’',
  },
  inner: {
    label: 'å†…åœ¨åŸå‹',
    description: 'ä½ çš„æƒ…æ„Ÿä¸–ç•Œä¸å†…åœ¨é©±åŠ¨åŠ›',
    icon: 'ğŸŒ™',
  },
  outer: {
    label: 'å¤–åœ¨åŸå‹',
    description: 'ä½ å‘ˆç°ç»™ä¸–ç•Œçš„æ ·å­',
    icon: 'â˜€ï¸',
  },
  shadow: {
    label: 'é˜´å½±åŸå‹',
    description: 'éšè—çš„æ½œèƒ½ä¸æˆé•¿ç©ºé—´',
    icon: 'ğŸŒ‘',
  },
};

export const DimensionRow = memo(function DimensionRow({
  dimension,
  archetypeId,
  score,
  expanded = false,
  className,
  onToggle,
}: DimensionRowProps) {
  const dimensionInfo = DIMENSION_INFO[dimension];
  const archetype = getArchetypeMeta(archetypeId);

  return (
    <div
      className={cn(
        'flex items-center gap-4 p-4 rounded-xl',
        'bg-vellum-50 hover:bg-vellum-100 transition-colors',
        'cursor-pointer',
        className
      )}
      onClick={onToggle}
    >
      {/* Dimension icon */}
      <span className="text-2xl">{dimensionInfo.icon}</span>

      {/* Dimension info */}
      <div className="flex-1 min-w-0">
        <div className="flex items-center gap-2">
          <span className="font-medium text-ink-800">
            {dimensionInfo.label}
          </span>
          {score !== undefined && (
            <span className="text-xs text-ink-400 bg-ink-100 px-2 py-0.5 rounded-full">
              {Math.round(score)}%
            </span>
          )}
        </div>
        <p className="text-sm text-ink-500 truncate">
          {dimensionInfo.description}
        </p>
      </div>

      {/* Archetype badge */}
      <ArchetypeBadge
        archetypeId={archetypeId}
        size="sm"
        showLabel
      />

      {/* Expanded content */}
      {expanded && (
        <div className="mt-4 pt-4 border-t border-ink-100">
          <p className="text-sm text-ink-600 mb-2">
            {archetype.slogan}
          </p>
          <div className="flex flex-wrap gap-2">
            {archetype.growthPoints.map((point, i) => (
              <span
                key={i}
                className="text-xs bg-mystic-100 text-mystic-700 px-2 py-1 rounded-full"
              >
                {point}
              </span>
            ))}
          </div>
        </div>
      )}
    </div>
  );
});
```

#### 2.4.3 VibeIDCard (Main Display Component)

```tsx
// src/skills/vibe-id/components/VibeIDCard.tsx

import { memo, useState, useCallback } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import type { VibeIDProfile, DimensionId } from '@/types/vibe-id';
import { ArchetypeBadge } from './ArchetypeBadge';
import { DimensionRow } from './DimensionRow';
import { ArchetypeWheel } from './ArchetypeWheel';
import { cn } from '@/utils/cn';

interface VibeIDCardProps {
  profile: VibeIDProfile;
  variant?: 'compact' | 'full' | 'expanded';
  showWheel?: boolean;
  className?: string;
}

const DIMENSIONS: DimensionId[] = ['core', 'inner', 'outer', 'shadow'];

export const VibeIDCard = memo(function VibeIDCard({
  profile,
  variant = 'full',
  showWheel = true,
  className,
}: VibeIDCardProps) {
  const [expandedDimension, setExpandedDimension] = useState<DimensionId | null>(null);

  // Stable callback using functional pattern (Vercel rule: rerender-functional-setstate)
  const toggleDimension = useCallback((dimension: DimensionId) => {
    setExpandedDimension(prev => prev === dimension ? null : dimension);
  }, []);

  if (variant === 'compact') {
    return (
      <div className={cn('flex items-center gap-2', className)}>
        {DIMENSIONS.map(dim => (
          <ArchetypeBadge
            key={dim}
            archetypeId={profile.archetypes[dim]}
            dimension={dim}
            size="sm"
            showDimension
          />
        ))}
      </div>
    );
  }

  return (
    <div
      className={cn(
        'bg-white rounded-2xl shadow-card overflow-hidden',
        'border border-ink-100',
        className
      )}
    >
      {/* Header with main archetypes */}
      <div className="p-6 bg-gradient-to-br from-vellum-50 to-white">
        <div className="flex items-center justify-between mb-4">
          <h3 className="text-lg font-semibold text-ink-800">
            ä½ çš„ VibeID
          </h3>
          <span className="text-xs text-ink-400">
            ç½®ä¿¡åº¦: {Math.round(profile.confidence * 100)}%
          </span>
        </div>

        {/* Four dimension badges in a row */}
        <div className="flex justify-around">
          {DIMENSIONS.map(dim => (
            <ArchetypeBadge
              key={dim}
              archetypeId={profile.archetypes[dim]}
              dimension={dim}
              size="md"
              showLabel
              showDimension
              interactive
              onClick={() => toggleDimension(dim)}
            />
          ))}
        </div>
      </div>

      {/* Archetype wheel visualization */}
      {showWheel && variant === 'expanded' && (
        <div className="p-6 border-t border-ink-100">
          <ArchetypeWheel
            scores={profile.scores}
            highlighted={profile.archetypes}
          />
        </div>
      )}

      {/* Dimension details */}
      <div className="p-4 space-y-2">
        <AnimatePresence mode="popLayout">
          {DIMENSIONS.map(dim => (
            <motion.div
              key={dim}
              layout
              initial={{ opacity: 0, y: 10 }}
              animate={{ opacity: 1, y: 0 }}
              exit={{ opacity: 0, y: -10 }}
            >
              <DimensionRow
                dimension={dim}
                archetypeId={profile.archetypes[dim]}
                score={profile.dimensionScores?.[dim]?.[profile.archetypes[dim]]}
                expanded={expandedDimension === dim}
                onToggle={() => toggleDimension(dim)}
              />
            </motion.div>
          ))}
        </AnimatePresence>
      </div>

      {/* Footer with source info */}
      <div className="px-6 py-3 bg-ink-50 text-xs text-ink-400">
        åŸºäº {profile.source === 'bazi' ? 'å…«å­—' : profile.source === 'zodiac' ? 'æ˜Ÿç›˜' : 'ç»¼åˆ'} åˆ†æ Â·
        æ›´æ–°äº {new Date(profile.calculatedAt).toLocaleDateString('zh-CN')}
      </div>
    </div>
  );
});
```

#### 2.4.4 ArchetypeWheel (Radar Chart)

```tsx
// src/skills/vibe-id/components/ArchetypeWheel.tsx

import { memo, useMemo } from 'react';
import ReactECharts from 'echarts-for-react';
import type { ArchetypeId, FourDimensionArchetypes } from '@/types/vibe-id';
import { ARCHETYPE_META, getAllArchetypes } from '../constants/archetypes';

interface ArchetypeWheelProps {
  scores: Record<ArchetypeId, number>;
  highlighted?: FourDimensionArchetypes;
  size?: number;
  className?: string;
}

export const ArchetypeWheel = memo(function ArchetypeWheel({
  scores,
  highlighted,
  size = 300,
  className,
}: ArchetypeWheelProps) {
  // Memoize chart options to prevent re-computation (Vercel rule: rerender-memo)
  const option = useMemo(() => {
    const archetypes = getAllArchetypes();

    // Build indicator array for radar
    const indicator = archetypes.map(a => ({
      name: a.emoji + ' ' + a.nameCn,
      max: 100,
    }));

    // Build data array
    const data = archetypes.map(a => scores[a.id] || 0);

    // Determine highlighted points
    const highlightedIds = highlighted
      ? Object.values(highlighted)
      : [];

    return {
      tooltip: {
        trigger: 'item',
      },
      radar: {
        indicator,
        shape: 'polygon',
        splitNumber: 4,
        axisName: {
          color: '#3D3D3D',
          fontSize: 11,
        },
        splitLine: {
          lineStyle: {
            color: 'rgba(139, 115, 85, 0.2)',
          },
        },
        splitArea: {
          areaStyle: {
            color: ['rgba(255, 250, 240, 0.3)', 'rgba(255, 250, 240, 0.5)'],
          },
        },
        axisLine: {
          lineStyle: {
            color: 'rgba(139, 115, 85, 0.3)',
          },
        },
      },
      series: [
        {
          type: 'radar',
          data: [
            {
              value: data,
              name: 'VibeID',
              areaStyle: {
                color: 'rgba(138, 79, 125, 0.3)',
              },
              lineStyle: {
                color: '#8A4F7D',
                width: 2,
              },
              itemStyle: {
                color: (params: { dataIndex: number }) => {
                  const archetype = archetypes[params.dataIndex];
                  return highlightedIds.includes(archetype.id)
                    ? archetype.color
                    : '#8A4F7D';
                },
              },
              symbol: 'circle',
              symbolSize: (value: number, params: { dataIndex: number }) => {
                const archetype = archetypes[params.dataIndex];
                return highlightedIds.includes(archetype.id) ? 10 : 6;
              },
            },
          ],
        },
      ],
    };
  }, [scores, highlighted]);

  return (
    <div className={className}>
      <ReactECharts
        option={option}
        style={{ width: size, height: size }}
        opts={{ renderer: 'svg' }}
      />
    </div>
  );
});
```

### 2.5 VibeID Tool Card (for Chat)

```tsx
// src/skills/vibe-id/tools/show-vibe-id.tsx

import { memo } from 'react';
import type { VibeIDProfile } from '@/types/vibe-id';
import { VibeIDCard } from '../components/VibeIDCard';

interface ShowVibeIDProps {
  data: {
    profile: VibeIDProfile;
    analysis?: string;
    recommendations?: string[];
  };
}

/**
 * Tool result card for displaying VibeID in chat
 * Registered in CardRegistry as 'show_vibe_id'
 */
export const ShowVibeID = memo(function ShowVibeID({ data }: ShowVibeIDProps) {
  const { profile, analysis, recommendations } = data;

  return (
    <div className="space-y-4 max-w-md">
      <VibeIDCard
        profile={profile}
        variant="full"
        showWheel={false}
      />

      {analysis && (
        <div className="p-4 bg-vellum-50 rounded-xl">
          <h4 className="text-sm font-medium text-ink-700 mb-2">
            åŸå‹è§£è¯»
          </h4>
          <p className="text-sm text-ink-600 leading-relaxed">
            {analysis}
          </p>
        </div>
      )}

      {recommendations && recommendations.length > 0 && (
        <div className="p-4 bg-mystic-50 rounded-xl">
          <h4 className="text-sm font-medium text-mystic-700 mb-2">
            æˆé•¿å»ºè®®
          </h4>
          <ul className="space-y-1">
            {recommendations.map((rec, i) => (
              <li key={i} className="text-sm text-mystic-600 flex items-start gap-2">
                <span className="text-mystic-400">â€¢</span>
                {rec}
              </li>
            ))}
          </ul>
        </div>
      )}
    </div>
  );
});

// Export for CardRegistry
export default ShowVibeID;
```

---

## 3. Design System

> **Theme**: ã€Œæš–é˜³ç¥ç§˜ã€ - Warm mysticism combining ancient wisdom aesthetics with modern clarity
> **Source**: VibeLife-frontend-v6.md Section 3

### 3.1 Design Principles

1. **Warm Mystery** (æš–é˜³ç¥ç§˜): Balance between approachable warmth and mystical depth
2. **Quiet Confidence**: Designs that inspire trust without overwhelming
3. **Ink Aesthetics**: Traditional Chinese ink painting inspiration with modern execution
4. **Progressive Revelation**: Information unveiled gradually, respecting user's journey

### 3.2 Color System

#### 3.2.1 CSS Variables

```css
/* src/styles/variables.css */

:root {
  /* ====================================================================== */
  /* INK COLORS - Primary text and UI elements                              */
  /* Inspired by Chinese ink gradations                                      */
  /* ====================================================================== */
  --ink-50: #F5F5F5;
  --ink-100: #E8E8E8;
  --ink-200: #D1D1D1;
  --ink-300: #A3A3A3;
  --ink-400: #737373;
  --ink-500: #525252;
  --ink-600: #404040;
  --ink-700: #303030;
  --ink-800: #1F1F1F;
  --ink-900: #0F0F0F;

  /* ====================================================================== */
  /* VELLUM COLORS - Backgrounds and surfaces                               */
  /* Inspired by aged paper and parchment                                    */
  /* ====================================================================== */
  --vellum-50: #FFFDF8;
  --vellum-100: #FFF9ED;
  --vellum-200: #FFF3DB;
  --vellum-300: #FFE9C2;
  --vellum-400: #FFDFA8;
  --vellum-500: #F5D08C;
  --vellum-600: #E6B85C;
  --vellum-700: #D4A03C;
  --vellum-800: #B8862C;
  --vellum-900: #8C661C;

  /* ====================================================================== */
  /* ANTIQUE GOLD - Accents and highlights                                  */
  /* Represents wisdom and value                                             */
  /* ====================================================================== */
  --gold-50: #FEF9E7;
  --gold-100: #FCF0C8;
  --gold-200: #F9E38F;
  --gold-300: #F5D257;
  --gold-400: #E6B800;
  --gold-500: #D4AF37;  /* Primary gold */
  --gold-600: #B8972F;
  --gold-700: #9A7F27;
  --gold-800: #7C671F;
  --gold-900: #5E4F17;

  /* ====================================================================== */
  /* MYSTIC PURPLE - Mystery and insight                                    */
  /* The spiritual dimension of the design                                   */
  /* ====================================================================== */
  --mystic-50: #F8F4FA;
  --mystic-100: #EDE4F2;
  --mystic-200: #DBC9E5;
  --mystic-300: #C4A7D4;
  --mystic-400: #A87FC0;
  --mystic-500: #8A4F7D;  /* Primary mystic */
  --mystic-600: #6E3F64;
  --mystic-700: #52304B;
  --mystic-800: #372032;
  --mystic-900: #1B1019;

  /* ====================================================================== */
  /* FIVE ELEMENT COLORS - Chinese cosmology                                */
  /* Used for Bazi, Zodiac, and elemental representations                   */
  /* ====================================================================== */

  /* Wood (æœ¨) - Growth, creativity */
  --element-wood: #228B22;
  --element-wood-light: #90EE90;
  --element-wood-dark: #006400;

  /* Fire (ç«) - Passion, transformation */
  --element-fire: #DC143C;
  --element-fire-light: #FF6B6B;
  --element-fire-dark: #8B0000;

  /* Earth (åœŸ) - Stability, nurturing */
  --element-earth: #DAA520;
  --element-earth-light: #F4D03F;
  --element-earth-dark: #8B4513;

  /* Metal (é‡‘) - Precision, value */
  --element-metal: #C0C0C0;
  --element-metal-light: #E8E8E8;
  --element-metal-dark: #808080;

  /* Water (æ°´) - Wisdom, flow */
  --element-water: #1E90FF;
  --element-water-light: #87CEEB;
  --element-water-dark: #000080;

  /* ====================================================================== */
  /* SEMANTIC COLORS                                                         */
  /* ====================================================================== */
  --color-success: #22C55E;
  --color-warning: #F59E0B;
  --color-error: #EF4444;
  --color-info: #3B82F6;

  /* ====================================================================== */
  /* SHADOWS                                                                 */
  /* ====================================================================== */
  --shadow-sm: 0 1px 2px 0 rgba(31, 31, 31, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(31, 31, 31, 0.1), 0 2px 4px -2px rgba(31, 31, 31, 0.1);
  --shadow-lg: 0 10px 15px -3px rgba(31, 31, 31, 0.1), 0 4px 6px -4px rgba(31, 31, 31, 0.1);
  --shadow-xl: 0 20px 25px -5px rgba(31, 31, 31, 0.1), 0 8px 10px -6px rgba(31, 31, 31, 0.1);
  --shadow-card: 0 4px 20px rgba(139, 115, 85, 0.12);
  --shadow-glow: 0 0 20px rgba(138, 79, 125, 0.3);

  /* ====================================================================== */
  /* SPACING                                                                 */
  /* ====================================================================== */
  --space-1: 0.25rem;   /* 4px */
  --space-2: 0.5rem;    /* 8px */
  --space-3: 0.75rem;   /* 12px */
  --space-4: 1rem;      /* 16px */
  --space-5: 1.25rem;   /* 20px */
  --space-6: 1.5rem;    /* 24px */
  --space-8: 2rem;      /* 32px */
  --space-10: 2.5rem;   /* 40px */
  --space-12: 3rem;     /* 48px */
  --space-16: 4rem;     /* 64px */

  /* ====================================================================== */
  /* TYPOGRAPHY                                                              */
  /* ====================================================================== */
  --font-sans: 'Inter', 'Noto Sans SC', system-ui, sans-serif;
  --font-serif: 'Noto Serif SC', 'Songti SC', serif;
  --font-mono: 'JetBrains Mono', 'Fira Code', monospace;

  --text-xs: 0.75rem;     /* 12px */
  --text-sm: 0.875rem;    /* 14px */
  --text-base: 1rem;      /* 16px */
  --text-lg: 1.125rem;    /* 18px */
  --text-xl: 1.25rem;     /* 20px */
  --text-2xl: 1.5rem;     /* 24px */
  --text-3xl: 1.875rem;   /* 30px */
  --text-4xl: 2.25rem;    /* 36px */

  /* ====================================================================== */
  /* BORDER RADIUS                                                           */
  /* ====================================================================== */
  --radius-sm: 0.25rem;   /* 4px */
  --radius-md: 0.5rem;    /* 8px */
  --radius-lg: 0.75rem;   /* 12px */
  --radius-xl: 1rem;      /* 16px */
  --radius-2xl: 1.5rem;   /* 24px */
  --radius-full: 9999px;

  /* ====================================================================== */
  /* Z-INDEX                                                                 */
  /* ====================================================================== */
  --z-dropdown: 100;
  --z-sticky: 200;
  --z-fixed: 300;
  --z-modal-backdrop: 400;
  --z-modal: 500;
  --z-popover: 600;
  --z-tooltip: 700;
  --z-toast: 800;
}

/* Dark mode overrides */
[data-theme="dark"] {
  --ink-50: #0F0F0F;
  --ink-100: #1F1F1F;
  --ink-200: #303030;
  --ink-300: #404040;
  --ink-400: #525252;
  --ink-500: #737373;
  --ink-600: #A3A3A3;
  --ink-700: #D1D1D1;
  --ink-800: #E8E8E8;
  --ink-900: #F5F5F5;

  --vellum-50: #1A1814;
  --vellum-100: #252119;
  --vellum-200: #302A1E;
  --vellum-300: #3B3323;
  --vellum-400: #463C28;
}
```

#### 3.2.2 Tailwind Configuration

```typescript
// tailwind.config.ts

import type { Config } from 'tailwindcss';

const config: Config = {
  content: [
    './src/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        // Ink palette
        ink: {
          50: 'var(--ink-50)',
          100: 'var(--ink-100)',
          200: 'var(--ink-200)',
          300: 'var(--ink-300)',
          400: 'var(--ink-400)',
          500: 'var(--ink-500)',
          600: 'var(--ink-600)',
          700: 'var(--ink-700)',
          800: 'var(--ink-800)',
          900: 'var(--ink-900)',
        },
        // Vellum palette
        vellum: {
          50: 'var(--vellum-50)',
          100: 'var(--vellum-100)',
          200: 'var(--vellum-200)',
          300: 'var(--vellum-300)',
          400: 'var(--vellum-400)',
          500: 'var(--vellum-500)',
          600: 'var(--vellum-600)',
          700: 'var(--vellum-700)',
          800: 'var(--vellum-800)',
          900: 'var(--vellum-900)',
        },
        // Gold palette
        gold: {
          50: 'var(--gold-50)',
          100: 'var(--gold-100)',
          200: 'var(--gold-200)',
          300: 'var(--gold-300)',
          400: 'var(--gold-400)',
          500: 'var(--gold-500)',
          600: 'var(--gold-600)',
          700: 'var(--gold-700)',
          800: 'var(--gold-800)',
          900: 'var(--gold-900)',
        },
        // Mystic palette
        mystic: {
          50: 'var(--mystic-50)',
          100: 'var(--mystic-100)',
          200: 'var(--mystic-200)',
          300: 'var(--mystic-300)',
          400: 'var(--mystic-400)',
          500: 'var(--mystic-500)',
          600: 'var(--mystic-600)',
          700: 'var(--mystic-700)',
          800: 'var(--mystic-800)',
          900: 'var(--mystic-900)',
        },
        // Five elements
        element: {
          wood: 'var(--element-wood)',
          'wood-light': 'var(--element-wood-light)',
          'wood-dark': 'var(--element-wood-dark)',
          fire: 'var(--element-fire)',
          'fire-light': 'var(--element-fire-light)',
          'fire-dark': 'var(--element-fire-dark)',
          earth: 'var(--element-earth)',
          'earth-light': 'var(--element-earth-light)',
          'earth-dark': 'var(--element-earth-dark)',
          metal: 'var(--element-metal)',
          'metal-light': 'var(--element-metal-light)',
          'metal-dark': 'var(--element-metal-dark)',
          water: 'var(--element-water)',
          'water-light': 'var(--element-water-light)',
          'water-dark': 'var(--element-water-dark)',
        },
      },
      fontFamily: {
        sans: ['var(--font-sans)'],
        serif: ['var(--font-serif)'],
        mono: ['var(--font-mono)'],
      },
      boxShadow: {
        card: 'var(--shadow-card)',
        glow: 'var(--shadow-glow)',
      },
      borderRadius: {
        '2xl': 'var(--radius-2xl)',
      },
      animation: {
        'breath': 'breath 4s ease-in-out infinite',
        'glow-pulse': 'glow-pulse 2s ease-in-out infinite',
        'float': 'float 6s ease-in-out infinite',
        'shimmer': 'shimmer 2s linear infinite',
      },
      keyframes: {
        breath: {
          '0%, 100%': { transform: 'scale(1)', opacity: '0.8' },
          '50%': { transform: 'scale(1.05)', opacity: '1' },
        },
        'glow-pulse': {
          '0%, 100%': { boxShadow: '0 0 20px rgba(138, 79, 125, 0.3)' },
          '50%': { boxShadow: '0 0 40px rgba(138, 79, 125, 0.5)' },
        },
        float: {
          '0%, 100%': { transform: 'translateY(0)' },
          '50%': { transform: 'translateY(-10px)' },
        },
        shimmer: {
          '0%': { backgroundPosition: '-200% 0' },
          '100%': { backgroundPosition: '200% 0' },
        },
      },
    },
  },
  plugins: [],
};

export default config;
```

### 3.3 Typography System

```css
/* src/styles/typography.css */

/* Heading styles */
.heading-1 {
  font-family: var(--font-serif);
  font-size: var(--text-4xl);
  font-weight: 700;
  line-height: 1.2;
  color: var(--ink-800);
  letter-spacing: -0.02em;
}

.heading-2 {
  font-family: var(--font-serif);
  font-size: var(--text-3xl);
  font-weight: 600;
  line-height: 1.25;
  color: var(--ink-800);
}

.heading-3 {
  font-family: var(--font-sans);
  font-size: var(--text-2xl);
  font-weight: 600;
  line-height: 1.3;
  color: var(--ink-700);
}

.heading-4 {
  font-family: var(--font-sans);
  font-size: var(--text-xl);
  font-weight: 600;
  line-height: 1.4;
  color: var(--ink-700);
}

/* Body text */
.body-large {
  font-family: var(--font-sans);
  font-size: var(--text-lg);
  line-height: 1.6;
  color: var(--ink-600);
}

.body {
  font-family: var(--font-sans);
  font-size: var(--text-base);
  line-height: 1.6;
  color: var(--ink-600);
}

.body-small {
  font-family: var(--font-sans);
  font-size: var(--text-sm);
  line-height: 1.5;
  color: var(--ink-500);
}

/* Caption and labels */
.caption {
  font-family: var(--font-sans);
  font-size: var(--text-xs);
  line-height: 1.4;
  color: var(--ink-400);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.label {
  font-family: var(--font-sans);
  font-size: var(--text-sm);
  font-weight: 500;
  line-height: 1.4;
  color: var(--ink-700);
}

/* Chinese-specific adjustments */
:lang(zh) {
  /* Slightly increase line height for Chinese text */
  line-height: 1.8;
  /* Use full-width punctuation */
  font-feature-settings: "fwid";
}
```

### 3.4 Archetype Visual System

Each archetype has a unique visual identity integrated into the design system:

```typescript
// src/skills/vibe-id/styles/archetype-styles.ts

import type { ArchetypeId } from '@/types/vibe-id';

/**
 * Archetype-specific CSS classes for visual theming
 */
export const ARCHETYPE_STYLES: Record<ArchetypeId, {
  gradient: string;
  glow: string;
  border: string;
  text: string;
  bg: string;
}> = {
  innocent: {
    gradient: 'bg-gradient-to-br from-pink-200 via-pink-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(255,183,197,0.4)]',
    border: 'border-pink-200',
    text: 'text-pink-600',
    bg: 'bg-pink-50',
  },
  explorer: {
    gradient: 'bg-gradient-to-br from-sky-200 via-sky-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(135,206,235,0.4)]',
    border: 'border-sky-200',
    text: 'text-sky-600',
    bg: 'bg-sky-50',
  },
  sage: {
    gradient: 'bg-gradient-to-br from-purple-200 via-purple-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(155,89,182,0.4)]',
    border: 'border-purple-200',
    text: 'text-purple-600',
    bg: 'bg-purple-50',
  },
  hero: {
    gradient: 'bg-gradient-to-br from-red-200 via-red-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(231,76,60,0.4)]',
    border: 'border-red-200',
    text: 'text-red-600',
    bg: 'bg-red-50',
  },
  outlaw: {
    gradient: 'bg-gradient-to-br from-rose-300 via-rose-200 to-rose-50',
    glow: 'shadow-[0_0_20px_rgba(139,0,0,0.4)]',
    border: 'border-rose-300',
    text: 'text-rose-700',
    bg: 'bg-rose-50',
  },
  magician: {
    gradient: 'bg-gradient-to-br from-violet-200 via-violet-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(142,68,173,0.4)]',
    border: 'border-violet-200',
    text: 'text-violet-600',
    bg: 'bg-violet-50',
  },
  regular: {
    gradient: 'bg-gradient-to-br from-green-200 via-green-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(39,174,96,0.4)]',
    border: 'border-green-200',
    text: 'text-green-600',
    bg: 'bg-green-50',
  },
  lover: {
    gradient: 'bg-gradient-to-br from-fuchsia-200 via-fuchsia-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(233,30,99,0.4)]',
    border: 'border-fuchsia-200',
    text: 'text-fuchsia-600',
    bg: 'bg-fuchsia-50',
  },
  jester: {
    gradient: 'bg-gradient-to-br from-amber-200 via-amber-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(243,156,18,0.4)]',
    border: 'border-amber-200',
    text: 'text-amber-600',
    bg: 'bg-amber-50',
  },
  caregiver: {
    gradient: 'bg-gradient-to-br from-emerald-200 via-emerald-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(46,204,113,0.4)]',
    border: 'border-emerald-200',
    text: 'text-emerald-600',
    bg: 'bg-emerald-50',
  },
  creator: {
    gradient: 'bg-gradient-to-br from-blue-200 via-blue-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(52,152,219,0.4)]',
    border: 'border-blue-200',
    text: 'text-blue-600',
    bg: 'bg-blue-50',
  },
  ruler: {
    gradient: 'bg-gradient-to-br from-yellow-200 via-yellow-100 to-white',
    glow: 'shadow-[0_0_20px_rgba(212,175,55,0.4)]',
    border: 'border-yellow-300',
    text: 'text-yellow-700',
    bg: 'bg-yellow-50',
  },
};

/**
 * Get archetype style classes
 */
export function getArchetypeStyles(id: ArchetypeId) {
  return ARCHETYPE_STYLES[id];
}
```

### 3.5 Animation Patterns

```tsx
// src/components/shared/animations.ts

import { Variants } from 'framer-motion';

/**
 * Standard animation variants for consistent motion design
 */

// Fade and slide up (for content reveal)
export const fadeInUp: Variants = {
  initial: { opacity: 0, y: 20 },
  animate: { opacity: 1, y: 0 },
  exit: { opacity: 0, y: -10 },
};

// Fade and scale (for modals and cards)
export const fadeInScale: Variants = {
  initial: { opacity: 0, scale: 0.95 },
  animate: { opacity: 1, scale: 1 },
  exit: { opacity: 0, scale: 0.95 },
};

// Stagger children (for lists)
export const staggerContainer: Variants = {
  animate: {
    transition: {
      staggerChildren: 0.05,
    },
  },
};

// Slide in from right (for navigation)
export const slideInRight: Variants = {
  initial: { x: '100%' },
  animate: { x: 0 },
  exit: { x: '100%' },
};

// Spring physics for interactive elements
export const springConfig = {
  type: 'spring',
  stiffness: 300,
  damping: 30,
};

// Smooth easing for non-interactive animations
export const smoothConfig = {
  duration: 0.3,
  ease: [0.4, 0, 0.2, 1],
};

/**
 * BreathAura animation component
 * Creates a subtle pulsing glow effect
 */
export const breathAuraVariants: Variants = {
  animate: {
    scale: [1, 1.02, 1],
    opacity: [0.6, 0.8, 0.6],
    transition: {
      duration: 4,
      repeat: Infinity,
      ease: 'easeInOut',
    },
  },
};
```

### 3.6 Component Patterns

#### 3.6.1 Card Pattern

```tsx
// src/components/ui/Card.tsx

import { forwardRef, HTMLAttributes } from 'react';
import { cn } from '@/utils/cn';

interface CardProps extends HTMLAttributes<HTMLDivElement> {
  variant?: 'default' | 'elevated' | 'outlined' | 'mystical';
  padding?: 'none' | 'sm' | 'md' | 'lg';
}

const VARIANT_CLASSES = {
  default: 'bg-white border border-ink-100',
  elevated: 'bg-white shadow-card',
  outlined: 'bg-transparent border-2 border-ink-200',
  mystical: 'bg-gradient-to-br from-vellum-50 to-white border border-gold-200 shadow-glow',
};

const PADDING_CLASSES = {
  none: '',
  sm: 'p-3',
  md: 'p-4',
  lg: 'p-6',
};

export const Card = forwardRef<HTMLDivElement, CardProps>(
  ({ variant = 'default', padding = 'md', className, children, ...props }, ref) => {
    return (
      <div
        ref={ref}
        className={cn(
          'rounded-xl',
          VARIANT_CLASSES[variant],
          PADDING_CLASSES[padding],
          className
        )}
        {...props}
      >
        {children}
      </div>
    );
  }
);

Card.displayName = 'Card';
```

#### 3.6.2 Button Pattern

```tsx
// src/components/ui/Button.tsx

import { forwardRef, ButtonHTMLAttributes } from 'react';
import { cn } from '@/utils/cn';

interface ButtonProps extends ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'ghost' | 'mystical';
  size?: 'sm' | 'md' | 'lg';
  loading?: boolean;
}

const VARIANT_CLASSES = {
  primary: 'bg-mystic-500 text-white hover:bg-mystic-600 active:bg-mystic-700',
  secondary: 'bg-vellum-100 text-ink-700 hover:bg-vellum-200 active:bg-vellum-300',
  ghost: 'bg-transparent text-ink-600 hover:bg-ink-50 active:bg-ink-100',
  mystical: 'bg-gradient-to-r from-mystic-500 to-gold-500 text-white hover:opacity-90',
};

const SIZE_CLASSES = {
  sm: 'h-8 px-3 text-sm',
  md: 'h-10 px-4 text-base',
  lg: 'h-12 px-6 text-lg',
};

export const Button = forwardRef<HTMLButtonElement, ButtonProps>(
  ({ variant = 'primary', size = 'md', loading, className, disabled, children, ...props }, ref) => {
    return (
      <button
        ref={ref}
        className={cn(
          'inline-flex items-center justify-center gap-2',
          'font-medium rounded-lg transition-colors',
          'focus:outline-none focus:ring-2 focus:ring-mystic-300 focus:ring-offset-2',
          'disabled:opacity-50 disabled:cursor-not-allowed',
          VARIANT_CLASSES[variant],
          SIZE_CLASSES[size],
          className
        )}
        disabled={disabled || loading}
        {...props}
      >
        {loading && (
          <svg className="animate-spin h-4 w-4" viewBox="0 0 24 24">
            <circle
              className="opacity-25"
              cx="12"
              cy="12"
              r="10"
              stroke="currentColor"
              strokeWidth="4"
              fill="none"
            />
            <path
              className="opacity-75"
              fill="currentColor"
              d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"
            />
          </svg>
        )}
        {children}
      </button>
    );
  }
);

Button.displayName = 'Button';
```

