---
id: case-extraction
name: Case 抽取
impact: HIGH
impactDescription: 案例是专家系统的核心资产，影响分析质量
tags: case, 案例抽取, 案例库
---

# Case 抽取规则

## 适用场景

从 knowledge_chunks 表中抽取结构化案例，写入 cases 表。

典型请求：
- "抽取八字案例"
- "从知识库提取案例"
- "建立案例库"

## 分析要点

| 步骤 | 执行要点 | 命令/操作 | 优先级 |
|-----|---------|----------|-------|
| 1 | 确认 skill_id | 询问用户 | 必须 |
| 2 | 检查 chunks 数量 | 查询 knowledge_chunks 表 | 必须 |
| 3 | 读取抽取提示模板 | `templates/prompts/CASE_EXTRACTION_PROMPT.md` | 必须 |
| 4 | 执行抽取脚本 | `python workers/case_extractor.py {skill}` | 必须 |
| 5 | 验证抽取结果 | 检查 cases 表记录数 | 必须 |

## Case 数据结构

```json
{
  "id": "case-{skill}-{序号}",
  "skill_id": "{skill_id}",
  "name": "案例名称",
  "core_data": {
    "year": "甲子",
    "month": "乙丑",
    ...
  },
  "features": {
    "daymaster": "丙火",
    "strength": "身强",
    ...
  },
  "reasoning_chain": [
    {
      "step": 1,
      "framework": "十神分析",
      "observation": "观察到...",
      "analysis": "分析...",
      "conclusion": "结论..."
    }
  ],
  "guidance_patterns": [
    {
      "pattern_name": "财官双美",
      "condition": "条件...",
      "advice": "建议...",
      "source": "《滴天髓》"
    }
  ],
  "tags": ["事业", "财运"],
  "authority": "high"
}
```

## 输出要求

1. **必须执行**：
   - 加载抽取提示模板
   - 执行抽取脚本
   - 验证数据完整性

2. **内容要求**：
   - 每个 case 必须有 core_data
   - 每个 case 必须有 reasoning_chain
   - 每个 case 必须标注 authority

3. **引导方向**：
   - 抽取完成后询问是否进行质量检查
   - 或继续 Rule 抽取

## 质量标准

| 指标 | 目标 |
|-----|------|
| 案例数量 | ≥50 cases/skill |
| 标签覆盖 | 覆盖所有核心场景 |
| 数据完整性 | 100% 有 core_data |

## 常见问题

### 抽取数量不足
增加 knowledge_chunks 的覆盖范围，或降低抽取门槛。

### 案例质量不高
人工审核低质量案例，标记为 authority: low。
