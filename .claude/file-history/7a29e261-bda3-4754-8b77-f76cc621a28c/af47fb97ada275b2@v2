/**
 * Onboarding Flow Types - v2.1
 *
 * ç”¨æˆ·æµç¨‹é˜¶æ®µå®šä¹‰å’ŒçŠ¶æ€ç±»å‹
 */

export type OnboardingStep =
  | 'landing'      // Stage 1: Landing Page å•é¡µè¡¨å•
  | 'loading'      // Stage 2: æ™ºèƒ½åŠ è½½
  | 'aha'          // Stage 3: 30ç§’ Aha Moment
  | 'persona'      // Stage 4: äººæ ¼é€‰æ‹©
  | 'interview'    // Stage 5: æ·±åº¦è®¿è°ˆ
  | 'letter'       // Stage 6: æ¥è‡ªæœªæ¥çš„ä¿¡
  | 'conversion'   // Stage 7: è½¬åŒ–ä»˜è´¹

export type PersonaType = 'warm' | 'sharp' | 'wise'

export interface PersonaConfig {
  id: PersonaType
  name: string
  nameEn: string
  emotionValue: number // -100 to 100
  description: string
  sampleText: string
  icon: string
}

export const PERSONAS: Record<PersonaType, PersonaConfig> = {
  warm: {
    id: 'warm',
    name: 'æ¸©æš–å‘å¯¼',
    nameEn: 'Warm Guide',
    emotionValue: 80,
    description: 'ç†è§£ä½ ã€æ”¯æŒä½ ï¼Œç”¨æ¸©æš–çš„æ–¹å¼å¼•å¯¼ä½ ',
    sampleText: 'æˆ‘ç†è§£ä½ æœ€è¿‘å‹åŠ›å¾ˆå¤§ï¼Œè¿™æ˜¯æ­£å¸¸çš„...',
    icon: 'ğŸŒ¸',
  },
  sharp: {
    id: 'sharp',
    name: 'çŠ€åˆ©æŒšå‹',
    nameEn: 'Sharp Friend',
    emotionValue: -20,
    description: 'ç›´è¨€ä¸è®³ï¼Œè¯´ä½ éœ€è¦å¬ä½†å¯èƒ½ä¸æƒ³å¬çš„è¯',
    sampleText: 'åˆ«éª—è‡ªå·±äº†ï¼Œä½ çœŸæ­£æƒ³è¦çš„å…¶å®æ˜¯...',
    icon: 'âš¡',
  },
  wise: {
    id: 'wise',
    name: 'æ™ºæ…§å¯¼å¸ˆ',
    nameEn: 'Wise Mentor',
    emotionValue: 50,
    description: 'æ·±åº¦åˆ†æï¼Œä»å‘½ç†è§’åº¦ç»™ä½ ç†æ€§å»ºè®®',
    sampleText: 'ä»å‘½ç›˜æ¥çœ‹ï¼Œä½ ç›®å‰å¤„äºä¸€ä¸ªè½¬æŠ˜æœŸ...',
    icon: 'ğŸŒ™',
  },
}

export type ConcernType = 'love' | 'career' | 'self' | 'health' | 'wealth'

export interface ConcernConfig {
  id: ConcernType
  label: string
  icon: string
}

export const CONCERNS: ConcernConfig[] = [
  { id: 'love', label: 'æ„Ÿæƒ…', icon: 'ğŸ’•' },
  { id: 'career', label: 'äº‹ä¸š', icon: 'ğŸ’¼' },
  { id: 'self', label: 'è‡ªæˆ‘', icon: 'ğŸŒŸ' },
  { id: 'health', label: 'å¥åº·', icon: 'ğŸŒ¿' },
  { id: 'wealth', label: 'è´¢è¿', icon: 'ğŸ’°' },
]

export interface BirthInfo {
  year: number
  month: number
  day: number
  hour: number | null  // å¯é€‰
  isLunar?: boolean    // æ˜¯å¦å†œå†
  gender?: 'male' | 'female'
}

export interface OnboardingState {
  step: OnboardingStep
  birthInfo: BirthInfo | null
  concerns: ConcernType[]
  persona: PersonaType | null
  baziData: BaziData | null
  interviewAnswers: InterviewAnswer[]
  letterContent: string | null
}

export interface BaziData {
  yearPillar: { stem: string; branch: string }
  monthPillar: { stem: string; branch: string }
  dayPillar: { stem: string; branch: string }
  hourPillar: { stem: string; branch: string } | null
  dayMaster: string
  dayMasterElement: string
  insight: string
  fortune: {
    score: number
    luckyColor: string
    luckyNumber: number
    advice: string
  }
}

export interface InterviewAnswer {
  questionId: string
  questionText: string
  selectedOptions: string[]
  openAnswer: string
}

export interface InterviewQuestion {
  id: string
  questionText: string
  reasoning: string  // æ¨ç†è¿‡ç¨‹å±•ç¤º
  options: Array<{
    id: string
    text: string
  }>
  allowMultiple: boolean
  showOpenInput: boolean
  openInputPlaceholder?: string
}

// è®¡ç®—æ­¥éª¤
export interface CalculationStep {
  id: string
  label: string
  status: 'pending' | 'loading' | 'done'
}

export const CALCULATION_STEPS: Omit<CalculationStep, 'status'>[] = [
  { id: 'paipan', label: 'æ’ç›˜å®Œæˆ' },
  { id: 'wuxing', label: 'åˆ†æäº”è¡Œå¼ºå¼±' },
  { id: 'dayun', label: 'è®¡ç®—å¤§è¿æµå¹´' },
  { id: 'fortune', label: 'ç”Ÿæˆä»Šæ—¥è¿åŠ¿' },
  { id: 'kline', label: 'ç»˜åˆ¶äººç”Ÿ K çº¿' },
]
