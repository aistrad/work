# VibeLife 顶层架构设计

> Version: 11.2 | 2026-01-21
> 原则：**四维统一 × 各司其职 × 极简**

---

## 一、核心洞察

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                    VibeLife = 人类理解自己的基础设施                          │
│                                                                             │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│   用户的四个核心问题               VibeLife 的四大支柱                        │
│   ────────────────────           ────────────────────                       │
│                                                                             │
│   "我想找专家咨询"          ──▶   CoreAgent + Skills (对话即服务)            │
│   "我的信息太分散"          ──▶   VibeProfile (用户信息统一)                 │
│   "我是谁？"               ──▶   Me + VibeInsight (跨维度自我认知)          │
│   "我要成为谁？"           ──▶   VibeTarget (目标与成长)                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 二、四大支柱

### 2.1 CoreAgent + Skills：对话即服务

**职责**：用户找专家咨询

```
┌─────────────────────────────────────────────────────────────────┐
│                    CoreAgent + Skills                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  核心能力：LLM 驱动的对话路由 + Skill 执行                        │
│                                                                  │
│  Skills（按领域划分）：                                           │
│  ─────────────────────────────────────────────────────────────   │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │  Core                                                    │     │
│  │  └─ core: 生命对话者（AI 的灵魂，始终激活）               │     │
│  ├─────────────────────────────────────────────────────────┤     │
│  │  心理成长                                                │     │
│  │  ├─ lifecoach: 人生教练（目标、卡点、成长）              │     │
│  │  └─ mindfulness: 正念导师（情绪、冥想）                  │     │
│  ├─────────────────────────────────────────────────────────┤     │
│  │  东方命理                                                │     │
│  │  └─ bazi: 八字命理（格局、运势、时机）                   │     │
│  ├─────────────────────────────────────────────────────────┤     │
│  │  西方占星                                                │     │
│  │  ├─ zodiac: 西方占星（星盘、行运）                       │     │
│  │  └─ jungastro: 荣格占星（心理学视角）                    │     │
│  ├─────────────────────────────────────────────────────────┤     │
│  │  直觉洞察                                                │     │
│  │  └─ tarot: 塔罗占卜（当下指引）                          │     │
│  ├─────────────────────────────────────────────────────────┤     │
│  │  职业发展                                                │     │
│  │  └─ career: 职业规划（人岗匹配）                         │     │
│  ├─────────────────────────────────────────────────────────┤     │
│  │  自我认知                                                │     │
│  │  └─ vibe_insight: 人格画像（跨维度融合）                      │     │
│  └─────────────────────────────────────────────────────────┘     │
│                                                                  │
│  关键特性：                                                       │
│  • LLM 自动路由（不是 if-else）                                  │
│  • 配置驱动（SKILL.md）                                          │
│  • Tool Calling（工具即能力）                                    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

### 2.2 VibeProfile：用户信息统一

**职责**：一个人的完整画像

```
┌─────────────────────────────────────────────────────────────────┐
│                       VibeProfile                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  三层数据架构：                                                   │
│  ─────────────────────────────────────────────────────────────   │
│                                                                  │
│  Layer 1: Identity（身份）                                       │
│  ─────────────────────────────────────────────────────────────   │
│  来源：用户填写                                                   │
│  内容：birth_info, account, preferences                          │
│                                                                  │
│  Layer 2: Skill Data（Skill 产出）                               │
│  ─────────────────────────────────────────────────────────────   │
│  来源：Skills 实时写入                                           │
│  内容：bazi.chart, zodiac.chart, lifecoach.goals                 │
│                                                                  │
│  Layer 3: VibeInsight（跨维度画像）                                   │
│  ─────────────────────────────────────────────────────────────   │
│  来源：ProfileExtractor 融合生成                                 │
│  内容：详见 2.3 节                                               │
│                                                                  │
│  ─────────────────────────────────────────────────────────────   │
│                                                                  │
│  核心原则：                                                       │
│  • VibeProfile 是数据中心，不是功能模块                          │
│  • 所有模块读写 VibeProfile                                      │
│  • Single Source of Truth                                        │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

### 2.3 Me + VibeInsight：我是谁

**职责**：跨维度的自我认知

**VibeInsight 模型（荣格 + 阿德勒融合）**：

```
┌─────────────────────────────────────────────────────────────────┐
│                    VibeInsight 三维模型                               │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                                                          │     │
│  │   维度 1: 本质 (Essence) — 我是什么                       │     │
│  │   ─────────────────────────────────────────────────────  │     │
│  │                                                          │     │
│  │   静态层：先天倾向                                        │     │
│  │   来源：skill_data.bazi + skill_data.zodiac              │     │
│  │                                                          │     │
│  │   {                                                       │     │
│  │     archetype: {                                          │     │
│  │       primary: "creator",      // 主原型                  │     │
│  │       secondary: "explorer",   // 副原型                  │     │
│  │       shadow: "ruler"          // 阴影原型                │     │
│  │     },                                                    │     │
│  │     traits: [                                             │     │
│  │       { source: "bazi", trait: "表达力强" },              │     │
│  │       { source: "zodiac", trait: "好奇心旺" }             │     │
│  │     ]                                                     │     │
│  │   }                                                       │     │
│  │                                                          │     │
│  └─────────────────────────────────────────────────────────┘     │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                                                          │     │
│  │   维度 2: 动态 (Dynamic) — 我现在怎么样 + 往哪走          │     │
│  │   ─────────────────────────────────────────────────────  │     │
│  │                                                          │     │
│  │   动态层：当前状态 + 变化趋势                             │     │
│  │   来源：对话抽取（ProfileExtractor）                      │     │
│  │                                                          │     │
│  │   {                                                       │     │
│  │     // 当前状态                                           │     │
│  │     emotion: { current: "calm", intensity: 0.6 },        │     │
│  │     energy: { level: 0.7, focus: ["career"] },           │     │
│  │     active_archetype: "creator",                          │     │
│  │                                                          │     │
│  │     // 变化趋势                                           │     │
│  │     trend: {                                              │     │
│  │       archetype_shift: { rising: "pioneer", delta: 0.05 },│     │
│  │       emotion_trend: "stable",                            │     │
│  │       direction: "expansion"                              │     │
│  │     }                                                     │     │
│  │   }                                                       │     │
│  │                                                          │     │
│  └─────────────────────────────────────────────────────────┘     │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐     │
│  │                                                          │     │
│  │   维度 3: 规律 (Pattern) — 我的行为模式                   │     │
│  │   ─────────────────────────────────────────────────────  │     │
│  │                                                          │     │
│  │   洞察层：长期规律                                        │     │
│  │   来源：历史行为分析                                      │     │
│  │                                                          │     │
│  │   {                                                       │     │
│  │     behaviors: [                                          │     │
│  │       { pattern: "晚间活跃", confidence: 0.8 },           │     │
│  │       { pattern: "周期性低落", trigger: "周一" }          │     │
│  │     ],                                                    │     │
│  │     insights: [                                           │     │
│  │       "你在压力下倾向于独处思考",                         │     │
│  │       "创意灵感常在深夜涌现"                              │     │
│  │     ]                                                     │     │
│  │   }                                                       │     │
│  │                                                          │     │
│  └─────────────────────────────────────────────────────────┘     │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

**Me 页设计原则**：

```
┌─────────────────────────────────────────────────────────────────┐
│                         Me 页                                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  首屏：一句话核心洞察                                            │
│  ─────────────────────────────────────────────────────────────   │
│  "你的创造者特质正在显化，近期频繁讨论写作与此呼应。"              │
│                                                                  │
│  展开：三维画像                                                   │
│  ─────────────────────────────────────────────────────────────   │
│  • 本质：我是什么（原型 + 特质）                                 │
│  • 动态：我现在怎么样 + 往哪走（状态 + 趋势）                    │
│  • 规律：我的模式（行为洞察）                                    │
│                                                                  │
│  ─────────────────────────────────────────────────────────────   │
│                                                                  │
│  核心原则：                                                       │
│  • 本质是"倾向"，不是"定论"                                      │
│  • 动态每天都在变，趋势展示成长方向                              │
│  • 规律帮助自我觉察，而非预测命运                                │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

### 2.4 VibeTarget + Goals：我要成为谁

**职责**：目标管理与成长陪伴

```
┌─────────────────────────────────────────────────────────────────┐
│                      VibeTarget (Goals)                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  核心职责：帮助用户设定、追踪、达成目标                           │
│  ─────────────────────────────────────────────────────────────   │
│                                                                  │
│  数据结构：                                                       │
│                                                                  │
│  skill_data.lifecoach.goals = [                                  │
│    {                                                             │
│      id: "goal_001",                                             │
│      title: "完成写作项目",                                      │
│      description: "写完第一本书的初稿",                          │
│      status: "in_progress",                                      │
│      progress: 0.6,                                              │
│      created_at: "2026-01-10",                                   │
│      deadline: "2026-03-01",                                     │
│      check_ins: [                                                │
│        { date: "2026-01-18", note: "写了3章", mood: "good" }     │
│      ]                                                           │
│    }                                                             │
│  ]                                                               │
│                                                                  │
│  ─────────────────────────────────────────────────────────────   │
│                                                                  │
│  VibeTarget 页功能：                                                 │
│  • 目标列表（按进度/时间排序）                                   │
│  • 打卡记录                                                       │
│  • 进度追踪                                                       │
│  • 成就回顾                                                       │
│                                                                  │
│  ─────────────────────────────────────────────────────────────   │
│                                                                  │
│  与 Lifecoach 的关系：                                           │
│  • Chat 中设定目标 → 写入 skill_data.lifecoach.goals            │
│  • VibeTarget 页读取并展示                                          │
│  • Proactive 推送目标提醒                                        │
│                                                                  │
│  ─────────────────────────────────────────────────────────────   │
│                                                                  │
│  设计原则：                                                       │
│  • 默认不加入命理元素（纯粹的目标管理）                          │
│  • 用户主动询问时，才提供命理视角                                │
│  • 重点是陪伴和鼓励，不是预测和判断                              │
│                                                                  │
│  示例交互：                                                       │
│  用户："帮我看看写作目标"                                        │
│  → 展示进度、打卡记录、鼓励                                      │
│                                                                  │
│  用户："从命理角度看，现在适合推进写作吗？"                      │
│  → 调用 Bazi Skill，提供命理视角                                 │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 三、数据流

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              数据流全景                                      │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  写入流：                                                                    │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  用户对话 (Chat)                                                            │
│      │                                                                      │
│      ├─ Bazi Skill ─────▶ skill_data.bazi                                  │
│      ├─ Zodiac Skill ───▶ skill_data.zodiac                                │
│      ├─ Lifecoach ──────▶ skill_data.lifecoach.goals                       │
│      │                                                                      │
│      ▼                                                                      │
│  conversations/messages                                                     │
│      │                                                                      │
│      ▼ (每日凌晨 3 点)                                                      │
│  ProfileExtractor                                                           │
│      │                                                                      │
│      └─▶ vibe_insight (本质 + 动态 + 规律)                                      │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  读取流：                                                                    │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  Me 页 ◀─────────── vibe_insight (三维画像)                                │
│  VibeTarget 页 ◀──── skill_data.lifecoach.goals                            │
│  Chat ◀───────────── skill_data (上下文注入)                               │
│  Proactive ◀──────── vibe_insight.dynamic + goals                          │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 四、VibeProfile 数据结构

```json
{
  "identity": {
    "birth_info": { "date": "1990-01-01", "time": "12:00", "location": "北京" },
    "account": { "vibe_id": "VB-xxx", "display_name": "用户" }
  },

  "skill_data": {
    "bazi": { "chart": {...}, "dayun": {...} },
    "zodiac": { "natal_chart": {...}, "transits": {...} },
    "lifecoach": {
      "goals": [{ "id": "g1", "title": "写作", "progress": 0.6 }]
    }
  },

  "vibe_insight": {
    "essence": {
      "archetype": { "primary": "creator", "secondary": "explorer", "shadow": "ruler" },
      "traits": [
        { "source": "bazi", "trait": "表达力强" },
        { "source": "zodiac", "trait": "好奇心旺" }
      ]
    },
    "dynamic": {
      "emotion": { "current": "calm", "intensity": 0.6 },
      "energy": { "level": 0.7, "focus": ["career"] },
      "active_archetype": "creator",
      "trend": {
        "archetype_shift": { "rising": "pioneer", "delta": 0.05 },
        "emotion_trend": "stable",
        "direction": "expansion"
      }
    },
    "pattern": {
      "behaviors": [{ "pattern": "晚间活跃", "confidence": 0.8 }],
      "insights": ["创意灵感常在深夜涌现"]
    },
    "updated_at": "2026-01-21T03:00:00Z"
  },

  "preferences": { "timezone": "Asia/Shanghai" }
}
```

---

## 五、API 设计

### 5.1 Me API

```
GET /api/v1/me/dashboard

Response:
{
  "primary_insight": "你的创造者特质正在显化",
  "vibe_insight": {
    "essence": { "archetype": {...}, "traits": [...] },
    "dynamic": { "emotion": {...}, "energy": {...}, "trend": {...} },
    "pattern": { "behaviors": [...], "insights": [...] }
  },
  "data_level": "A"
}
```

### 5.2 VibeTarget API

```
GET /api/v1/target/goals
Response: { "goals": [...] }

POST /api/v1/target/goals
Body: { "title": "...", "description": "..." }

PUT /api/v1/target/goals/{id}/check-in
Body: { "note": "今天写了一章", "mood": "good" }
```

---

## 六、关键设计决策

| 决策 | 内容 |
|------|------|
| Skill 分类 | 按领域划分（心理/命理/占星/直觉/职业/认知），不分层级 |
| VibeInsight 模型 | 三维：本质(静态) + 动态(状态+趋势) + 规律(模式) |
| VibeTarget 定位 | 纯粹的目标管理，默认不加入命理元素 |
| 命理与目标 | 用户主动询问时才融合，不主动推送命理判断 |
| 数据分层 | Identity → Skill Data → VibeInsight（三层） |

---

## 七、实施路径（8天）

| Phase | 内容 | 时间 |
|-------|------|------|
| 1 | ProfileExtractor 升级（VibeInsight 三维模型） | 3天 |
| 2 | Me 页 + API | 2天 |
| 3 | VibeTarget 页 + API | 3天 |

---

## 八、与北极星对齐

| 北极星 | 实现 |
|--------|------|
| 深度理解 | VibeInsight 三维模型（本质 + 动态 + 规律） |
| 主动关心 | Proactive（基于 dynamic + goals） |
| 无限扩展 | Skills 按领域划分 |
| 温暖不粘腻 | VibeTarget 默认不加命理判断 |

---

> **Version**: 11.2 | 2026-01-21
