"use client";

/**
 * FortuneCard - ä»Šæ—¥è¿åŠ¿å¡ç‰‡ (v2.0)
 *
 * å±•ç¤ºï¼š
 * - æ•´ä½“è¿åŠ¿åˆ†æ•°ï¼ˆè¿›åº¦æ¡ï¼‰
 * - å®œ/å¿Œå»ºè®®ï¼ˆhighlights/cautionsï¼‰
 * - è¿åŠ¿ä¸»é¢˜æ´å¯Ÿ
 */

import { motion } from "framer-motion";
import { cn } from "@/lib/utils";

interface FortuneCardProps {
  score: number;
  theme: string;
  suggestions: {
    do: string[];
    avoid: string[];
  };
  insights?: string[];
  className?: string;
}

export function FortuneCard({
  score,
  theme,
  suggestions,
  insights,
  className,
}: FortuneCardProps) {
  // æ ¹æ®åˆ†æ•°ç¡®å®šé¢œè‰²
  const getScoreColor = (s: number) => {
    if (s >= 75) return "from-emerald-400 to-green-500";
    if (s >= 50) return "from-amber-400 to-orange-500";
    return "from-rose-400 to-red-500";
  };

  const getScoreLabel = (s: number) => {
    if (s >= 80) return "å¤§å‰";
    if (s >= 70) return "å‰";
    if (s >= 50) return "ä¸­";
    return "éœ€ç•™æ„";
  };

  return (
    <div
      className={cn(
        "rounded-2xl bg-gradient-to-br from-amber-50/80 via-orange-50/60 to-yellow-50/80",
        "dark:from-amber-950/40 dark:via-orange-950/30 dark:to-yellow-950/40",
        "p-4 border border-amber-100/50 dark:border-amber-800/30",
        className
      )}
    >
      {/* æ ‡é¢˜ */}
      <div className="flex items-center gap-2 mb-3">
        <span className="text-lg">ğŸŒŸ</span>
        <span className="text-sm font-medium text-amber-900 dark:text-amber-100">
          ä»Šæ—¥è¿åŠ¿
        </span>
        <span className="ml-auto text-xs px-2 py-0.5 rounded-full bg-amber-100 dark:bg-amber-900/50 text-amber-700 dark:text-amber-300 font-medium">
          {getScoreLabel(score)}
        </span>
      </div>

      {/* åˆ†æ•°è¿›åº¦æ¡ */}
      <div className="mb-4">
        <div className="flex items-center justify-between text-xs text-amber-700 dark:text-amber-300 mb-1.5">
          <span>æ•´ä½“èƒ½é‡</span>
          <span className="font-medium">{score}</span>
        </div>
        <div className="h-2 bg-amber-200/60 dark:bg-amber-800/40 rounded-full overflow-hidden">
          <motion.div
            initial={{ width: 0 }}
            animate={{ width: `${score}%` }}
            transition={{ duration: 0.8, delay: 0.2, ease: "easeOut" }}
            className={cn(
              "h-full rounded-full bg-gradient-to-r",
              getScoreColor(score)
            )}
          />
        </div>
      </div>

      {/* å®œ/å¿Œå»ºè®® */}
      <div className="space-y-2 mb-3">
        {suggestions.do.length > 0 && (
          <div className="flex items-start gap-2">
            <span className="text-xs text-emerald-600 dark:text-emerald-400 mt-0.5 shrink-0">
              â˜€ï¸ å®œ
            </span>
            <span className="text-xs text-amber-800 dark:text-amber-200 line-clamp-1">
              {suggestions.do.slice(0, 2).join("ã€")}
            </span>
          </div>
        )}
        {suggestions.avoid.length > 0 && (
          <div className="flex items-start gap-2">
            <span className="text-xs text-orange-600 dark:text-orange-400 mt-0.5 shrink-0">
              âš ï¸ æ…
            </span>
            <span className="text-xs text-amber-800 dark:text-amber-200 line-clamp-1">
              {suggestions.avoid.slice(0, 2).join("ã€")}
            </span>
          </div>
        )}
      </div>

      {/* è¿åŠ¿ä¸»é¢˜ */}
      {theme && (
        <div className="flex items-start gap-2 pt-2 border-t border-amber-200/50 dark:border-amber-800/30">
          <span className="text-xs text-amber-500 mt-0.5">ğŸ’¡</span>
          <span className="text-xs text-amber-700 dark:text-amber-300 leading-relaxed">
            {theme}
          </span>
        </div>
      )}
    </div>
  );
}

export default FortuneCard;
