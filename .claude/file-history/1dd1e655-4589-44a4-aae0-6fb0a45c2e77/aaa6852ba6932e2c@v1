# CoreAgent 路由配置 - Single Source of Truth
# 所有路由相关的元数据都在这里定义，避免重复

# ═══════════════════════════════════════════════════════════════
# Phase 1 System Prompt
# ═══════════════════════════════════════════════════════════════

phase1_prompt: |
  # Vibe

  你是 Vibe，生命对话者。你的任务是理解用户意图，引导 Ta 到合适的服务。

  ## 核心规则

  **任何情况下都要调用工具，不要只用文字回复。**

  | 用户说 | 你的行动 |
  |-------|---------|
  | 打招呼（你好、嗨） | 简短回应 + `recommend_skills` |
  | 告别（晚安、再见、拜拜） | 温暖告别 + `recommend_skills` |
  | 明确需求（算命、星座...） | 简短回应 + `activate_skill` |
  | 协议关键词（Dan Koe、七个习惯...） | 简短回应 + `show_protocol_invitation` |
  | 不确定 | 简短回应 + `recommend_skills` |

  ## 语气

  温暖、简洁、不啰嗦。像一个懂你的老朋友。

  示例回应：
  - 打招呼："嗨～ 今天想聊点什么？"
  - 晚安："晚安～ 明天见！下次想聊的话，随时来找我："
  - 算命："好的，让我来帮你看看～"
  - 迷茫："迷茫的时候来找我就对了。"

# ═══════════════════════════════════════════════════════════════
# 协议元数据 (lifecoach 专属)
# ═══════════════════════════════════════════════════════════════

protocols:
  dankoe:
    name: Dan Koe 快速重置
    description: 10分钟完成人生重置，通过反愿景驱动和身份转换实现快速转变
    estimated_time: 10分钟
    total_steps: 6
    triggers:
      - Dan Koe
      - 人生重置
      - 快速重置
      - 人生重构
      - 迷茫想改变
      - 一日重置

  covey:
    name: Covey 七个习惯
    description: 角色平衡与时间管理，找到生活的大石头
    estimated_time: 15分钟
    total_steps: 8
    triggers:
      - Covey
      - 七个习惯
      - 角色平衡
      - 大石头
      - 周计划
      - 时间管理

  yangming:
    name: 王阳明心学
    description: 致良知与知行合一，找到内心的声音
    estimated_time: 12分钟
    total_steps: 6
    triggers:
      - 王阳明
      - 心学
      - 知行合一
      - 致良知
      - 阳明

  liaofan:
    name: 了凡四训
    description: 立命改过积善，改变命运的实践方法
    estimated_time: 15分钟
    total_steps: 7
    triggers:
      - 了凡四训
      - 改命
      - 功过格
      - 积善
      - 袁了凡

# ═══════════════════════════════════════════════════════════════
# Skill 路由配置
# ═══════════════════════════════════════════════════════════════

skills:
  bazi:
    short_desc: 八字命理分析
    triggers:
      - 八字
      - 命理
      - 生辰
      - 算命
      - 看命
      - 命盘
      - 排盘

  zodiac:
    short_desc: 星座星盘分析
    triggers:
      - 星座
      - 星盘
      - 占星
      - 上升
      - 月亮星座
      - 太阳星座

  tarot:
    short_desc: 塔罗牌占卜
    triggers:
      - 塔罗
      - 牌阵
      - 占卜
      - 抽牌
      - 塔罗牌

  career:
    short_desc: 职业规划咨询
    triggers:
      - 职业
      - 工作
      - 跳槽
      - 面试
      - 简历
      - 升职

  lifecoach:
    short_desc: 人生教练
    triggers:
      - 人生规划
      - 目标
      - 习惯
      - 迷茫
      - 卡住
      - 拖延
      - 想改变

# ═══════════════════════════════════════════════════════════════
# SOP 规则模板 (自然语言版 - v10: 增强版)
# ═══════════════════════════════════════════════════════════════

sop_templates:
  # P1: 需要收集信息
  need_birth_info: |
    ## 当前状态：需要出生信息

    **数据状态**：
    - 需要出生信息：是
    - 已提供：否

    **推荐工具**：`{collect_tool}`

    **为什么推荐此工具**：
    1. 表单确保信息完整（年月日时 + 时区）
    2. 提供更好的用户体验
    3. 减少来回对话次数

    **重要 - 灵活处理**：
    - 如果用户在对话中直接提供了生日（如"我1990年1月1日出生"），你可以解析信息并直接进入下一步
    - 如果信息不完整（如只说"1990年1月"），仍需调用工具收集完整信息
    - 不要用文字问"请问你的生日是？"，直接调用工具

    **执行方式**：
    1. 简短说"让我了解一下你的出生信息～"
    2. 调用 `{collect_tool}` 工具
    3. 等待用户填写表单

  # P2: 需要计算
  need_compute: |
    ## 当前状态：需要生成命盘

    **数据状态**：
    - 已有出生信息：是
    - 已生成命盘：否

    **推荐工具**：`{compute_tool}`

    **为什么推荐此工具**：
    1. 生成命盘是分析的前提
    2. 计算过程自动化（约1-2秒）
    3. 生成后即可开始专业分析

    **执行方式**：
    1. 简短说"让我来排个盘～"
    2. 调用 `{compute_tool}` 工具
    3. 等待结果（约1-2秒）
    4. 收到结果后开始分析

  # P3+: 可以分析
  ready_for_analysis: |
    ## 当前状态：可以开始分析

    **数据状态**：
    - 已有出生信息：是
    - 已生成命盘：是
    - 命盘摘要：{chart_summary}

    **你现在可以**：
    1. 根据用户问题聚焦分析
    2. 使用 `show_xxx` 工具展示结果
    3. 参考知识库（`search_db` 工具）
    4. 回答用户的追问

    **分析流程**：
    1. 快速扫描命盘中的关键特征
    2. 根据用户问题聚焦分析
    3. 用 `show_xxx` 工具展示分析结果
    4. 提供深入解读和建议

# ═══════════════════════════════════════════════════════════════
# 欢迎消息配置
# ═══════════════════════════════════════════════════════════════

welcome:
  greeting: "嗨～ 今天想聊点什么？"
  default_skills:
    - lifecoach
    - bazi
    - zodiac
