"""
E2E 测试配置
"""
import pytest
import sys
sys.path.insert(0, "/home/aiscend/work/vibelife/apps/api")

import httpx
from httpx import ASGITransport
from main import app


@pytest.fixture
async def client():
    """创建测试客户端"""
    transport = ASGITransport(app=app)
    async with httpx.AsyncClient(transport=transport, base_url="http://test") as client:
        yield client


@pytest.fixture
def free_headers():
    """免费用户 headers"""
    return {"X-Test-Tier": "free"}


@pytest.fixture
def paid_headers():
    """付费用户 headers"""
    return {"X-Test-Tier": "paid"}


@pytest.fixture
def guest_headers():
    """访客 headers"""
    return {"X-Test-Tier": "guest"}
