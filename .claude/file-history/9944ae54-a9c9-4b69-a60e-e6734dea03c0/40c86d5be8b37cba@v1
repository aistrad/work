version: "2.0"
skill_id: mindfulness
description: 正念导师工具 - 练习引导、记录统计

# ═══════════════════════════════════════════════════════════════════════════
# 动作型工具
# ═══════════════════════════════════════════════════════════════════════════
action:
  - name: start_mindfulness_session
    description: |
      开始正念练习会话。
      何时调用：
      - 用户请求做正念/冥想/呼吸练习时
      - 系统检测到情绪波动建议练习时
      - 其他 Skill 结束后触发收尾练习时
    parameters:
      - name: practice_type
        type: string
        required: true
        description: 练习类型
        enum:
          - breathing        # 呼吸锚定 (1-3分钟)
          - breathing_478    # 478呼吸 (2分钟)
          - stop             # STOP急救 (1分钟)
          - body_scan        # 身体扫描 (3分钟)
          - morning          # 晨间意图 (3分钟)
          - focus            # 专注启动 (2分钟)
          - sleep            # 睡前放松 (5-10分钟)
          - rain             # RAIN情绪处理 (5-10分钟)
          - integration      # 专家收尾 (2分钟)
      - name: duration_minutes
        type: integer
        required: false
        description: 练习时长（分钟）
        default: 3
      - name: context
        type: object
        required: false
        description: |
          上下文信息：
          - trigger: user/schedule/emotion_detect/expert_handoff
          - preceding_skill: bazi/zodiac/tarot/career
          - emotion_detected: anxiety/anger/sadness
      - name: mood_before
        type: integer
        required: false
        description: 练习前情绪评分 (1-5)

  - name: complete_mindfulness_session
    description: |
      完成正念练习并记录。
      何时调用：
      - 用户完成练习后
      - 用户中途退出时（标记 completed=false）
    parameters:
      - name: session_id
        type: string
        required: true
        description: 练习会话 ID
      - name: completed
        type: boolean
        required: true
        description: 是否完成
      - name: mood_after
        type: integer
        required: false
        description: 练习后情绪评分 (1-5)
      - name: notes
        type: string
        required: false
        description: 用户反馈笔记

# ═══════════════════════════════════════════════════════════════════════════
# 展示型工具
# ═══════════════════════════════════════════════════════════════════════════
display:
  - name: show_skill_intro
    description: |
      展示 Skill 介绍卡片。用于首次使用或用户想了解功能时。
      卡片包含：功能介绍、快速开始提示、订阅状态。
    type: display
    card_type: skill_intro
    when_to_call: |
      - 用户首次使用此 Skill 时
      - 用户问"这个能做什么"、"有什么功能"时
      - 用户说"介绍一下"、"帮助"时
    parameters:
      - name: variant
        type: string
        enum: [full, compact, mini]
        default: compact
        description: 卡片变体（full=完整版, compact=精简版, mini=迷你版）
      - name: reason
        type: string
        description: 展示原因（如"首次使用"、"功能介绍"）

  - name: show_practice_guide
    description: |
      展示正念练习的分步引导。
      引导词从对应 rules/{practice_type}.md 获取。
    card_type: practice_guide
    parameters:
      - name: practice_type
        type: string
        required: true
        description: 练习类型
        enum:
          - breathing
          - breathing_478
          - stop
          - body_scan
          - morning
          - focus
          - sleep
          - rain
          - integration
      - name: step
        type: integer
        required: false
        description: 当前步骤（分步展示时）

  - name: show_mindfulness_stats
    description: |
      展示用户的正念练习统计。
      何时调用：
      - 用户询问练习记录时
      - 完成里程碑时
    card_type: mindfulness_stats
    parameters:
      - name: period
        type: string
        required: false
        description: 统计周期
        default: all
        enum:
          - today
          - week
          - month
          - all

  - name: show_streak_celebration
    description: |
      展示连续打卡庆祝卡片。
      何时调用：达到 3/7/14/21/30 天里程碑时
    card_type: streak_celebration
    parameters:
      - name: streak_days
        type: integer
        required: true
        description: 连续天数
      - name: total_minutes
        type: integer
        required: false
        description: 总练习分钟数

  - name: show_emotion_check
    description: |
      展示情绪检测卡片。
      何时调用：
      - 检测到可能的负面情绪时
      - 建议练习前了解用户状态时
    card_type: emotion_check
    parameters:
      - name: detected_emotion
        type: string
        required: false
        description: 检测到的情绪
        enum:
          - anxiety
          - anger
          - sadness
          - stress
          - overwhelm
      - name: suggestion
        type: string
        required: false
        description: 建议的练习类型（stop/rain）
