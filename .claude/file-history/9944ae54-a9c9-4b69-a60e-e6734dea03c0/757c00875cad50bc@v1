#!/usr/bin/env python3
"""æµ‹è¯•åç«¯å·¥å…· handler å®ç°æƒ…å†µ"""
import os
import re

skills = {
    "tarot": {
        "handlers_file": "/home/aiscend/work/vibelife/apps/api/skills/tarot/tools/handlers.py",
        "expected_tools": ["show_skill_intro", "show_tarot_spread"]
    },
    "career": {
        "handlers_file": "/home/aiscend/work/vibelife/apps/api/skills/career/tools/handlers.py",
        "expected_tools": ["show_skill_intro", "show_career_analysis", "show_personality_profile"]
    },
    "mindfulness": {
        "handlers_file": "/home/aiscend/work/vibelife/apps/api/skills/mindfulness/tools/handlers.py",
        "expected_tools": ["show_skill_intro", "show_practice_guide", "show_mindfulness_stats", "show_streak_celebration", "show_emotion_check"]
    },
}

print("\n" + "="*70)
print("åç«¯å·¥å…· Handler å®ç°æ£€æŸ¥")
print("="*70 + "\n")

for skill, config in skills.items():
    handlers_file = config["handlers_file"]
    expected_tools = config["expected_tools"]

    print(f"ğŸ“¦ {skill.upper()}")

    if not os.path.exists(handlers_file):
        print(f"  âŒ handlers.py NOT FOUND!")
        print()
        continue

    with open(handlers_file, 'r', encoding='utf-8') as f:
        content = f.read()

    for tool in expected_tools:
        # æŸ¥æ‰¾å‡½æ•°å®šä¹‰
        patterns = [
            rf'async def {tool}\(',
            rf'def {tool}\(',
            rf'"{tool}".*:',  # å­—å…¸å½¢å¼
            rf"'{tool}'.*:",  # å­—å…¸å½¢å¼
        ]

        found = any(re.search(pattern, content) for pattern in patterns)

        if found:
            print(f"  âœ… {tool:30} handler exists")
        else:
            print(f"  âš ï¸  {tool:30} handler MAY NOT exist (needs manual verification)")

    print()

print("="*70)
print("æ³¨æ„: show_skill_intro å¯èƒ½åœ¨å…¨å±€ core handlers ä¸­å®ç°")
print("="*70 + "\n")
