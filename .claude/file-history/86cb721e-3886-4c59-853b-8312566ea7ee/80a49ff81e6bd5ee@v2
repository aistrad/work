"""
Agent Framework - V6 Architecture
CoreAgent with LLM-based skill selection (Claude Agent SDK style)

V6 Changes:
- CoreAgent replaces Orchestrator + SkillAgents
- LLM-based skill selection (no keyword matching)
- SkillLoader loads SKILL.md files
- Unified tool schema from YAML
- SOP state persistence with Redis
- Skill validation for CI
"""

# Core Agent
from .core import CoreAgent, AgentContext, AgentEvent, AgentState, create_agent
from .skill_loader import load_skill, build_system_prompt, get_available_skills, SkillConfig
from .subagent import SkillSubAgent
from .quota import QuotaTracker, TIER_LIMITS

# Stream Adapters
from .stream_adapter import (
    BaseStreamAdapter,
    AISDKv6Adapter,
    LegacySSEAdapter,
    StreamConfig,
    get_adapter,
)

# V6 新增: 统一工具定义
from .tool_schema import (
    ToolDef,
    ToolParam,
    load_skill_tools,
    get_skill_tools_openai,
    get_global_tools_openai,
    get_all_tools_for_skill,
    get_tool_card_type,
)

# V6 新增: 统一工具注册表
from .tool_registry import (
    ToolRegistry,
    ToolContext,
    tool_handler,
)

# V6 新增: SOP 状态持久化
from .sop_state import (
    SOPState,
    SOPStateManager,
    get_sop_manager,
)

# V6 新增: SOP 引擎
from .sop_engine import (
    SOPEngine,
    SOPPhase,
    SOPAction,
    create_sop_engine,
    check_sop_requirements,
)

# V6 新增: Skill 校验
from .skill_validator import (
    validate_skill,
    validate_all_skills,
    ValidationResult,
    ValidationError,
)

__all__ = [
    # Core Agent
    "CoreAgent",
    "AgentContext",
    "AgentEvent",
    "AgentState",
    "SkillConfig",
    "SkillSubAgent",
    "QuotaTracker",
    "TIER_LIMITS",
    "create_agent",
    "load_skill",
    "build_system_prompt",
    "get_available_skills",
    # Stream Adapters
    "BaseStreamAdapter",
    "AISDKv6Adapter",
    "LegacySSEAdapter",
    "StreamConfig",
    "get_adapter",
    # Tool Schema
    "ToolDef",
    "ToolParam",
    "load_skill_tools",
    "get_skill_tools_openai",
    "get_global_tools_openai",
    "get_all_tools_for_skill",
    "get_tool_card_type",
    # Tool Registry
    "ToolRegistry",
    "ToolContext",
    "tool_handler",
    # SOP State
    "SOPState",
    "SOPStateManager",
    "get_sop_manager",
    # SOP Engine
    "SOPEngine",
    "SOPPhase",
    "SOPAction",
    "create_sop_engine",
    "check_sop_requirements",
    # Skill Validator
    "validate_skill",
    "validate_all_skills",
    "ValidationResult",
    "ValidationError",
]
