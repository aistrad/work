#!/bin/bash
# VibeLife 部署脚本
# 运行: sudo bash deploy.sh

set -e

echo "=== VibeLife 部署脚本 ==="
echo ""

# 1. 应用 Nginx 配置
echo "[1/4] 应用 Nginx 配置..."
cp /home/aiscend/work/vibelife/nginx-vibelife.conf /etc/nginx/sites-available/vibelife

# 2. 测试 Nginx 配置
echo "[2/4] 测试 Nginx 配置..."
nginx -t

# 3. 重载 Nginx
echo "[3/4] 重载 Nginx..."
systemctl reload nginx

# 4. 验证部署
echo "[4/4] 验证部署..."
sleep 2

echo ""
echo "=== 部署完成 ==="
echo ""
echo "访问地址:"
echo "  主站:     http://106.37.170.238:8230/"
echo "  八字入口: http://106.37.170.238:8231/"
echo "  星座入口: http://106.37.170.238:8232/"
echo ""
echo "API 健康检查:"
curl -s http://127.0.0.1:8230/health || echo "API 检查失败"
echo ""
