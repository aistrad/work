 Taskman 3.0 - 多用户运维管理系统设计                                                                                                       
                                                                                                                                            
 0. 项目背景                                                                                                                                
                                                                                                                                            
 VibeLife 生态系统                                                                                                                          
                                                                                                                                            
 核心产品: VibeLife - AI原生个人成长陪伴平台                                                                                                
 - 多 Skill 站点: bazi, zodiac, mbti, attach, career                                                                                        
 - 技术栈: Node.js + PostgreSQL + LLM                                                                                                       
 - 部署: /opt/vibelife/ (api + web)                                                                                                         
                                                                                                                                            
 数据服务:                                                                                                                                  
 - /data/hkse/ - 港股数据 (2007-至今)                                                                                                       
 - /data/gs/ - 金融数据                                                                                                                     
 - /data/knowledge/ - 知识库 (MBTI, 八字, 塔罗等)                                                                                           
 - /data/anaconda3/ - AI/ML 环境                                                                                                            
                                                                                                                                            
 用户角色                                                                                                                                   
 ┌──────────┬──────┬───────────────────────────────┐                                                                                        
 │   用户   │ UID  │             职责              │                                                                                        
 ├──────────┼──────┼───────────────────────────────┤                                                                                        
 │ aiscend  │ 1000 │ 开发者/管理员, 所有资源所有者 │                                                                                        
 ├──────────┼──────┼───────────────────────────────┤                                                                                        
 │ base     │ 1001 │ 基础服务                      │                                                                                        
 ├──────────┼──────┼───────────────────────────────┤                                                                                        
 │ crawler  │ 1002 │ 数据抓取 (港股/金融数据)      │                                                                                        
 ├──────────┼──────┼───────────────────────────────┤                                                                                        
 │ vibelife │ 1004 │ VibeLife 应用运维             │                                                                                        
 ├──────────┼──────┼───────────────────────────────┤                                                                                        
 │ clawdbot │ 1005 │ AI Ops Lead (Claude Code)     │                                                                                        
 └──────────┴──────┴───────────────────────────────┘                                                                                        
 ---                                                                                                                                        
 1. 系统架构                                                                                                                                
                                                                                                                                            
 ┌─────────────────────────────────────────────────────────────────────┐                                                                    
 │                         aiscend (开发者/管理员)                       │                                                                  
 │                    - sudo 权限, 所有资源所有者                        │                                                                  
 │                    - /opt/vibelife, /etc/vibelife 管理               │                                                                   
 └─────────────────────────────────────────────────────────────────────┘                                                                    
                                     │                                                                                                      
                                     ▼                                                                                                      
 ┌─────────────────────────────────────────────────────────────────────┐                                                                    
 │                      clawdbot (运维主控 Ops Lead)                    │                                                                   
 │                                                                      │                                                                   
 │  职责:                                                               │                                                                   
 │  - 管理所有 clawdbot 实例                                            │                                                                   
 │  - 维护共享配置模板                                                  │                                                                   
 │  - 集中监控和健康检查                                                │                                                                   
 │  - 配置分发和同步                                                    │                                                                   
 │                                                                      │                                                                   
 │  工具:                                                               │                                                                   
 │  - /instances - 实例管理                                             │                                                                   
 │  - /deploy - 配置部署                                                │                                                                   
 │  - /monitor - 集中监控                                               │                                                                   
 └─────────────────────────────────────────────────────────────────────┘                                                                    
                                     │                                                                                                      
           ┌─────────────────────────┼─────────────────────────┐                                                                            
           ▼                         ▼                         ▼                                                                            
 ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐                                                                      
 │    vibelife     │      │    crawler      │      │    [future]     │                                                                      
 │   应用运维      │      │   数据抓取      │      │   其他服务      │                                                                      
 │                 │      │                 │      │                 │                                                                      
 │ ~/.clawdbot/    │      │ ~/.clawdbot/    │      │ ~/.clawdbot/    │                                                                      
 │ ~/clawd/        │      │ ~/clawd/        │      │ ~/clawd/        │                                                                      
 └─────────────────┘      └─────────────────┘      └─────────────────┘                                                                      
                                                                                                                                            
 ---                                                                                                                                        
 2. 目录结构设计                                                                                                                            
                                                                                                                                            
 2.1 共享目录 (由 aiscend 管理)                                                                                                             
                                                                                                                                            
 /etc/vibelife/                                                                                                                             
 ├── clawdbot/                                                                                                                              
 │   ├── profiles/                # 共享配置模板                                                                                            
 │   │   ├── base.json           # 基础配置                                                                                                 
 │   │   ├── telegram.json       # Telegram 模板                                                                                            
 │   │   ├── whisper.json        # 语音转录模板                                                                                             
 │   │   └── full.json           # 完整模板                                                                                                 
 │   ├── env/                                                                                                                               
 │   │   ├── common.env          # 共享环境变量 (代理等)                                                                                    
 │   │   └── secrets.env         # 共享密钥 (只读)                                                                                          
 │   └── policies/                                                                                                                          
 │       └── permissions.json    # 权限策略                                                                                                 
 ├── ssh/                         # 共享 SSH 密钥                                                                                           
 └── db/                          # 数据库配置                                                                                              
                                                                                                                                            
 2.2 Ops Lead (clawdbot) 目录                                                                                                               
                                                                                                                                            
 /home/clawdbot/                                                                                                                            
 ├── .clawdbot/                                                                                                                             
 │   ├── clawdbot.json           # 主配置                                                                                                   
 │   └── tasks/                                                                                                                             
 │       ├── registry.json       # 本地任务                                                                                                 
 │       ├── instances.json      # 实例注册表 ⭐ 新增                                                                                       
 │       ├── docs/                                                                                                                          
 │       │   ├── SETUP.md                                                                                                                   
 │       │   └── INSTANCES-STATUS.md  ⭐ 新增                                                                                               
 │       └── deployments/        # 部署历史 ⭐ 新增                                                                                         
 │           └── YYYY-MM-DD/                                                                                                                
 └── clawd/                                                                                                                                 
     └── skills/                                                                                                                            
         └── taskman/                                                                                                                       
             ├── SKILL.md                                                                                                                   
             ├── taskman.sh                                                                                                                 
             ├── autoconfig.sh                                                                                                              
             ├── setup.sh                                                                                                                   
             ├── instances.sh     ⭐ 新增: 实例管理                                                                                         
             ├── deploy.sh        ⭐ 新增: 配置部署                                                                                         
             ├── monitor.sh       ⭐ 新增: 集中监控                                                                                         
             ├── lib/                                                                                                                       
             │   ├── registry.sh                                                                                                            
             │   ├── cron.sh                                                                                                                
             │   ├── notify.sh                                                                                                              
             │   ├── profiles.sh                                                                                                            
             │   ├── docs.sh                                                                                                                
             │   └── multi-instance.sh  ⭐ 新增                                                                                             
             └── profiles/                                                                                                                  
                                                                                                                                            
 2.3 运维用户目录 (vibelife, crawler 等)                                                                                                    
                                                                                                                                            
 /home/{user}/                                                                                                                              
 ├── .clawdbot/                                                                                                                             
 │   ├── clawdbot.json           # 本地配置 (继承共享)                                                                                      
 │   ├── local-overrides.json    # 本地覆盖配置                                                                                             
 │   └── tasks/                                                                                                                             
 │       ├── registry.json       # 本地任务                                                                                                 
 │       └── profiles/           # 从主控同步的模板                                                                                         
 └── clawd/                       # 工作空间 (可选)                                                                                         
                                                                                                                                            
 ---                                                                                                                                        
 3. 命令设计                                                                                                                                
                                                                                                                                            
 3.1 /instances - 实例管理 (仅 clawdbot)                                                                                                    
 ┌───────────────────────────────────┬──────────────────┐                                                                                   
 │               命令                │       说明       │                                                                                   
 ├───────────────────────────────────┼──────────────────┤                                                                                   
 │ /instances                        │ 列出所有注册实例 │                                                                                   
 ├───────────────────────────────────┼──────────────────┤                                                                                   
 │ /instances register <user> [role] │ 注册新实例       │                                                                                   
 ├───────────────────────────────────┼──────────────────┤                                                                                   
 │ /instances unregister <user>      │ 取消注册         │                                                                                   
 ├───────────────────────────────────┼──────────────────┤                                                                                   
 │ /instances check [user]           │ 检查实例状态     │                                                                                   
 ├───────────────────────────────────┼──────────────────┤                                                                                   
 │ /instances check-all              │ 检查所有实例     │                                                                                   
 ├───────────────────────────────────┼──────────────────┤                                                                                   
 │ /instances report                 │ 生成状态报告     │                                                                                   
 └───────────────────────────────────┴──────────────────┘                                                                                   
 3.2 /deploy - 配置部署 (仅 clawdbot)                                                                                                       
 ┌──────────────────────────┬────────────────────────┐                                                                                      
 │           命令           │          说明          │                                                                                      
 ├──────────────────────────┼────────────────────────┤                                                                                      
 │ /deploy <user> [profile] │ 部署配置到指定用户     │                                                                                      
 ├──────────────────────────┼────────────────────────┤                                                                                      
 │ /deploy all [profile]    │ 部署到所有实例         │                                                                                      
 ├──────────────────────────┼────────────────────────┤                                                                                      
 │ /deploy sync-profiles    │ 同步配置模板到所有实例 │                                                                                      
 ├──────────────────────────┼────────────────────────┤                                                                                      
 │ /deploy rollback <user>  │ 回滚上次部署           │                                                                                      
 ├──────────────────────────┼────────────────────────┤                                                                                      
 │ /deploy history [user]   │ 查看部署历史           │                                                                                      
 └──────────────────────────┴────────────────────────┘                                                                                      
 3.3 /monitor - 集中监控 (仅 clawdbot)                                                                                                      
 ┌────────────────────────────┬──────────────────┐                                                                                          
 │            命令            │       说明       │                                                                                          
 ├────────────────────────────┼──────────────────┤                                                                                          
 │ /monitor status            │ 所有实例状态概览 │                                                                                          
 ├────────────────────────────┼──────────────────┤                                                                                          
 │ /monitor logs <user>       │ 查看实例日志     │                                                                                          
 ├────────────────────────────┼──────────────────┤                                                                                          
 │ /monitor alerts            │ 查看告警         │                                                                                          
 ├────────────────────────────┼──────────────────┤                                                                                          
 │ /monitor exec <user> <cmd> │ 在实例上执行命令 │                                                                                          
 ├────────────────────────────┼──────────────────┤                                                                                          
 │ /monitor exec-all <cmd>    │ 在所有实例执行   │                                                                                          
 └────────────────────────────┴──────────────────┘                                                                                          
 3.4 原有命令保持不变                                                                                                                       
                                                                                                                                            
 - /tasks - 任务管理                                                                                                                        
 - /autoconfig - 系统配置                                                                                                                   
 - /setup - 配置管理                                                                                                                        
                                                                                                                                            
 ---                                                                                                                                        
 4. 数据模型                                                                                                                                
                                                                                                                                            
 4.1 instances.json (实例注册表)                                                                                                            
                                                                                                                                            
 {                                                                                                                                          
   "version": 1,                                                                                                                            
   "master": {                                                                                                                              
     "user": "clawdbot",                                                                                                                    
     "role": "ops-lead",                                                                                                                    
     "description": "Operations Lead"                                                                                                       
   },                                                                                                                                       
   "instances": [                                                                                                                           
     {                                                                                                                                      
       "user": "vibelife",                                                                                                                  
       "role": "app-ops",                                                                                                                   
       "description": "VibeLife 应用运维",                                                                                                  
       "registeredAt": "2026-01-28T00:00:00Z",                                                                                              
       "configDir": "/home/vibelife/.clawdbot",                                                                                             
       "workspace": "/home/vibelife/clawd",                                                                                                 
       "status": "running",                                                                                                                 
       "lastCheck": "2026-01-28T10:00:00Z",                                                                                                 
       "lastDeploy": "2026-01-28T08:00:00Z",                                                                                                
       "deployedProfile": "full",                                                                                                           
       "tags": ["production", "telegram"]                                                                                                   
     },                                                                                                                                     
     {                                                                                                                                      
       "user": "crawler",                                                                                                                   
       "role": "data-ops",                                                                                                                  
       "description": "数据抓取服务",                                                                                                       
       "registeredAt": "2026-01-28T00:00:00Z",                                                                                              
       "status": "stopped",                                                                                                                 
       "tags": ["scraping"]                                                                                                                 
     }                                                                                                                                      
   ]                                                                                                                                        
 }                                                                                                                                          
                                                                                                                                            
 4.2 配置继承模型                                                                                                                           
                                                                                                                                            
 /etc/vibelife/clawdbot/profiles/base.json  (共享基础)                                                                                      
                     ↓                                                                                                                      
 /home/clawdbot/clawd/skills/taskman/profiles/*.json  (模板库)                                                                              
                     ↓                                                                                                                      
 /home/{user}/.clawdbot/clawdbot.json  (用户配置)                                                                                           
                     ↓                                                                                                                      
 /home/{user}/.clawdbot/local-overrides.json  (本地覆盖)                                                                                    
                                                                                                                                            
 优先级: local-overrides > 用户配置 > 模板 > 共享基础                                                                                       
                                                                                                                                            
 ---                                                                                                                                        
 5. 权限模型                                                                                                                                
                                                                                                                                            
 5.1 用户组                                                                                                                                 
 ┌────────────────┬──────────────────────────────────┬────────────────────────────┐                                                         
 │       组       │               成员               │            权限            │                                                         
 ├────────────────┼──────────────────────────────────┼────────────────────────────┤                                                         
 │ vibelife-admin │ aiscend                          │ 完全读写, sudo             │                                                         
 ├────────────────┼──────────────────────────────────┼────────────────────────────┤                                                         
 │ vibelife-ops   │ clawdbot, vibelife, crawler, ... │ 读取共享配置, 各自目录读写 │                                                         
 └────────────────┴──────────────────────────────────┴────────────────────────────┘                                                         
 5.2 文件权限                                                                                                                               
 ┌────────────────────────────────────────┬─────────┬────────────────┬──────┐                                                               
 │                  路径                  │ 所有者  │       组       │ 权限 │                                                               
 ├────────────────────────────────────────┼─────────┼────────────────┼──────┤                                                               
 │ /etc/vibelife/                         │ root    │ vibelife-ops   │ 750  │                                                               
 ├────────────────────────────────────────┼─────────┼────────────────┼──────┤                                                               
 │ /etc/vibelife/clawdbot/profiles/       │ aiscend │ vibelife-ops   │ 755  │                                                               
 ├────────────────────────────────────────┼─────────┼────────────────┼──────┤                                                               
 │ /etc/vibelife/clawdbot/env/secrets.env │ root    │ vibelife-ops   │ 640  │                                                               
 ├────────────────────────────────────────┼─────────┼────────────────┼──────┤                                                               
 │ /opt/vibelife/                         │ aiscend │ vibelife-admin │ 775  │                                                               
 ├────────────────────────────────────────┼─────────┼────────────────┼──────┤                                                               
 │ /var/log/vibelife/                     │ root    │ vibelife-ops   │ 775  │                                                               
 └────────────────────────────────────────┴─────────┴────────────────┴──────┘                                                               
 5.3 Sudo 规则 (clawdbot)                                                                                                                   
                                                                                                                                            
 # /etc/sudoers.d/clawdbot-ops                                                                                                              
 clawdbot ALL=(vibelife,crawler) NOPASSWD: /usr/bin/systemctl --user *                                                                      
 clawdbot ALL=(vibelife,crawler) NOPASSWD: /home/*/clawd/skills/taskman/*.sh                                                                
 clawdbot ALL=(vibelife,crawler) NOPASSWD: /usr/bin/cat /home/*/.clawdbot/*                                                                 
                                                                                                                                            
 ---                                                                                                                                        
 6. 工作流程                                                                                                                                
                                                                                                                                            
 6.1 新用户接入流程                                                                                                                         
                                                                                                                                            
 1. aiscend 创建用户                                                                                                                        
    $ sudo vibelife-add-user <username> "description"                                                                                       
                                                                                                                                            
 2. clawdbot 注册实例                                                                                                                       
    /instances register <username> <role>                                                                                                   
                                                                                                                                            
 3. clawdbot 部署配置                                                                                                                       
    /deploy <username> full                                                                                                                 
                                                                                                                                            
 4. clawdbot 同步模板                                                                                                                       
    /deploy sync-profiles                                                                                                                   
                                                                                                                                            
 5. 验证                                                                                                                                    
    /instances check <username>                                                                                                             
                                                                                                                                            
 6.2 配置更新流程                                                                                                                           
                                                                                                                                            
 1. 更新共享模板                                                                                                                            
    编辑 /home/clawdbot/clawd/skills/taskman/profiles/*.json                                                                                
                                                                                                                                            
 2. 同步到所有实例                                                                                                                          
    /deploy sync-profiles                                                                                                                   
                                                                                                                                            
 3. (可选) 重新部署配置                                                                                                                     
    /deploy all <profile>                                                                                                                   
                                                                                                                                            
 4. 生成文档                                                                                                                                
    /setup docs                                                                                                                             
                                                                                                                                            
 6.3 监控流程                                                                                                                               
                                                                                                                                            
 定时任务 (cron):                                                                                                                           
   */30 * * * * /instances check-all >> /var/log/vibelife/clawdbot/monitor.log                                                              
                                                                                                                                            
 告警:                                                                                                                                      
   - 实例状态变为 stopped → 通知 Telegram                                                                                                   
   - 配置同步失败 → 记录日志                                                                                                                
                                                                                                                                            
 ---                                                                                                                                        
 7. 文件清单                                                                                                                                
                                                                                                                                            
 7.1 新增脚本                                                                                                                               
 ┌───────────────────────┬────────────────────┐                                                                                             
 │         文件          │        功能        │                                                                                             
 ├───────────────────────┼────────────────────┤                                                                                             
 │ instances.sh          │ 实例注册、状态检查 │                                                                                             
 ├───────────────────────┼────────────────────┤                                                                                             
 │ deploy.sh             │ 配置部署、模板同步 │                                                                                             
 ├───────────────────────┼────────────────────┤                                                                                             
 │ monitor.sh            │ 集中监控、日志查看 │                                                                                             
 ├───────────────────────┼────────────────────┤                                                                                             
 │ lib/multi-instance.sh │ 多实例核心库函数   │                                                                                             
 └───────────────────────┴────────────────────┘                                                                                             
 7.2 修改文件                                                                                                                               
 ┌─────────────────┬──────────────────────┐                                                                                                 
 │      文件       │       修改内容       │                                                                                                 
 ├─────────────────┼──────────────────────┤                                                                                                 
 │ SKILL.md        │ 添加新命令文档       │                                                                                                 
 ├─────────────────┼──────────────────────┤                                                                                                 
 │ lib/docs.sh     │ 添加实例状态报告生成 │                                                                                                 
 ├─────────────────┼──────────────────────┤                                                                                                 
 │ profiles/*.json │ 添加多用户相关配置项 │                                                                                                 
 └─────────────────┴──────────────────────┘                                                                                                 
 7.3 新增数据文件                                                                                                                           
 ┌────────────────────────────────────────────┬──────────────┐                                                                              
 │                    文件                    │     说明     │                                                                              
 ├────────────────────────────────────────────┼──────────────┤                                                                              
 │ ~/.clawdbot/tasks/instances.json           │ 实例注册表   │                                                                              
 ├────────────────────────────────────────────┼──────────────┤                                                                              
 │ ~/.clawdbot/tasks/docs/INSTANCES-STATUS.md │ 实例状态报告 │                                                                              
 ├────────────────────────────────────────────┼──────────────┤                                                                              
 │ ~/.clawdbot/tasks/deployments/             │ 部署历史记录 │                                                                              
 └────────────────────────────────────────────┴──────────────┘                                                                              
 ---                                                                                                                                        
 8. 实施步骤                                                                                                                                
                                                                                                                                            
 Phase 1: 基础设施 (aiscend 执行)                                                                                                           
                                                                                                                                            
 1. 创建用户组和共享目录                                                                                                                    
 2. 配置 sudoers 规则                                                                                                                       
 3. 创建共享配置模板目录                                                                                                                    
                                                                                                                                            
 Phase 2: 核心脚本 (clawdbot 目录)                                                                                                          
                                                                                                                                            
 1. 实现 lib/multi-instance.sh                                                                                                              
 2. 实现 instances.sh                                                                                                                       
 3. 实现 deploy.sh                                                                                                                          
 4. 实现 monitor.sh                                                                                                                         
 5. 更新 SKILL.md                                                                                                                           
                                                                                                                                            
 Phase 3: 集成测试                                                                                                                          
                                                                                                                                            
 1. 注册测试实例                                                                                                                            
 2. 测试配置部署                                                                                                                            
 3. 测试监控功能                                                                                                                            
 4. 验证权限隔离                                                                                                                            
                                                                                                                                            
 Phase 4: 文档和自动化                                                                                                                      
                                                                                                                                            
 1. 更新配置文档生成                                                                                                                        
 2. 添加监控定时任务                                                                                                                        
 3. 创建操作手册                                                                                                                            
                                                                                                                                            
 ---                                                                                                                                        
 9. 用户专属配置                                                                                                                            
                                                                                                                                            
 9.1 clawdbot (Ops Lead)                                                                                                                    
                                                                                                                                            
 职责: AI 运维总控, 管理所有 clawdbot 实例                                                                                                  
                                                                                                                                            
 专属任务:                                                                                                                                  
 ┌─────────────────┬──────────────────┬──────────────┐                                                                                      
 │       ID        │       说明       │     计划     │                                                                                      
 ├─────────────────┼──────────────────┼──────────────┤                                                                                      
 │ instances-check │ 检查所有实例状态 │ */30 * * * * │                                                                                      
 ├─────────────────┼──────────────────┼──────────────┤                                                                                      
 │ config-sync     │ 同步配置模板     │ 0 2 * * *    │                                                                                      
 ├─────────────────┼──────────────────┼──────────────┤                                                                                      
 │ report-generate │ 生成状态报告     │ 0 6 * * *    │                                                                                      
 └─────────────────┴──────────────────┴──────────────┘                                                                                      
 Profile: ops-lead.json                                                                                                                     
 {                                                                                                                                          
   "tools.media.audio.enabled": true,                                                                                                       
   "agents.defaults.maxConcurrent": 4,                                                                                                      
   "commands.native": "auto"                                                                                                                
 }                                                                                                                                          
                                                                                                                                            
 9.2 vibelife (App Ops)                                                                                                                     
                                                                                                                                            
 职责: VibeLife 应用运维, API/Web 服务监控                                                                                                  
                                                                                                                                            
 专属任务:                                                                                                                                  
 ┌──────────────┬──────────────┬──────────────┐                                                                                             
 │      ID      │     说明     │     计划     │                                                                                             
 ├──────────────┼──────────────┼──────────────┤                                                                                             
 │ api-health   │ API 健康检查 │ */5 * * * *  │                                                                                             
 ├──────────────┼──────────────┼──────────────┤                                                                                             
 │ db-backup    │ 数据库备份   │ 0 3 * * *    │                                                                                             
 ├──────────────┼──────────────┼──────────────┤                                                                                             
 │ logs-rotate  │ 日志轮转     │ 0 0 * * *    │                                                                                             
 ├──────────────┼──────────────┼──────────────┤                                                                                             
 │ deploy-check │ 部署状态检查 │ */15 * * * * │                                                                                             
 └──────────────┴──────────────┴──────────────┘                                                                                             
 Profile: vibelife-ops.json                                                                                                                 
 {                                                                                                                                          
   "agents.defaults.workspace": "/opt/vibelife",                                                                                            
   "env.vars.NODE_ENV": "production",                                                                                                       
   "tools.exec.pathPrepend": "/opt/vibelife/node_modules/.bin"                                                                              
 }                                                                                                                                          
                                                                                                                                            
 9.3 crawler (Data Ops)                                                                                                                     
                                                                                                                                            
 职责: 数据抓取服务, 港股/金融数据维护                                                                                                      
                                                                                                                                            
 专属任务:                                                                                                                                  
 ┌───────────────┬────────────────┬──────────────┐                                                                                          
 │      ID       │      说明      │     计划     │                                                                                          
 ├───────────────┼────────────────┼──────────────┤                                                                                          
 │ hkse-crawl    │ 港股数据抓取   │ 0 18 * * 1-5 │                                                                                          
 ├───────────────┼────────────────┼──────────────┤                                                                                          
 │ gs-crawl      │ GS 数据抓取    │ 0 8 * * *    │                                                                                          
 ├───────────────┼────────────────┼──────────────┤                                                                                          
 │ data-validate │ 数据完整性检查 │ 0 20 * * *   │                                                                                          
 ├───────────────┼────────────────┼──────────────┤                                                                                          
 │ storage-check │ 存储空间检查   │ 0 0 * * 0    │                                                                                          
 └───────────────┴────────────────┴──────────────┘                                                                                          
 Profile: crawler-ops.json                                                                                                                  
 {                                                                                                                                          
   "agents.defaults.workspace": "/home/crawler/work",                                                                                       
   "env.vars.CHROME_PROFILE": "/data/chrome_profile",                                                                                       
   "env.vars.DOWNLOAD_DIR": "/data/chrome_download"                                                                                         
 }                                                                                                                                          
                                                                                                                                            
 ---                                                                                                                                        
 10. 共享资源配置                                                                                                                           
                                                                                                                                            
 /etc/vibelife/clawdbot/env/common.env                                                                                                      
                                                                                                                                            
 # 代理配置                                                                                                                                 
 http_proxy=http://127.0.0.1:7890                                                                                                           
 https_proxy=http://127.0.0.1:7890                                                                                                          
                                                                                                                                            
 # 数据目录                                                                                                                                 
 DATA_ROOT=/data                                                                                                                            
 LOGS_ROOT=/var/log/vibelife                                                                                                                
                                                                                                                                            
 # Anaconda                                                                                                                                 
 CONDA_PREFIX=/data/anaconda3/envs/ai                                                                                                       
 PATH=/data/anaconda3/envs/ai/bin:$PATH                                                                                                     
                                                                                                                                            
 /etc/vibelife/clawdbot/profiles/shared-base.json                                                                                           
                                                                                                                                            
 {                                                                                                                                          
   "name": "shared-base",                                                                                                                   
   "description": "所有运维用户共享的基础配置",                                                                                             
   "patches": [                                                                                                                             
     {"path": "env.vars.http_proxy", "value": "http://127.0.0.1:7890"},                                                                     
     {"path": "env.vars.https_proxy", "value": "http://127.0.0.1:7890"},                                                                    
     {"path": "gateway.port", "value": 18789},                                                                                              
     {"path": "gateway.mode", "value": "local"}                                                                                             
   ]                                                                                                                                        
 }                                                                                                                                          
                                                                                                                                            
 ---                                                                                                                                        
 11. 验证清单                                                                                                                               
                                                                                                                                            
 基础功能                                                                                                                                   
                                                                                                                                            
 - /instances 列出所有注册实例                                                                                                              
 - /instances register user role 成功注册                                                                                                   
 - /instances check user 正确检测状态                                                                                                       
 - /deploy user profile 配置正确部署                                                                                                        
 - /deploy sync-profiles 模板同步成功                                                                                                       
 - /monitor status 显示所有实例状态                                                                                                         
                                                                                                                                            
 权限验证                                                                                                                                   
                                                                                                                                            
 - vibelife 无法访问 crawler 配置                                                                                                           
 - clawdbot 可以检查所有实例状态                                                                                                            
 - 共享配置对所有 ops 用户可读                                                                                                              
                                                                                                                                            
 自动化验证                                                                                                                                 
                                                                                                                                            
 - 定时任务正确同步到 crontab                                                                                                               
 - 文档自动生成包含实例信息                                                                                                                 
 - 健康检查告警正常触发                                                                                                                     
                                                                                                                                            
 业务验证                                                                                                                                   
                                                                                                                                            
 - vibelife: API 健康检查正常                                                                                                               
 - crawler: 数据抓取任务执行正常                                                                                                            
 - clawdbot: 实例监控报告生成正常                                                                                                           
╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌╌