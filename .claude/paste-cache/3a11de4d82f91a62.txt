 262 +        ToolRegistry.initialize()                                                                                                                                                             
      263 +        first_tools = ToolRegistry.get_all_tools()                                                                                                                                            
      264 +                                                                                                                                                                                              
      265 +        ToolRegistry.initialize()                                                                                                                                                             
      266 +        second_tools = ToolRegistry.get_all_tools()                                                                                                                                           
      267 +                                                                                                                                                                                              
      268 +        assert len(first_tools) == len(second_tools)                                                                                                                                          
      269 +                                                                                                                                                                                              
      270 +    def test_schema_caching(self):                                                                                                                                                            
      271 +        """测试 Schema 缓存"""                                                                                                                                                                
      272 +        from services.agent.tool_registry import ToolRegistry                                                                                                                                 
      273 +                                                                                                                                                                                              
      274 +        ToolRegistry.initialize()                                                                                                                                                             
      275 +                                                                                                                                                                                              
      276 +        # 多次获取应该返回相同结果                                                                                                                                                            
      277 +        schema1 = ToolRegistry.get_schema()                                                                                                                                                   
      278 +        schema2 = ToolRegistry.get_schema()                                                                                                                                                   
      279 +                                                                                                                                                                                              
      280 +        assert schema1["version"] == schema2["version"]                                                                                                                                       
      281 +        assert len(schema1["tools"]) == len(schema2["tools"])   