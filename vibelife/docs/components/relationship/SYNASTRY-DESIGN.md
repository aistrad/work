# VibeLife 合盘功能产品设计

> Version: 1.0 | 2026-01-22
> Status: Draft

---

## 1. 产品愿景

**「合盘」让用户看见关系中看不见的部分。**

每段关系都有其独特的化学反应——为什么有些人一见如故，有些人总是摩擦不断？合盘功能通过融合东西方智慧（星座、八字、荣格心理学），帮助用户理解关系的深层动力，找到更好的相处之道。

---

## 2. 用户洞察

### 2.1 目标用户

| 用户类型 | 典型场景 | 核心诉求 |
|---------|---------|---------|
| **恋爱中的年轻人** | 刚认识一个人，想知道合不合适 | 快速判断、有趣好玩 |
| **长期伴侣** | 相处多年，想更深理解对方 | 深度分析、改善建议 |
| **新手父母** | 想理解孩子的性格 | 亲子沟通、教育方式 |
| **创业者** | 找合伙人、评估团队成员 | 合作匹配、互补分析 |

### 2.2 用户痛点

1. **「市面上的合盘太单一」** - 只看太阳星座，准确度低
2. **「需要对方配合」** - 很多产品要求对方也注册，尴尬
3. **「看完分数不知道怎么办」** - 只有评分，没有可操作的建议
4. **「只适合恋爱场景」** - 想看亲子、合伙人，但找不到合适的工具

### 2.3 用户期望

> "我想知道和 TA 在一起会是什么感觉，遇到什么问题，怎么解决。"
> "不只是一个分数，而是真正帮我理解这段关系。"

---

## 3. 产品定位

### 3.1 核心差异化

| 我们 | 竞品 |
|------|------|
| **多维融合**：星座 + 八字 + 荣格 | 单一维度（只有星座） |
| **无需对方参与**：输入生辰即可 | 需要双方都注册 |
| **多关系类型**：恋爱/亲子/合伙人/朋友 | 只做恋爱配对 |
| **AI 深度解读**：个性化建议 | 模板化结果 |
| **关系管理**：保存重要的人 | 一次性分析 |

### 3.2 价值主张

```
「了解你们的关系，就像了解你们自己一样深入。」
```

---

## 4. 用户体验设计

### 4.1 核心用户旅程

```
┌─────────────────────────────────────────────────────────────────────┐
│                        用户旅程地图                                  │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  触发          收集           等待          发现          行动       │
│   │             │              │             │             │        │
│   ▼             ▼              ▼             ▼             ▼        │
│ ┌───┐        ┌───┐         ┌───┐        ┌───┐         ┌───┐       │
│ │想了│        │填写│         │看到│        │阅读│         │保存│       │
│ │解TA│───────▶│信息│────────▶│动画│───────▶│结果│────────▶│分享│       │
│ └───┘        └───┘         └───┘        └───┘         └───┘       │
│                                                                      │
│ 情绪：         情绪：          情绪：        情绪：         情绪：     │
│ 好奇期待       有点麻烦        期待紧张      惊喜/认同      满足       │
│                                                                      │
│ 设计目标：      设计目标：       设计目标：     设计目标：      设计目标： │
│ 降低门槛       极简表单        仪式感        Aha Moment    促进分享   │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

### 4.2 关键体验时刻

#### Moment 1: 触发 - 「我想看合盘」

**场景**：用户在对话中自然提起想了解和某人的关系

**设计原则**：
- 零摩擦触发：用户说"想看和TA的合盘"即可开始
- 如果已保存过关系对象，优先询问"你想看和谁的合盘？"
- 新用户直接进入信息收集

#### Moment 2: 收集 - 「告诉我 TA 的信息」

**场景**：需要用户输入对方的出生信息

**设计原则**：
- **极简表单**：只问必要的（姓名、关系、生日、地点）
- **减少输入**：时间可选，默认正午
- **情感化设计**：先选关系类型（恋人/家人/朋友），让用户进入情境
- **即时反馈**：填完即刻显示星座，建立期待

**表单设计**：

```
┌─────────────────────────────────────────┐
│                                         │
│   TA 是你的...                          │
│                                         │
│   💕 恋人    💍 伴侣    👨‍👧 亲子         │
│   👫 兄弟姐妹  🤝 合伙人   👥 朋友       │
│                                         │
│   ─────────────────────────────────     │
│                                         │
│   TA 叫什么？                           │
│   ┌─────────────────────────────┐      │
│   │                             │      │
│   └─────────────────────────────┘      │
│                                         │
│   TA 什么时候出生？                      │
│   ┌─────────────────────────────┐      │
│   │ 选择日期...            📅   │      │
│   └─────────────────────────────┘      │
│   ☐ 我知道具体时间（可选）               │
│                                         │
│   TA 在哪里出生？                        │
│   ┌─────────────────────────────┐      │
│   │ 搜索城市...            🔍   │      │
│   └─────────────────────────────┘      │
│                                         │
│   ─────────────────────────────────     │
│                                         │
│   ☑ 保存 TA，方便下次查看               │
│                                         │
│          [ 开始分析 ]                   │
│                                         │
└─────────────────────────────────────────┘
```

#### Moment 3: 等待 - 「正在计算你们的缘分」

**场景**：后台计算合盘，用户等待结果

**设计原则**：
- **仪式感**：不是简单的 loading，而是"正在解读你们的星盘"
- **透明感**：展示计算步骤（分析星座相位... 分析八字配对... 分析心理契合...）
- **控制时间**：即使计算很快，也保持 3-5 秒的仪式感

**动画设计**：

```
┌─────────────────────────────────────────┐
│                                         │
│                                         │
│          ✨ 正在解读你们的缘分 ✨        │
│                                         │
│                                         │
│      ┌───┐            ┌───┐            │
│      │ 你 │ ── ✨ ──  │ TA │            │
│      └───┘            └───┘            │
│                                         │
│                                         │
│      ☑ 分析星座相位                     │
│      ▶ 解读八字配对                     │
│      ○ 计算心理契合                     │
│                                         │
│                                         │
└─────────────────────────────────────────┘
```

#### Moment 4: 发现 - 「你们的关系画像」

**场景**：展示合盘结果，用户阅读分析

**设计原则**：
- **先总览后详情**：先给一个综合印象，再展开各维度
- **情感化表达**：不是冷冰冰的分数，而是"你们是天生一对"
- **可探索性**：用户可以点击感兴趣的维度深入了解
- **平衡优劣**：既有亮点也有挑战，真实可信

**结果展示设计**：

```
┌─────────────────────────────────────────┐
│                                         │
│         💕 你 和 小明 的关系画像         │
│                                         │
│      ┌───────────────────────┐         │
│      │                       │         │
│      │         78            │         │
│      │        ───            │         │
│      │       「灵魂伴侣」      │         │
│      │                       │         │
│      │  你们有很深的心灵连接   │         │
│      │                       │         │
│      └───────────────────────┘         │
│                                         │
├─────────────────────────────────────────┤
│                                         │
│  ♈ 星座契合                    82      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━░░   │
│  太阳天蝎 × 太阳双鱼 = 水象深情组合      │
│                                    ▶   │
│                                         │
│  ☯ 八字配对                    72      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━░░░░░░░   │
│  日主甲木生癸水，滋养型关系              │
│                                    ▶   │
│                                         │
│  🧠 心理契合                    80      │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━░░░   │
│  依附风格互补，成长潜力大                │
│                                    ▶   │
│                                         │
├─────────────────────────────────────────┤
│                                         │
│  ✨ 你们的亮点                          │
│  • 情感共鸣强烈，能读懂彼此              │
│  • 价值观相近，容易达成共识              │
│                                         │
│  ⚡ 需要注意                            │
│  • 都比较敏感，要学会给彼此空间          │
│  • 决策时可能都太感性                    │
│                                         │
│  💡 相处建议                            │
│  • 定期进行深度对话，保持心灵连接         │
│  • 在重大决定前给彼此冷静时间             │
│                                         │
└─────────────────────────────────────────┘
```

#### Moment 5: 行动 - 「保存/分享」

**场景**：用户看完结果，决定下一步

**设计原则**：
- **保存关系**：一键保存，下次直接选择
- **分享能力**：生成精美的分享图片
- **继续对话**：可以追问具体问题

---

## 5. 产品概念：VibeRelationship

### 5.1 Vibe 层三维度模型

VibeProfile 的 `vibe` 层是跨 Skill 的洞察层，存储 AI 从各个 Skill 中提炼的用户画像。现有两个维度：

```
┌─────────────────────────────────────────────────────────────────────┐
│                         Vibe 层：我是谁的完整图景                      │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│   vibeInsight          vibeTarget          vibeRelationship         │
│   ─────────           ──────────          ─────────────────         │
│   「我是谁」           「我要成为谁」         「我与他人」              │
│                                                                      │
│   • 核心人格           • 北极星愿景          • 重要关系画像            │
│   • 行为模式           • 人生目标            • 关系动力洞察            │
│   • 价值观             • 阶段性目标          • 相处模式               │
│   • 情绪状态           • 成长方向            • 成长机会               │
│                                                                      │
│   来源：               来源：                来源：                   │
│   bazi, zodiac,        lifecoach,           synastry（合盘）         │
│   jungastro            career               所有关系分析              │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

**vibeRelationship 是第三维度**：记录用户与重要他人的关系洞察。

### 5.2 为什么需要 vibeRelationship？

| 问题 | vibeRelationship 如何解决 |
|------|-------------------------|
| 合盘结果看完就没了 | 持久存储，随时回顾 |
| 想看和某人的相处建议 | 直接读取，无需重新计算 |
| AI 不知道我的关系背景 | 对话时可引用关系洞察 |
| 多次合盘结果分散 | 统一存储，形成关系档案 |

### 5.3 vibeRelationship 存储什么？

**设计原则**：
- 存储**洞察**，不存储原始数据（原始数据在 relationships 中）
- 存储**最重要的关系**，不是所有合盘历史
- 存储**可操作的建议**，不只是分数

**概念结构**：

```
vibeRelationship:
  primaryPartner:           # 主要伴侣（如果有）
    personId: "rel_001"
    name: "小明"
    type: "romantic"
    overallHarmony: 78
    coreInsight: "你们是水象深情组合，情感细腻，能感知彼此"
    strengths:
      - "情感共鸣强烈"
      - "价值观相近"
    growthAreas:
      - "给彼此更多空间"
      - "重大决策前冷静"
    lastUpdated: "2026-01-22"

  keyRelationships:         # 其他重要关系（最多5个）
    - personId: "rel_002"
      name: "爸爸"
      type: "parent_child"
      overallHarmony: 65
      coreInsight: "你们的沟通方式差异较大，但内心都很关心对方"
      bestApproach: "少讲道理，多表达关心"

  relationshipPatterns:     # 跨关系的模式洞察
    attachmentStyle: "安全型偏焦虑"
    commonChallenges:
      - "容易过度付出"
      - "需要更多独处时间"
    growthOpportunities:
      - "学习设立边界"
      - "表达需求时更直接"
```

### 5.4 用户价值

**场景 1：日常对话中引用**

> 用户：最近和小明又吵架了
> AI：（读取 vibeRelationship）我记得你们的沟通方式有时会不同步。上次合盘分析建议你们在重大决策前给彼此冷静时间。这次是类似的情况吗？

**场景 2：快速回顾**

> 用户：我和小明的合盘结果是什么来着？
> AI：你们综合契合度 78%，是"灵魂伴侣"级别。最大的亮点是情感共鸣强，需要注意的是都比较敏感，要给彼此空间。

**场景 3：关系成长追踪**（后期功能）

> 用户：我觉得最近和小明相处好多了
> AI：太好了！你们上次合盘是3个月前，要不要重新分析一下，看看关系有什么变化？

---

## 6. 功能设计

### 6.1 核心功能

| 功能 | 描述 | 优先级 |
|------|------|--------|
| **多维合盘分析** | 星座 + 八字 + 荣格三维度分析 | P0 |
| **关系对象管理** | 保存常用的关系对象，一键查看 | P0 |
| **AI 综合解读** | 不只是分数，还有深度解读和建议 | P0 |
| **多关系类型** | 支持恋爱、亲子、合伙人等场景 | P0 |

### 6.2 关系类型设计

每种关系类型有不同的分析侧重点和话术风格：

| 关系类型 | 分析侧重 | 话术风格 |
|---------|---------|---------|
| 💕 **恋人** | 激情、情感、沟通、稳定性 | 浪漫、温柔 |
| 💍 **伴侣** | 稳定性、成长、默契、挑战 | 成熟、务实 |
| 👨‍👧 **亲子** | 理解、沟通、教育方式 | 温暖、引导 |
| 👫 **兄弟姐妹** | 互补、竞争、支持 | 轻松、亲切 |
| 🤝 **合伙人** | 互补、信任、决策风格 | 专业、理性 |
| 👥 **朋友** | 相容性、趣味、支持 | 轻松、有趣 |

### 6.3 分析维度说明

#### 星座合盘（西方占星）
- **看什么**：太阳、月亮、上升星座的相位关系
- **告诉用户**：你们的能量如何互动，哪里和谐哪里冲突
- **举例**：「TA 的月亮落在你的上升点，你们初见就有莫名的亲切感」

#### 八字配对（东方命理）
- **看什么**：日主生克、五行互补、十神互动
- **告诉用户**：你们在传统命理中的匹配程度
- **举例**：「你的甲木生 TA 的丙火，你是 TA 的贵人」

#### 荣格心理契合
- **看什么**：依附风格、关系模式、投射倾向
- **告诉用户**：你们在心理层面的互动模式
- **举例**：「你们的依附风格互补，可以帮助彼此成长」

---

## 7. 交互细节

### 7.1 已有关系对象时的流程

当用户说"想看合盘"且已保存过关系对象：

```
┌─────────────────────────────────────────┐
│                                         │
│   你想看和谁的合盘？                     │
│                                         │
│   ┌─────────────────────────────────┐   │
│   │ 💕 小明                         │   │
│   │    上次：3天前                   │   │
│   └─────────────────────────────────┘   │
│                                         │
│   ┌─────────────────────────────────┐   │
│   │ 👨‍👧 爸爸                         │   │
│   │    还没看过                      │   │
│   └─────────────────────────────────┘   │
│                                         │
│   ┌─────────────────────────────────┐   │
│   │ ➕ 添加新的人                    │   │
│   └─────────────────────────────────┘   │
│                                         │
└─────────────────────────────────────────┘
```

### 7.2 详情卡片交互

点击某个维度可以展开详情：

```
┌─────────────────────────────────────────┐
│                                         │
│  ♈ 星座契合详情                    关闭 │
│                                         │
├─────────────────────────────────────────┤
│                                         │
│   你                      TA            │
│  ┌─────────┐          ┌─────────┐      │
│  │ ☀️ 天蝎  │          │ ☀️ 双鱼  │      │
│  │ 🌙 狮子  │    💫    │ 🌙 天蝎  │      │
│  │ ⬆️ 处女  │          │ ⬆️ 巨蟹  │      │
│  └─────────┘          └─────────┘      │
│                                         │
│  关键相位                               │
│  ───────────────────────────────────    │
│  ☌ 你的太阳 合 TA的月亮                 │
│     「情感深度连接，能读懂彼此」          │
│                                         │
│  △ 你的金星 三合 TA的火星               │
│     「浪漫与激情的和谐流动」              │
│                                         │
│  □ 你的水星 刑 TA的水星                 │
│     「沟通方式不同，需要磨合」            │
│                                         │
│  ✨ 综合解读                            │
│  你们是典型的水象深情组合，情感细腻，      │
│  能够感知彼此的情绪波动。月亮与太阳的      │
│  连接让你们有很强的默契...               │
│                                         │
└─────────────────────────────────────────┘
```

### 7.3 分享功能

生成精美的分享图片：

```
┌─────────────────────────────────────────┐
│                                         │
│           VibeLife 合盘报告             │
│                                         │
│       ┌───┐   💕   ┌───┐              │
│       │你  │ ───── │TA │              │
│       └───┘        └───┘              │
│                                         │
│             契合度 78%                  │
│           「灵魂伴侣级别」               │
│                                         │
│      ♈ 星座 82  ☯ 八字 72  🧠 心理 80   │
│                                         │
│      ─────────────────────────         │
│                                         │
│         扫码查看完整分析                 │
│            [二维码]                     │
│                                         │
└─────────────────────────────────────────┘
```

---

## 8. 边界情况处理

### 8.1 信息不完整

| 情况 | 处理方式 |
|------|---------|
| 不知道对方出生时间 | 默认使用正午，说明"更精确的时间可以提升准确度" |
| 不知道对方出生地点 | 允许只填省/城市，或"不确定" |
| 只知道年份 | 不支持，提示"至少需要知道月份和日期" |

### 8.2 结果解读

| 分数区间 | 表达方式 | 基调 |
|---------|---------|------|
| 85-100 | 「天作之合」 | 欣喜但不夸张 |
| 70-84 | 「默契组合」 | 积极正向 |
| 55-69 | 「需要磨合」 | 中性客观 |
| 40-54 | 「互补成长」 | 聚焦成长机会 |
| < 40 | 「挑战较多」 | 坦诚但不悲观 |

**设计原则**：
- 永远不说"不合适"、"分手吧"这样绝对化的话
- 低分也要给出正面的解读角度
- 重点放在"如何相处"而不是"该不该在一起"

---

## 9. 成功指标

### 9.1 核心指标

| 指标 | 目标 | 说明 |
|------|------|------|
| **合盘完成率** | > 80% | 开始合盘 → 看到结果 |
| **关系对象保存率** | > 50% | 看完结果后选择保存 |
| **详情展开率** | > 60% | 点击查看各维度详情 |
| **回访率** | > 30% | 7 天内再次使用合盘 |

### 9.2 用户反馈目标

- 「准确度」评分 > 4.0 / 5.0
- 「建议有用」评分 > 4.0 / 5.0
- NPS > 40

---

## 10. 实现优先级

### Phase 1: MVP - 已完成 (2026-01-22)

- [x] 星座合盘（真实相位计算，调用 zodiac.calculate_synastry）
- [x] 收集对方信息表单 (CollectSynastryInfoCard)
- [x] 关系对象选择 (SelectRelationshipCard)
- [x] 合盘总览卡片 (SynastryOverviewCard)
- [x] 星座详情展开 (ZodiacSynastryDetailCard)
- [x] 等待动画 (SynastryCalculatingCard)
- [x] vibeRelationship 数据存储（在 vibe.relationship.relationships 中）
- [x] 保存合盘洞察到关系对象

**实现文件**：
- 后端：`apps/api/skills/synastry/` (handlers.py, synastry_engine.py)
- 前端：`apps/web/src/skills/synastry/cards/`
- 数据层：`apps/api/stores/unified_profile_repo.py` (vibeRelationship API)
- 规格：`docs/components/VibeProfile/SPEC.md` (vibe.relationship 结构)

### Phase 2: 完善

- [ ] 八字合婚分析
- [ ] 多关系类型差异化话术
- [ ] 分享功能

### Phase 3: 增强

- [ ] 荣格心理契合分析
- [ ] 关系对象管理（编辑、删除）
- [ ] 邀请对方注册功能

---

## 11. 开放问题

1. **分数展示方式**：用数字（78%）还是等级（灵魂伴侣）还是两者结合？
2. **低分情况处理**：如果分数很低，如何措辞既诚实又不伤害用户？
3. **农历需求**：八字计算需要农历，是否在表单中支持农历输入？
4. **隐私顾虑**：保存他人信息是否需要特别的隐私提示？
