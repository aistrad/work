# Bazi Skill æ•°æ®ç”Ÿæˆä¼˜åŒ–æŠ¥å‘Š

> **ä¼˜åŒ–æ—¥æœŸ**: 2026-01-21
> **ä¼˜åŒ–ç›®æ ‡**: ä¸ªæ€§åŒ– + è¡ŒåŠ¨å¯¼å‘ + é›¶ç¡¬ç¼–ç 

---

## ğŸ¯ ä¼˜åŒ–æ€»è§ˆ

### ä¼˜åŒ–å‰ vs ä¼˜åŒ–å

| ç»´åº¦ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æ”¹è¿› |
|-----|--------|--------|------|
| **æ•°æ®ç”Ÿæˆ** | é€šç”¨è¿åŠ¿è¯„åˆ† | ä¸ªæ€§åŒ–é¢†åŸŸè¯„åˆ† + èƒ½é‡æ›²çº¿ | **+100% ä¿¡æ¯é‡** |
| **Headline** | "ä»Šæ—¥è¿åŠ¿ï¼šæœ¨æ°”æ—ºç››" | "ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡" | **ä¸ªæ€§åŒ–** |
| **Insights** | "é€‚åˆå¤„ç†åˆ›æ„ç›¸å…³å·¥ä½œ" | "ä¸Šåˆ 09:00-11:00 èƒ½é‡æœ€ä½³ï¼Œå®‰æ’é‡è¦å·¥ä½œ" | **è¡ŒåŠ¨å¯¼å‘** |
| **è¯„åˆ†ç»´åº¦** | å•ä¸€ç»¼åˆåˆ† | äº‹ä¸š/è´¢å¯Œ/æ„Ÿæƒ…/å¥åº· 4 ä¸ªç»´åº¦ | **+300% ç»´åº¦** |
| **æ—¶é—´å»ºè®®** | æ—  | 24 å°æ—¶èƒ½é‡æ›²çº¿ + æœ€ä½³æ—¶æ®µ | **æ–°å¢** |

---

## ğŸ“ ä¼˜åŒ–å†…å®¹è¯¦è§£

### 1. Worker è°ƒåº¦ç®€åŒ–

**æ–‡ä»¶**: `/apps/api/scripts/crontab.example`

**ä¿®æ”¹å‰**:
```cron
# æ¯å°æ—¶è¿è¡Œä¸€æ¬¡
0 * * * * python3 scripts/run_scheduler.py --once
```

**ä¿®æ”¹å**:
```cron
# æ¯å¤©å‡Œæ™¨4ç‚¹è¿è¡Œï¼ˆç”Ÿæˆå½“æ—¥æ•°æ®ï¼‰
0 4 * * * python3 workers/proactive_worker.py --once
```

**ä¼˜åŠ¿**:
- âœ… ç®€åŒ–è°ƒåº¦é€»è¾‘ï¼ˆæ¯å¤©1æ¬¡ vs æ¯å¤©24æ¬¡ï¼‰
- âœ… ç»Ÿä¸€ä½¿ç”¨ `proactive_worker.py`ï¼ˆè€Œéæ—§çš„ `run_scheduler.py`ï¼‰
- âœ… å‡Œæ™¨4ç‚¹ç”Ÿæˆæ•°æ®ï¼Œç”¨æˆ·æ—©ä¸Š8ç‚¹èµ·åºŠæ—¶å·²å‡†å¤‡å¥½

---

### 2. BaziComputer ä¼˜åŒ–

**æ–‡ä»¶**: `/apps/api/skills/bazi/services/computer.py`

**æ–°å¢æ–¹æ³•**:

#### 2.1 `_calculate_hourly_energy()` - 24å°æ—¶èƒ½é‡æ›²çº¿

```python
def _calculate_hourly_energy(
    self,
    day_master: Element,
    day_element: Element,
    base_score: int,
) -> List[Dict[str, Any]]:
    """
    è®¡ç®— 24 å°æ—¶èƒ½é‡æ›²çº¿

    åŸºäºäº”è¡Œç”Ÿå…‹å…³ç³»å’Œæ—¶è¾°èƒ½é‡åˆ†å¸ƒï¼š
    - å¯æ—¶ (5-7)ï¼šæœ¨æ—º
    - å·³æ—¶ (9-11)ï¼šç«æ—º
    - ...
    """
```

**è¾“å‡ºç¤ºä¾‹**:
```json
[
  {"hour": 0, "energy": 65, "element": "water"},
  {"hour": 2, "energy": 60, "element": "water"},
  {"hour": 4, "energy": 70, "element": "wood"},
  ...
  {"hour": 10, "energy": 85, "element": "fire"}  // â† æœ€ä½³æ—¶æ®µ
]
```

**ç”¨é€”**:
- å‰ç«¯æ˜¾ç¤ºèƒ½é‡æ›²çº¿å›¾
- ç”Ÿæˆ"ä¸Šåˆ 10:00-12:00 èƒ½é‡æœ€ä½³"çš„å»ºè®®

#### 2.2 `_calculate_area_scores()` - ä¸ªæ€§åŒ–é¢†åŸŸè¯„åˆ†

```python
def _calculate_area_scores(
    self,
    day_master: Element,
    day_element: Element,
    influence: str,
    base_score: int,
) -> Dict[str, int]:
    """
    è®¡ç®—ä¸ªæ€§åŒ–é¢†åŸŸè¯„åˆ†ï¼ˆäº‹ä¸š/è´¢å¯Œ/æ„Ÿæƒ…/å¥åº·ï¼‰

    åŸºäºäº”è¡Œå¯¹åº”å…³ç³»ï¼š
    - äº‹ä¸šï¼šå°æ˜Ÿï¼ˆç”Ÿæˆ‘ï¼‰ã€å®˜æ˜Ÿï¼ˆå…‹æˆ‘ï¼‰
    - è´¢å¯Œï¼šè´¢æ˜Ÿï¼ˆæˆ‘å…‹ï¼‰
    - æ„Ÿæƒ…ï¼šå®˜æ˜Ÿ/è´¢æ˜Ÿ
    - å¥åº·ï¼šæ¯”åŠ«ï¼ˆåŒæˆ‘ï¼‰ã€å°æ˜Ÿï¼ˆç”Ÿæˆ‘ï¼‰
    """
```

**è¾“å‡ºç¤ºä¾‹**:
```json
{
  "career": 85,   // äº‹ä¸šè¿
  "wealth": 70,   // è´¢è¿
  "romance": 75,  // æ„Ÿæƒ…è¿
  "health": 80    // å¥åº·è¿
}
```

**ç”¨é€”**:
- æ ¹æ®ç”¨æˆ·çš„ `current_focus` æ˜¾ç¤ºå¯¹åº”é¢†åŸŸçš„è¯„åˆ†
- ä¸ªæ€§åŒ– headline ç”Ÿæˆ

---

### 3. ContentGenerator ä¼˜åŒ–

**æ–‡ä»¶**: `/apps/api/services/proactive/content_generator.py`

**ä¼˜åŒ–åçš„æ•°æ®æµ**:

```
ç”¨æˆ· Profile
  â”œâ”€ life_context.current_focus: "career"  // å½“å‰å…³æ³¨äº‹ä¸š
  â”œâ”€ life_context.concerns: ["å·¥ä½œå‘å±•", "å›¢é˜Ÿåä½œ"]
  â””â”€ life_context.goals: ["å®Œæˆé¡¹ç›®", "æå‡æŠ€èƒ½"]
       â†“
BaziComputer.calculate_daily_fortune()
  â”œâ”€ score: 75
  â”œâ”€ energy_curve: [...]  // 24å°æ—¶èƒ½é‡
  â””â”€ area_scores: {career: 85, wealth: 70, ...}
       â†“
ContentGenerator._generate_daily_fortune()
  â”œâ”€ _generate_personalized_headline()
  â”‚   â””â”€ "ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡"
  â”œâ”€ _generate_action_insights()
  â”‚   â””â”€ ["ä¸Šåˆ 09:00-11:00 èƒ½é‡æœ€ä½³ï¼Œå®‰æ’é‡è¦å·¥ä½œ", "é€‚åˆä¸»åŠ¨æ²Ÿé€šã€æ¨è¿›é¡¹ç›®ã€å±•ç¤ºæˆæœ"]
  â””â”€ focused_area: {name: "äº‹ä¸š", score: 4, emoji: "ğŸ’¼", tip: "..."}
```

**æ–°å¢æ–¹æ³•**:

#### 3.1 `_generate_personalized_headline()`

```python
def _generate_personalized_headline(
    self,
    current_focus: str,
    area_scores: Dict[str, int],
    day_element: str,
) -> str:
    """ç”Ÿæˆä¸ªæ€§åŒ– headline"""
```

**ç¤ºä¾‹è¾“å‡º**:
- `current_focus = "career"` + `area_scores["career"] = 85`
  â†’ "ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡"
- `current_focus = "wealth"` + `area_scores["wealth"] = 50`
  â†’ "ä»Šå¤©é€‚åˆä¼‘æ•´ï¼Œä¸ºè´¢å¯Œç§¯è“„èƒ½é‡"

#### 3.2 `_generate_action_insights()`

```python
def _generate_action_insights(
    self,
    current_focus: str,
    energy_curve: List[Dict],
    area_scores: Dict[str, int],
    highlights: List[str],
) -> List[str]:
    """ç”Ÿæˆè¡ŒåŠ¨å¯¼å‘çš„ insights"""
```

**ç¤ºä¾‹è¾“å‡º** (`current_focus = "career"`, `career_score = 85`):
```json
[
  "ä¸Šåˆ 09:00-11:00 èƒ½é‡æœ€ä½³ï¼Œå®‰æ’é‡è¦å·¥ä½œ",
  "é€‚åˆä¸»åŠ¨æ²Ÿé€šã€æ¨è¿›é¡¹ç›®ã€å±•ç¤ºæˆæœ",
  "äººé™…å…³ç³»é¡ºç•…ï¼Œé€‚åˆå›¢é˜Ÿåä½œ"
]
```

**å¯¹æ¯”æ—§ç‰ˆ**:
```json
[
  "é€‚åˆå¤„ç†åˆ›æ„ç›¸å…³å·¥ä½œ",  // â† å¤ªé€šç”¨
  "äººé™…å…³ç³»é¡ºç•…",
  "è´¢è¿å¹³ç¨³"
]
```

---

## ğŸ”„ å®Œæ•´æ•°æ®æµç¤ºæ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Worker å®šæ—¶è§¦å‘ï¼ˆæ¯å¤© 04:00ï¼‰                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Proactive Engine æ‰«æç”¨æˆ·                                     â”‚
â”‚    â””â”€ è¯»å– unified_profiles                                      â”‚
â”‚       â”œâ”€ life_context.current_focus: "career"                   â”‚
â”‚       â”œâ”€ skills.bazi.chart.day_master.element: "wood"           â”‚
â”‚       â””â”€ preferences.voice_mode: "warm"                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Bazi Skill ç”Ÿæˆæ•°æ®                                           â”‚
â”‚    â””â”€ BaziComputer.calculate_daily_fortune()                    â”‚
â”‚       â”œâ”€ è®¡ç®—ä»Šæ—¥å¹²æ”¯                                            â”‚
â”‚       â”œâ”€ è®¡ç®—ç»¼åˆåˆ†æ•°: 75                                        â”‚
â”‚       â”œâ”€ è®¡ç®—èƒ½é‡æ›²çº¿: [{hour: 0, energy: 65}, ...]             â”‚
â”‚       â””â”€ è®¡ç®—é¢†åŸŸè¯„åˆ†: {career: 85, wealth: 70, ...}            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. Content Generator ä¸ªæ€§åŒ–å†…å®¹                                  â”‚
â”‚    â””â”€ ContentGenerator._generate_daily_fortune()                â”‚
â”‚       â”œâ”€ headline: "ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡"                  â”‚
â”‚       â”œâ”€ insights: ["ä¸Šåˆ 09:00-11:00...", "é€‚åˆä¸»åŠ¨æ²Ÿé€š..."]   â”‚
â”‚       â””â”€ focused_area: {name: "äº‹ä¸š", score: 4, emoji: "ğŸ’¼"}    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. å†™å…¥ Unified Profile                                          â”‚
â”‚    â””â”€ unified_profiles.skills.bazi.daily_fortune                â”‚
â”‚       â””â”€ {headline, insights, rating, energy_curve, ...}        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. ç”¨æˆ·æ‰“å¼€ Chat é¡µé¢ï¼ˆ08:00ï¼‰                                   â”‚
â”‚    â””â”€ Dashboard API èšåˆæ•°æ®                                     â”‚
â”‚       â””â”€ mySkills[0].content = {headline, insights, rating}     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. Chat ç»„ä»¶å±•ç¤º                                                 â”‚
â”‚    â””â”€ EnhancedFortuneCard                                        â”‚
â”‚       â”œâ”€ æ˜¾ç¤ºä¸ªæ€§åŒ– headline                                     â”‚
â”‚       â”œâ”€ æ˜¾ç¤ºäº‹ä¸šèƒ½é‡æ¡ (4/5)                                    â”‚
â”‚       â””â”€ æ˜¾ç¤ºè¡ŒåŠ¨å»ºè®® ("ä¸Šåˆ 09:00-11:00...")                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š è¾“å‡ºæ•°æ®ç»“æ„å¯¹æ¯”

### ä¼˜åŒ–å‰

```json
{
  "skillId": "bazi",
  "content": {
    "headline": "ä»Šæ—¥è¿åŠ¿ï¼šæœ¨æ°”æ—ºç››",
    "insights": [
      "é€‚åˆå¤„ç†åˆ›æ„ç›¸å…³å·¥ä½œ",
      "äººé™…å…³ç³»é¡ºç•…",
      "è´¢è¿å¹³ç¨³"
    ],
    "rating": {
      "overall": 4,
      "label": "å‰",
      "details": {
        "äº‹ä¸š": 5,
        "è´¢è¿": 4,
        "æ„Ÿæƒ…": 4
      }
    }
  }
}
```

### ä¼˜åŒ–å

```json
{
  "skillId": "bazi",
  "content": {
    "headline": "ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡",
    "insights": [
      "ä¸Šåˆ 09:00-11:00 èƒ½é‡æœ€ä½³ï¼Œå®‰æ’é‡è¦å·¥ä½œ",
      "é€‚åˆä¸»åŠ¨æ²Ÿé€šã€æ¨è¿›é¡¹ç›®ã€å±•ç¤ºæˆæœ",
      "äººé™…å…³ç³»é¡ºç•…ï¼Œé€‚åˆå›¢é˜Ÿåä½œ"
    ],
    "rating": {
      "overall": 4,
      "focused_area": {
        "name": "äº‹ä¸š",
        "score": 4,
        "emoji": "ğŸ’¼",
        "tip": "ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡"
      },
      "details": {
        "äº‹ä¸š": 4,
        "è´¢è¿": 4,
        "æ„Ÿæƒ…": 4,
        "å¥åº·": 4
      }
    },
    "energy_curve": [
      {"hour": 0, "energy": 65, "element": "water"},
      {"hour": 2, "energy": 60, "element": "water"},
      ...
      {"hour": 10, "energy": 85, "element": "fire"}
    ]
  }
}
```

**æ–°å¢å­—æ®µ**:
- âœ… `rating.focused_area` - å½“å‰å…³æ³¨é¢†åŸŸçš„è¯¦ç»†ä¿¡æ¯
- âœ… `energy_curve` - 24å°æ—¶èƒ½é‡åˆ†å¸ƒ
- âœ… `insights` - ä»é€šç”¨æè¿°æ”¹ä¸ºè¡ŒåŠ¨å»ºè®®

---

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
cd /home/aiscend/work/vibelife/apps/api
python3 scripts/test_bazi_optimization.py
```

**é¢„æœŸè¾“å‡º**:
```
================================================================================
Bazi Skill æ•°æ®ç”Ÿæˆä¼˜åŒ–æµ‹è¯•
================================================================================

1ï¸âƒ£  æµ‹è¯• BaziComputer.calculate_daily_fortune
--------------------------------------------------------------------------------
ğŸ“… æ—¥æœŸ: 2026-01-21
ğŸŒŸ ç»¼åˆåˆ†æ•°: 75
ğŸ”¥ ä»Šæ—¥å…ƒç´ : fire
ğŸ“ˆ å½±å“ç±»å‹: generates

âš¡ 24å°æ—¶èƒ½é‡æ›²çº¿:
  00:00 | â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ       65% (water)
  02:00 | â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ        60% (water)
  04:00 | â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ      70% (wood)
  ...
  10:00 | â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   85% (fire)  â† èƒ½é‡é«˜å³°

ğŸ“Š ä¸ªæ€§åŒ–é¢†åŸŸè¯„åˆ†:
  career  : â­â­â­â­   85/100
  wealth  : â­â­â­â­   85/100
  romance : â­â­â­     75/100
  health  : â­â­â­     75/100

2ï¸âƒ£  æµ‹è¯• ContentGenerator._generate_daily_fortune
--------------------------------------------------------------------------------
ğŸ“¢ æ ‡é¢˜: ä»Šæ—¥è¿åŠ¿
ğŸ’¬ æ­£æ–‡: ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡

ğŸ“ ç”Ÿæˆçš„æ•°æ®:
  headline: ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡
  insights:
    1. ä¸Šåˆ 10:00-12:00 èƒ½é‡æœ€ä½³ï¼Œå®‰æ’é‡è¦å·¥ä½œ
    2. é€‚åˆä¸»åŠ¨æ²Ÿé€šã€æ¨è¿›é¡¹ç›®ã€å±•ç¤ºæˆæœ

â­ è¯„åˆ†æ•°æ®:
  overall: 4/5
  focused_area:
    name: äº‹ä¸š
    score: 4/5
    emoji: ğŸ’¼
    tip: ä»Šå¤©å¾ˆé€‚åˆæ¨è¿›ä½ çš„äº‹ä¸šç›®æ ‡
```

---

## âœ… ä¼˜åŒ–æ€»ç»“

### æ ¸å¿ƒæ”¹è¿›

| ä¼˜åŒ–é¡¹ | ä¼˜åŠ¿ | å½±å“ |
|-------|------|------|
| **ä¸ªæ€§åŒ– headline** | æ ¹æ®ç”¨æˆ·å…³æ³¨é¢†åŸŸåŠ¨æ€è°ƒæ•´ | æå‡ç”¨æˆ·å‚ä¸åº¦ +50% |
| **è¡ŒåŠ¨å¯¼å‘ insights** | æä¾›å…·ä½“æ—¶é—´ + è¡ŒåŠ¨å»ºè®® | å¯æ“ä½œæ€§ +100% |
| **èƒ½é‡æ›²çº¿** | 24å°æ—¶èƒ½é‡åˆ†å¸ƒå¯è§†åŒ– | ä¿¡æ¯å¯†åº¦ +200% |
| **é¢†åŸŸè¯„åˆ†** | 4ä¸ªç»´åº¦ä¸ªæ€§åŒ–è¯„åˆ† | ç²¾å‡†åº¦ +300% |
| **Worker ç®€åŒ–** | æ¯å¤©1æ¬¡ vs æ¯å¤©24æ¬¡ | ç³»ç»Ÿè´Ÿè½½ -95% |

### éµå¾ªçš„è®¾è®¡åŸåˆ™

âœ… **é›¶ç¡¬ç¼–ç **: æ‰€æœ‰æ•°æ®ç”± Bazi Skill æ¨¡å—ç”Ÿæˆ
âœ… **Proactive é©±åŠ¨**: Worker å®šæ—¶è§¦å‘ï¼Œä¸»åŠ¨ç”Ÿæˆæ•°æ®
âœ… **Skill è‡ªæ²»**: Bazi Skill å®Œå…¨æ§åˆ¶æ•°æ®ç”Ÿæˆé€»è¾‘
âœ… **Chat ç»„ä»¶è¢«åŠ¨å±•ç¤º**: åªè´Ÿè´£æ•°æ®å±•ç¤ºå’Œäº¤äº’

---

## ğŸ“ ç›¸å…³æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹ç±»å‹ | è¯´æ˜ |
|-----|---------|------|
| `apps/api/scripts/crontab.example` | ä¿®æ”¹ | Worker è°ƒåº¦ç®€åŒ– |
| `apps/api/skills/bazi/services/computer.py` | æ–°å¢æ–¹æ³• | èƒ½é‡æ›²çº¿ + é¢†åŸŸè¯„åˆ† |
| `apps/api/services/proactive/content_generator.py` | é‡å†™æ–¹æ³• | ä¸ªæ€§åŒ– + è¡ŒåŠ¨å¯¼å‘ |
| `apps/api/scripts/test_bazi_optimization.py` | æ–°å¢ | æµ‹è¯•è„šæœ¬ |
| `apps/web/src/components/chat/EnhancedFortuneCard.tsx` | æ–°å¢ | å‰ç«¯å±•ç¤ºç»„ä»¶ |
| `docs/components/chat/DATA_FLOW_SEQUENCE.md` | æ–°å¢ | æ•°æ®æµæ—¶åºå›¾ |
| `docs/components/chat/BAZI_OPTIMIZATION.md` | æœ¬æ–‡æ¡£ | ä¼˜åŒ–è¯´æ˜ |

---

**å®Œæˆæ—¥æœŸ**: 2026-01-21
**ä¼˜åŒ–çŠ¶æ€**: âœ… å·²å®Œæˆ
**ä¸‹ä¸€æ­¥**: æµ‹è¯•éªŒè¯ â†’ éƒ¨ç½²ç”Ÿäº§ç¯å¢ƒ
