# Skill Management System Specification

> Version: 1.0 | 2026-01-19
> è®¾è®¡ç›®æ ‡ï¼šè®©ç”¨æˆ·å‘ç°ã€è®¢é˜…ã€ç®¡ç† Skillï¼Œä¸ä¸»åŠ¨æ¨¡å—æ·±åº¦é›†æˆ

---

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 è®¾è®¡åŸåˆ™

| åŸåˆ™ | è¯´æ˜ |
|------|------|
| **å‘ç°ä¼˜å…ˆ** | å¤šå…¥å£æ›å…‰ï¼Œè®©ç”¨æˆ·è‡ªç„¶å‘ç°æ–° Skill |
| **ç®€å•ç®¡ç†** | Skill çº§åˆ«è®¢é˜…ï¼Œä¸€é”®å¼€å…³æ¨é€ |
| **æ™ºèƒ½æ¨è** | åŸºäºå¯¹è¯å†…å®¹å’Œç”¨æˆ·æ¡£æ¡ˆä¸»åŠ¨æ¨è |
| **æ¸è¿›å¼å¼•å¯¼** | ä»å…è´¹ä½“éªŒåˆ°ä»˜è´¹è½¬åŒ–çš„è‡ªç„¶è·¯å¾„ |

### 1.2 Skill åˆ†ç±»

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Skill åˆ†ç±»ä½“ç³»                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Core Layer (å§‹ç»ˆæ¿€æ´»ï¼Œä¸å¯å–æ¶ˆ)                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚    â”‚
â”‚  â”‚  â”‚  core   â”‚  ç”Ÿå‘½å¯¹è¯è€… - AI çš„çµé­‚                 â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                  â”‚
â”‚                           â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Default Layer (é»˜è®¤æ¿€æ´»ï¼Œå…è´¹ï¼Œå¯å–æ¶ˆ)               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚    â”‚
â”‚  â”‚  â”‚ mindfulness â”‚  â”‚  lifecoach  â”‚                   â”‚    â”‚
â”‚  â”‚  â”‚  æ­£å¿µå¯¼å¸ˆ    â”‚  â”‚  äººç”Ÿæ•™ç»ƒ    â”‚                   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                           â”‚                                  â”‚
â”‚                           â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Professional Layer (éœ€è®¢é˜…ï¼Œä»˜è´¹)                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ bazi â”‚ â”‚ zodiac â”‚ â”‚ tarot â”‚ â”‚jungastroâ”‚ â”‚careerâ”‚  â”‚    â”‚
â”‚  â”‚  â”‚ å…«å­— â”‚ â”‚ æ˜Ÿåº§   â”‚ â”‚ å¡”ç½—  â”‚ â”‚è£æ ¼å æ˜Ÿ â”‚ â”‚ èŒä¸š â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 Skill çŠ¶æ€æœº

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
         â”‚   not_subscribed    â”‚       â”‚
         â”‚   (æœªè®¢é˜…/å·²å–æ¶ˆ)    â”‚       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
                    â”‚                  â”‚
                    â”‚ subscribe()      â”‚ unsubscribe()
                    â”‚                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
         â”‚     subscribed      â”‚â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚      (å·²è®¢é˜…)        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ push_enabled  â”‚ â—„â”€â”€â”€â–º â”‚ push_disabled â”‚
â”‚  (æ¨é€å¼€å¯)    â”‚       â”‚  (æ¨é€å…³é—­)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ•°æ®æ¨¡å‹

### 2.1 Skill å…ƒæ•°æ® (skill_metadata)

å­˜å‚¨åœ¨ SKILL.md çš„ YAML frontmatter ä¸­ï¼š

```yaml
---
id: bazi
name: å…«å­—å‘½ç†
version: 3.0.0
description: èæ±‡ã€Šæ»´å¤©é«“ã€‹ã€Šç©·é€šå®é‰´ã€‹ã€Šå­å¹³çœŸè¯ ã€‹ç­‰ç»å…¸çš„å…«å­—å‘½ç†å¤§å¸ˆ
icon: "ğŸ”®"
color: "#D4A574"
category: professional  # core | default | professional
pricing:
  type: premium  # free | premium | credits
  trial_messages: 3  # å…è´¹è¯•ç”¨æ¶ˆæ¯æ•°
triggers:
  - å…«å­—
  - å‘½ç†
  - ç”Ÿè¾°
  - æµ‹ç®—
requires_birth_info: true
requires_compute: true
features:
  - name: å‘½ç›˜è§£è¯»
    description: å››æŸ±å…«å­—å®Œæ•´åˆ†æ
  - name: å¤§è¿æµå¹´
    description: åå¹´å¤§è¿å‘¨æœŸåˆ†æ
  - name: æ¯æ—¥è¿åŠ¿
    description: åŸºäºæµæ—¥çš„æ¯æ—¥æŒ‡å¼•
showcase:
  tagline: "æ´å¯Ÿå‘½è¿ç„æœºï¼ŒæŠŠæ¡äººç”Ÿæ–¹å‘"
  highlights:
    - "èæ±‡å››å¤§ç»å…¸"
    - "ä¸ªæ€§åŒ–è§£è¯»"
    - "è¿åŠ¿è¶‹åŠ¿åˆ†æ"
  preview_image: /skills/bazi/preview.png
---
```

### 2.2 ç”¨æˆ· Skill è®¢é˜… (user_skill_subscriptions)

```sql
CREATE TABLE user_skill_subscriptions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES vibe_users(id),
  skill_id VARCHAR(50) NOT NULL,
  status VARCHAR(20) NOT NULL DEFAULT 'subscribed',  -- subscribed | unsubscribed
  push_enabled BOOLEAN DEFAULT true,
  subscribed_at TIMESTAMPTZ DEFAULT now(),
  unsubscribed_at TIMESTAMPTZ,
  trial_messages_used INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(user_id, skill_id)
);

-- ç´¢å¼•
CREATE INDEX idx_user_skill_subs_user ON user_skill_subscriptions(user_id);
CREATE INDEX idx_user_skill_subs_status ON user_skill_subscriptions(status);
```

### 2.3 Skill ä½¿ç”¨è®°å½• (skill_usage_log)

```sql
CREATE TABLE skill_usage_log (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES vibe_users(id),
  skill_id VARCHAR(50) NOT NULL,
  action VARCHAR(50) NOT NULL,  -- chat | tool_call | view_card | subscribe | unsubscribe
  metadata JSONB DEFAULT '{}',
  created_at TIMESTAMPTZ DEFAULT now()
);

-- ç”¨äºæ¨èç®—æ³•
CREATE INDEX idx_skill_usage_user_time ON skill_usage_log(user_id, created_at DESC);
```

---

## 3. API è®¾è®¡

### 3.1 Skill Gateway æ‰©å±•

```
routes/skills.py æ‰©å±•:

GET  /api/v1/skills                       # è·å–æ‰€æœ‰ Skill åˆ—è¡¨
GET  /api/v1/skills/{skill_id}            # è·å–å•ä¸ª Skill è¯¦æƒ…
GET  /api/v1/skills/{skill_id}/services   # è·å– Skill æœåŠ¡åˆ—è¡¨
POST /api/v1/skills/{skill_id}/{action}   # æ‰§è¡Œ Skill æœåŠ¡

# æ–°å¢ - Skill è®¢é˜…ç®¡ç†
GET  /api/v1/skills/subscriptions         # è·å–ç”¨æˆ·çš„è®¢é˜…åˆ—è¡¨
POST /api/v1/skills/{skill_id}/subscribe  # è®¢é˜… Skill
POST /api/v1/skills/{skill_id}/unsubscribe # å–æ¶ˆè®¢é˜… Skill
POST /api/v1/skills/{skill_id}/push       # åˆ‡æ¢æ¨é€å¼€å…³

# æ–°å¢ - Skill æ¨è
GET  /api/v1/skills/recommendations       # è·å–æ¨è Skill
GET  /api/v1/skills/featured              # è·å–ç²¾é€‰ Skill
```

### 3.2 API å“åº”æ ¼å¼

#### GET /api/v1/skills

```json
{
  "skills": [
    {
      "id": "bazi",
      "name": "å…«å­—å‘½ç†",
      "description": "èæ±‡å››å¤§ç»å…¸çš„å…«å­—å‘½ç†å¤§å¸ˆ",
      "icon": "ğŸ”®",
      "color": "#D4A574",
      "category": "professional",
      "pricing": {
        "type": "premium",
        "trial_messages": 3
      },
      "showcase": {
        "tagline": "æ´å¯Ÿå‘½è¿ç„æœºï¼ŒæŠŠæ¡äººç”Ÿæ–¹å‘",
        "highlights": ["èæ±‡å››å¤§ç»å…¸", "ä¸ªæ€§åŒ–è§£è¯»", "è¿åŠ¿è¶‹åŠ¿åˆ†æ"]
      },
      "user_status": {
        "subscribed": true,
        "push_enabled": true,
        "trial_messages_used": 0
      }
    }
  ],
  "categories": {
    "core": { "name": "æ ¸å¿ƒèƒ½åŠ›", "count": 1 },
    "default": { "name": "åŸºç¡€åŠŸèƒ½", "count": 2 },
    "professional": { "name": "ä¸“ä¸šæŠ€èƒ½", "count": 5 }
  }
}
```

#### GET /api/v1/skills/recommendations

```json
{
  "recommendations": [
    {
      "skill_id": "zodiac",
      "reason": "based_on_conversation",
      "context": "ä½ æœ€è¿‘èŠåˆ°äº†äººé™…å…³ç³»ï¼Œæ˜Ÿåº§åˆ†æå¯ä»¥å¸®ä½ ç†è§£å…³ç³»åŠ¨åŠ›",
      "score": 0.85
    },
    {
      "skill_id": "mindfulness",
      "reason": "based_on_emotion",
      "context": "æ„ŸçŸ¥åˆ°ä½ å¯èƒ½æœ‰äº›ç„¦è™‘ï¼Œæ­£å¿µç»ƒä¹ å¯ä»¥å¸®åŠ©æ”¾æ¾",
      "score": 0.72
    }
  ]
}
```

---

## 4. å‘ç°å…¥å£è®¾è®¡

### 4.1 å…¥å£çŸ©é˜µ

| å…¥å£ | ä½ç½® | è§¦å‘æ—¶æœº | å±•ç¤ºå½¢å¼ | ä¼˜å…ˆçº§ |
|------|------|----------|----------|--------|
| Skill å¸‚åœº | ç‹¬ç«‹é¡µé¢ /skills | ç”¨æˆ·ä¸»åŠ¨è®¿é—® | å®Œæ•´åˆ—è¡¨+åˆ†ç±» | HIGH |
| å¯¹è¯æ¨è | å¯¹è¯æµä¸­ | AI æ£€æµ‹åˆ°ç›¸å…³æ„å›¾ | å†…åµŒå¡ç‰‡ | HIGH |
| è®¾ç½®ç®¡ç† | è®¾ç½® > Skill ç®¡ç† | ç”¨æˆ·ç®¡ç†è®¢é˜… | å¼€å…³åˆ—è¡¨ | MEDIUM |
| é¦–é¡µå¡ç‰‡ | ä¸»é¡µä¾§è¾¹æ  | æ¯æ¬¡è¿›å…¥é¦–é¡µ | æ¨èå¡ç‰‡ | MEDIUM |

### 4.2 Skill å¸‚åœºé¡µé¢ (/skills)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è¿”å›                    æ¢ç´¢ Skill                    ğŸ”     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸŒŸ ç²¾é€‰æ¨è                                              â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚ â”‚ ğŸ”®           â”‚  â”‚ â­           â”‚  â”‚ ğŸ´           â”‚    â”‚    â”‚
â”‚  â”‚ â”‚ å…«å­—å‘½ç†     â”‚  â”‚ è¥¿æ–¹å æ˜Ÿ     â”‚  â”‚ å¡”ç½—å åœ     â”‚    â”‚    â”‚
â”‚  â”‚ â”‚ æ´å¯Ÿå‘½è¿ç„æœº â”‚  â”‚ æ˜Ÿç›˜è§£è¯»     â”‚  â”‚ ç…§è§å†…å¿ƒ     â”‚    â”‚    â”‚
â”‚  â”‚ â”‚ [å·²è®¢é˜… âœ“]   â”‚  â”‚ [ç«‹å³è¯•ç”¨]   â”‚  â”‚ [äº†è§£æ›´å¤š]   â”‚    â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                  â”‚
â”‚  ğŸ“š åˆ†ç±»æµè§ˆ                                                     â”‚
â”‚                                                                  â”‚
â”‚  [å…¨éƒ¨] [å‘½ç†å åœ] [å¿ƒç†æˆé•¿] [ç”Ÿæ´»æ–¹å¼]                          â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ”® å…«å­—å‘½ç†                                    [å·²è®¢é˜…]  â”‚    â”‚
â”‚  â”‚ èæ±‡ã€Šæ»´å¤©é«“ã€‹ã€Šç©·é€šå®é‰´ã€‹ç­‰ç»å…¸                          â”‚    â”‚
â”‚  â”‚ â˜…â˜…â˜…â˜…â˜… Â· å‘½ç›˜è§£è¯» Â· å¤§è¿æµå¹´ Â· æ¯æ—¥è¿åŠ¿                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ â­ è¥¿æ–¹å æ˜Ÿ                                    [è®¢é˜…]    â”‚    â”‚
â”‚  â”‚ å¿ƒç†å æ˜Ÿåˆ†æï¼Œæ­ç¤ºå†…åœ¨æ„å›¾                                â”‚    â”‚
â”‚  â”‚ â˜…â˜…â˜…â˜…â˜† Â· æ˜Ÿç›˜è§£è¯» Â· è¡Œè¿åˆ†æ Â· åˆç›˜é…å¯¹                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ§˜ æ­£å¿µå¯¼å¸ˆ                        [é»˜è®¤] [æ¨é€å¼€å¯ â—]   â”‚    â”‚
â”‚  â”‚ 3åˆ†é’Ÿå†…è®©ä½ å¹³é™ä¸‹æ¥                                       â”‚    â”‚
â”‚  â”‚ â˜…â˜…â˜…â˜…â˜… Â· å‘¼å¸ç»ƒä¹  Â· æƒ…ç»ªæ€¥æ•‘ Â· ç¡å‰æ”¾æ¾                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 å¯¹è¯ä¸­æ™ºèƒ½æ¨è

**è§¦å‘æ¡ä»¶**ï¼š
1. ç”¨æˆ·æåˆ°æœªè®¢é˜… Skill çš„è§¦å‘è¯
2. æƒ…ç»ªæ£€æµ‹åˆ°å¯è¢«æŸ Skill å¤„ç†
3. å¯¹è¯ä¸»é¢˜ä¸æŸ Skill é«˜åº¦ç›¸å…³

**æ¨èå¡ç‰‡æ ·å¼**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡ å‘ç°ç›¸å…³èƒ½åŠ›                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ â­ è¥¿æ–¹å æ˜Ÿ                                         â”‚     â”‚
â”‚  â”‚                                                     â”‚     â”‚
â”‚  â”‚ ä½ æåˆ°äº†äººé™…å…³ç³»çš„å›°æ‰°ã€‚                            â”‚     â”‚
â”‚  â”‚ æ˜Ÿåº§åˆç›˜åˆ†æå¯ä»¥å¸®ä½ ç†è§£ä½ ä»¬ä¹‹é—´çš„åŠ¨åŠ›æ¨¡å¼ã€‚         â”‚     â”‚
â”‚  â”‚                                                     â”‚     â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚     â”‚
â”‚  â”‚ â”‚   ç«‹å³è¯•ç”¨    â”‚  â”‚   äº†è§£æ›´å¤š   â”‚                 â”‚     â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  [ä¸å†æ¨èæ­¤ Skill] [æš‚æ—¶éšè—]                                â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 è®¾ç½®é¡µé¢ç®¡ç†

**ä½ç½®**ï¼šè®¾ç½® > Skill ç®¡ç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† è®¾ç½®                    Skill ç®¡ç†                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  å·²è®¢é˜… (4)                                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ ğŸ’¬ Core                              [å§‹ç»ˆæ¿€æ´»]     â”‚     â”‚
â”‚  â”‚ ç”Ÿå‘½å¯¹è¯è€… - AI çš„çµé­‚                              â”‚     â”‚
â”‚  â”‚                                    æ¨é€: â”â”â”â”â”â”â”â”â”  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ ğŸ”® å…«å­—å‘½ç†                                   [â—]  â”‚     â”‚
â”‚  â”‚ å‘½ç›˜è§£è¯»ã€å¤§è¿æµå¹´ã€æ¯æ—¥è¿åŠ¿                        â”‚     â”‚
â”‚  â”‚ æ¨é€: [â—]                           [å–æ¶ˆè®¢é˜…]      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ ğŸ§˜ æ­£å¿µå¯¼å¸ˆ                         [é»˜è®¤] [â—]     â”‚     â”‚
â”‚  â”‚ å‘¼å¸ç»ƒä¹ ã€æƒ…ç»ªæ€¥æ•‘                                  â”‚     â”‚
â”‚  â”‚ æ¨é€: [â—]                           [å–æ¶ˆè®¢é˜…]      â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  æ¢ç´¢æ›´å¤š Skill â†’                                            â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.5 é¦–é¡µå¡ç‰‡æ¨è

**ä½ç½®**ï¼šPC å³ä¾§è¾¹æ  / ç§»åŠ¨ç«¯é¦–é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ’¡ ä¸ºä½ æ¨è                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ ğŸ´ å¡”ç½—å åœ                      â”‚    â”‚
â”‚  â”‚                                  â”‚    â”‚
â”‚  â”‚ "æŠ½ä¸€å¼ ç‰Œï¼Œ                      â”‚    â”‚
â”‚  â”‚  çœ‹çœ‹ä»Šå¤©çš„æŒ‡å¼•"                  â”‚    â”‚
â”‚  â”‚                                  â”‚    â”‚
â”‚  â”‚ 3 æ¡å…è´¹ä½“éªŒæœºä¼š                  â”‚    â”‚
â”‚  â”‚                                  â”‚    â”‚
â”‚  â”‚ [ç«‹å³ä½“éªŒ]                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                          â”‚
â”‚  æŸ¥çœ‹å…¨éƒ¨ Skill â†’                        â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Skill ä»‹ç»å¡ç‰‡ç»„ä»¶

### 5.1 ç»„ä»¶å˜ä½“

| å˜ä½“ | ç”¨é€” | å°ºå¯¸ |
|------|------|------|
| `compact` | åˆ—è¡¨é¡¹ã€å¿«é€Ÿé€‰æ‹© | é«˜åº¦å›ºå®š 64px |
| `card` | å¸‚åœºå±•ç¤ºã€æ¨è | å®½åº¦è‡ªé€‚åº”ï¼Œé«˜åº¦ auto |
| `detail` | è¯¦æƒ…é¡µ Hero | å…¨å®½ï¼Œé«˜åº¦ 200-300px |
| `inline` | å¯¹è¯ä¸­å†…åµŒ | å®½åº¦ 100%ï¼Œé«˜åº¦ auto |

### 5.2 ç»„ä»¶ Props

```typescript
interface SkillCardProps {
  skill: SkillMetadata;
  variant: 'compact' | 'card' | 'detail' | 'inline';
  userStatus?: {
    subscribed: boolean;
    pushEnabled: boolean;
    trialMessagesUsed: number;
  };
  showActions?: boolean;
  onSubscribe?: () => void;
  onUnsubscribe?: () => void;
  onTogglePush?: () => void;
  onTry?: () => void;
  onLearnMore?: () => void;
}
```

### 5.3 è§†è§‰è®¾è®¡

**Card å˜ä½“**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚ ğŸ”® â”‚  å…«å­—å‘½ç†                           [å·²è®¢é˜… âœ“]  â”‚
â”‚  â””â”€â”€â”€â”€â”˜                                                 â”‚
â”‚                                                          â”‚
â”‚  æ´å¯Ÿå‘½è¿ç„æœºï¼ŒæŠŠæ¡äººç”Ÿæ–¹å‘                              â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ âœ“ å‘½ç›˜è§£è¯»  âœ“ å¤§è¿æµå¹´  âœ“ æ¯æ—¥è¿åŠ¿             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                          â”‚
â”‚  æ¨é€é€šçŸ¥                                     [â—]        â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              æŸ¥çœ‹è¯¦æƒ…                            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. ä¸ä¸»åŠ¨æ¨¡å—é›†æˆ

### 6.1 æ¨é€æ§åˆ¶é€»è¾‘

```python
# services/proactive/engine.py æ‰©å±•

async def _should_send_to_user(self, user_id: UUID, skill_id: str) -> bool:
    """æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åº”è¯¥æ”¶åˆ°è¯¥ Skill çš„æ¨é€"""

    # 1. æ£€æŸ¥è®¢é˜…çŠ¶æ€
    subscription = await SkillSubscriptionRepo.get(user_id, skill_id)

    # 2. Core Skill å§‹ç»ˆå‘é€
    if skill_id == "core":
        return True

    # 3. Default Skill æ£€æŸ¥æ˜¯å¦è¢«å–æ¶ˆè®¢é˜…
    if skill_id in ["mindfulness", "lifecoach"]:
        if subscription and subscription.status == "unsubscribed":
            return False
        # æ£€æŸ¥æ¨é€å¼€å…³
        if subscription and not subscription.push_enabled:
            return False
        return True

    # 4. Professional Skill éœ€è¦è®¢é˜…
    if not subscription or subscription.status != "subscribed":
        return False

    # 5. æ£€æŸ¥æ¨é€å¼€å…³
    return subscription.push_enabled
```

### 6.2 reminders.yaml æ‰©å±•

æ¯ä¸ª Skill çš„ `reminders.yaml` æ–°å¢å­—æ®µï¼š

```yaml
# skills/bazi/reminders.yaml

version: "1.0"
skill_id: bazi
description: å…«å­—å‘½ç†æé†’å®šä¹‰

# æ–°å¢ï¼šè®¢é˜…æ§åˆ¶
subscription:
  category: professional
  requires_subscription: true
  push_default: true

reminder_types:
  - id: daily_fortune
    name: æ¯æ—¥è¿åŠ¿
    # ... å…¶ä»–é…ç½®
```

### 6.3 ç”¨æˆ·åå¥½åŒæ­¥

æ¨é€å¼€å…³çŠ¶æ€å­˜å‚¨åœ¨ `user_skill_subscriptions.push_enabled`ï¼ŒProactiveEngine æŸ¥è¯¢æ—¶ JOIN æ­¤è¡¨è¿‡æ»¤ã€‚

---

## 7. æ¨èç®—æ³•

### 7.1 æ¨èä¿¡å·

| ä¿¡å· | æƒé‡ | æ¥æº |
|------|------|------|
| è§¦å‘è¯åŒ¹é… | 0.4 | å¯¹è¯å†…å®¹ |
| æƒ…ç»ªæ£€æµ‹ | 0.25 | æƒ…ç»ªåˆ†æ |
| ç”¨æˆ·æ¡£æ¡ˆ | 0.2 | unified_profiles |
| ä½¿ç”¨å†å² | 0.15 | skill_usage_log |

### 7.2 æ¨èåœºæ™¯

```python
class SkillRecommendationService:

    async def get_conversation_recommendations(
        self,
        user_id: UUID,
        message: str,
        emotion: Optional[str] = None
    ) -> List[SkillRecommendation]:
        """åŸºäºå¯¹è¯å†…å®¹æ¨è Skill"""

        recommendations = []

        # 1. æ£€æŸ¥è§¦å‘è¯åŒ¹é…
        for skill_id, config in self._skill_configs.items():
            if self._matches_triggers(message, config.get("triggers", [])):
                # æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²è®¢é˜…
                subscription = await SkillSubscriptionRepo.get(user_id, skill_id)
                if not subscription or subscription.status != "subscribed":
                    recommendations.append(SkillRecommendation(
                        skill_id=skill_id,
                        reason="based_on_conversation",
                        context=self._generate_context(message, config),
                        score=0.85
                    ))

        # 2. æƒ…ç»ªæ£€æµ‹æ¨è
        if emotion in ["anxious", "stressed", "worried"]:
            recommendations.append(SkillRecommendation(
                skill_id="mindfulness",
                reason="based_on_emotion",
                context="æ„ŸçŸ¥åˆ°ä½ å¯èƒ½æœ‰äº›ç„¦è™‘ï¼Œæ­£å¿µç»ƒä¹ å¯ä»¥å¸®åŠ©æ”¾æ¾",
                score=0.72
            ))

        # 3. æŒ‰åˆ†æ•°æ’åºï¼Œå»é‡
        return self._dedupe_and_sort(recommendations)
```

---

## 8. å‰ç«¯ç»„ä»¶ç»“æ„

### 8.1 ç›®å½•ç»“æ„

```
apps/web/src/
â”œâ”€â”€ app/
â”‚   â””â”€â”€ skills/
â”‚       â”œâ”€â”€ page.tsx              # Skill å¸‚åœºé¡µé¢
â”‚       â””â”€â”€ [skillId]/
â”‚           â””â”€â”€ page.tsx          # Skill è¯¦æƒ…é¡µ
â”œâ”€â”€ components/
â”‚   â””â”€â”€ skill/
â”‚       â”œâ”€â”€ SkillCard.tsx         # Skill å¡ç‰‡ç»„ä»¶
â”‚       â”œâ”€â”€ SkillList.tsx         # Skill åˆ—è¡¨ç»„ä»¶
â”‚       â”œâ”€â”€ SkillRecommendation.tsx  # æ¨èå¡ç‰‡
â”‚       â”œâ”€â”€ SkillSubscriptionToggle.tsx  # è®¢é˜…å¼€å…³
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useSkillSubscription.ts   # è®¢é˜…ç®¡ç† Hook
â”‚   â””â”€â”€ useSkillRecommendations.ts # æ¨è Hook
â””â”€â”€ providers/
    â””â”€â”€ SkillProvider.tsx         # æ‰©å±•ç°æœ‰ Provider
```

### 8.2 æ ¸å¿ƒ Hook

```typescript
// hooks/useSkillSubscription.ts

interface UseSkillSubscriptionReturn {
  subscriptions: SkillSubscription[];
  isLoading: boolean;
  subscribe: (skillId: string) => Promise<void>;
  unsubscribe: (skillId: string) => Promise<void>;
  togglePush: (skillId: string, enabled: boolean) => Promise<void>;
  isSubscribed: (skillId: string) => boolean;
  isPushEnabled: (skillId: string) => boolean;
}

export function useSkillSubscription(): UseSkillSubscriptionReturn {
  // å®ç°
}
```

---

## 9. è¿ç§»è®¡åˆ’

### Phase 1: æ•°æ®æ¨¡å‹ (1 å¤©)
- [ ] åˆ›å»º `user_skill_subscriptions` è¡¨
- [ ] åˆ›å»º `skill_usage_log` è¡¨
- [ ] ä¸ºç°æœ‰ç”¨æˆ·åˆå§‹åŒ–é»˜è®¤è®¢é˜…

### Phase 2: API å¼€å‘ (2 å¤©)
- [ ] æ‰©å±• `/api/v1/skills` è·¯ç”±
- [ ] å®ç°è®¢é˜…ç®¡ç† API
- [ ] å®ç°æ¨è API

### Phase 3: å‰ç«¯å¼€å‘ (3 å¤©)
- [ ] Skill å¸‚åœºé¡µé¢
- [ ] Skill å¡ç‰‡ç»„ä»¶
- [ ] è®¾ç½®é¡µé¢ Skill ç®¡ç†
- [ ] å¯¹è¯æ¨èå¡ç‰‡

### Phase 4: ä¸»åŠ¨æ¨¡å—é›†æˆ (1 å¤©)
- [ ] ProactiveEngine é›†æˆè®¢é˜…æ£€æŸ¥
- [ ] æ¨é€å¼€å…³é€»è¾‘

### Phase 5: æ¨èç®—æ³• (2 å¤©)
- [ ] è§¦å‘è¯åŒ¹é…
- [ ] æƒ…ç»ªæ£€æµ‹é›†æˆ
- [ ] é¦–é¡µæ¨èå¡ç‰‡

---

## 10. é™„å½•

### 10.1 Skill å…ƒæ•°æ®å®Œæ•´ç¤ºä¾‹

è§ `skill-metadata-schema.yaml`

### 10.2 UI è®¾è®¡ç¨¿

è§ `ui-designs/` ç›®å½•

### 10.3 API å®Œæ•´æ–‡æ¡£

è§ `api-reference.md`
