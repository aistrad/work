# Vibe ID 重构设计文档

> Version: 7.0 | 2026-01-18
> Status: Design Complete, Ready for Implementation

---

## 概述

Vibe ID 是 VibeLife 平台的**用户身份系统**，类似于 Apple ID 之于苹果生态。它不仅是一个人格分析结果，更是用户在平台上的核心身份标识和所有服务的入口钥匙。

## 战略定位

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│   Vibe ID = 用户身份系统 + 裂变引擎 + 数据护城河                              │
│                                                                             │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │                                                                     │   │
│   │   用户身份系统                                                       │   │
│   │   ────────────                                                      │   │
│   │   • 每个用户的唯一数字身份                                           │   │
│   │   • 所有服务的入口钥匙                                               │   │
│   │   • AI "懂你" 的数据基础                                            │   │
│   │                                                                     │   │
│   │   裂变引擎                                                           │   │
│   │   ────────                                                          │   │
│   │   • 分享卡片驱动社交传播 (K-factor > 1.5)                            │   │
│   │   • 关系匹配邀请机制                                                 │   │
│   │   • "你的 Vibe 是什么" 成为社交语言                                  │   │
│   │                                                                     │   │
│   │   数据护城河                                                         │   │
│   │   ──────────                                                        │   │
│   │   • 用户画像越用越准                                                 │   │
│   │   • 迁移成本高                                                       │   │
│   │   • 竞争对手无法复制                                                 │   │
│   │                                                                     │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 设计决策

| 决策项 | 选择 | 说明 |
|--------|------|------|
| 核心定位 | 用户身份系统 | 类似 Apple ID，所有功能围绕它展开 |
| 创建流程 | 极简入口 | 只需生日+时间，3分钟内完成 |
| 数据结构 | 扩展为完整画像 | 包含身份、四维、标签、关系倾向等 |
| 裂变优先级 | 分享卡片优先 | 先做分享卡片，再做关系匹配 |
| 技术路径 | 扩展现有 Skill | 保持架构一致性 |
| 数据迁移 | 全新开始 | 清空旧数据，使用新结构 |
| 分享卡片 | 服务端渲染 | 兼容性最好 |
| 原型体系 | 保持 12 原型 | 已有完整元数据 |
| 首次体验 | 完全无登录 | localStorage 暂存，注册后迁移 |

## 文档结构

| 文档 | 说明 |
|------|------|
| [SPEC.md](./SPEC.md) | 详细规格说明 |
| [DATA-MODEL.md](./DATA-MODEL.md) | 数据模型定义 |
| [API.md](./API.md) | API 接口设计 |
| [FRONTEND.md](./FRONTEND.md) | 前端组件设计 |
| [SHARE-CARD.md](./SHARE-CARD.md) | 分享卡片设计 |
| [IMPLEMENTATION.md](./IMPLEMENTATION.md) | 实现计划 |

## 核心用户旅程

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          Vibe ID 用户旅程                                    │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  1. 首次体验 (无需注册，3分钟)                                               │
│  ════════════════════════════════                                           │
│                                                                             │
│  用户触点: 小红书/抖音/朋友分享                                               │
│       │                                                                     │
│       ▼                                                                     │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  输入生日 + 出生时间                                                  │   │
│  │       ↓                                                              │   │
│  │  3秒加载动画 (神秘感)                                                 │   │
│  │       ↓                                                              │   │
│  │  展示 Vibe ID 卡片                                                    │   │
│  │       ↓                                                              │   │
│  │  "哇！这也太准了吧" → 分享到社交媒体                                   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  2. 分享裂变                                                                 │
│  ════════════                                                               │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  生成分享卡片 (服务端渲染)                                            │   │
│  │       ↓                                                              │   │
│  │  分享到朋友圈/小红书                                                  │   │
│  │       ↓                                                              │   │
│  │  朋友扫码 → 创建自己的 Vibe ID → 继续分享                            │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
│  3. 注册转化                                                                 │
│  ════════════                                                               │
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │  "保存你的 Vibe ID，解锁更多功能"                                     │   │
│  │       ↓                                                              │   │
│  │  微信/手机号注册                                                      │   │
│  │       ↓                                                              │   │
│  │  localStorage 数据迁移到账号                                          │   │
│  │       ↓                                                              │   │
│  │  进入主 App，开始日常陪伴                                             │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 关键指标

| 指标 | 目标值 | 说明 |
|------|--------|------|
| 首次体验完成率 | > 80% | 输入信息到看到结果 |
| 分享率 | > 30% | 看到结果后分享 |
| K-factor | > 1.5 | 每个用户带来的新用户数 |
| 注册转化率 | > 20% | 体验后注册 |
| D7 留存 | > 30% | 7日留存率 |

## 技术架构

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                          Vibe ID 技术架构                                    │
├──────────────────────────────────────────────���──────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         前端 (Next.js)                               │   │
│  │                                                                     │   │
│  │  /vibe-id              主页 (展示/创建入口)                          │   │
│  │  /vibe-id/create       创建流程                                      │   │
│  │  /vibe-id/[shareCode]  分享落地页                                    │   │
│  │  /vibe-id/match        配对页面                                      │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                        │                                    │
│                                        ▼                                    │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         后端 (FastAPI)                               │   │
│  │                                                                     │   │
│  │  skills/vibe_id/                                                    │   │
│  │  ├── services/                                                      │   │
│  │  │   ├── service.py           主服务 (重构)                         │   │
│  │  │   ├── identity_engine.py   身份计算引擎 (新)                      │   │
│  │  │   ├── fusion_engine.py     融合算法 (扩展)                        │   │
│  │  │   ├── card_renderer.py     分享卡片渲染 (新)                      │   │
│  │  │   ├── match_engine.py      配对引擎 (新)                          │   │
│  │  │   └── tag_generator.py     标签生成器 (新)                        │   │
│  │  └── tools/                                                         │   │
│  │      └── handlers.py          工具处理器 (扩展)                      │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                        │                                    │
│                                        ▼                                    │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                         数据层 (PostgreSQL)                          │   │
│  │                                                                     │   │
│  │  unified_profiles.skill_data.vibe_id (v7.0 新结构)                  │   │
│  │                                                                     │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

## 待解决问题

1. **分享卡片图片存储**: 使用本地文件系统还是 OSS？
2. **分享码生成策略**: 6位随机码是否足够？是否需要防碰撞？
3. **无登录数据暂存**: localStorage 方案的数据结构和过期策略？
4. **配对算法细节**: 匹配度计算的具体权重如何设定？

---

*"你的 Vibe 是什么？"*
