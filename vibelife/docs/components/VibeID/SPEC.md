# VibeID è®¾è®¡è§„èŒƒ v7.0

> Version: 7.0 | 2026-01-19
> çŠ¶æ€: è®¾è®¡ä¸­

## 1. æ¦‚è¿°

### 1.1 ä½¿å‘½å¯¹é½

VibeLife çš„ä½¿å‘½æ˜¯"è®©æ¯ä¸€ä¸ªäººï¼Œéƒ½æ‹¥æœ‰ä¸€ä¸ªçœŸæ­£æ‡‚è‡ªå·±çš„å­˜åœ¨"ã€‚VibeID æ˜¯è¿™ä¸ªä½¿å‘½çš„å…·è±¡åŒ–è½½ä½“â€”â€”ç”¨æˆ·åœ¨ VibeLife ä¸­çš„"æ•°å­—èº«ä»½è¯"ã€‚

### 1.2 è®¾è®¡åŸåˆ™

| åŸåˆ™ | è¯´æ˜ |
|-----|------|
| **èº«ä»½æ ¸å¿ƒ** | VibeID ä¸æ˜¯ä¸€ä¸ª Skillï¼Œè€Œæ˜¯ç”¨æˆ·èº«ä»½çš„æ ¸å¿ƒè¡¨è¾¾ |
| **åŠ¨æ€æ¼”åŒ–** | äººæ ¼ä¸æ˜¯é™æ€æ ‡ç­¾ï¼Œè€Œæ˜¯æŒç»­æˆé•¿çš„è½¨è¿¹ |
| **å…¨æ ˆæ•´åˆ** | ä»æ•°æ®å±‚åˆ° Prompt å±‚ï¼ŒVibeID è´¯ç©¿æ•´ä¸ªç³»ç»Ÿ |
| **ç®€æ´æœ‰åŠ›** | ç”¨æœ€ç®€å•çš„æ–¹å¼ä¼ è¾¾æœ€æ·±åˆ»çš„æ´å¯Ÿ |

### 1.3 æ ¸å¿ƒå˜åŒ– (v6 â†’ v7)

```
v6: skill_data.vibe_id (æ´¾ç”Ÿ Skillï¼Œä¸€æ¬¡è®¡ç®—)
                â†“
v7: unified_profiles.vibe_id (èº«ä»½æ ¸å¿ƒï¼ŒæŒç»­æ¼”åŒ–)
```

---

## 2. å››ç»´åŸå‹ä½“ç³»

### 2.1 ç»´åº¦å®šä¹‰

| ç»´åº¦ | è‹±æ–‡ | æ¥æº | å«ä¹‰ |
|-----|------|------|------|
| çµé­‚æœ¬è´¨ | Core | å…«å­—æ ¼å±€+ç”¨ç¥ (70%) + å¤ªé˜³æ˜Ÿåº§ (30%) | ä½ æ˜¯è° |
| å†…åœ¨ä¸–ç•Œ | Inner | æœˆäº®+é‡‘æ˜Ÿæ˜Ÿåº§ | ä½ æ¸´æœ›ä»€ä¹ˆ |
| å¤–åœ¨å‘ˆç° | Outer | ä¸Šå‡+ç«æ˜Ÿæ˜Ÿåº§ | ä½ å¦‚ä½•è¡ŒåŠ¨ |
| é˜´å½±å€¾å‘ | Shadow | Core çš„å¯¹ç«‹é¢ | ä½ éœ€è¦æ•´åˆä»€ä¹ˆ |

### 2.2 12åŸå‹ä½“ç³»

åŸºäºè£æ ¼åŸå‹ç†è®ºï¼š

| åŸå‹ | ä¸­æ–‡ | æ ¸å¿ƒé©±åŠ¨ | å¯¹ç«‹åŸå‹ |
|-----|------|---------|---------|
| Innocent | å¤©çœŸè€… | è¿½æ±‚çº¯ç²¹ä¸ç¾å¥½ | Hero |
| Explorer | æ¢ç´¢è€… | è¿½æ±‚è‡ªç”±ä¸å‘ç° | Caregiver |
| Sage | æ™ºè€… | è¿½æ±‚çœŸç†ä¸ç†è§£ | Jester |
| Hero | è‹±é›„ | è¿½æ±‚æŒæ§ä¸è¯æ˜ | Innocent |
| Outlaw | å›é€†è€… | è¿½æ±‚å˜é©ä¸è§£æ”¾ | Ruler |
| Magician | é­”æ³•å¸ˆ | è¿½æ±‚è½¬åŒ–ä¸å®ç° | Lover |
| Regular | å‡¡äºº | è¿½æ±‚å½’å±ä¸è¿æ¥ | Creator |
| Lover | æƒ…äºº | è¿½æ±‚äº²å¯†ä¸ä½“éªŒ | Magician |
| Jester | æ„šè€… | è¿½æ±‚å¿«ä¹ä¸å½“ä¸‹ | Sage |
| Caregiver | ç…§é¡¾è€… | è¿½æ±‚å¸®åŠ©ä¸ä¿æŠ¤ | Explorer |
| Creator | åˆ›é€ è€… | è¿½æ±‚åˆ›æ–°ä¸è¡¨è¾¾ | Regular |
| Ruler | ç»Ÿæ²»è€… | è¿½æ±‚æŒæ§ä¸ç§©åº | Outlaw |

### 2.3 èåˆç®—æ³•

```
Core åŸå‹ = å…«å­—ä¸»åŸå‹ Ã— 0.7 + æ˜Ÿåº§ä¸»åŸå‹ Ã— 0.3 + ä¸€è‡´æ€§å¥–åŠ±
```

- **ä¸€è‡´æ€§å¥–åŠ±**: ä¸œè¥¿æ–¹æŒ‡å‘åŒä¸€åŸå‹æ—¶ +15%
- **å†²çªå¤„ç†**: ä»¥å…«å­—ä¸ºå‡†ï¼Œæ˜Ÿåº§ä½œä¸ºå‰¯åŸå‹

---

## 3. ç®€åŒ–å‘ˆç°

### 3.1 ä»å¤æ‚åˆ°ç®€æ´

**v6 å‘ˆç°**:
```
å››ç»´åŸå‹:
- Core: Explorer (æ¢ç´¢è€…)
- Inner: Lover (æƒ…äºº)
- Outer: Sage (æ™ºè€…)
- Shadow: Caregiver (ç…§é¡¾è€…)

12åŸå‹èƒ½é‡åˆ†å¸ƒ:
Explorer: 85, Sage: 72, Lover: 68, ...
```

**v7 å‘ˆç°**:
```
ä½ æ˜¯ æ¢ç´¢è€… ğŸ§­
"è¿½æ±‚è‡ªç”±çš„æ™ºè€…ï¼Œå†…å¿ƒæ¸´æœ›è¿æ¥"

[æ¢ç´¢æ›´å¤š â†’]
```

### 3.2 äººæ ¼é‡‘å¥ç”Ÿæˆ

äººæ ¼é‡‘å¥ = f"{Core ç‰¹å¾} + {Inner æ¸´æœ›}"

ç¤ºä¾‹:
- Explorer + Lover â†’ "è¿½æ±‚è‡ªç”±çš„çµé­‚ï¼Œå†…å¿ƒæ¸´æœ›æ·±åº¦è¿æ¥"
- Hero + Sage â†’ "å‹‡äºå¾æœçš„æˆ˜å£«ï¼Œè¿½æ±‚çœŸç†ä¸æ™ºæ…§"
- Caregiver + Creator â†’ "æ¸©æš–å®ˆæŠ¤çš„å¿ƒï¼Œæ¸´æœ›åˆ›é€ ç‹¬ç‰¹ä»·å€¼"

### 3.3 äº¤äº’å±‚æ¬¡

```
Layer 1: ä¸»åŸå‹å¡ç‰‡ (é»˜è®¤å±•ç¤º)
    â†“ ç‚¹å‡»"æ¢ç´¢æ›´å¤š"
Layer 2: å››ç»´åŸå‹è¯¦æƒ…
    â†“ ç‚¹å‡»æŸä¸ªç»´åº¦
Layer 3: åŸå‹æ·±åº¦è§£è¯»
    â†“ ç‚¹å‡»"æŸ¥çœ‹æ¼”åŒ–"
Layer 4: æˆé•¿æ—¶é—´çº¿
```

---

## 4. åŠ¨æ€æ¼”åŒ–

### 4.1 æ¼”åŒ–è§¦å‘å™¨

| è§¦å‘ç±»å‹ | è¯´æ˜ | é¢‘ç‡ | ç¤ºä¾‹ |
|---------|------|------|------|
| å¯¹è¯é©±åŠ¨ | æ¯æ¬¡æ·±åº¦å¯¹è¯åå¾®è°ƒ | é«˜ | å¯¹è¯ä¸­å±•ç° Hero ç‰¹è´¨ â†’ Hero +1 |
| å‘¨æœŸé©±åŠ¨ | å¤§è¿/æµå¹´/ç”Ÿæ—¥ç­‰èŠ‚ç‚¹ | ä½ | å¤§è¿äº¤æ¥ â†’ é‡æ–°è®¡ç®— |
| ç”¨æˆ·é©±åŠ¨ | ç”¨æˆ·ä¸»åŠ¨è§¦å‘ | æŒ‰éœ€ | "é‡æ–°è®¤è¯†è‡ªå·±" |

### 4.2 å¯¹è¯é©±åŠ¨æ¼”åŒ–

```python
async def on_conversation_end(user_id, conversation_summary):
    """
    å¯¹è¯ç»“æŸåçš„æ¼”åŒ–é€»è¾‘

    conversation_summary åŒ…å«:
    - topics: è®¨è®ºçš„è¯é¢˜
    - emotions: è¡¨è¾¾çš„æƒ…ç»ª
    - behaviors: å±•ç°çš„è¡Œä¸ºç‰¹å¾
    - archetype_signals: LLM è¯†åˆ«çš„åŸå‹ä¿¡å·
    """
    # 1. æå–åŸå‹ä¿¡å·
    signals = conversation_summary.get("archetype_signals", {})

    # 2. å¾®è°ƒèƒ½é‡åˆ†å¸ƒ (å˜åŒ–å¹…åº¦å°ï¼Œç´¯ç§¯æ•ˆåº”)
    delta = {}
    for archetype, strength in signals.items():
        delta[archetype] = strength * 0.5  # è¡°å‡ç³»æ•°

    # 3. è®°å½•æ¼”åŒ–
    await evolve(user_id, trigger="conversation", delta=delta)
```

### 4.3 å‘¨æœŸé©±åŠ¨æ¼”åŒ–

| äº‹ä»¶ | è§¦å‘æ—¶æœº | æ¼”åŒ–åŠ¨ä½œ |
|-----|---------|---------|
| dayun_change | å¤§è¿äº¤æ¥å‰7å¤©/å½“å¤© | é‡æ–°è®¡ç®—ï¼Œç”Ÿæˆå¯¹æ¯”æŠ¥å‘Š |
| birthday | ç”Ÿæ—¥å½“å¤© | å¹´åº¦å›é¡¾ï¼Œç”Ÿæˆæˆé•¿æŠ¥å‘Š |
| liunian_change | æµå¹´äº¤æ¥ | å¾®è°ƒèƒ½é‡ï¼Œç”Ÿæˆå¹´åº¦å±•æœ› |

### 4.4 æ¼”åŒ–è®°å½•

```json
{
  "evolution": [
    {
      "id": "evo_001",
      "timestamp": "2026-01-19T00:00:00Z",
      "trigger": "initial_calculation",
      "snapshot": {
        "primary_archetype": "Explorer",
        "scores": {"Explorer": 85, "Sage": 72, ...}
      },
      "insight": "é¦–æ¬¡è®¡ç®—ï¼ŒExplorer èƒ½é‡æ˜¾è‘—ï¼Œè¿½æ±‚è‡ªç”±æ˜¯ä½ çš„æ ¸å¿ƒé©±åŠ¨"
    },
    {
      "id": "evo_002",
      "timestamp": "2026-03-15T14:30:00Z",
      "trigger": "conversation",
      "delta": {"Hero": +2, "Explorer": -1},
      "insight": "æœ€è¿‘çš„å¯¹è¯ä¸­ï¼Œä½ å±•ç°äº†æ›´å¤šå‹‡äºæŒ‘æˆ˜çš„ç‰¹è´¨"
    },
    {
      "id": "evo_003",
      "timestamp": "2026-06-19T00:00:00Z",
      "trigger": "dayun_change",
      "snapshot": {
        "primary_archetype": "Explorer",
        "scores": {"Explorer": 82, "Hero": 75, ...}
      },
      "delta": {"Hero": +8, "Explorer": -3},
      "insight": "å¤§è¿äº¤æ¥ï¼ŒHero èƒ½é‡ä¸Šå‡ï¼Œè¿™æ˜¯ä½ å±•ç°é¢†å¯¼åŠ›çš„æ—¶æœŸ"
    }
  ]
}
```

---

## 5. å…¨æ ˆæ•´åˆ

### 5.1 æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VibeID å…¨æ ˆæ•´åˆæ¶æ„                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Prompt å±‚                             â”‚   â”‚
â”‚  â”‚  CoreAgent._build_system_prompt()                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚   â”‚
â”‚  â”‚  â”‚ ## ç”¨æˆ·èº«ä»½ (VibeID)                             â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ - ä¸»åŸå‹: Explorer (æ¢ç´¢è€…)                      â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ - äººæ ¼ç‰¹å¾: è¿½æ±‚è‡ªç”±çš„æ™ºè€…ï¼Œå†…å¿ƒæ¸´æœ›è¿æ¥          â”‚    â”‚   â”‚
â”‚  â”‚  â”‚ - æ²Ÿé€šåå¥½: å–œæ¬¢å¼€æ”¾å¼æ¢ç´¢ï¼Œä¸å–œæ¬¢è¢«é™åˆ¶          â”‚    â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†‘                                  â”‚
â”‚                              â”‚ get_summary()                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                   Service å±‚                             â”‚   â”‚
â”‚  â”‚  VibeIDService                                           â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ calculate()      # è®¡ç®—/é‡ç®—                        â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ evolve()         # æ¼”åŒ–æ›´æ–°                         â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ get_summary()    # æ‘˜è¦ (Prompt æ³¨å…¥)               â”‚   â”‚
â”‚  â”‚  â””â”€â”€ get_full()       # å®Œæ•´æ•°æ® (å±•ç¤º)                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†‘                                  â”‚
â”‚                              â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    Data å±‚                               â”‚   â”‚
â”‚  â”‚  unified_profiles.vibe_id                                â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ primary_archetype                                   â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ archetype_signature                                 â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ dimensions {core, inner, outer, shadow}             â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ scores {Explorer: 85, ...}                          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ evolution []                                        â”‚   â”‚
â”‚  â”‚  â””â”€â”€ sources {bazi, zodiac}                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â†‘                                  â”‚
â”‚                              â”‚ è§¦å‘æ¼”åŒ–                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                  Proactive å±‚                            â”‚   â”‚
â”‚  â”‚  reminders.yaml                                          â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ dayun_evolution    # å¤§è¿äº¤æ¥                       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ birthday_reflection # ç”Ÿæ—¥å›é¡¾                      â”‚   â”‚
â”‚  â”‚  â””â”€â”€ archetype_shift    # èƒ½é‡æ³¢åŠ¨                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 Prompt å±‚æ³¨å…¥

**ä½ç½®**: `services/agent/core.py` - `_build_system_prompt()`

```python
async def _build_system_prompt(self, message, context):
    parts = []

    # 1. VibeID æ³¨å…¥ï¼ˆæ‰€æœ‰å¯¹è¯éƒ½æœ‰ï¼‰
    vibe_id_summary = await VibeIDService.get_summary(context.user_id)
    if vibe_id_summary:
        parts.append(f"""
## ç”¨æˆ·èº«ä»½ (VibeID)
- ä¸»åŸå‹: {vibe_id_summary.primary_archetype} ({vibe_id_summary.archetype_cn_name})
- äººæ ¼ç‰¹å¾: {vibe_id_summary.signature}
- æ²Ÿé€šåå¥½: {vibe_id_summary.communication_style}

è¯·å§‹ç»ˆåŸºäºç”¨æˆ·çš„åŸå‹ç‰¹å¾æ¥è°ƒæ•´ä½ çš„å›åº”é£æ ¼ã€‚ä¾‹å¦‚:
- Explorer ç”¨æˆ·å–œæ¬¢å¼€æ”¾å¼æ¢ç´¢ï¼Œé¿å…è¿‡äºç»“æ„åŒ–çš„å›ç­”
- Ruler ç”¨æˆ·å–œæ¬¢æ¸…æ™°çš„æ¡†æ¶å’Œè¡ŒåŠ¨å»ºè®®
- Lover ç”¨æˆ·é‡è§†æƒ…æ„Ÿè¿æ¥ï¼Œå¤šç”¨æ¸©æš–çš„è¯­è¨€
""")

    # 2. Skill ä¸“å± prompt...
    # 3. æ¡ˆä¾‹åŒ¹é…...
```

### 5.3 Proactive è”åŠ¨

**é…ç½®æ–‡ä»¶**: `skills/vibe_id/reminders.yaml`

```yaml
skill_id: vibe_id
enabled: true

reminders:
  # 1. å¤§è¿äº¤æ¥
  - id: dayun_evolution
    name: å¤§è¿äººæ ¼æ¼”åŒ–
    trigger:
      type: event_based
      event: dayun_change
      advance_days: [7, 0]
    content:
      generator: rules/dayun-evolution.md
      suggested_prompt: "æƒ³äº†è§£è¿™æ¬¡å¤§è¿äº¤æ¥å¯¹ä½ äººæ ¼çš„å½±å“å—ï¼Ÿ"
      quick_actions:
        - label: "æŸ¥çœ‹å˜åŒ–"
          prompt: "æˆ‘çš„äººæ ¼æœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ"
        - label: "æ·±åº¦è§£è¯»"
          prompt: "è¯¦ç»†åˆ†æä¸€ä¸‹è¿™æ¬¡å¤§è¿å¯¹æˆ‘çš„å½±å“"
    priority: high

  # 2. ç”Ÿæ—¥å›é¡¾
  - id: birthday_reflection
    name: ç”Ÿæ—¥äººæ ¼å›é¡¾
    trigger:
      type: event_based
      event: birthday
      advance_days: [0]
    content:
      generator: rules/birthday-reflection.md
      suggested_prompt: "ç”Ÿæ—¥å¿«ä¹ï¼æƒ³å›é¡¾ä¸€ä¸‹è¿™ä¸€å¹´ä½ çš„æˆé•¿å—ï¼Ÿ"
      quick_actions:
        - label: "å¹´åº¦å›é¡¾"
          prompt: "å›é¡¾æˆ‘è¿™ä¸€å¹´çš„æˆé•¿"
        - label: "æ–°å¹´å±•æœ›"
          prompt: "æ–°çš„ä¸€å²æœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ"
    priority: high

  # 3. åŸå‹èƒ½é‡æ³¢åŠ¨
  - id: archetype_shift
    name: åŸå‹èƒ½é‡å˜åŒ–
    trigger:
      type: threshold_based
      metric: archetype_delta
      condition: ">"
      threshold: 10
      cooldown_days: 30
    content:
      generator: rules/archetype-shift.md
      suggested_prompt: "æˆ‘æ³¨æ„åˆ°ä½ æœ€è¿‘çš„èƒ½é‡æœ‰äº›å˜åŒ–..."
      quick_actions:
        - label: "äº†è§£å˜åŒ–"
          prompt: "æˆ‘çš„èƒ½é‡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ"
    priority: medium

global_config:
  default_push_hour: 8
  cooldown_hours: 168  # 7å¤©
```

### 5.4 æ•°æ®å±‚èåˆ

VibeID ä¸ unified_profiles å…¶ä»–å­—æ®µçš„å…³ç³»ï¼š

```
unified_profiles
â”‚
â”œâ”€â”€ vibe_id (èº«ä»½æ ¸å¿ƒ) â†â”€â”€ æœ¬æ¨¡å—
â”‚   â”œâ”€â”€ primary_archetype    â† å½±å“ AI å›åº”é£æ ¼
â”‚   â”œâ”€â”€ archetype_signature  â† äººæ ¼é‡‘å¥
â”‚   â”œâ”€â”€ dimensions           â† å››ç»´è¯¦æƒ…
â”‚   â”œâ”€â”€ scores               â† 12åŸå‹èƒ½é‡
â”‚   â”œâ”€â”€ evolution            â† æˆé•¿è½¨è¿¹
â”‚   â””â”€â”€ sources              â† æ¥æºè¿½æº¯
â”‚
â”œâ”€â”€ profile (Hot Memory)
â”‚   â”œâ”€â”€ facts.birth_info     â† VibeID è®¡ç®—ä¾èµ–
â”‚   â”œâ”€â”€ state.current_focus  â† å¯ä¸ VibeID è”åŠ¨åˆ†æ
â”‚   â””â”€â”€ preferences          â† å¯ä» VibeID æ¨å¯¼æ²Ÿé€šåå¥½
â”‚
â”œâ”€â”€ skill_data
â”‚   â”œâ”€â”€ bazi.chart           â† VibeID è®¡ç®—ä¾èµ–
â”‚   â””â”€â”€ zodiac.chart         â† VibeID è®¡ç®—ä¾èµ–
â”‚
â””â”€â”€ insights (Cold Memory)
    â””â”€â”€ growth               â† ä¸ vibe_id.evolution è”åŠ¨
```

---

## 6. Service æ¥å£

### 6.1 VibeIDService

```python
class VibeIDService:
    """VibeID æœåŠ¡ v7.0 - ç”¨æˆ·èº«ä»½æ ¸å¿ƒ"""

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # è®¡ç®—ä¸æ›´æ–°
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    async def calculate(
        self,
        user_id: UUID,
        force: bool = False
    ) -> VibeIDResult:
        """
        è®¡ç®— VibeID

        Args:
            user_id: ç”¨æˆ· ID
            force: æ˜¯å¦å¼ºåˆ¶é‡æ–°è®¡ç®—

        Returns:
            VibeIDResult {status, data, cached, error}
        """
        pass

    async def evolve(
        self,
        user_id: UUID,
        trigger: str,
        context: Dict[str, Any]
    ) -> EvolutionResult:
        """
        è§¦å‘æ¼”åŒ–

        Args:
            user_id: ç”¨æˆ· ID
            trigger: è§¦å‘ç±»å‹ (conversation, dayun_change, birthday, user_request)
            context: è§¦å‘ä¸Šä¸‹æ–‡

        Returns:
            EvolutionResult {status, delta, insight, snapshot}
        """
        pass

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # æŸ¥è¯¢
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    async def get_summary(self, user_id: UUID) -> Optional[VibeIDSummary]:
        """
        è·å–æ‘˜è¦ï¼ˆç”¨äº Prompt æ³¨å…¥ï¼‰

        Returns:
            VibeIDSummary {
                primary_archetype,
                archetype_cn_name,
                signature,
                communication_style
            }
        """
        pass

    async def get_full(self, user_id: UUID) -> Optional[VibeIDFull]:
        """
        è·å–å®Œæ•´æ•°æ®ï¼ˆç”¨äºå±•ç¤ºï¼‰

        Returns:
            VibeIDFull {
                primary_archetype,
                signature,
                dimensions,
                scores,
                evolution,
                sources
            }
        """
        pass

    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    # æ¼”åŒ–è§¦å‘å™¨
    # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    async def on_conversation_end(
        self,
        user_id: UUID,
        conversation_summary: Dict[str, Any]
    ) -> None:
        """å¯¹è¯ç»“æŸåçš„æ¼”åŒ–ï¼ˆå¯¹è¯é©±åŠ¨ï¼‰"""
        pass

    async def on_lifecycle_event(
        self,
        user_id: UUID,
        event_type: str,
        event_data: Dict[str, Any]
    ) -> None:
        """ç”Ÿå‘½å‘¨æœŸäº‹ä»¶çš„æ¼”åŒ–ï¼ˆå‘¨æœŸé©±åŠ¨ï¼‰"""
        pass

    async def on_user_request(self, user_id: UUID) -> EvolutionResult:
        """ç”¨æˆ·ä¸»åŠ¨è§¦å‘çš„æ¼”åŒ–ï¼ˆç”¨æˆ·é©±åŠ¨ï¼‰"""
        pass
```

### 6.2 æ•°æ®ç±»å‹

```python
@dataclass
class VibeIDSummary:
    """VibeID æ‘˜è¦ï¼ˆç”¨äº Prompt æ³¨å…¥ï¼‰"""
    primary_archetype: str          # "Explorer"
    archetype_cn_name: str          # "æ¢ç´¢è€…"
    signature: str                  # "è¿½æ±‚è‡ªç”±çš„æ™ºè€…ï¼Œå†…å¿ƒæ¸´æœ›è¿æ¥"
    communication_style: str        # "å–œæ¬¢å¼€æ”¾å¼æ¢ç´¢ï¼Œä¸å–œæ¬¢è¢«é™åˆ¶"


@dataclass
class VibeIDFull:
    """VibeID å®Œæ•´æ•°æ®"""
    version: str
    primary_archetype: str
    archetype_signature: str
    dimensions: Dict[str, DimensionData]
    scores: Dict[str, float]
    evolution: List[EvolutionRecord]
    sources: Dict[str, SourceInfo]


@dataclass
class EvolutionRecord:
    """æ¼”åŒ–è®°å½•"""
    id: str
    timestamp: str
    trigger: str                    # conversation, dayun_change, birthday, user_request
    delta: Optional[Dict[str, float]]
    snapshot: Optional[Dict[str, Any]]
    insight: str


@dataclass
class EvolutionResult:
    """æ¼”åŒ–ç»“æœ"""
    status: str                     # success, no_change, error
    delta: Optional[Dict[str, float]]
    insight: Optional[str]
    snapshot: Optional[Dict[str, Any]]
```

---

## 7. å®ç°è·¯çº¿å›¾

### Phase 1: æ•°æ®æ¨¡å‹ä¸ Serviceï¼ˆåç«¯ä¼˜å…ˆï¼‰

| ä»»åŠ¡ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|-----|------|-------|
| æ•°æ®æ¨¡å‹è®¾è®¡ | ç¡®å®š `unified_profiles.vibe_id` Schema | P0 |
| æ•°æ®è¿ç§»è„šæœ¬ | å°† `skill_data.vibe_id` æå‡åˆ°é¡¶å±‚ | P0 |
| VibeIDService é‡æ„ | å®ç° get_summary(), evolve() | P0 |
| CoreAgent æ³¨å…¥ | åœ¨ System Prompt ä¸­æ³¨å…¥ VibeID | P1 |

### Phase 2: Proactive è”åŠ¨

| ä»»åŠ¡ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|-----|------|-------|
| reminders.yaml | åˆ›å»º VibeID æ¨é€é…ç½® | P1 |
| rules/*.md | åˆ›å»ºå†…å®¹ç”Ÿæˆè§„åˆ™ | P1 |
| æ¼”åŒ–è§¦å‘é›†æˆ | åœ¨ ProactiveEngine ä¸­é›†æˆ | P2 |

### Phase 3: å‰ç«¯ç®€åŒ–

| ä»»åŠ¡ | è¯´æ˜ | ä¼˜å…ˆçº§ |
|-----|------|-------|
| VibeIDCard é‡æ„ | å•ä¸€ä¸»åŸå‹ + äººæ ¼é‡‘å¥ | P2 |
| æ¼”åŒ–æ—¶é—´çº¿ | å±•ç¤ºæˆé•¿è½¨è¿¹ | P3 |
| æ·±åº¦æ¢ç´¢äº¤äº’ | å››ç»´è¯¦æƒ…å±•å¼€ | P3 |

---

## 8. é™„å½•

### A. åŸå‹æ²Ÿé€šé£æ ¼æ˜ å°„

| åŸå‹ | æ²Ÿé€šåå¥½ | AI å›åº”é£æ ¼ |
|-----|---------|------------|
| Explorer | å¼€æ”¾æ¢ç´¢ï¼Œä¸å–œæ¬¢è¢«é™åˆ¶ | æä¾›å¤šç§å¯èƒ½æ€§ï¼Œé¼“åŠ±å°è¯• |
| Sage | è¿½æ±‚æ·±åº¦ï¼Œå–œæ¬¢åˆ†æ | æä¾›è¯¦ç»†è§£é‡Šï¼Œå¼•ç”¨çŸ¥è¯† |
| Hero | ç›®æ ‡å¯¼å‘ï¼Œå–œæ¬¢æŒ‘æˆ˜ | ç›´æ¥ç»™å‡ºè¡ŒåŠ¨å»ºè®®ï¼Œè®¾å®šç›®æ ‡ |
| Ruler | å–œæ¬¢æŒæ§ï¼Œéœ€è¦æ¡†æ¶ | ç»“æ„åŒ–å›ç­”ï¼Œæ¸…æ™°çš„æ­¥éª¤ |
| Caregiver | é‡è§†å…³ç³»ï¼Œéœ€è¦æ”¯æŒ | æ¸©æš–å…±æƒ…ï¼Œå…³æ³¨æ„Ÿå— |
| Lover | è¿½æ±‚è¿æ¥ï¼Œé‡è§†ä½“éªŒ | æƒ…æ„Ÿä¸°å¯Œï¼Œå¼ºè°ƒæ„Ÿå— |
| Creator | è¿½æ±‚ç‹¬ç‰¹ï¼Œå–œæ¬¢åˆ›æ–° | é¼“åŠ±åˆ›æ„ï¼Œé¿å…å¥—è·¯ |
| Outlaw | æŒ‘æˆ˜æƒå¨ï¼Œè¿½æ±‚è‡ªç”± | å°Šé‡ç‹¬ç«‹æ€§ï¼Œä¸è¯´æ•™ |
| Magician | è¿½æ±‚è½¬åŒ–ï¼Œç›¸ä¿¡å¯èƒ½ | å¼ºè°ƒæ½œåŠ›ï¼Œæä¾›è½¬åŒ–è§†è§’ |
| Innocent | è¿½æ±‚ç¾å¥½ï¼Œéœ€è¦å®‰å…¨ | æ­£é¢ç§¯æï¼Œæä¾›å®‰æ…° |
| Jester | è¿½æ±‚å¿«ä¹ï¼Œå–œæ¬¢è½»æ¾ | å¹½é»˜é£è¶£ï¼Œä¸è¿‡äºä¸¥è‚ƒ |
| Regular | è¿½æ±‚å½’å±ï¼Œé‡è§†è¿æ¥ | å¹³å®äº²åˆ‡ï¼Œå¼ºè°ƒå…±åŒç‚¹ |

### B. ç‰ˆæœ¬å†å²

- **v7.0** (2026-01-19): é‡æ„ä¸ºç”¨æˆ·èº«ä»½æ ¸å¿ƒï¼Œæ”¯æŒåŠ¨æ€æ¼”åŒ–å’Œå…¨æ ˆæ•´åˆ
- **v6.0** (2026-01-15): V7 æ¶æ„å¯¹é½ï¼Œç®€åŒ–æ•°æ®æ¨¡å‹
- **v5.0** (2026-01-10): é…ç½®é©±åŠ¨çš„èåˆç®—æ³•
