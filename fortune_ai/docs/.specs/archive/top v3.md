╔═══════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                MENTIS v3.0 SYSTEM ARCHITECTURE                                     ║
║                                Stream-Centric Agentic Platform                                     ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                   ║
║  ┌─────────────────────────────────────────────────────────────────────────────────────────────┐ ║
║  │                                    🌐 CLIENT LAYER                                          │ ║
║  │  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐        │ ║
║  │  │   iOS App       │  │   Android App   │  │   Web App       │  │   WeChat Mini   │        │ ║
║  │  │   (React Native)│  │   (React Native)│  │   (Next.js)     │  │   (Taro)        │        │ ║
║  │  └────────┬────────┘  └────────┬────────┘  └────────┬────────┘  └────────┬────────┘        │ ║
║  │           └────────────────────┴────────────────────┴────────────────────┘                  │ ║
║  └───────────────────────────────────────────┬─────────────────────────────────────────────────┘ ║
║                                              │                                                    ║
║                                              │ HTTPS / WebSocket                                  ║
║                                              ▼                                                    ║
║  ┌───────────────────────────────────────────────────────────────────────────────────────────┐   ║
║  │                                   🚪 API GATEWAY                                          │   ║
║  │                          (Vercel Edge / Cloudflare Workers)                               │   ║
║  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐     │   ║
║  │  │ Rate Limit  │  │   Auth      │  │   Routing   │  │   CORS      │  │   Logging   │     │   ║
║  │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘     │   ║
║  └────────────────────────────────────────┬──────────────────────────────────────────────────┘   ║
║                                           │                                                       ║
║                                           ▼                                                       ║
║  ┌───────────────────────────────────────────────────────────────────────────────────────────┐   ║
║  │                              🧠 AGENT RUNTIME LAYER                                        │   ║
║  │                              (Next.js API Routes + Vercel AI SDK)                          │   ║
║  │                                                                                           │   ║
║  │   ┌─────────────────────────────────────────────────────────────────────────────────────┐│   ║
║  │   │                           STREAM PROCESSOR                                          ││   ║
║  │   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                ││   ║
║  │   │  │ STT Engine  │→ │ NLP Extract │→ │ Emotion Det │→ │ Action Match│                ││   ║
║  │   │  │ (Whisper)   │  │ (GPT-4)     │  │ (Custom)    │  │ (Embedding) │                ││   ║
║  │   │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘                ││   ║
║  │   └─────────────────────────────────────────────────────────────────────────────────────┘│   ║
║  │                                                                                           │   ║
║  │   ┌─────────────────────────────────────────────────────────────────────────────────────┐│   ║
║  │   │                           ORCHESTRATOR                                              ││   ║
║  │   │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                ││   ║
║  │   │  │Intent Class │  │Module Router│  │Context Build│  │A2UI Format  │                ││   ║
║  │   │  │意图分类器   │  │模块路由器   │  │上下文构建器 │  │输出格式化   │                ││   ║
║  │   │  └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘                ││   ║
║  │   └─────────────────────────────────────────────────────────────────────────────────────┘│   ║
║  └────────────────────────────────────────┬──────────────────────────────────────────────────┘   ║
║                                           │                                                       ║
║                    ┌──────────────────────┼──────────────────────┐                               ║
║                    │                      │                      │                               ║
║                    ▼                      ▼                      ▼                               ║
║  ┌─────────────────────────┐ ┌─────────────────────────┐ ┌─────────────────────────┐            ║
║  │    🔮 DECODE LAYER      │ │    🧩 REFRAME LAYER     │ │    🎯 EVOLVE LAYER      │            ║
║  │    (Plug & Play)        │ │    (认知重塑)           │ │    (行为进化)           │            ║
║  │  ┌───────────────────┐  │ │  ┌───────────────────┐  │ │  ┌───────────────────┐  │            ║
║  │  │ Module: BaZi      │  │ │  │ Module: CBT       │  │ │  │ Module: Habit     │  │            ║
║  │  │ Module: ZiWei     │  │ │  │ Module: ACT       │  │ │  │ Module: If-Then   │  │            ║
║  │  │ Module: MBTI      │  │ │  │ Module: NLP-Rw    │  │ │  │ Module: Momentum  │  │            ║
║  │  │ Module: Jung      │  │ │  │ Module: Stoic     │  │ │  │ Module: Streak    │  │            ║
║  │  └───────────────────┘  │ │  └───────────────────