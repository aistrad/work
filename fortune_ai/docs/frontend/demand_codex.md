# 小红书需求 → Mentis 系统设计改进建议（Codex 输出）

- 需求来源：`fortune_ai/docs/frontend/需求-小红书-20260101.txt`
- 现有设计参考：`fortune_ai/docs/core/system_design_final_mvp_v3.md`、`fortune_ai/docs/core/os_design_v3.md`、`fortune_ai/docs/core/modul_core_v3.md`
- 输出目标：把“小红书内容形态/用户问题/评论互动”的需求，映射为 Mentis v4.2 可落地的系统设计改进项（能力、数据、接口、交互、治理、落地节奏）
- 版本：v0.1（2026-01-02）

---

## 1. 需求洞察（从小红书样本反推）

### 1.1 高密度“需求信号”

样本内容虽非传统 PRD，但密集呈现了**用户真实问题**与**内容消费方式**：

- **强情绪入口**：失业/断交/失恋/内耗/健康焦虑（尤其“女性长辈健康”）、对未来不确定性的恐惧与求解。
- **核心质疑**：不想只听“会发生什么”，更想要“怎么解决难题/怎么变好”（样本里直接出现该句式）。
- **两类心智**并存：  
  - 宿命/确定性追求（“算准”“想知道结局”）  
  - 工具/行动导向（“坏结果是提醒规避”“改命先改性格”）
- **强互动场景**：评论区集中提问（“我属啥”“本命年怎么算”“红绳断了怎么办”“XX座怎么翻身”“要事业/财富/爱情”），需要高频、低成本、可复制的答复机制。

### 1.2 主流内容形态（决定系统需要“生产什么”）

从样本可抽象为 5 类“内容/服务”：

1. **年运/周运/星象盘**（12 星座，工作/财务/感情/健康四象限；带时间窗口与“注意事项”）
2. **生肖/本命年/民俗避雷**（红绳/颜色/属相边界：除夕/正月/立春口径冲突）
3. **情感与人格类解读**（星座性格/关系互动脚本，“情绪价值”与边界）
4. **塔罗内容**（科普+方法论：能量解析、流变/错位/同位；以及单卡/牌阵解读）
5. **评论区运营**（提问→答复→引导关注/私信/跳转的链路）

### 1.3 对 Mentis 的“产品机会”定义

将上述形态转译为 Mentis 的机会点：

- **“预测”必须落到“行动闭环”**：把玄学/占卜的输出统一收敛到 Mentis 的 `Commitment` 闭环（与现有 WCG 北极星指标一致）。
- **低门槛即时洞察**（强转化）：支持“星座/生肖/塔罗”也能在未登录时给 1 句洞察 + 1 个可执行动作（Landing Page/分享卡）。
- **模板化可复制**（高频评论场景）：把“评论区提问”视为一种输入格式，需要标准化解析与输出卡片。
- **治理优先**：小红书内容天然高敏（健康、财务、精神依赖），系统必须内建反依赖与安全兜底，而不是靠运营人工把关。

---

## 2. 现有系统设计现状（v4.2 SSOT）

### 2.1 架构与约束（已具备的“骨架”）

Mentis v4.2 关键底座在现有 core 文档中已明确：

- **Agent Runtime**：Next.js API Route 使用 Vercel AI SDK `streamText()` + `tool()`（可多步推理 `maxSteps`）
- **Data Service**：FastAPI 降级为 L0/L1 数据服务层（CRUD + 计算）
- **SSOT**：业务数据统一写入 PostgreSQL（DB=mentis）
- **产品硬约束**：纯 AI；不做公开社区 feed（仅隐私社交）；强调反依赖与行动闭环

### 2.2 能力覆盖与缺口（与小红书需求对齐）

从 `modul_core_v3.md`/`os_design_v3.md` 可见：

- `/divine` 规划包含：八字/紫微/星座（但紫微/星座仍待实现）
- `/heal` 已有 PERMA/CBT 思路，但“关系/边界/情绪价值”的高频话题尚缺专门的交互模板与卡片
- **未覆盖**：塔罗（样本占比高、且有方法论深度）
- **未成体系**：评论区运营（内容生产、快速回复、引导链路）在系统设计中尚未被定义为“模块”

---

## 3. 设计改进总览（从“内容需求”到“系统能力”）

下面给出一组**最小改动、与 v4.2 架构一致**的改进方向（按优先级）。

### 3.1 新增/补齐 L2 Expert Skills（保持 Tool Calling 一致性）

> 原则：所有新能力都以 `tool()` 形式进入 Skills Registry；输出统一走 A2UI card + Commitment。

**A. 补齐（现有设计缺口）**

- `calculate_ziwei`：紫微排盘与关键断点（先做到“可解释 + 可行动”，不要先追求全量技法）
- `astro_chart` / `astro_fortune`：西方星座基础能力拆分为两层  
  - `astro_chart`：计算（太阳/上升/月亮、关键宫位/相位的最小集）  
  - `astro_fortune`：基于时间窗口产出周运/年运结构化建议（工作/财务/感情/健康）

**B. 新增（小红书强需求）**

- `tarot_draw`：抽牌（支持可复现随机种子、正逆位）+ 返回牌面结构  
- `tarot_interpret`：基于牌阵 + 问题语境输出（包含“能量解析/流变/错位/同位”的结构化字段）
- `zodiac_resolver`：解决“我属啥/本命年怎么算”的口径冲突：同时给出  
  - 生肖（按农历春节）  
  - 八字年柱（按立春）  
  - 并解释差异与“该用哪个”取决于场景

### 3.2 A2UI 输出扩展（支撑“内容形态”）

建议新增/规范 4 类卡片（避免把长文塞进 chat 文本）：

- `astro_fortune_card`：时间窗口 + 四象限（事业/财务/感情/健康）+ 1 个“本周最小行动”
- `zodiac_explain_card`：生肖结果 + 口径差异解释 + 快速 FAQ（可复用到评论回复）
- `tarot_spread_card`：牌阵可视化（位置含义）+ 结论/风险点/行动建议
- `xhs_reply_card`：针对评论输入的“短答复”模板：  
  - 先共情一句 → 给 1 个结论 → 给 1 个行动 → 给 1 个可选追问（减少追问成本）

### 3.3 “评论区输入”作为一等公民（解析与路由）

样本评论具备稳定模式：`{生日/星座/生肖} + {诉求}`，或纯诉求（“怎么办”）。

建议在 Intent Detection 前增加轻量解析器：

- `input_channel = xhs_comment|xhs_dm|app_chat`
- `input_kind = ask_zodiac|ask_fortune|ask_relationship|ask_tarot|ask_health_anxiety|...`
- 对 `ask_zodiac`/`ask_tarot` 这类高确定性问题：优先走 Command Mode（减少 LLM 乱跑）

---

## 4. 数据与接口（SSOT 扩展建议）

### 4.1 数据表建议（不破坏现有命名体系）

> 目标：把“内容生产/解读/回复/分享”纳入可审计、可复用、可度量的 SSOT。

**A. 占卜类会话归档（可选，但强烈建议）**

- `fortune_divination_session`：统一承载 bazi/ziwei/astro/tarot 的一次“解读会话”  
  - 字段建议：`type`、`input`、`result_card`、`safety_flags`、`created_at`、`source_channel`

**B. 塔罗专用（如果需要更细审计）**

- `fortune_tarot_draw`：抽牌记录（牌 ID、正逆位、种子、牌阵位）

**C. 内容资产（支持运营/模板化复用）**

- `fortune_content_asset`：标题/正文/话题标签/封面文案/引用来源（可选）/适用平台（xhs/douyin/…）
- `fortune_content_template`：可热更新模板（与 Admin Prompt 热更新体系对齐）

**D. 分享与转化归因（不做站内广场，也能做外部分享）**

- `fortune_share_link`：短链/邀请码/来源渠道（xhs_post/xhs_comment_reply/…）→ 注册归因

### 4.2 API/路由建议（与 v4.2 分层一致）

- **Next.js Agent Runtime**：新增 Tool 调用所需的 `/api/chat` 内部 tool handlers（TS），保持流式输出。
- **FastAPI Data Service**：新增纯计算/查询端点（不承载推理）  
  - `POST /api/astro/chart`、`POST /api/zodiac/resolve`、`POST /api/tarot/draw`（抽牌也可放 TS，但若需统一审计可落 Python+DB）
- **Landing Page**：扩展 `POST /api/landing/insight` 的 `input_type`：  
  - `bazi|emotion|astro|zodiac|tarot`（仍保持“短输出 + 不存储/或匿名存储”策略）

---

## 5. 交互与体验（把小红书内容“产品化”）

### 5.1 /divine 的多模态入口（避免用户迷路）

建议把 `/divine` 细分为 4 个显式子模式（UI Tab 或二级选择）：

- 八字（输入出生）
- 星座（输入生日/选择星座 + 选择时间窗口：日/周/月/年）
- 生肖（输入农历/阳历 + 自动解释口径）
- 塔罗（输入问题 + 选择牌阵：1/3/5 张）

每个子模式都必须输出：`结论（短） + 风险提醒（短） + 1 个 Commitment`。

### 5.2 面向评论区的“短答复模式”

在 Admin（或运营侧页面）提供一个最小工作台：

1. 粘贴评论文本（可批量）
2. 自动识别类型（生肖/星座/情感/塔罗）
3. 生成 2~3 个不同风格的回复（standard/warm/roast 受控）
4. 一键复制：短回复 / 长回复 / 话题标签（#星座 #运势 …）
5. 自动生成落地页引导语（不恐吓，不诱导沉迷）

---

## 6. 治理与安全（小红书场景的“必答题”）

### 6.1 反依赖强化（对齐现有产品原则）

样本中大量“求确定性/求安慰”的文本，极易触发依赖。建议把反依赖策略前置到新模块：

- 塔罗/运势类输出：强制给“可执行动作”，并限制连续追问的形态（先做反馈再继续）
- 健康相关：只做情绪安抚与就医建议，不做诊断与治疗结论；卡片中显式提示“需要专业帮助”
- 财务相关：禁止具体投资建议；输出“风险框架 + 行动实验（预算/记账/沟通）”

### 6.2 可追溯与审核

- 运营内容（标题/正文/回复）应落库（`fortune_content_asset`），并支持在 Admin 中审计与回溯
- 对“高风险主题”（疾病/自伤/极端情绪）打 `safety_flags`，并走更保守的回复模板

---

## 7. 落地路径（按最小可用闭环拆分）

> 目标：先让“星座/生肖/塔罗”在产品内形成闭环，再谈规模化运营与增长自动化。

### P0（1~2 周）：补齐基础计算 + 标准卡片

- 补齐 `zodiac_resolver`（解决属相口径问题）+ `zodiac_explain_card`
- 实现 `astro_fortune` 最小版（先做“周运”，四象限+行动）
- 塔罗先做 1 张/3 张牌阵：`tarot_draw` + `tarot_spread_card`（含能量解析最小字段）
- 所有输出都落到 `Commitment`（复用现有闭环）

### P1（2~4 周）：运营资产与分享链路

- `fortune_content_asset` + Admin 最小工作台（生成标题/正文/标签/引导语）
- 海报模板扩展：星座周运/年运、塔罗单卡（适配小红书尺寸）
- `fortune_share_link` 归因：来自“评论回复/笔记/海报”的注册来源可被度量

### P2（4~8 周）：个性化与冷路径沉淀

- Insight Agent 增强：从对话/评论输入提取用户偏好（事业/情感/健康优先级），用于个性化运势结构
- 塔罗进阶：牌阵教学模式（流变/错位/同位）+ 用户练习轨道（30 天）
- A/B：不同回复模板对转化与 WCG 的影响（不追求“更玄”，追求“更可执行”）

---

## 8. 结论（对 core 文档的具体改动建议清单）

不直接修改 core 文档，先给出“应补齐/应新增”的条目，便于后续回写到 `fortune_ai/docs/core/*`：

- 在 `modul_core_v3.md`：将 `/divine` 的“星座/紫微未实现”拆为明确 P0/P1；新增“塔罗”子模块与卡片类型。
- 在 `os_design_v3.md`：为“评论区输入/运营内容资产”补一条 Cold Path（内容沉淀与模板优化），但保持“纯 AI + 无站内广场”约束。
- 在 `system_design_final_mvp_v3.md`：补充新增表（`fortune_divination_session`/`fortune_content_asset`/`fortune_share_link` 等）与对应 API 的最小设计。

